(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[5676],{24237:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a,r,n=s(87363);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},i.apply(this,arguments)}const o=e=>n.createElement("svg",i({fill:"none",viewBox:"0 0 18 18",xmlns:"http://www.w3.org/2000/svg"},e),a||(a=n.createElement("rect",{width:"100%",height:"100%",rx:4})),r||(r=n.createElement("path",{fill:"currentColor",d:"M5.456 7.846 3.95 9.353l4.02 4.02 1.507-1.507L14.5 6.84l-1.507-1.507-5.025 5.025z"})))},43871:(e,t,s)=>{"use strict";s.d(t,{N:()=>a});var a=function(){return"undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement}},73832:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"AuthDialog.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(5095),s.e(8946)]).then(s.bind(s,88901)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 88901}},{ssr:!1}),o=i},89193:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"DebugPanel.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(3710),s.e(7671)]).then(s.bind(s,77536)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 77536}},{ssr:!1}),o=i},6476:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"Gallery.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(6122),s.e(9427)]).then(s.bind(s,43507)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 43507}},{ssr:!1}),o=i},39010:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"PassportRegistrationChecker.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(6952).then(s.bind(s,19599)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 19599}},{ssr:!1}),o=i},60136:(e,t,s)=>{"use strict";s.d(t,{D:()=>i});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"ShortcutDrawer.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(6122),s.e(5543)]).then(s.bind(s,90115)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 90115}},{resolveComponent:e=>e.ShortcutDrawer})},48225:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"BalanceRefilled.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(4521).then(s.bind(s,72067)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 72067}},{ssr:!1}),o=i},92999:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"Feedback.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(6122),s.e(7110)]).then(s.bind(s,88700)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 88700}},{ssr:!1}),o=i},59389:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"MergeConflictsDialog.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(3925).then(s.bind(s,10618)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 10618}},{}),o=i},11775:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"PlayGameHeaderMenu.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(3710),s.e(4932)]).then(s.bind(s,45977)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 45977}},{}),o=i},69833:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"PlayPurchaseDialog.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(6122),s.e(3710),s.e(5095),s.e(8726)]).then(s.bind(s,61258)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 61258}},{ssr:!1}),o=i},43633:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"PlaySimilarGamesManager.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(6122),s.e(9359)]).then(s.bind(s,48673)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 48673}},{}),o=i},87005:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"InGameProfilePopup.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(888).then(s.bind(s,44194)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 44194}},{}),o=i},125:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"QuestManager.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(3111).then(s.bind(s,29223)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 29223}},{ssr:!1}),o=i},58097:(e,t,s)=>{"use strict";s.d(t,{c:()=>i});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"UserContainer.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(6122),s.e(3710),s.e(1891)]).then(s.bind(s,37205)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 37205}},{resolveComponent:e=>e.UserContainer})},33196:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var a=s(87363),r=s.n(a),n=s(86976),i=s(1481);const o=(0,n.Z)({resolved:{},chunkName:()=>"Promo.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(5095),s.e(3660)]).then(s.bind(s,55140)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 55140}},{ssr:!1,error:i.Z}),d=o},13048:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"ScopesDialog.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(7925).then(s.bind(s,31330)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 31330}},{}),o=i},33381:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"ShortcutPopup.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(6587).then(s.bind(s,82579)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 82579}},{}),o=i},41103:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"ShortcutManager.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(18).then(s.bind(s,37903)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 37903}},{ssr:!1}),o=i},89775:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"UserActivityPopup.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(987).then(s.bind(s,58278)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 58278}},{}),o=i},47774:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(87363),r=s.n(a),n=s(86976);const i=(0,n.Z)({resolved:{},chunkName:()=>"UxFeedbackFrame.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>s.e(7191).then(s.bind(s,87880)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 87880}},{ssr:!1}),o=i},81839:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var a=s(87363),r=s.n(a),n=s(86976),i=s(77976);const o=(0,n.Z)({resolved:{},chunkName:()=>"GameInfo.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(6122),s.e(3710),s.e(4818),s.e(3936),s.e(805)]).then(s.bind(s,2963)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return 2963}},{error:i.Z}),d=o},17780:(e,t,s)=>{"use strict";s.d(t,{E:()=>r});var a=s(95765);const r=({baseUrl:e,path:t,lang:s,languages:r,tld:n="ru"})=>{let i="";void 0!==s&&(i=(({lang:e,languages:t,tld:s})=>"com"===s&&"en"!==e&&t.includes(e))({languages:r,lang:s,tld:n})?`${s}/`:"");let o=`${`${e}${i?`/${i.replace(/\/*$/,"")}`:""}`}${t}`;return i&&(o=(0,a.D)(o)),o}},61910:(e,t,s)=>{"use strict";s.d(t,{X:()=>b});var a=s(87363),r=s.n(a),n=s(16949),i=s(24237),o=s(9579),d=s(39672);const l={"sz-18":"checkbox-critical-module__sz-18--bkrJI","align-top":"checkbox-critical-module__align-top--LZGTh","align-center":"checkbox-critical-module__align-center--P6SxJ","align-bottom":"checkbox-critical-module__align-bottom--YTlvt",checkbox:"checkbox-critical-module__checkbox--QSq4A",checked:"checkbox-critical-module__checked--iGuDb",disabled:"checkbox-critical-module__disabled--BAmph",part:"checkbox-critical-module__part--XjCPu",control:"checkbox-critical-module__control--gdlIp",tick:"checkbox-critical-module__tick--Csl14",wrapper:"checkbox-critical-module__wrapper--XCy8g"};let c;var h=Object.defineProperty,u=Object.defineProperties,p=Object.getOwnPropertyDescriptors,m=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,w=(e,t,s)=>t in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;const f={...(c=s(22695))&&c.default||{}},y=(0,a.forwardRef)(((e,t)=>{const s=e,{align:c="center",className:h="",size:y,checked:b=!1,disabled:k=!1,onChange:A,onKeyDown:E,onKeyUp:S,label:I}=s,P=((e,t)=>{var s={};for(var a in e)v.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&m)for(var a of m(e))t.indexOf(a)<0&&g.call(e,a)&&(s[a]=e[a]);return s})(s,["align","className","size","checked","disabled","onChange","onKeyDown","onKeyUp","label"]),R=`input-${(0,a.useId)()}`,T=(0,a.useCallback)((e=>{!k&&(null==A||A(e))}),[k,A]),C=(0,d.c)({variant:"checkbox-label"});return r().createElement("div",{className:(0,o.y)(l.checkbox,k&&l.disabled,b&&l.checked,l[`align-${c}`],l[`sz-${y}`])},I&&r().createElement("label",{className:(0,o.y)(l.part,f.label,C),htmlFor:R},I),r().createElement("div",{className:(0,o.y)(l.wrapper,l.part)},r().createElement("div",{className:(0,o.y)(l.tick)},b&&r().createElement(n.Z,{size:18},r().createElement(i.Z,null))),r().createElement("input",(D=((e,t)=>{for(var s in t||(t={}))v.call(t,s)&&w(e,s,t[s]);if(m)for(var s of m(t))g.call(t,s)&&w(e,s,t[s]);return e})({type:"checkbox"},P),L={autoComplete:"off",checked:b,className:(0,o.y)(h,l.control),disabled:k,id:R,ref:t,onChange:T},u(D,p(L))))));var D,L}));y.displayName="Checkbox";const b=(0,a.memo)(y)},82646:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>Rr});var a=s(38096),r=s(26108),n=s(85383),i=s(87363),o=s.n(i),d=s(29994),l=s(31320),c=s(43548),h=s(43876);const u="achv-manager";var p=s(68878),m=s(37705),v=s(40656),g=s(93298);const w=class{};w.achvPropsNamesMapping={slug:"id",status:"type",target:"cost",title:"name"},w.achvPropsValuesMapping={target:({goal:e})=>e},w.achvStatusMapping={allGlobal:"all_global",allLocal:"all_local",completed:"completed",inProgress:"in_progress",expired:"expired"},w.mapAcvToAchvEntity=e=>Object.entries(e).reduce(((e,[t,s])=>{const a=w.achvPropsValuesMapping[t];let r=s;return a&&(r=a(s)),e[w.achvPropsNamesMapping[t]||t]=r,e}),{}),w.mapAchvStatus=e=>w.achvStatusMapping[e];let f=w;var y=Object.defineProperty,b=Object.getOwnPropertySymbols,k=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,E=(e,t,s)=>t in e?y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,S=(e,t)=>{for(var s in t||(t={}))k.call(t,s)&&E(e,s,t[s]);if(b)for(var s of b(t))A.call(t,s)&&E(e,s,t[s]);return e},I=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const P=class{};P.setProgressErrMsg="Achievements | setProgress: cannot set achievement progress",P.getProgressErrMsg="Achievements | getProgress: cannot get achievement progress",P.getListErrMsg="Achievements | getList: cannot load achievements list",P.incorrectActionTypeErrMsg="Incorrect action type",P.logPrefix="Achievements | Parent frame",P.logColor={background:"#355c7d",text:"#ffffff"},P.debugLog=(0,g.M$)(P.logPrefix,g.XG.Dev,P.logColor),P.path="/achievements",P.timeout=5*v.WT*(0,l.n)(),P.lang=p.g.RU,P.isInitialized=!1,P.init=e=>{P.lang=e,P.isInitialized||(c.Z.onExternalMessage(u,P.onMessage),P.isInitialized=!0)},P.onMessage=({data:{type:e,action:t,data:s}},a)=>{const r=e=>a({data:{success:!0,result:e}}),n=e=>a({data:{success:!1,error:e}});switch(P.debugLog(`received ${u} messages event: `,e,t,s),t){case"setProgress":P.setProgress(s).then(r).catch((()=>n(P.setProgressErrMsg)));break;case"getProgress":P.getList(null,null==s?void 0:s.id).then((e=>{if(!e.length)return Promise.reject();r(e[0].progress)})).catch((()=>n(P.getProgressErrMsg)));break;case"getList":P.getList((null==s?void 0:s.status)||null).then(r).catch((()=>n(P.getListErrMsg)));break;default:P.log(new Error(`${P.incorrectActionTypeErrMsg}: ${t}`))}},P.setProgress=(...e)=>I(P,[...e],(function*(e={}){const{id:t,progress:s}=e;return t&&void 0!==s?P.fetch([],{method:"PATCH",body:JSON.stringify({slug:t,progress:{score:s}}),headers:new Headers({"content-type":"application/json"})}).then((({data:e})=>f.mapAcvToAchvEntity(e))):Promise.reject()})),P.getList=(e,t="")=>I(P,null,(function*(){if(Boolean(e&&e.length)===Boolean(t))return Promise.reject();const s=[["lang",P.lang]];return e&&e.length&&s.push(["status",f.mapAchvStatus(e[0])]),t&&s.push(["slug",t]),P.fetch(s).then((({data:e})=>e.map((e=>f.mapAcvToAchvEntity(e)))))})),P.fetch=(...e)=>I(P,[...e],(function*(e=[],t={}){const s=new URLSearchParams(e).toString();return(0,h.rQ)({apiPath:`${P.path}${s?"?"+s:""}`,options:S(S({},{credentials:"include",method:"GET"}),t),timeout:P.timeout}).catch((e=>{throw P.log(e),e}))})),P.log=({name:e="Error",message:t="Unknown achievements error"},s="")=>{const a=`${e}: ${t}`;P.debugLog(a),(0,m.H)({block:P.logPrefix,message:a,source:P.logPrefix,sourceMethod:s})};let R=P;const T=(0,i.memo)((({lang:e})=>((0,i.useEffect)((()=>R.init(e)),[e]),o().createElement(o().Fragment,null))));var C=s(57650),D=s(23678),L=s(45331),O=s(59303),x=s(77123);const _=s(73832).Z;var B=s(33119),N=s(14184),M=s(68279),$=s(21466),F=s(81470),q=s(42126),W=s(58432),Z=s(36880),G=s(76488),U=s(17254),H=s(91605),j=s(77901),z=s(41811),V=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const K=(0,g.M$)("auth-dialog-manager",g.XG.Dev);class Y extends i.Component{constructor(e){var t;super(e),this.state={requestId:"",visible:!1},this.checkLogin=()=>{const e=(0,Z.e)(this.authCookieName);this.login&&e&&this.login!==e&&(K("AuthDialogManager: change_account"),(0,H.U4)({},{backgroundAuthChange:"change_account"})),this.login=e},this.onInternalMessage=(e,t)=>{const{action:s,data:a}=e.data;if(this.isDisabled)return t({error:new Error("auth disabled")});"open"!==s&&"open-auth-window"!==s||(this.close(),this.setState({requestId:a.requestId},(()=>{this.createAuthPromise(e,t)})))},this.onAuthChanged=e=>{const{action:t,data:s}=e.data;["changed","auth-dialog-success"].includes(t)&&s.hasAuth!==this.props.hasAuth&&this.props.getUserPassport()},this.onDialogApply=()=>{this.sendParams("ok");const e=this._openAuthWindow();e?this.resolvePromise(e):this.rejectPromise(new M.Z({code:"AUTH_WINDOW_REJECTED",message:"Can not open auth window."})),this.close()},this.onDialogClose=()=>{this.sendParams("cancel"),this.close()};const s=(null==(t=(0,a.getDomainConfig)().auth)?void 0:t.provider)===O.Ho.XSOLLA;this.authCookieName=s?"xsolla_login":"yandex_login",this.login=(0,Z.e)(this.authCookieName)}componentDidMount(){c.Z.onInternalMessage("auth-dialog",this.onInternalMessage),c.Z.onInternalMessage("auth",this.onAuthChanged,{withHistory:!0}),document.addEventListener("visibilitychange",this.checkLogin)}componentWillUnmount(){c.Z.offInternalMessage("auth-dialog",this.onInternalMessage),c.Z.offInternalMessage("auth",this.onAuthChanged),document.removeEventListener("visibilitychange",this.checkLogin)}componentDidUpdate(e){e.hasAuth!==this.props.hasAuth&&(this.login=(0,Z.e)(this.authCookieName),this.props.hasAuth?this.props.fetchPlatformSubscriptions():this.props.clearPlatformSubscriptions())}createAuthPromise(e,t){const{action:s,data:a}=e.data;let r;switch(s){case"open-auth-window":r=this.openAuthWindow(!1,a.origin);break;case"open":r=this.open();break;default:return}r.then((e=>t({data:{authWindow:e}}))).catch((e=>{K(`${s} auth dialog error`,e),t({error:e})}))}sendParams(e){H.Eu.params({borrowParams:{sdk:{auth:{dialog:e,appId:this.context.playPageData.gameInfo.appId}}}})}open(){return V(this,null,(function*(){if(this.props.hasAuth)return;if(!this.props.inCurrentTab){const e=yield this._tryOpenAuthWindowOnStart();if(e)return Promise.resolve(e)}const e=this.setPromise();return this.showDialog(),e.promise}))}openAuthWindow(e=!1,t){return V(this,null,(function*(){if(e)return Promise.resolve(this._openAuthWindow(t)||void 0);const{data:s}=yield c.Z.post({type:"auth",action:"has-auth"}),{hasAuth:a}=s;return!a&&this._openAuthWindow(t)||void 0}))}_tryOpenAuthWindowOnStart(){return function(){const{userAgent:e}=window.navigator;return!/^((?!chrome|android).)*safari/i.test(e)&&!/\sFirefox\//.test(e)&&!!/\sChrome\//.test(e)}()&&this.openAuthWindow()||Promise.resolve(void 0)}showDialog(){this.setState({visible:!0})}setPromise(){if(this.openPromise)return this.openPromise;let e=()=>{},t=()=>{};const s={promise:new Promise(((s,a)=>{e=s,t=a})),resolve:e,reject:t};return this.openPromise=s,s}resolvePromise(e){this.openPromise&&(this.openPromise.resolve(e),this.openPromise=null)}rejectPromise(e){this.openPromise&&(this.openPromise.reject(e),this.openPromise=null)}close(){this.setState({requestId:"",visible:!1}),this.rejectPromise(new M.Z({code:"AUTH_DIALOG_CANCEL",message:"User canceled auth dialog."}))}_openAuthWindow(e="games_sdk_auth"){const t=(0,j.zd)(),s=(0,W.KT)(),r=z.XL.includes(s),n=this.props.inCurrentTab||t||r||this.context.isTranssion,{provider:i}=(0,a.getDomainConfig)().auth||{};let o="";n?(o=window.location.href,r&&(o=(0,q.Z)({url:o,params:{clid:s}}))):o=(0,$.EP)(`${location.origin}${this.context.baseUrl}/sdk/static/auth-retpath.html?req-id=${encodeURIComponent(this.state.requestId)}&origin=${encodeURIComponent(window.origin)}&version=${encodeURIComponent(this.context.version)}`);const d=(0,U.x)()?G.tu:"";let l=`https://${(0,G.GH)()}/auth${d}?from=game&origin=${encodeURIComponent(e)}&retpath=${encodeURIComponent(o)}`;const{requestId:c}=this.state;if(this.props.isOauth){if(!c)return void(0,N.fF)(new Error("No requestId for OAuthURL"));l=F.Z.getOauthUrl(c)}else if(i===O.Ho.XSOLLA){if(!c)return void(0,N.fF)(new Error("No requestId for XSollaUrl"));l=F.Z.getXsollaAuthUrl(c)}if(!n)return window.open(l,"_blank");window.location.href=l}get isDisabled(){const e=(0,W.KT)();return z.TZ.includes(e)}render(){return this.state.visible?o().createElement(_,{onApply:this.onDialogApply,onClose:this.onDialogClose}):null}}Y.contextType=L.Z;const X=(0,d.$j)((function(e){return{isOauth:e.userData.isOauth,hasAuth:Boolean(e.userData.login)}}),(function(e){return(0,x.DE)({getUserPassport:B.Ps,fetchPlatformSubscriptions:B.VR,clearPlatformSubscriptions:B.cp},e)}))(Y);var J=s(68797),Q=s(24029),ee=s(88372),te=s(92999),se=s(11324),ae=s(79409),re=s(35090);class ne extends L.P{constructor(){super(...arguments),this.state={dialogIsRequested:!1,dialogWasRequested:!1,isCanShow:!1,reason:"UNKNOWN",wasTriggered:!1},this.onInternalMessage=e=>{var t,s;if("request-review"===e.data.action){this.setState({dialogIsRequested:!0});const{gameInfo:e}=this.context.playPageData,a=null==(s=null==(t=this.context.playPageData)?void 0:t.gameData)?void 0:s.media;this.props.dispatch((0,B.N3)({appID:parseInt(e.appId,10),gameID:e.appId,pictureUrl:a?(0,se.Jn)(a,{size:z.xY.YOUR_GAMES}):"",game:e,gameName:e.title}))}},this.onExternalMessage=(e,t)=>{switch(e.data.action){case"request-review":this.setPromise(),this.openPopupDialog().then((e=>{this.setState({dialogIsRequested:!1},(()=>{t({data:e})}))})).catch((e=>{t({data:{feedbackSent:!1,reason:e}})}));break;case"can-review":this.releasePromise(),this.canShowPopup().then((({hasAuth:e,rated:s,isCanShow:a,reason:r})=>{a?this.setState({isCanShow:a},(()=>{t({data:{value:a}})})):this.state.wasTriggered&&r?t({data:{reason:r,value:a}}):s?this.setState({reason:"GAME_RATED",wasTriggered:!0},(()=>{t({data:{reason:"GAME_RATED",value:!1}})})):e?this.setState({isCanShow:!0,wasTriggered:!0},(()=>{t({data:{value:!0}})})):this.setState({reason:"NO_AUTH",wasTriggered:!0},(()=>{t({data:{reason:"NO_AUTH",value:!1}})}))})).catch((()=>{this.setState({reason:"UNKNOWN",wasTriggered:!0},(()=>{t({data:{reason:"UNKNOWN",value:this.state.isCanShow}})}))}))}}}componentDidMount(){var e;const{gameInfo:t}=this.context.playPageData,s=null==(e=this.context.playPageData.gameData)?void 0:e.media;this.props.dispatch((0,B.N3)({appID:parseInt(t.appId,10),gameID:t.appId,pictureUrl:s?(0,se.Jn)(s,{size:z.xY.YOUR_GAMES}):"",game:t,gameName:t.title})),c.Z.onExternalMessage("feedback",this.onExternalMessage),c.Z.onInternalMessage("feedback",this.onInternalMessage)}componentWillUnmount(){c.Z.offExternalMessage("feedback",this.onExternalMessage),c.Z.offInternalMessage("feedback",this.onInternalMessage),this.props.dispatch((0,B.N3)({appID:null,gameID:null,rating:0,text:""}))}componentDidUpdate(e){if(this.promiseWrapper&&e.appID&&!this.props.appID&&["ready","success","error"].includes(e.state)){const{result:t,state:s}=e;"success"===s?this.promiseWrapper.resolve(t):this.promiseWrapper.reject(new Error("Unknown")),this.promiseWrapper=void 0}}releasePromise(){this.promiseWrapper&&(this.promiseWrapper.reject(new Error("Reject")),this.promiseWrapper=void 0)}setPromise(){this.releasePromise(),this.promiseWrapper=new r.Z}canShowPopup(){return new Promise(((e,t)=>{if((0,U.x)())return e({isCanShow:!1,reason:"REQUESTED_FROM_TV"});const{feedbackSettings:s}=(0,a.getDomainConfig)();if(!(0,ae.w)(this.context.tld,null==s?void 0:s.allowedTlds))return e({isCanShow:!1,reason:"UNKNOWN"});c.Z.post({type:"auth",action:"has-auth"}).then((({data:s})=>{const{hasAuth:a}=s;if(a&&G.XK&&"NO_AUTH"===this.state.reason)return void e({isCanShow:!0});if(this.state.wasTriggered&&this.state.isCanShow)return void e({isCanShow:this.state.isCanShow});if(this.state.wasTriggered&&!this.state.dialogIsRequested&&!this.state.dialogWasRequested)return void e({isCanShow:this.state.isCanShow,reason:this.state.reason});if(!a&&G.XK)return void e({isCanShow:!1,reason:"NO_AUTH"});if(this.state.dialogIsRequested)return void e({isCanShow:!1,reason:"REVIEW_ALREADY_REQUESTED"});if(this.state.dialogWasRequested)return void e({isCanShow:!1,reason:"REVIEW_WAS_REQUESTED"});const{appId:r}=this.context.playPageData.gameInfo;this.props.dispatch((0,B.bq)(parseInt(r,10))).then(e).catch(t)}))}))}openPopupDialog(){var e;return this.state.wasTriggered&&this.state.isCanShow&&!this.state.dialogIsRequested&&!this.state.dialogWasRequested||(0,re._G)()?(this.setState({dialogIsRequested:!0,dialogWasRequested:!0,isCanShow:!1}),(null==(e=this.promiseWrapper)?void 0:e.promise)||Promise.reject(new Error("Unexpected error"))):Promise.reject(new Error("Unexpected usage (use canReview before requestReview)"))}render(){return this.state.dialogIsRequested?o().createElement(te.Z,null):null}}const ie=(0,d.$j)((function(e){return{appID:e.feedback.appID,rating:e.feedback.rating,result:e.feedback.result,state:e.feedback.state}}))(ne);var oe=s(14555),de=s(64865),le=s(25971),ce=s(37341);const he=(0,i.memo)((()=>{const{gameplaySwitch:e}=(0,ce.jT)(),t=(0,i.useCallback)((({data:t})=>e(t.action)),[e]);return(0,i.useEffect)((()=>(c.Z.onExternalMessage(le.Tn,t,{withHistory:!1}),()=>c.Z.offExternalMessage(le.Tn,t))),[t]),o().createElement(o().Fragment,null)}));var ue=s(25873),pe=s(5314);const me=()=>{const[e,t]=(0,i.useState)(""),s=(0,i.useCallback)((e=>{"show"===e.data.action&&t(e.data.data.message)}),[]);return(0,i.useEffect)((()=>(c.Z.onInternalMessage("message-box",s),()=>{c.Z.offInternalMessage("message-box",s)})),[s]),e?o().createElement(pe.Z,{autohide:!0},e):null};var ve=s(6006),ge=s(52362),we=s(68712),fe=s(73320),ye=s(15227),be=s(24878),ke=s(67404),Ae=s(85467),Ee=s(37557),Se=s(94671),Ie=s(73285),Pe=s(29008);const Re={container:"MiddleLayerInfo-critical-module__container--xC5MO",icon:"MiddleLayerInfo-critical-module__icon--gzeuw",description:"MiddleLayerInfo-critical-module__description--CIEPH",titleAndAbout:"MiddleLayerInfo-critical-module__titleAndAbout--Y3oiD",title:"MiddleLayerInfo-critical-module__title--ZX5_W",about:"MiddleLayerInfo-critical-module__about--jfILA",aboutIcon:"MiddleLayerInfo-critical-module__aboutIcon--hyyN8",ratings:"MiddleLayerInfo-critical-module__ratings--lzDf2",categoriesAndDeveloper:"MiddleLayerInfo-critical-module__categoriesAndDeveloper--e7xsk",categories:"MiddleLayerInfo-critical-module__categories--prxAH",developer:"MiddleLayerInfo-critical-module__developer--cFRtk",divider:"MiddleLayerInfo-critical-module__divider--_BIxg",playAndLegal:"MiddleLayerInfo-critical-module__playAndLegal--_aj1p",apply:"MiddleLayerInfo-critical-module__apply--aZc7p",legal:"MiddleLayerInfo-critical-module__legal--mKvwC"};function Te({className:e,onAbout:t,onPlay:s}){const{playPageData:a}=(0,i.useContext)(L.Z),{gameInfo:r,gameData:n}=a,d=null==n?void 0:n.media,l=(0,Ie.T)(r.title);return o().createElement("div",{className:(0,Se.E)(Re.container,e),"data-testid":"middle-layer-info"},o().createElement(ye.Z,{alt:l,media:null!=d?d:{},mix:Re.icon,size:z.xY.S}),o().createElement("div",{className:Re.description},o().createElement(Ce,{onAbout:t}),o().createElement(De,null),o().createElement(Le,null),o().createElement(Oe,{onPlay:s})))}function Ce({onAbout:e}){const{playPageData:t}=(0,i.useContext)(L.Z),{gameInfo:s}=t,a=(0,Ie.T)(s.title),r=(0,Ae.T)(),n=(0,i.useMemo)((()=>o().createElement(xe,null)),[]);return o().createElement("div",{className:Re.titleAndAbout},o().createElement("h1",{className:Re.title,itemScope:!0,itemType:"http://schema.org/WebPage"},a),o().createElement(ve.z,{className:Re.about,iconLeft:n,size:32,view:"empty",onClick:e},r("game.description.title")))}function De(){var e;const{playPageData:t}=(0,i.useContext)(L.Z),{gameInfo:s,gameSettings:a}=t,r=s.gameQualityScore,n=s.rating,d=null==(e=a.features)?void 0:e.age_rating;return r||n?o().createElement("div",{className:Re.ratings},r&&o().createElement(be.Z,{value:r}),o().createElement(ke.Z,{hasWebAppsCategory:!1,rating:n}),d&&o().createElement(ge.Wd,{variant:Pe.Ft[d]},d)):null}function Le(){var e;const{playPageData:t,categoryDataMappedByID:s}=(0,i.useContext)(L.Z),{gameData:a,gameInfo:r,gameSettings:n}=t,d=null==a?void 0:a.categoryIDs,l=null==a?void 0:a.developer,c=!r.gameQualityScore&&!r.rating,h=null==(e=n.features)?void 0:e.age_rating;if(d||l)return o().createElement("div",{className:Re.categoriesAndDeveloper},d&&o().createElement("div",{className:Re.categories},d.map((e=>{const t=s[e];if(t)return o().createElement(we.Z,{key:e,name:t.name,title:t.title,type:fe.q.CLEAR,withIcon:!0,withLink:!0})}))),l&&o().createElement(o().Fragment,null,o().createElement("div",{className:Re.divider},"·"),o().createElement("div",{className:Re.developer},l.name)),c&&h&&o().createElement(o().Fragment,null,o().createElement("div",{className:Re.divider},"·"),o().createElement(ge.Wd,{variant:Pe.Ft[h]},h)))}function Oe({onPlay:e}){const{baseHost:t}=(0,i.useContext)(L.Z),{verticalName:s}=(0,Ee.C)((e=>e.vertical)),a=(0,Ae.T)();return o().createElement("div",{className:Re.playAndLegal},o().createElement(ve.z,{className:Re.apply,size:40,view:"primary",onClick:e},a(`common.play.vertical-${s}`)),o().createElement("div",{className:Re.legal},a(`guard.legal.text.vertical-${s}`)," ",o().createElement("a",{className:"games-link",href:a("guard.license.link.href"),target:"_blank"},a("guard.license.link.text"))))}function xe(){return o().createElement("svg",{height:"16",width:"16"},o().createElement("g",{fill:"currentColor"},o().createElement("path",{d:"M7 8a1 1 0 0 1 2 0v3a1 1 0 1 1-2 0V8ZM8 4a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z"}),o().createElement("path",{d:"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16Zm0-2A6 6 0 1 0 8 2a6 6 0 0 0 0 12Z","fill-rule":"evenodd"})))}var _e=s(61910);const Be={root:"MiddleLayerPermissions-critical-module__root--gBAO9",withBorder:"MiddleLayerPermissions-critical-module__withBorder--jxk7C",left:"MiddleLayerPermissions-critical-module__left--ivnpq",right:"MiddleLayerPermissions-critical-module__right--mVNla",permissionText:"MiddleLayerPermissions-critical-module__permissionText--VApoo"};var Ne=s(32054),Me=s(41318);const $e=e=>{const{permissionChecked:t,categoryNames:s,onPermissionChange:a}=e,r=(0,i.useContext)(L.Z),n=(0,Ae.T)(),{playPageData:l,userRegionData:c}=r,{gameData:h}=l,u=s||(null==h?void 0:h.categoriesNames)||[],p=(0,Ne.CU)({gameData:h,userRegionData:c}),m=(0,d.v9)((e=>Boolean(e.userData.login))),v=u.map((e=>n(`category.${e}.disclaimer`,{withNoErrors:!0}))).filter(Boolean).join("\n"),g=(0,Me.f)(m,p,n);return o().createElement("div",{className:(0,Se.E)(Be.root,v?Be.withBorder:null)},o().createElement("div",{className:Be.left},o().createElement(_e.X,{checked:t,className:Be.checkbox,size:18,onChange:a}),o().createElement("div",{className:Be.permissionText},g)),v&&o().createElement("div",{className:Be.right},v))};var Fe=s(96665),qe=s(6476);const We="MiddleLayerInGame-critical-module__layer--Aeh3z",Ze="MiddleLayerInGame-critical-module__info--h5T6b",Ge="MiddleLayerInGame-critical-module__gallery--o6vS0",Ue="MiddleLayerInGame-critical-module__permissions--SoTpb";var He=s(72122),je=s(5825);const ze=()=>{const e=(0,je.T)(),t=(0,i.useCallback)((()=>{e((0,He.e)(!1)),c.Z.post({type:"middle-layer",action:"close"})}),[e]),s=(0,i.useCallback)((()=>{}),[]);return o().createElement("article",{className:(0,Se.E)(We,Fe.P)},o().createElement(Te,{className:Ze,onAbout:t,onPlay:t}),o().createElement("section",{className:Ge},o().createElement(qe.Z,null)),o().createElement("section",{className:Ge},"Gallery"),o().createElement("section",{className:Ue},o().createElement($e,{permissionChecked:!0,onPermissionChange:s})))};const Ve=s(39010).Z;var Ke=s(58613),Ye=s(46211);const Xe=(0,g.M$)("PlatformSubscriptions",g.XG.Dev);class Je extends i.PureComponent{componentDidMount(){Xe("componentDidMount"),this.removeExpiredSubscriptions();Boolean(this.props.userData.login)&&Math.abs(Date.now()-this.props.subscriptions.time)>v.dV&&this.props.fetchPlatformSubscriptions()}componentWillUnmount(){this.removeExpiredSubscriptionsTimeout&&window.clearTimeout(this.removeExpiredSubscriptionsTimeout)}componentDidUpdate(e){const t=e.subscriptions,s=this.props.subscriptions;JSON.stringify(t)!==JSON.stringify(s)&&Xe("Subscriptions was updated",this.props.subscriptions)}removeExpiredSubscriptions(){Xe("removeExpiredSubscriptions");const{subscriptions:e,time:t,ver:s}=this.props.subscriptions;if("object"!=typeof e||"number"!=typeof t||s!==Ke.iY||Math.abs(Date.now()-t)>v.s2)this.props.setPlatformSubscriptions(Ke.$F.platformSubscriptions);else{let a=!1;Object.keys(e).forEach((t=>{const s=e[t],r=s.time?s.time+s.duration:s.expired;(function(e){return"object"==typeof e&&"number"==typeof e.duration&&"number"==typeof e.expired})(s)&&Date.now()<r||(Xe(`remove "${t}" subscription`),delete e[t],a=!0)})),a&&this.props.setPlatformSubscriptions({subscriptions:e,time:t,ver:s})}this.removeExpiredSubscriptionsTimeout=window.setTimeout((()=>this.removeExpiredSubscriptions()),v.dV)}render(){return null}}Je.contextType=L.Z;const Qe=(0,d.$j)((function(e){const{value:t,error:s}=(0,Ye.c)(e);return{subscriptions:t,error:s,userData:e.userData}}),(function(e){return(0,x.DE)({fetchPlatformSubscriptions:B.VR,setPlatformSubscriptions:B.Cg},e)}))(Je);var et=s(34967),tt=s(40532),st=s(29758),at=s(63904),rt=s.n(at),nt=s(18455),it=s(26256),ot=s(4463),dt=s(76103),lt=s(40184),ct=s(15771);const ht=rt().with("exit-button"),ut=({iconClass:e,onClick:t,mix:s,onEnable:a})=>{const r=(0,Ae.T)(),n=(0,ot.TH)(),{abt:{flags:d},isPWA:l,isGamesApp:c,deviceType:h}=(0,lt.b)();return(0,i.useMemo)((()=>{const e="mobile"===h&&l&&(0,ct.Xd)(d),t=new URLSearchParams(n.search);return e||c||"1"===t.get("exit-button")}),[h,d,c,l,n.search])?(a(),o().createElement(o().Fragment,null,o().createElement("div",{className:`${ht()} ${s}`,title:r("header.button.exit.text"),onClick:t},o().createElement(dt.Z,{className:`b('icon') ${e}`,type:"exit"})))):null};const pt=s(11775).Z;var mt=s(70135),vt=s(65751),gt=s(17780),wt=s(68108);function ft(e){var t;const{url:s,source:r,lang:n,location:i,context:o}=e,{hidePaymentsAndCurrency:d,isPWA:l,pfid:c,referrer:h,tld:u,baseUrl:p}=o,m=vt.parse((null==(t=i.search)?void 0:t.slice(1))||""),v=r;d&&(v[z.o1]="1"),l&&(v[z.cB]="1"),(0,wt.sD)(h)&&(v[z.Vw]=h),c&&(v[z.om]=c);const g=["exit-button"];Object.keys(m).forEach((e=>{const t=m[e];g.includes(e)&&"string"==typeof t&&(v[e]=t)}));const w=(0,re.Yk)(i.search,v);return(0,gt.E)({baseUrl:p,path:w?`${s}${w}`:s,lang:n,languages:(0,a.getDomainConfig)().languages,tld:u})}var yt=s(82027),bt=s(27859),kt=s(91115);const At=rt().with("play-game-header");const Et=(0,n.E)((0,d.$j)((function(e){return{getText:e.getText,isFullscreenActive:e.ui.isFullscreenActive,vertical:e.vertical}}))((function(e){const t=(0,i.useContext)(L.Z),s=(0,Ae.T)(),{isVisible:r,isCarouselAnimationDisabled:n,isEnableExitButton:d,onExitButtonClick:l,sendHeaderParams:h}=e,u=(0,i.useRef)(!1),[p,m]=(0,i.useState)(n?"":"logo"),[g,w]=(0,i.useState)(0),[f,y]=(0,i.useState)(null),b=e=>{const{action:t}=e.data||{};t===mt.ur.GameReady&&(u.current=!0)},k=()=>{y(bt.Z.isPortrait?"portrait":"landscape")},A=(s="game_header_logo")=>{const a=e.location,{pathLang:r}=t;return ft({url:"/",source:{utm_source:s},location:a,lang:r,context:t})},E=(0,i.useCallback)((()=>{h("logo")}),[h]),S=(0,i.useCallback)((()=>{h("all_games")}),[h]),I=()=>{m((e=>"logo"===e?"title":"logo")),w((e=>e+1))};(0,i.useEffect)((()=>{const e=window.setTimeout((()=>{u.current=!0}),10*v.WT);return bt.Z.addChangeListener(k),c.Z.onExternalMessage("game-measuring",b),()=>{bt.Z.removeChangeListener(k),c.Z.offExternalMessage("game-measuring",b),clearTimeout(e)}}),[]),(0,i.useEffect)((()=>{if(!p||!r)return;if(u.current&&g>=3&&"logo"===p){let e=window.setTimeout((()=>{m("")}),v.WT);return()=>{clearTimeout(e)}}const e=window.setTimeout(I,2e3);return()=>{clearTimeout(e)}}),[r,p,g,f]);const P=()=>{var e;const{oneTabPWA:s,lang:r}=t,{componentsSettings:n}=(0,a.getDomainConfig)();return o().createElement("div",{className:At("logo")},o().createElement("a",{href:A(),target:(0,yt.AO)({oneTabPWA:s}),onClick:E},o().createElement(dt.Z,{type:null==(e=n.newHeader)?void 0:e.logo.long[(0,kt.Lx)(r)]})))},R=()=>{const{title:e}=t.playPageData.gameInfo;return o().createElement("span",{className:At("info")},o().createElement("span",{className:At("middle")},o().createElement("a",{className:`${At("link")} hover pointer`,href:A(),target:"_blank",title:(0,Ie.T)(e)},o().createElement("span",{className:At("title")},(0,Ie.T)(e)))))},T=()=>{const{isFullscreenButtonAvailable:s,getText:a,isFullscreenActive:r}=e;return s&&o().createElement("div",{className:`${At("action")} ${At("fullscreen")} hover pointer`,title:a(`header.button.${r?"exit":"enter"}-fullscreen.text`),onClick:e.onFullscreenButtonClick},(()=>{const{isFullscreenActive:s}=e,{uatraits:a}=t,r=(null==a?void 0:a.OSFamily)===it.k.IOS&&!(null==a?void 0:a.isTablet),n=(null==a?void 0:a.BrowserName)===it.Z.YandexSearch;let i="desktop";return r&&n&&(i="yabroios"),o().createElement(dt.Z,{className:At("fullscreen-icon",{enable:!s}),modifiers:{enable:!s,env:i},type:"fullscreen"})})())};return e.isVisible?o().createElement(o().Fragment,null,(()=>{const e=s("header.all-games");return o().createElement("div",{className:At("back-to-catalog-wrapper")},o().createElement("a",{className:`${At("link")} pointer app-page`,href:A("game_header_all_games"),target:"_blank",title:(0,Ie.T)(e),onClick:S},o().createElement("span",{className:At("back-to-catalog-icon")},o().createElement(dt.Z,{type:"arrow-white"})),o().createElement("span",{className:At("back-to-catalog-text")},e)))})(),o().createElement("div",{className:At("carousel",{[p]:Boolean(p)})},P(),R()),o().createElement("div",{className:At("right")},(()=>{const{menuVisible:t,getText:s,handleMenuClose:a,menuAnchorRef:r,onMenuIconClick:n,menuDotted:i}=e;return o().createElement("div",{className:`${At("action")} ${At("menu")} menu hover pointer`,ref:e.menuAnchorRef,title:s("header.button.menu.text"),onClick:n},o().createElement("div",{className:At("menu-icon-wrapper",{dotted:i})},o().createElement(dt.Z,{className:At("menu-icon"),type:"game-menu-white"})),t&&o().createElement(pt,{anchorRef:r,onClose:a}))})(),T(),o().createElement(ut,{iconClass:At("exit"),mix:`${At("action")} ${At("exit")} hover pointer`,onClick:l,onEnable:d}))):null}))),St=rt().with("play-game-header");const It=(0,n.E)((0,d.$j)((function(e){return{getText:e.getText,isFullscreenActive:e.ui.isFullscreenActive,vertical:e.vertical}}))((function(e){const t=(0,i.useContext)(L.Z),s=(0,Ae.T)(),{isEnableExitButton:r,onExitButtonClick:n,sendHeaderParams:d,isFullscreenActive:l}=e,c=(0,i.useCallback)((()=>{d("logo")}),[d]),h=(0,i.useCallback)((()=>{d("all_games")}),[d]),u=()=>{const{isFullscreenButtonAvailable:s,getText:a,isFullscreenActive:r}=e;return s&&o().createElement("div",{className:`${St("action")} ${St("fullscreen")} hover pointer`,title:a(`header.button.${r?"exit":"enter"}-fullscreen.text`),onClick:e.onFullscreenButtonClick},(()=>{const{uatraits:e}=t,s=(null==e?void 0:e.OSFamily)===it.k.IOS&&!(null==e?void 0:e.isTablet),a=(null==e?void 0:e.BrowserName)===it.Z.YandexSearch;let r="desktop";return s&&a&&(r="yabroios"),o().createElement(dt.Z,{className:St("fullscreen-icon",{enable:!l}),modifiers:{enable:!l,env:r},type:"fullscreen"})})())};return e.isVisible?o().createElement(o().Fragment,null,(()=>{var s;const r=e.location,{pathLang:n,oneTabPWA:i}=t,{componentsSettings:d}=(0,a.getDomainConfig)(),l=ft({url:"/",source:{utm_source:"game_header_logo"},location:r,lang:n,context:t});return o().createElement("div",{className:St("logo")},o().createElement("a",{href:l,target:(0,yt.AO)({oneTabPWA:i}),onClick:c},o().createElement(dt.Z,{type:null==(s=d.newHeader)?void 0:s.logo.short})))})(),(()=>{const a=e.location,{pathLang:r}=t,n=ft({url:"/",source:{utm_source:"game_header_all_games"},location:a,lang:r,context:t}),i=s("header.all-games");return o().createElement("div",{className:St("all-games-wrapper")},o().createElement("a",{className:`${St("all-games")} ${St("link")} pointer app-page`,href:n,target:"_blank",title:(0,Ie.T)(i),onClick:h},o().createElement("span",{className:St("all-games-icon")},o().createElement(dt.Z,{type:"all-games"})),o().createElement("span",{className:St("all-games-text")},i)))})(),o().createElement("div",{className:St("right")},(()=>{const{menuVisible:t,getText:s,handleMenuClose:a,menuAnchorRef:r,onMenuIconClick:n,menuDotted:i}=e;return o().createElement("div",{className:`${St("action")} ${St("menu")} menu hover pointer`,ref:e.menuAnchorRef,title:s("header.button.menu.text"),onClick:n},o().createElement("div",{className:St("menu-icon-wrapper",{dotted:i})},o().createElement(dt.Z,{className:St("menu-icon"),type:"game-menu-white"})),t&&o().createElement(pt,{anchorRef:r,onClose:a}))})(),u(),o().createElement(ut,{iconClass:St("exit"),mix:`${St("action")} ${St("exit")} hover pointer`,onClick:n,onEnable:r}))):null}))),Pt=rt().with("play-game-header");const Rt=(0,n.E)((0,d.$j)((function(e){return{getText:e.getText,isFullscreenActive:e.ui.isFullscreenActive,vertical:e.vertical}}))((function(e){const t=(0,i.useContext)(L.Z),{isEnableExitButton:s,onExitButtonClick:r,sendHeaderParams:n}=e,d=(0,i.useCallback)((()=>{n("logo")}),[n]);return e.isVisible?o().createElement(o().Fragment,null,(()=>{const{menuVisible:t,getText:s,handleMenuClose:a,menuAnchorRef:r,onMenuIconClick:n,menuDotted:i}=e;return o().createElement("div",{className:`${Pt("action")} ${Pt("menu")} menu hover pointer`,ref:e.menuAnchorRef,title:s("header.button.menu.text"),onClick:n},o().createElement("div",{className:Pt("menu-icon-wrapper",{dotted:i})},o().createElement(dt.Z,{className:Pt("menu-icon"),type:"game-menu-white"})),t&&o().createElement(pt,{anchorRef:r,onClose:a}))})(),(()=>{var s;const r=e.location,{pathLang:n,oneTabPWA:i,lang:l}=t,{componentsSettings:c}=(0,a.getDomainConfig)(),h=ft({url:"/",source:{utm_source:"game_header_logo"},location:r,lang:n,context:t});return o().createElement("div",{className:Pt("logo")},o().createElement("a",{href:h,target:(0,yt.AO)({oneTabPWA:i}),onClick:d},o().createElement(dt.Z,{type:null==(s=c.newHeader)?void 0:s.logo.long[(0,kt.Lx)(l)]})))})(),(()=>{const{isFullscreenButtonAvailable:a,getText:n,isFullscreenActive:i}=e;return o().createElement("div",{className:Pt("right")},a&&o().createElement("div",{className:`${Pt("action")} ${Pt("fullscreen")} hover pointer`,title:n(`header.button.${i?"exit":"enter"}-fullscreen.text`),onClick:e.onFullscreenButtonClick},(()=>{const{isFullscreenActive:s}=e,{uatraits:a}=t,r=(null==a?void 0:a.OSFamily)===it.k.IOS&&!(null==a?void 0:a.isTablet),n=(null==a?void 0:a.BrowserName)===it.Z.YandexSearch;let i="desktop";return r&&n&&(i="yabroios"),o().createElement(dt.Z,{className:Pt("fullscreen-icon",{enable:!s}),modifiers:{enable:!s,env:i},type:"fullscreen"})})()),o().createElement(ut,{iconClass:Pt("exit"),mix:`${Pt("action")} ${Pt("exit")} hover pointer`,onClick:r,onEnable:s}))})()):null})));var Tt=s(36172),Ct=s(91521),Dt=s(99709),Lt=s(85578),Ot=s(28705),xt=s(17061);function _t(e){const t=["utm_medium","utm_source"].reduce(((e,s)=>{const a=(0,xt.V)(s);return a&&(t[s]=a),e}),{}),s=(0,q.Z)({url:`${e}/`,params:t});window.location.replace(s)}var Bt=s(81442),Nt=s(48810),Mt=s(30448),$t=s(68606),Ft=Object.defineProperty,qt=Object.getOwnPropertySymbols,Wt=Object.prototype.hasOwnProperty,Zt=Object.prototype.propertyIsEnumerable,Gt=(e,t,s)=>t in e?Ft(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Ut=(e,t)=>{for(var s in t||(t={}))Wt.call(t,s)&&Gt(e,s,t[s]);if(qt)for(var s of qt(t))Zt.call(t,s)&&Gt(e,s,t[s]);return e};const Ht=rt().with("play-game-header"),jt=(0,g.M$)("PlayGameHeader",g.XG.Dev);let zt,Vt=0;class Kt extends L.P{constructor(e){super(e),this.menuAnchorRef=o().createRef(),this.backButtonListenerInGame=!1,this.isExitEnabled=!1,this.onPlayGameHeaderMessage=e=>{if(!this.props.isVisible)return;const{action:t}=e.data;"show"!==t?"hide"===t&&this.setState({visible:!1}):this.setState({visible:!0})},this.onExitButtonClick=()=>{this.sendParams("exit"),this.onExit(!0)},this.onFullscreenButtonClick=()=>{this.sendParams("fullscreen"),this.toggleFullscreen()},this.onMenuIconClick=()=>{const e=(0,$t.hY)($t.jF.GUARD);e?(0,$t.Vy)(e.children):(this.sendParams("menu"),this.setState({menuDotted:!1,menuVisible:!this.state.menuVisible}))},this.onBackButtonClick=()=>{this.sendParams("hide-menu-back"),this.closeMenu({isMenuItem:!1,isBackLink:!0})},this.handleMenuClose=e=>{this.closeMenu({isMenuItem:Boolean(null==e?void 0:e.isMenuItem),isBackLink:!1})},this.closeMenu=e=>{e.isMenuItem||e.isBackLink||window.history.back(),this.setState({menuVisible:!1})},this.isEnableExitButton=()=>{this.isExitEnabled=!0},this.state={isFullscreen:!1,menuDotted:!1,menuVisible:!1,visible:e.isVisible}}get isAdvStickyBannerEnabled(){return(0,Ot.xm)(this.context.playPageData)}componentDidMount(){jt("componentDidMount"),this.setMenuDotMarker(),this.checkExitEnabled(),this.setExitButtonAvalibility(),this.setBackButtonGameHandler(),this.initMessaging()}componentWillUnmount(){jt("componentWillUnmount"),c.Z.offInternalMessage("play-game-header",this.onPlayGameHeaderMessage),this.removeBackButtonListener()}initMessaging(){c.Z.onInternalMessage("play-game-header",this.onPlayGameHeaderMessage)}sendParams(e){H.Eu.params({borrowParams:{header:{action:e}}})}setMenuDotMarker(){var e,t,s;const a=!0===(null==(s=null==(t=null==(e=window.YandexGamesSDK)?void 0:e.game.settings)?void 0:t.extraFeatures)?void 0:s.leaderboards)&&!(0,Nt.dq)(Ct.b).value,r=!(0,Nt.dq)(Ct.Z).value&&!this.props.advDisabledByPartnersKit;this.setState({menuDotted:a||r})}setExitButtonAvalibility(){this.isExitEnabled&&(this.context.isGamesApp?this.handleHistoryBack():(0,Mt.c)((()=>{window.setTimeout((()=>this.handleHistoryBack()))}),{once:!0}))}setBackButtonGameHandler(){}get isEmbeddedWindow(){return Boolean("object"==typeof window&&window.parent!==window)}isFullscreenButtonAvailable(){return!this.context.isIpad&&(!(this.isEmbeddedWindow&&!(0,Bt.r)())&&(!this.isExitEnabled&&this.props.isFullscreenEnabled))}handleHistoryBack(){window.history.pushState("root",""),window.history.pushState("main-page",""),window.addEventListener("popstate",(e=>{if(this.clearingHistoryAndGoToCatalog)null===e.state?_t(this.context.baseUrl):setTimeout((()=>{window.history.back()}),0);else if("root"===e.state){if(window.history.pushState("main-page",""),this.backButtonListenerInGame)return c.Z.postToChild((0,Dt.TI)(Lt.q.HISTORY_BACK)),Vt>0&&clearTimeout(zt),Vt++,void(zt=setTimeout((()=>{var e,t;null==(t=null==(e=null==window?void 0:window.Ya)?void 0:e.Rum)||t.logEventString("history_back","",{additional:{backHandleCount:Vt}}),Vt=0}),2e3));this.onExit()}}),!0)}toggleFullscreen(){c.Z.post({type:"screen-manager",action:"toggle-fullscreen"})}exitToCatalog(){const{reqUrl:e}=this.context,t=ft({url:"/",source:{utm_source:"game_header_x_close"},location:this.props.location,lang:this.props.lang,context:this.context}),s=(0,nt.ky)(t,{currentLocation:e});window.open(s,"_self")}onExit(e){this.context.isGamesApp?c.Z.post({type:"document-events",action:"back"}):e&&this.exitToCatalog()}componentDidUpdate(e,t){t.menuVisible!==this.state.menuVisible&&(this.state.menuVisible?this.addBackButtonListener():this.removeBackButtonListener())}addBackButtonListener(){setTimeout((()=>window.history.pushState("menu","","#menu")),0),window.addEventListener("popstate",this.onBackButtonClick,!1)}removeBackButtonListener(){window.removeEventListener("popstate",this.onBackButtonClick)}checkExitEnabled(){const{abt:{flags:e},isPWA:t,isGamesApp:s,deviceType:a}=this.context,r=new URLSearchParams(this.props.location.search),n="mobile"===a&&t&&(0,ct.Xd)(e);this.isExitEnabled=n||s||"1"===r.get("exit-button")}render(){const{mode:e,isCarouselAnimationDisabled:t}=this.props;this.isPlayToEarn=(0,ct.XP)(this.context.abt.flags),this.checkExitEnabled();const s={handleMenuClose:this.handleMenuClose,isFullscreenButtonAvailable:this.isFullscreenButtonAvailable(),isVisible:this.state.visible,menuAnchorRef:this.menuAnchorRef,menuDotted:this.state.menuDotted,menuVisible:this.state.menuVisible,onFullscreenButtonClick:this.onFullscreenButtonClick,onMenuIconClick:this.onMenuIconClick,sendHeaderParams:this.sendParams,isEnableExitButton:this.isEnableExitButton,onExitButtonClick:this.onExitButtonClick,isCarouselAnimationDisabled:t};return o().createElement("div",{className:Ht({"catalog-enabled":!1,"exit-enabled":this.isExitEnabled,"fullscreen-enabled":this.props.isFullscreenEnabled,"menu-enabled":!0,"with-adv":this.isAdvStickyBannerEnabled,p2e:this.isPlayToEarn,hide:!this.state.visible,[e]:!0,exp:!0})},this.props.mode===ct.g.CenteredLogo&&o().createElement(Rt,Ut({},s)),this.props.mode===ct.g.AllGames&&o().createElement(It,Ut({},s)),this.props.mode===ct.g.Carousel&&o().createElement(Et,Ut({},s)))}}(0,n.E)((0,d.$j)((function(e){return{advDisabledByPartnersKit:e.advDisabledByPartnersKit,darkTheme:(0,Tt.Up)(e),isFullscreenActive:e.ui.isFullscreenActive,isFullscreenEnabled:e.ui.isFullscreenEnabled,lang:e.lang,getText:e.getText,userData:e.userData}}))(Kt));var Yt=s(2737),Xt=s(10576),Jt=s(14375);const Qt=(0,i.createContext)({handleEvent:e=>{throw new Error("PlayGuardContext is not initialized")},hidden:!1,withPurchasesPermissions:!1});var es=s(90043),ts=s(31136),ss=s(89592);const as=(0,g.M$)("PlayGuard",g.XG.Popup);class rs extends L.P{constructor(){super(...arguments),this.state={show:this.isNeedToShow(),hidden:!0},this.wasShowed=!this.state.show,this.permissionsPromiseWrapper=new r.Z,this.onGuardMessage=(e,t)=>{var s;if("play-guard"!==(null==(s=e.data.data)?void 0:s.source))switch(e.data.action){case"is-guard-enabled":t({data:{result:this.isGuardEnabled}});break;case"get-show-state":t({data:{result:!this.wasShowed}});break;case"get-was-showed":t({data:{result:this.wasShowed}});break;case"apply":if(this.wasShowed)this.permissionsPromiseWrapper.reject();else{const{actionSource:t,permission:s}=e.data.data;this.apply({actionSource:t,permission:s})}break;case"show":c.Z.post({type:"promo-bar",action:"show"}),c.Z.post({type:"guard",action:"state-changed",data:{state:"up"}});break;case"focus":this.wasShowed?(0,Jt.D)():window.focus();break;case"get-permission-promise":this.responseGetPermissionsPromise(t)}},this.onExternalGuardMessage=(e,t)=>{if("get-permission-promise"===e.data.action)this.responseGetPermissionsPromise(t)},this.onScopesMessage=(e,t)=>{"open-scopes-dialog"!==e.data.action||this.wasShowed||(this.openScopesCallback=t)},this.handleEvent=e=>{switch(e.type){case"apply":{const{actionSource:t,permission:s}=e.detail;this.apply({actionSource:t,permission:s});break}case"auth":this.auth();break;case"cancel":this.cancel();break;case"info":this.info()}}}componentDidMount(){as("componentDidMount",this.state),c.Z.onExternalMessage("guard",this.onExternalGuardMessage),c.Z.onInternalMessage("guard",this.onGuardMessage,{withHistory:!0}),c.Z.onInternalMessage("scopes",this.onScopesMessage),this.permissionsPromiseWrapper.promise.catch((()=>{}));const e=this.isNeedToShow();this.setIsGuardOpened(e),this.wasShowed=!e;const t=e?"show":"hide";this.setState({hidden:this.context.isAdvSplashScreenEnabled,show:e},(()=>{this.wasShowed&&this.postSetWasShowedAction()})),e&&(c.Z.post({type:"promo-bar",action:"show"}),this.sendParams({show:!0})),this.sendParams({initialStatus:t}),c.Z.post({type:"guard",action:"init"}),c.Z.post({type:"guard",action:"state-changed",data:{state:"show"===t?"up":"play"}})}componentWillUnmount(){as("componentWillUnmount"),c.Z.offExternalMessage("guard",this.onExternalGuardMessage),c.Z.offInternalMessage("guard",this.onGuardMessage),c.Z.offInternalMessage("scopes",this.onScopesMessage)}responseGetPermissionsPromise(e){this.wasShowed&&this.permissionsPromiseWrapper.reject(),this.permissionsPromiseWrapper.promise.then((t=>{e({data:{result:t}})})).catch((()=>{e({data:{result:void 0}})}))}setIsGuardOpened(e){this.props.dispatch((0,es.lt)(e))}get isPurchasesPermissionNeed(){const{playPageData:e,userRegionData:t}=this.context,{gameData:s}=e;return(0,Ne.CU)({gameData:s,userRegionData:t})}get isGuardEnabled(){const{location:e}=this.props,{abt:t,playPageData:s,referrerClid:a,userRegionData:r}=this.context,{gameData:n}=s,{flags:i}=t,o=(0,Ne.pr)({gameData:n,userRegionData:r});return(0,Ne.ZY)({clid:a,flags:i,isConfirmedGuard:o,location:e})}isNeedToShow(){return this.isGuardEnabled}apply({actionSource:e,permission:t}){if(this.applyPromise)return;this.applyPromise=Promise.race([(0,ts.D)(5e3).then((()=>this.permissionsPromiseWrapper.reject())),new Promise(((s,a)=>{const{appId:r}=this.context.playPageData.gameInfo;this.sendScope({appId:r,permission:t,withPurchasesPermissions:this.isPurchasesPermissionNeed,isGuardEnabled:!0}).then((()=>{void 0!==t?(this.permissionsPromiseWrapper.resolve(t),H.Eu.params({borrowParams:{personal:{showed:!0,value:t===Xt._I.ALLOW}}})):(this.permissionsPromiseWrapper.reject(),H.Eu.params({borrowParams:{personal:{showed:!1,value:!1}}})),H.Eu.reachGoal(ss.Ji.GUARD_APPLY),r&&H.Eu.gtag("view_item",{send_to:"AW-10952943694",value:0,items:[{id:r,location_id:0,google_business_vertical:"custom"}]}),c.Z.post({type:"guard",action:"apply",data:{source:"play-guard"}}),c.Z.post({type:"guard",action:"state-changed",data:{state:"play"}}),this.sendParams({apply:e}),c.Z.post({type:"promo-bar",action:"remove"}),s(void 0)}))}))]).then((()=>this.close())).finally((()=>this.applyPromise=void 0))}auth(){this.sendParams({auth:!0}),c.Z.post({type:"auth",action:"auth-dialog-open",data:{initializer:"guard"}})}cancel(){const{referrer:e}=this.context;this.sendParams({cancel:!0}),this.openScopesCallback&&(this.openScopesCallback({data:{result:!1}}),this.openScopesCallback=void 0),c.Z.post({type:"guard",action:"cancel",data:e?{referrer:e}:{}})}close(){this.wasShowed=!0,this.setIsGuardOpened(!1),this.setState({show:!1},(()=>this.postSetWasShowedAction())),(0,Jt.D)(),c.Z.post({type:"guard",action:"closed"})}info(){this.sendParams({info:!0}),c.Z.post({type:"guard",action:"info"}),c.Z.post({type:"guard",action:"state-changed",data:{state:"info"}}),c.Z.post({type:"promo-bar",action:"hide"})}sendScope(e){return t=this,s=arguments,a=function*({appId:e,isGuardEnabled:t,withPurchasesPermissions:s,permission:a}){const r=yield c.Z.post({type:"scopes",action:"apply-guard",data:{permission:a,appId:e,isGuardEnabled:t,withPurchasesPermissions:s}});this.openScopesCallback&&(this.openScopesCallback({data:{result:r}}),this.openScopesCallback=void 0)},new Promise(((e,r)=>{var n=e=>{try{o(a.next(e))}catch(e){r(e)}},i=e=>{try{o(a.throw(e))}catch(e){r(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,i);o((a=a.apply(t,s)).next())}));var t,s,a}sendParams(e){H.Eu.params({borrowParams:{guard:e}})}postSetWasShowedAction(){c.Z.post({type:"guard",action:"set-was-showed",data:{result:!0}})}render(){return this.state.show?o().createElement(Qt.Provider,{value:{handleEvent:this.handleEvent,hidden:this.state.hidden,withPurchasesPermissions:this.isPurchasesPermissionNeed}},this.props.children):null}}const ns=(0,n.E)((0,d.$j)(null)(rs));var is=s(31416),os=s(69838);const ds=rt().with("play-game-header-logo"),ls=()=>{const e=(0,lt.b)(),t=(0,ot.TH)(),{abt:s,isPWA:a,oneTabPWA:r,reqUrl:n,pathLang:i}=e,d=(0,Ae.T)(),l=ft({url:"/",source:{utm_source:"game_header_logo"},location:t,lang:i,context:e});let c=o().createElement(is.Z,{type:os.q7.HEADER});return o().createElement(nt.Kk,{className:`${ds("link",{pwa:false})} pointer`,currentLocation:n,href:l,tabIndex:-1,target:(0,yt.AO)({oneTabPWA:r}),title:d("common.service.name")},c)};var cs=s(58097),hs=s(41952);const us=rt().with("play-game-header"),ps=(0,g.M$)("PlayGameHeader",g.XG.Dev);s(61976);let ms,vs=0;const gs=({context:e})=>{const t=(0,Ae.T)(),s=(0,i.useCallback)((()=>{e.handleEvent(new CustomEvent("auth"))}),[e]);return o().createElement(ve.z,{className:us("middle-layer-login-button"),"data-guard-auth":"true",size:24,view:"secondary",onClick:s},o().createElement("span",null,t("authpopup.button.login"))," ",o().createElement("span",{className:us("middle-layer-login-button_secondary-caption")},t("authpopup.button.caption")))};class ws extends L.P{constructor(e){super(e),this.menuAnchorRef=o().createRef(),this.backButtonListenerInGame=!1,this.isExitEnabled=!1,this.onPlayGameHeaderMessage=e=>{if(!this.props.isVisible)return;const{action:t}=e.data;"show"!==t?"hide"===t&&this.setState({visible:!1}):this.setState({visible:!0})},this.onAppInfoClick=e=>{e.preventDefault(),c.Z.post({type:"document-events",action:"show-info"}),this.sendParams("app-page")},this.onExitButtonClick=()=>{this.sendParams("exit"),this.onExit(!0)},this.onFullscreenButtonClick=()=>{this.sendParams("fullscreen"),this.toggleFullscreen()},this.onHeaderLogoClick=()=>{this.sendParams("logo")},this.onMenuIconClick=()=>{const e=(0,$t.hY)($t.jF.GUARD);e?(0,$t.Vy)(e.children):(this.sendParams("menu"),this.setState({menuDotted:!1,menuVisible:!this.state.menuVisible}))},this.onBackButtonClick=()=>{this.sendParams("hide-menu-back"),this.closeMenu({isMenuItem:!1,isBackLink:!0})},this.handleMenuClose=e=>{this.closeMenu({isMenuItem:Boolean(null==e?void 0:e.isMenuItem),isBackLink:!1})},this.closeMenu=e=>{e.isMenuItem||e.isBackLink||window.history.back(),this.setState({menuVisible:!1})},this.isEnableExitButton=()=>{this.isExitEnabled=!0},this.state={isFullscreen:!1,menuDotted:!1,menuVisible:!1,visible:e.isVisible}}get isAdvStickyBannerEnabled(){return(0,Ot.xm)(this.context.playPageData)}componentDidMount(){ps("componentDidMount"),this.setMenuDotMarker(),this.checkExitEnabled(),this.setExitButtonAvalibility(),this.setBackButtonGameHandler(),this.initMessaging()}componentWillUnmount(){ps("componentWillUnmount"),c.Z.offInternalMessage("play-game-header",this.onPlayGameHeaderMessage),this.removeBackButtonListener()}initMessaging(){c.Z.onInternalMessage("play-game-header",this.onPlayGameHeaderMessage)}sendParams(e){H.Eu.params({borrowParams:{header:{action:e}}})}setMenuDotMarker(){var e,t,s;const a=!0===(null==(s=null==(t=null==(e=window.YandexGamesSDK)?void 0:e.game.settings)?void 0:t.extraFeatures)?void 0:s.leaderboards)&&!(0,Nt.dq)(Ct.b).value,r=!(0,Nt.dq)(Ct.Z).value&&!this.props.advDisabledByPartnersKit;this.setState({menuDotted:a||r})}setExitButtonAvalibility(){this.isExitEnabled&&(this.context.isGamesApp?this.handleHistoryBack():(0,Mt.c)((()=>{window.setTimeout((()=>this.handleHistoryBack()))}),{once:!0}))}setBackButtonGameHandler(){}get isEmbeddedWindow(){return Boolean("object"==typeof window&&window.parent!==window)}isFullscreenButtonAvailable(){return!this.context.isIpad&&(!(this.isEmbeddedWindow&&!(0,Bt.r)())&&(!this.isExitEnabled&&this.props.isFullscreenEnabled))}handleHistoryBack(){window.history.pushState("root",""),window.history.pushState("main-page",""),window.addEventListener("popstate",(e=>{if(this.clearingHistoryAndGoToCatalog)null===e.state?_t(this.context.baseUrl):setTimeout((()=>{window.history.back()}),0);else if("root"===e.state){if(window.history.pushState("main-page",""),this.backButtonListenerInGame)return c.Z.postToChild((0,Dt.TI)(Lt.q.HISTORY_BACK)),vs>0&&clearTimeout(ms),vs++,void(ms=setTimeout((()=>{var e,t;null==(t=null==(e=null==window?void 0:window.Ya)?void 0:e.Rum)||t.logEventString("history_back","",{additional:{backHandleCount:vs}}),vs=0}),2e3));this.onExit()}}),!0)}toggleFullscreen(){c.Z.post({type:"screen-manager",action:"toggle-fullscreen"})}exitToCatalog(){const{reqUrl:e}=this.context,t=ft({url:"/",source:{utm_source:"game_header_x_close"},location:this.props.location,lang:this.props.lang,context:this.context}),s=(0,nt.ky)(t,{currentLocation:e});window.open(s,"_self")}onExit(e){this.context.isGamesApp?c.Z.post({type:"document-events",action:"back"}):e&&this.exitToCatalog()}componentDidUpdate(e,t){t.menuVisible!==this.state.menuVisible&&(this.state.menuVisible?this.addBackButtonListener():this.removeBackButtonListener())}addBackButtonListener(){setTimeout((()=>window.history.pushState("menu","","#menu")),0),window.addEventListener("popstate",this.onBackButtonClick,!1)}removeBackButtonListener(){window.removeEventListener("popstate",this.onBackButtonClick)}renderLogo(){return o().createElement("span",{className:us("logo"),onClick:this.onHeaderLogoClick},o().createElement(ls,null))}renderHeaderInfo(){const{baseUrlWithLangPath:e,referrer:t,hidePaymentsAndCurrency:s,isPWA:a,isMiddleLayerInGameExp:r}=this.context;if(r&&this.props.isMiddleLayerShownInGame)return null;const{appId:n,title:i}=this.context.playPageData.gameInfo,d=`${e}/app/${n}${(0,re.Px)({search:"?utm_source=game_header_title&info=true",params:{[z.o1]:s?"1":"",[z.om]:(0,xt.V)(z.om,this.context.location)||"",[z.Vw]:(0,wt.sD)(t)?t:"",[z.cB]:a?"1":""}})}`;return o().createElement("span",{className:us("info")},o().createElement("span",{className:us("middle")},o().createElement("a",{className:`${us("link")} hover pointer app-page`,href:d,target:"_blank",title:(0,Ie.T)(i),onClick:this.onAppInfoClick},o().createElement("span",{className:us("title")},(0,Ie.T)(i)))))}renderFullscreenIcon(){const{isFullscreenActive:e}=this.props,{uatraits:t}=this.context,s=(null==t?void 0:t.OSFamily)===it.k.IOS&&!(null==t?void 0:t.isTablet),a=(null==t?void 0:t.BrowserName)===it.Z.YandexSearch;let r="desktop";return s&&a&&(r="yabroios"),o().createElement(dt.Z,{className:us("fullscreen-icon",{enable:!e}),modifiers:{enable:!e,env:r},type:"fullscreen"})}renderBalance(){const{abt:e,hidePortalCurrency:t}=this.context,{getText:s}=this.props;return t||(0,ct.Sn)(e.flags)?null:o().createElement("div",{className:`${us("action",{balance:!0})} ${us("menu")} menu hover pointer`,ref:this.menuAnchorRef,title:s("header.button.balance.text")},o().createElement(Yt.Z,{type:"game"}))}renderMiddleLayerLoginButton(){return!this.context.isMiddleLayerInGameExp||this.props.hasAuth?null:o().createElement(ns,null,o().createElement(Qt.Consumer,null,(e=>o().createElement(gs,{context:e}))))}renderActions(){const{getText:e,isFullscreenActive:t}=this.props;let s=ft({url:"/",source:{utm_source:"game_header_tickets",tab_profile:"timeline"},context:this.context,location:this.props.location,lang:this.props.lang});return o().createElement("div",{className:us("actions"),"data-nosnippet":"true"},this.renderMiddleLayerLoginButton(),this.renderBalance(),this.isPlayToEarn&&o().createElement(cs.c,{passportOrigin:hs._4.GamesHeader,small:!0,url:s}),o().createElement("div",{className:`${us("action")} ${us("menu")} menu hover pointer`,ref:this.menuAnchorRef,title:e("header.button.menu.text"),onClick:this.onMenuIconClick},o().createElement("div",{className:us("menu-icon-wrapper",{dotted:this.state.menuDotted})},o().createElement(dt.Z,{className:us("menu-icon"),type:"game-menu-white"})),this.state.menuVisible&&o().createElement(pt,{anchorRef:this.menuAnchorRef,onClose:this.handleMenuClose})),this.isFullscreenButtonAvailable()&&o().createElement("div",{className:`${us("action")} ${us("fullscreen")} hover pointer`,title:e(`header.button.${t?"exit":"enter"}-fullscreen.text`),onClick:this.onFullscreenButtonClick},this.renderFullscreenIcon()),o().createElement(ut,{iconClass:us("exit"),mix:`${us("action")} ${us("exit")} hover pointer`,onClick:this.onExitButtonClick,onEnable:this.isEnableExitButton}))}checkExitEnabled(){const{abt:{flags:e},isPWA:t,isGamesApp:s,deviceType:a}=this.context,r=new URLSearchParams(this.props.location.search),n="mobile"===a&&t&&(0,ct.Xd)(e);this.isExitEnabled=n||s||"1"===r.get("exit-button")}render(){return this.isPlayToEarn=(0,ct.XP)(this.context.abt.flags),this.checkExitEnabled(),o().createElement("div",{className:us({"catalog-enabled":!1,"exit-enabled":this.isExitEnabled,"fullscreen-enabled":this.props.isFullscreenEnabled,"menu-enabled":!0,"with-adv":this.isAdvStickyBannerEnabled,p2e:this.isPlayToEarn,hide:!this.state.visible})},this.state.visible&&o().createElement(o().Fragment,null,this.renderLogo(),this.renderHeaderInfo(),this.renderActions()))}}const fs=(0,n.E)((0,d.$j)((function(e){var t;return{advDisabledByPartnersKit:e.advDisabledByPartnersKit,darkTheme:(0,Tt.Up)(e),getText:e.getText,hasAuth:Boolean(e.userData.login),isFullscreenActive:e.ui.isFullscreenActive,isFullscreenEnabled:e.ui.isFullscreenEnabled,lang:e.lang,isMiddleLayerShownInGame:null==(t=e.middleLayerInGameData)?void 0:t.show,userData:e.userData}}))(ws));var ys=Object.defineProperty,bs=Object.getOwnPropertySymbols,ks=Object.prototype.hasOwnProperty,As=Object.prototype.propertyIsEnumerable,Es=(e,t,s)=>t in e?ys(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Ss=(e,t)=>{for(var s in t||(t={}))ks.call(t,s)&&Es(e,s,t[s]);if(bs)for(var s of bs(t))As.call(t,s)&&Es(e,s,t[s]);return e};const Is=function(e){const t=(0,i.useContext)(L.Z),{abt:{flags:s}}=t;return(0,ct.XH)(s),o().createElement(fs,Ss({},e))};var Ps=s(29716),Rs=s(24919);const Ts=rt().with("play-guard-dialog"),Cs=({onAuthButtonClick:e})=>{var t;const s=(0,Ae.T)(),{playPageData:{gameSettings:r}}=(0,lt.b)(),n=(0,d.v9)((e=>Boolean(e.userData.login))),{disableLogin:i}=(0,a.getDomainConfig)().auth||{};if(i)return null;return!n&&Boolean(null==(t=r.features)?void 0:t.user_data_required)?o().createElement("div",{className:Ts("authorize")},o().createElement("div",{className:Ts("authorize-description")},s("guard.player.auth.description")),o().createElement(ve.z,{"data-guard-auth":"true","data-testid":"PlayGuardAuthorize-Button",size:32,type:"submit",view:"secondary",onClick:e},s("common.login"))):null},Ds=rt().with("play-guard-dialog"),Ls=()=>{const e=(0,Ae.T)(),{playPageData:{gameInfo:t}}=(0,lt.b)(),s=t.categoryNames.map((t=>e(`category.${t}.disclaimer`,{withNoErrors:!0}))).filter(Boolean).join("\n");return s?o().createElement("div",{className:Ds("disclaimer")},s):null},Os=rt().with("play-guard-dialog"),xs=({onPermissionChange:e,permissionChecked:t,withPurchasesPermissions:s})=>{var a;const{playPageData:{gameSettings:r}}=(0,lt.b)(),n=(0,Ae.T)(),i=(0,d.v9)((e=>Boolean(e.userData.login)));if(!(s||i&&Boolean(null==(a=r.features)?void 0:a.user_data_required)))return null;const l=(0,Me.f)(i,s,n);return o().createElement("div",{className:Os("permission")},o().createElement("div",{className:Os("permission-description")},l),o().createElement(_e.X,{checked:t,className:Os("permission-checkbox"),size:18,onChange:e}))};var _s=s(30520);const Bs=()=>o().createElement(dt.Z,{type:"play"}),Ns=({className:e,onClick:t})=>{const s=(0,Ae.T)()("common.play.notable");return o().createElement(_s.Z,{className:e,"data-guard-accept":"play_button",iconLeft:Bs,size:"l",type:"submit",view:"play",onClick:t},s)},Ms=({children:e,className:t,onClick:s})=>{var r,n;const d=(0,i.useContext)(L.Z),{componentsSettings:l}=(0,a.getDomainConfig)(),c=(null==(r=l.buttons)?void 0:r.playGuardApplySize)||"l",h=(null==(n=l.buttons)?void 0:n.playGuardApplyView)||"action";return(0,ct.Nt)(d.abt.flags)?o().createElement(Ns,{className:t,onClick:s}):o().createElement(_s.Z,{className:t,"data-guard-accept":"play_button",size:c,type:"submit",view:h,onClick:s},e)};var $s=s(4230),Fs=s(604),qs=s(92901),Ws=s(98343);function Zs(e){const t=function(e){let t=1;for(let s=1e3;s>1;s/=10)if(e>=s){t=s;break}return t}(e);return Math.floor(e/t)*t}function Gs(e){const t=Zs(e);let s="";try{s=new Intl.NumberFormat("ru-RU").format(t)}catch(e){s=function(e){let t=`${e}`,s="0";for(;t.length>0;){const e=t.slice(-3);t=t.slice(0,-3),s=s?`${e} ${s}`:e}return s}(t)}return t>10&&(s+="+"),s}var Us=s(68199),Hs=(s(53722),Object.defineProperty),js=Object.defineProperties,zs=Object.getOwnPropertyDescriptors,Vs=Object.getOwnPropertySymbols,Ks=Object.prototype.hasOwnProperty,Ys=Object.prototype.propertyIsEnumerable,Xs=(e,t,s)=>t in e?Hs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Js=(e,t)=>{for(var s in t||(t={}))Ks.call(t,s)&&Xs(e,s,t[s]);if(Vs)for(var s of Vs(t))Ys.call(t,s)&&Xs(e,s,t[s]);return e},Qs=(e,t)=>js(e,zs(t));s(40925);const ea=rt().with("play-guard-dialog");ea("header-cancel-link"),ea("permission-checkbox"),ea("apply-button");class ta extends L.P{constructor(){super(...arguments),this.hasMounted=!1,this.aboutGameConversionDataEvents={isClicked:!1,isRendered:!1},this.state={permissionChecked:!0,isSimilarGamesEnables:this.isSimilarGamesEnabled()},this.handleEarlyEvents=()=>{var e;null==(e=window.earlyEvents)||e.messages.forEach((e=>{const{type:t,action:s,data:a}=e;if("guard"===t)switch(s){case"auth":this.auth();break;case"close":this.cancel();break;case"accept":this.setState({permissionChecked:a.permissionChecked},(()=>{this.apply(a.actionSource)}))}}))},this.handleFocusOutEvent=e=>{requestAnimationFrame((()=>{if(document.activeElement===(0,qs.n)()){window.focus();const t=e.target;t&&"focus"in t&&"function"==typeof t.focus&&t.focus()}}))},this.onAuthButtonClick=()=>{this.auth()},this.onApplyButtonClick=()=>{this.apply(Fs.Q.PlayButton)},this.onExternalClick=e=>{const t=this.state.permissionChecked?Xt._I.ALLOW:Xt._I.FORBID;this.props.handleEvent(new CustomEvent("apply",{detail:{actionSource:Fs.Q.Background,permission:this.isPermissionsVisible()?t:void 0}}))},this.onContentClick=e=>{e.stopPropagation()},this.onOpenInfoClick=e=>{e.stopPropagation(),this.logOnceAboutGameConversionDataEventsIsClicked(),this.props.handleEvent(new CustomEvent("info")),c.Z.post({type:"promo-bar",action:"hide"})},this.apply=e=>{const t=this.state.permissionChecked?Xt._I.ALLOW:Xt._I.FORBID;this.props.handleEvent(new CustomEvent("apply",{detail:{actionSource:e,permission:this.isPermissionsVisible()?t:void 0}}))},this.auth=()=>{this.props.handleEvent(new CustomEvent("auth"))},this.cancel=()=>{this.props.handleEvent(new CustomEvent("cancel"))},this.onPermissionChange=e=>{this.setState(Qs(Js({},this.state),{permissionChecked:e.target.checked}))}}componentDidMount(){this.hasMounted=!0,window.focus(),window.addEventListener("focusout",this.handleFocusOutEvent),this.setState(Qs(Js({},this.state),{isSimilarGamesEnables:this.isSimilarGamesEnabled()})),this.handleEarlyEvents()}componentWillUnmount(){window.removeEventListener("focusout",this.handleFocusOutEvent)}isSimilarGamesEnabled(){const{abt:{flags:e},playPageData:t,isDistGame:s}=this.context,{location:a}=this.props;return(0,$s._Z)({appId:t.gameInfo.appId,hasMounted:this.hasMounted,isDistGame:s,locationHash:a.hash,locationSearch:a.search,showExceptNavigationFromPlayedGames:(0,ct.tQ)(e),showOnRedirectFromCatalog:(0,ct.Fe)(e)})}isAdvStickyBannerEnabled(){const{settings:e}=this.context.playPageData.gameData||{},{adv:t}=(0,Ot.Lf)(e);return this.context.playPageData.isAdvStickyBannerEnabled&&Boolean(t)}get texts(){const{getText:e}=this.props,{gamesLogoUrlText:t,gamesLogoUrlYandexName:s,verticalName:a}=this.props.vertical;return{aboutGameText:e(`guard.about-game.vertical-${a}`),commonPlayButtonText:e(`common.play.vertical-${a}`),gamesLogoUrlText:t===os.CF.WEBAPPS_CATEGORY_SERVICE_NAME?e("common.service.app_name"):e("common.service.short_name"),gamesLogoUrlYandexName:s,legalText:e(`guard.legal.text.vertical-${a}`),serviceLogoIconType:`logo-${a}`}}get gameData(){var e,t;const{getText:s}=this.props,{gameInfo:a,gameSettings:r,gameData:n}=this.context.playPageData,i=a.hasWebAppsCategory?"guard.users.count.text":"guard.players.count.text",o=a.playersCount?s(i,{number:Zs(a.playersCount)}):void 0,d=a.hasWebAppsCategory?s("game.rating.users.new"):s("game.rating.new"),l=(0,Us.R)(this.context.isSlowCountry)?this.context.cdnUrl:void 0;return{ageRating:null==(e=r.features)?void 0:e.age_rating,hasWebAppsCategory:a.hasWebAppsCategory,icon:(0,se.kM)(a.iconUrl,l),playersCount:a.playersCount?Gs(a.playersCount):void 0,playersCountText:o,gameQualityScore:a.gameQualityScore,publisher:(0,Ie.T)(a.publisher.name),rating:a.rating,ratingText:d,title:(0,Ie.T)(a.title),userDataRequired:Boolean(null==(t=r.features)?void 0:t.user_data_required),categories:a.categoryNames,categoriesIDs:(null==n?void 0:n.categoryIDs)||[]}}renderCancelButton(){const{oneTabPWA:e}=this.context;return o().createElement("a",{className:`${ea("header-cancel-link")} games-link`,"data-guard-close":"true",target:(0,yt.AO)({oneTabPWA:e}),onClick:this.cancel},this.props.getText("common.cancel"))}renderHeader(){const{baseUrl:e,referrer:t,tld:s,isPWA:r,oneTabPWA:n}=this.context,{getText:i,vertical:{verticalCategory:d,verticalName:l}}=this.props,c=d?`/category/${d}`:"/",h=(0,re.Px)({search:"?utm_source=game_guard_logo",params:{[z.cB]:r?"1":"",[z.Vw]:(0,wt.sD)(t)?t:""}}),u=(0,gt.E)({baseUrl:e,path:`${c}${h?`${h}`:""}`,lang:this.context.pathLang,languages:(0,a.getDomainConfig)().languages,tld:s});return o().createElement("div",{className:ea("header")},o().createElement("span",{className:ea("header-logo")},o().createElement(nt.Kk,{className:ea("header-logo-link"),href:u,tabIndex:-1,target:(0,yt.AO)({oneTabPWA:n}),title:i(`common.service.name.vertical-${l}`)},o().createElement(is.Z,{type:os.q7.GUARD}))),this.renderCancelButton())}renderRating(){return o().createElement("div",{className:ea("description-players")},this.gameData.gameQualityScore&&o().createElement(be.Z,{value:this.gameData.gameQualityScore}),o().createElement(ke.Z,{hasWebAppsCategory:this.gameData.hasWebAppsCategory,rating:this.gameData.rating,useNewText:!0}))}renderDescription(){const{isSlowCountry:e}=this.context,{ageRating:t}=this.gameData;return o().createElement("div",{className:ea("description")},o().createElement(Rs.Z,{alt:this.gameData.title,className:ea("description-icon",{low:e}),crossOrigin:"anonymous",size:38,src:this.gameData.icon}),o().createElement("div",{className:ea("description-details")},o().createElement("div",{className:ea("description-details-header")},o().createElement("div",{className:ea("description-title-wrapper")},o().createElement("h1",{className:ea("description-title"),itemScope:!0,itemType:"http://schema.org/WebPage"},this.gameData.title),t&&o().createElement(ge.Wd,{className:ea("description-ageRating"),"data-testid":"PlayGuard-AgeTag",variant:Pe.Ft[t]},t)),o().createElement("div",{className:ea("description-publisher")},this.gameData.publisher),o().createElement(Ps.Z,{categoriesNames:this.gameData.categories,categoryIDs:this.gameData.categoriesIDs,mix:ea("categories")}))))}isPermissionsVisible(){return this.props.withPurchasesPermissions||this.props.hasAuth&&this.gameData.userDataRequired}logOnceAboutGameConversionDataEventsIsRendered(){this.aboutGameConversionDataEvents.isRendered||(this.aboutGameConversionDataEvents.isRendered=!0,window.clickdaemonLog(Ws.zx.CONVERSION,{item:"game_page_guard_learn_more_render",app_id:this.context.playPageData.gameInfo.appId}))}logOnceAboutGameConversionDataEventsIsClicked(){this.aboutGameConversionDataEvents.isClicked||(this.aboutGameConversionDataEvents.isClicked=!0,window.clickdaemonLog(Ws.zx.CONVERSION,{item:"game_page_guard_learn_more_click",app_id:this.context.playPageData.gameInfo.appId}))}renderApply(){return o().createElement("div",{className:ea("apply"),title:this.texts.commonPlayButtonText},o().createElement(Ms,{className:ea("apply-button"),onClick:this.onApplyButtonClick},this.texts.commonPlayButtonText))}renderLegal(){const{baseHost:e}=this.context,{getText:t}=this.props;return o().createElement("div",{className:ea("legal")},this.texts.legalText," ",o().createElement("a",{className:"games-link",href:t("guard.license.link.href"),target:"_blank"},t("guard.license.link.text")))}renderOpenInfo(){return"undefined"!=typeof window&&this.logOnceAboutGameConversionDataEventsIsRendered(),o().createElement("div",{className:`${ea("open-info")} games-link`,onClick:this.onOpenInfoClick},o().createElement(dt.Z,{type:"info"}),this.texts.aboutGameText)}render(){const e=this.state.isSimilarGamesEnables&&!this.props.isFullscreenActive;return o().createElement("div",{className:ea({"with-blur":!0,"with-adv":this.isAdvStickyBannerEnabled(),"with-similar":e,hidden:this.props.hidden}),onClick:this.onExternalClick},o().createElement("div",{className:ea("content"),onClick:this.onContentClick},this.renderHeader(),this.renderDescription(),this.renderRating(),o().createElement(xs,{permissionChecked:this.state.permissionChecked,withPurchasesPermissions:this.props.withPurchasesPermissions,onPermissionChange:this.onPermissionChange}),o().createElement(Cs,{onAuthButtonClick:this.onAuthButtonClick}),this.renderApply(),this.renderLegal(),o().createElement(Ls,null)),this.renderOpenInfo())}}const sa=(0,n.E)((0,d.$j)((function(e){return{darkTheme:(0,Tt.Up)(e),getText:e.getText,hasAuth:Boolean(e.userData.login),isFullscreenActive:e.ui.isFullscreenActive,isSimilarGamesLoading:e.similarGamesLoading,lang:e.lang,vertical:e.vertical}}))(ta));function aa(){return o().createElement(Qt.Consumer,null,(e=>o().createElement(sa,{handleEvent:e.handleEvent,hidden:e.hidden,withPurchasesPermissions:e.withPurchasesPermissions})))}var ra=s(97976),na=s(43633),ia=s(87005),oa=s(125),da=s(73673);const la=s(13048).Z;var ca=s(35864),ha=Object.defineProperty,ua=Object.defineProperties,pa=Object.getOwnPropertyDescriptors,ma=Object.getOwnPropertySymbols,va=Object.prototype.hasOwnProperty,ga=Object.prototype.propertyIsEnumerable,wa=(e,t,s)=>t in e?ha(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,fa=(e,t)=>{for(var s in t||(t={}))va.call(t,s)&&wa(e,s,t[s]);if(ma)for(var s of ma(t))ga.call(t,s)&&wa(e,s,t[s]);return e},ya=(e,t)=>ua(e,pa(t)),ba=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const ka=(0,g.M$)("Scopes",g.XG.Popup),Aa={method:"POST",credentials:"include",referrerPolicy:"no-referrer-when-downgrade",headers:{Accept:"application/json","Content-Type":"application/json"}};class Ea extends i.Component{constructor(e){super(e),this.onInternalMessage=(e,t)=>{const{action:s,data:a}=e.data;"apply-guard"===s&&this.handleApplyGuard(a,t)},this.onExternalMessage=(e,t)=>{"open-scopes-dialog"===e.data.action&&c.Z.post({type:"guard",action:"get-show-state"}).then((({data:e})=>{const{result:s}=e;s||this.show().then((e=>{t({data:{result:e}})})).catch((()=>{t({data:{result:null}})}))}))},this.handleEvent=e=>{switch(e.type){case"apply":this.sendParams("apply"),this.apply();break;case"cancel":this.sendParams("cancel"),this.cancel();break;case"close":this.sendParams("close"),this.close();break;default:(0,N.fF)(new Error(`Unknown event type ${e.type}`))}},this.state={show:!1}}componentDidMount(){ka("componentDidMount"),c.Z.onInternalMessage("scopes",this.onInternalMessage),c.Z.onExternalMessage("scopes",this.onExternalMessage)}componentWillUnmount(){ka("componentWillUnmount"),c.Z.offInternalMessage("scopes",this.onInternalMessage),c.Z.offExternalMessage("scopes",this.onExternalMessage)}handleApplyGuard(e,t){!e.isGuardEnabled&&this.props.hasAuth?e.permission&&this.postDataPermissions({permissions:e.permission,withPurchasesPermissions:e.withPurchasesPermissions}).then((e=>t({data:{result:e}}))).catch((()=>t({data:{result:null}}))):this.postData({permissions:e.permission,guardConfirm:!0,withPurchasesPermissions:e.withPurchasesPermissions}).then((e=>t({data:{result:e}}))).catch((()=>t({data:{result:null}})))}show(){const e=this.context.abt.flags;if(this.showPromiseWrapper)return this.showPromiseWrapper.promise;this.setState({show:!0}),this.sendParams("show");const t=this.createShowPromiseWrapper();return((0,U.x)()&&(0,ct.r7)(e)||function(){const e=(0,W.KT)();return z.XL.includes(e)}())&&this.handleEvent(new CustomEvent("cancel")),t}createShowPromiseWrapper(){return this.showPromiseWrapper=new r.Z,this.showPromiseWrapper.promise}postData(e){return ba(this,arguments,(function*({guardConfirm:e,permissions:t,withPurchasesPermissions:s}){const a={};if(t&&[Xt._I.ALLOW,Xt._I.FORBID].includes(t)&&(a.avatar=t,a.publicName=t,s&&(a.purchasesInfo=t)),void 0!==e&&(a.guard=e),0===Object.keys(a).length)return Promise.reject(new Error("Wrong param value for private-info"));const r=(0,ca.H)("/player/private-info/"),n=ya(fa({},Aa),{body:JSON.stringify(a)});return yield(0,h.rQ)({apiPath:r,options:n})}))}postDataPermissions(e){return ba(this,arguments,(function*({permissions:e,withPurchasesPermissions:t}){const s={},a=(0,ca.H)("/player/scope-permissions/");[Xt._I.ALLOW,Xt._I.FORBID].includes(e)&&(s.avatar=e,s.publicName=e,t&&(s.purchasesInfo=e));const r=ya(fa({},Aa),{body:JSON.stringify(s)});return yield(0,h.rQ)({apiPath:a,options:r})}))}apply(){this.postDataPermissions({permissions:Xt._I.ALLOW}).then((e=>{this.showPromiseWrapper&&(this.showPromiseWrapper.resolve(e),this.showPromiseWrapper=null),this.close()})).catch((e=>{(0,N.fF)(e),this.close()}))}cancel(){this.postDataPermissions({permissions:Xt._I.FORBID}).then((e=>{this.showPromiseWrapper&&(this.showPromiseWrapper.resolve(e),this.showPromiseWrapper=null),this.close()})).catch((e=>{(0,N.fF)(e),this.close()}))}close(){this.setState({show:!1}),this.showPromiseWrapper&&(this.showPromiseWrapper.reject(),this.showPromiseWrapper=null)}sendParams(e){H.Eu.params({borrowParams:{scopes:{player:{dialog:e}}}})}render(){return this.state.show?o().createElement(la,{handleEvent:this.handleEvent}):null}}Ea.contextType=L.Z;const Sa=(0,d.$j)((e=>({hasAuth:Boolean(e.userData.login)})))(Ea);var Ia=s(33642),Pa=Object.defineProperty,Ra=Object.getOwnPropertySymbols,Ta=Object.prototype.hasOwnProperty,Ca=Object.prototype.propertyIsEnumerable,Da=(e,t,s)=>t in e?Pa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;const La=rt().with("screen-manager-rotate-banner"),Oa=()=>{c.Z.post({type:"screen-manager",action:"request-fullscreen"})},xa=e=>{const t=(0,Ae.T)()("rotate.banner.button.text.short"),s=bt.Z.isLockable,a=(0,i.useCallback)((e=>{window.blur(),setTimeout((()=>{null==e||e.focus(),window.focus(),window.dispatchEvent(new Event("focus"))}),1)}),[]);return o().createElement(Ia.Z,((e,t)=>{for(var s in t||(t={}))Ta.call(t,s)&&Da(e,s,t[s]);if(Ra)for(var s of Ra(t))Ca.call(t,s)&&Da(e,s,t[s]);return e})({},e),s&&o().createElement("button",{className:La("force-rotate-button"),ref:a,onClick:Oa},t))};var _a=s(33381),Ba=s(55968),Na=s(80024),Ma=s(16527),$a=s(70602),Fa=s(39449),qa=s(13377);const Wa="yandexGames_shortcut_installation_dates";const Za=(0,g.M$)("ShortcutManagerCommonApi",g.XG.Popup);function Ga(e,t){(0,H.U4)({},{shortcutApi:{action:e,params:t}})}class Ua{constructor(e,t,s){this.context=t,this.beforeInstallEventCallbacks=[],this.isPlayToEarn=!1,this.isYandex=!1,this.wasBeforeInstallPrompt=()=>Boolean(this.shouldCallBeforeInstallEventCallbackImmediataly),this.showBeforeInstallprompt=!1,this.appId=e,this.dispatch=s,window.addEventListener("beforeinstallprompt",(e=>{e.preventDefault(),this.shortcutEventPrompt=e,this.callBeforeInstallEventCallbacks()})),this.isPlayToEarn=(0,ct.XP)(t.abt.flags),this.isYandex=(0,j.RY)()}addListenerOnSuccessInit(e){this.shouldCallBeforeInstallEventCallbackImmediataly?e():this.beforeInstallEventCallbacks.push(e)}safeCallBeforeInstallEventCallbacks(){this.beforeInstallEventCallbacks.forEach((e=>e())),this.shouldCallBeforeInstallEventCallbackImmediataly=!0}callBeforeInstallEventCallbacks(){this.shouldCallBeforeInstallEventCallbackImmediataly||this.safeCallBeforeInstallEventCallbacks(),this.waitShowPromptAsync&&(this.waitShowPromptAsync=!1,this.showPromptByUserGesture("beforeinstallprompt")),Ga("beforeinstallprompt",{show:this.showBeforeInstallprompt})}addListenerOnExpiration(e){this.expirationCallback=e}getSupportStatus(){return Boolean(this.shortcutEventPrompt)}showPromptByUserGesture(e){const t=(0,Mt.c)((()=>(t(),this.showPrompt(e,Na.v.PAGE_OPEN))))}showPromptAsync(e){return t=this,s=null,a=function*(){const{source:t}=e;if(Ga("showPromptStart",e),this.shortcutEventPrompt)return Za(`ShortcutManagerCommonApi showPromptAsync: showPrompt exists and is called, source: ${e.source}`),t===Na.v.PAGE_OPEN?this.showPromptByUserGesture("userGesture"):this.showPrompt("showPrompt",t);this.waitShowPromptAsync=!0;const s=`ShortcutManagerCommonApi showPromptAsync: showPrompt doesn't exist and is called, source: ${e.source}`;if(Za(s),t===Na.v.GAME_API)throw new Error(s);console.info(s)},new Promise(((e,r)=>{var n=e=>{try{o(a.next(e))}catch(e){r(e)}},i=e=>{try{o(a.throw(e))}catch(e){r(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,i);o((a=a.apply(t,s)).next())}));var t,s,a}readInstallationDates(){const{value:e,wasError:t}=(0,Nt.dq)(Wa);if(!t)try{const t=JSON.parse(e||"{}");if(t&&"object"==typeof t)return t}catch(e){(0,m.H)({block:qa.W.SHORTCUTS_POPUP_MANAGER,prefix:"Error in readInstallationDates",source:"sdk"},e)}}shouldInstallAgain(){if(!this.appId)return!1;const e=this.readInstallationDates();if(!e)return!1;const t=new Date(e[this.appId]).getTime();return!!isNaN(t)||Math.abs(Date.now()-t)>=Fa.E$}setInstallationDate(){if(!this.appId)return;const e=this.readInstallationDates()||{};e[this.appId]=(new Date).toISOString(),(0,Nt.Ur)(Wa,JSON.stringify(e))}showPrompt(e,t){var s,a,r,n;if(Za("showPrompt"),this.shortcutEventPrompt){if("showPrompt"===e||this.shouldInstallAgain())return Ga("showPrompt",{showPromptReason:e}),(0,H.NF)({},ss.Ji.SHORTCUT_PROMPT_SHOW,{showPromptSource:e}),$a.Fj.show((0,$a.oU)({context:this.context,popupType:"system",source:(0,$a.N7)(t)})),null==(s=this.shortcutEventPrompt)||s.prompt().catch((e=>{Ga("showPromptError",{err:e.message}),console.warn("ShortcutManagerCommonApi error: ",e)})),null==(a=this.shortcutEventPrompt)||a.userChoice.then((s=>($a.Fj.click((0,$a.oU)({context:this.context,popupType:"system",source:(0,$a.N7)(t),result:"accepted"===s.outcome?"accepted":"rejected"})),"accepted"===s.outcome?((0,H.NF)({},ss.Ji.SHORTCUT_USER_CHOICE_ACCEPTED,{showPromptSource:e}),this.isPlayToEarn&&this.isYandex&&this.dispatch((0,Ma.$B)(Ba.cb.CREATE_LINK_IN_CATALOGUE))):(this.dispatch((0,B.yf)(!0)),(0,H.NF)({},ss.Ji.SHORTCUT_USER_CHOICE_DISMISSED,{showPromptSource:e})),this.shortcutEventPrompt=void 0,s))),null==(r=this.expirationCallback)||r.call(this),this.setInstallationDate(),null==(n=this.shortcutEventPrompt)?void 0:n.userChoice;Ga("showPromptError",{err:`You can call showPrompt on reason ${e} only once a day`})}}}var Ha=s(15987);var ja=s(62847),za=s(32595),Va=s(4915),Ka=s(31085);const Ya=(0,g.M$)("ShortcutPopupManager",g.XG.Popup),Xa=v.WT;class Ja extends i.PureComponent{constructor(){super(...arguments),this.state={canShowCalled:!1,forsedShowshortcutPopup:!1},this.onExternalMessage=(e,t)=>{return s=this,a=null,r=function*(){const{appId:s}=this.context.playPageData.gameInfo,{action:a}=e.data;switch(a){case"can-show-prompt":{const e=this.canShowApiPrompt(s);Ya(`onExternalMessage: action: "${a}", canShow: ${e}`),t({data:{canShow:e}}),this.setState({canShowCalled:!0});break}case"show-prompt":{const e=this.canShowApiPrompt(s);if(Ya(`onExternalMessage: action: "${a}", canShow: ${e}`),e){const e=this.installationChecker.catalogPromptHasShown(s)?"game":"catalog";H.Eu.reachGoal(ss.Ji.SHORTCUT_API_SHOW,{shortcutApi:{appId:s,manifestType:e}}),window.setTimeout((()=>{this.showApiPrompt({source:Na.v.GAME_API},s).then((e=>{t({data:{outcome:null==e?void 0:e.outcome}})}))}),Xa)}else this.state.canShowCalled?t({data:{canShow:e,reason:"cannot show prompt"}}):t({data:{canShow:e,reason:"use canShowPrompt before showPrompt"}});break}}},new Promise(((e,t)=>{var n=e=>{try{o(r.next(e))}catch(e){t(e)}},i=e=>{try{o(r.throw(e))}catch(e){t(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,i);o((r=r.apply(s,a)).next())}));var s,a,r},this.onInternalMessage=e=>{var t,s,a;const{action:r,data:n}=e.data;switch(r){case"show-api-prompt":Ya('onInternalMessage "show-api-prompt"'),this.showApiPrompt({source:n.source});break;case"show-shortcut-popup":Ya('onInternalMessage "show-shortcut-popup"'),this.showShortcutPopup();break;case"show-standalone-api-prompt":Ya('onInternalMessage "show-standalone-api-prompt"'),null==(a=null==(s=null==(t=window.yandex)?void 0:t.app)?void 0:s.installShortcut)||a.call(s);break;case"activate":{Ya('onInternalMessage "activate"');const e=new Event("beforeinstallprompt");e.userChoice=this.createExternalShortcutPromise("user-choice"),e.prompt=()=>this.createExternalShortcutPromise("prompt"),window.dispatchEvent(e);break}}},this.createExternalShortcutPromise=e=>new Promise(((t,s)=>{const a=`${e}-resolve`,r=`${e}-reject`,n=e=>{const{action:i}=e.data;i!==a&&i!==r||(c.Z.offInternalMessage("shortcut-manager",n),i===a?t(e.data.result):i===r&&s(e.data.result))};c.Z.onInternalMessage("shortcut-manager",n,{withHistory:!0}),"prompt"===e&&c.Z.post({type:"shortcut-manager",action:"prompt"})})),this.handleCloseShortcutPopup=()=>{const e=(t="game",window.YandexGamesSDK&&"function"==typeof window.YandexGamesSDK.getStack?window.YandexGamesSDK.getStack(t):document.body).querySelector("iframe");var t;e&&(0,ja.Z)(e),this.setState({forsedShowshortcutPopup:!1})}}componentDidMount(){const{appId:e}=this.context.playPageData.gameInfo;this.shortcutManagerApi=new Ua(e,this.context,this.props.dispatch),this.installationChecker=new Va.Z,this.initMessaging()}initMessaging(){c.Z.onExternalMessage("shortcut-manager",this.onExternalMessage),c.Z.onInternalMessage("shortcut-manager",this.onInternalMessage,{withHistory:!0}),c.Z.post({type:"shortcut-manager",action:"request"})}canShowApiPrompt(e){var t;const s=(0,za.N)(this.context.uatraits);return this.installationChecker.checkShowCapability(Ka.Wp.GameApi,{waitingPeriod:v.dV,maxShowCount:3,isMiniInfobarEnabled:s},e)&&(null==(t=this.shortcutManagerApi)?void 0:t.getSupportStatus())}showApiPrompt(e,t){const{source:s}=e;if(t&&!this.canShowApiPrompt(t))return Promise.resolve(void 0);const a=new Promise((e=>this.addListenerOnSuccessInit((()=>e(!0))))).then((()=>(s===Na.v.GAME_API&&this.installationChecker.updateShowData(Ka.Wp.GameApi,t),this.shortcutManagerApi.showPromptAsync(e))));return a.then((e=>{void 0!==e&&(this.props.dispatch((0,B.FJ)(void 0)),s===Na.v.GAME_API&&t&&("accepted"===e.outcome?(this.installationChecker.updateInstallationData(Ka.Wp.GameApi,t),this.installationChecker.setLastPromptAccepted(!0,t)):(this.props.dispatch((0,B.yf)(!0)),this.installationChecker.setLastPromptAccepted(!1,t))))})).catch((()=>{})),a}wasBeforeInstallPrompt(){return this.shortcutManagerApi.wasBeforeInstallPrompt()}addListenerOnSuccessInit(e){this.shortcutManagerApi.addListenerOnSuccessInit(e)}addListenerOnExpiration(e){this.shortcutManagerApi.addListenerOnExpiration(e)}showShortcutPopup(){this.setState({forsedShowshortcutPopup:!0})}render(){return this.state.forsedShowshortcutPopup||this.props.shouldShowShortcutPopup?o().createElement(_a.Z,{trigger:this.state.forsedShowshortcutPopup?Ha.w.MENU:Ha.w.TIMER,type:this.props.type,onClose:this.handleCloseShortcutPopup}):null}}Ja.contextType=L.Z;const Qa=(0,d.$j)((function(e){return{shouldShowShortcutPopup:e.shouldShowShortcutPopup}}))(Ja);var er=s(60136),tr=s(41103),sr=s(29810),ar=s(68316);const rr=s(47774).Z;var nr=s(22263);const ir=()=>{const e=(0,je.C)((({ui:e})=>e.isGuardOpened)),{gamePause:t,gameResume:s}=(0,ce.ff)({reason:"visibility_change"});return(0,i.useEffect)((()=>{if(e)return;const a=()=>{document.hidden?t():s()};return document.addEventListener("visibilitychange",a),()=>document.removeEventListener("visibilitychange",a)}),[t,s,e]),o().createElement(o().Fragment,null)};var or=s(53603),dr=s(37379),lr=s.n(dr),cr=(e=>(e.FULL="full",e.HIDDEN="hidden",e.MOVING="moving",e.SMALL="small",e))(cr||{});const hr=rt().with("app-drawer");class ur extends i.PureComponent{constructor(){super(...arguments),this.currentProgress=0,this.dragEvents=["touchstart","touchmove","touchend","touchcancel"],this.isDrawerEvent=void 0,this.touchStartPos={x:0,y:0},this.state={moving:!1},this.drawerInnerRef=e=>{e&&(this.element=e,this.curtain=this.element.querySelector(".app-drawer__curtain"),this.content=this.element.querySelector(".app-drawer__content"),this.dragEvents.forEach((e=>{var t;return null==(t=this.element)?void 0:t.addEventListener(e,this.handleDrag,{capture:!0,passive:!1})})),this.content.addEventListener("scroll",this.handleScroll,{passive:!0}))},this.handleDrag=e=>{var t;const{onChangeStatus:s,onClose:a,playerError:r,status:n}=this.props;if(!this.element||"hidden"===n||r)return;const i=e.touches[0];switch(e.type){case"touchstart":this.touchStartPos={x:i.pageX,y:i.pageY},this.isDrawerEvent=void 0;break;case"touchmove":void 0===this.isDrawerEvent&&(this.isDrawerEvent=Boolean(Math.abs(i.pageX-this.touchStartPos.x)<Math.abs(i.pageY-this.touchStartPos.y))&&(i.pageY>this.touchStartPos.y&&0===(null==(t=this.content)?void 0:t.scrollTop)||"full"!==n&&!this.isLandscape())),this.isDrawerEvent&&(e.preventDefault(),this.setState({moving:!0}),this.setProgress((this.touchStartPos.y-i.pageY)/this.element.offsetHeight));break;case"touchend":case"touchcancel":if(this.setState({moving:!1}),this.curtain&&(this.curtain.style.transform=""),!this.isDrawerEvent)return;if("full"===n&&this.currentProgress<1||this.currentProgress<.6)return s("hidden"),a(),void this.dragEvents.forEach((e=>{var t;return null==(t=this.element)?void 0:t.removeEventListener(e,this.handleDrag)}));this.currentProgress>.8&&s("full")}},this.handleScroll=()=>{var e;const{onChangeStatus:t,onUpdateScrollTop:s,status:a}=this.props;s((null==(e=this.content)?void 0:e.scrollTop)||0),"full"!==a&&t("full")},this.setProgress=e=>{const{status:t}=this.props;if(!this.element||!this.curtain)return;const s="full"===t||this.isLandscape()?1:.7,a=Math.min(1,Math.max(0,e+s)),r=this.element.offsetHeight-this.element.offsetHeight*a;this.curtain.style.transform=`translateY(${r}px) translateZ(0)`,this.currentProgress=a}}componentWillUnmount(){var e;null==(e=this.element)||e.removeEventListener("scroll",this.handleScroll),this.dragEvents.forEach((e=>{var t;return null==(t=this.element)?void 0:t.removeEventListener(e,this.handleDrag)}))}isLandscape(){return window.innerHeight<window.innerWidth}render(){const{children:e,hidden:t,mode:s,onClose:a,status:r,withShadow:n}=this.props,{moving:i}=this.state;return o().createElement("div",{className:hr({hidden:t,mode:s,moving:i,status:r,"with-promo-bar-landscape":!0}),ref:this.drawerInnerRef},o().createElement("div",{className:hr("drag-observer")},o().createElement("div",{className:hr("curtain",{moving:i,status:r})},o().createElement("div",{className:hr("handle")}),o().createElement("div",{className:hr("content",{status:r})},e)),o().createElement("div",{className:hr("bg",{shadow:n}),onClick:a})),o().createElement("noscript",null,o().createElement("style",null,".app .app-drawer_hidden {\n                            display: block;\n                        }")))}}ur.contextType=L.Z;var pr=s(69543),mr=s(26213);var vr=s(65562);const gr=s(81839).Z,wr=(0,g.M$)("gamePage",g.XG.Dev);s(82854);const fr=["document-events","guard"];class yr extends L.P{constructor(){super(...arguments),this.pageStartRef=o().createRef(),this.withInfo=-1!==this.props.location.search.indexOf("info=true"),this.needToShowLeaderboard=(()=>{const{search:e,hash:t}=this.props.location;return`${e}#${t}`.includes("leaderboard")})(),this.shouldRenderContent=Boolean(this.context.isSearchCrawler),this.state={showInfo:this.getInitGuardState(),showGuard:this.getInitGuardState(),drawerStatus:cr.SMALL,hiddenControls:this.getInitHiddenControls(),hiddenImages:!0,hiddenLazyElements:!0,hiddenVideo:!0,permission:!0,playerError:!1,scrollTop:0,scrollToLeaderboard:!1},this.handleClose=()=>{const{hiddenControls:e,showInfo:t}=this.state;!this.withInfo||e?(e?t&&!(0,yt.PK)()&&"#info"===location.hash&&history.back():c.Z.post({type:"guard",action:"show"}),this.setState({hiddenVideo:!0,scrollToLeaderboard:!1,showInfo:!1})):this.handleBack()},this.handleBackgroundClick=()=>{this.handleApply(Fs.Q.Background)},this.handleCloseButton=()=>{this.handleApply(Fs.Q.CloseButton)},this.handleDrawerClose=()=>{this.handleApply(Fs.Q.DrawerSwipe)},this.handleAuth=()=>{c.Z.post({type:"auth",action:"auth-dialog-open",data:{initializer:"app-page"}}),(0,H.U4)({},{action:"auth"})},this.handleBack=()=>{const{hiddenControls:e,showInfo:t}=this.state,{baseUrlWithLangPath:s,hidePaymentsAndCurrency:a,isGamesLiteApp:r,isPWA:n,oneTabPWA:i,pfid:o,referrer:d,uatraits:l}=this.context;if(t&&(e||i))return i||this.setState({showInfo:!1}),history.back(),void(0,H.U4)({},{action:"close-info"});(0,H.U4)({},{action:"back-to-catalog"}),document.documentElement.classList.remove("with-player"),this.exitFullscreen();const c=(0,vr.g)(l)&&i;if(!window.opener||r||c){const e=vt.parse(window.location.search.slice(1));d&&(0,wt.sD)(d)&&(e[z.Vw]=d),r&&(e.utm_source="close_button"),a&&(e[z.o1]="1"),n&&(e[z.cB]="1"),o&&(e[z.om]=o);const t=vt.stringify(e);let l=`${window.location.origin}${s}${t.length?`/?${t}`:""}`;l=(0,nt.ky)(l,{currentLocation:window.location.href}),window.open(l,i?"_parent":"_self")}else window.close()},this.handlePlayButton=()=>{this.handleApply(Fs.Q.PlayButton)},this.handleUpdateScrollTop=e=>{this.setState({scrollTop:e})},this.handlePermissionsChange=e=>{this.setState({permission:e})},this.feedbackRef=e=>{this.feedbackTitleElement=e},this.gameInstructionRef=e=>{this.gameInstructionElement=e},this.handleBackButton=e=>{const{hiddenControls:t}=this.state;!e.state&&t&&this.hideInfo()},this.handleEarlyEvents=()=>{var e;null==(e=window.earlyEvents)||e.messages.forEach((e=>{const{type:t,action:s,data:a}=e;if("guard"===t)switch(s){case"auth":this.handleAuth();break;case"close":this.handleBack();break;case"accept":this.setState({permission:a.permissionChecked},(()=>{this.handleApply(a.actionSource)}))}})),document.documentElement.classList.remove("without-guard")},this.changeDrawerStatus=e=>{this.setState({drawerStatus:e}),e===cr.FULL&&(this.setState({hiddenLazyElements:!1,hiddenVideo:!1}),c.Z.post({type:"promo-bar",action:"remove"}))},this.handleVisibilityChange=()=>{"visible"===document.visibilityState&&this.requestFullscreen()},this.requestFullscreen=()=>{var e;const{game:t}=this.props,s=(0,W.KT)();z.XL.includes(s)||bt.Z.requestFullscreenAndLockOrientation(null==(e=t.features)?void 0:e.orientation)},this.onAllMessages=e=>{const{type:t,action:s,data:a}=e.data,{platform:r}=this.context,{isIOS:n}=(0,Pe.AK)(r),{hiddenControls:i}=this.state;switch(t){case"document-events":switch(s){case"redirect":window.location.href=a.href;break;case"back":this.handleBack();break;case"show-info":case"show-review":case"show-instruction":case"show-leaderboard":this.setState({hiddenImages:!1,showInfo:!0}),this.setRenderTriggered(),this.sendNotificationToSelfWindow(),!(0,yt.PK)()&&i&&window.parent.history.pushState("info","","#info"),requestAnimationFrame((()=>{this.changeDrawerStatus(cr.FULL),lr().polyfill(),setTimeout((()=>{var e,t,a;switch(s){case"show-review":this.scrollAfterLeaderboardFetching("review");break;case"show-instruction":null==(e=this.gameInstructionElement)||e.scrollIntoView({behavior:"smooth"});break;case"show-leaderboard":this.scrollAfterLeaderboardFetching("leaderboard");break;case"show-info":null==(a=null==(t=this.pageStartRef.current)?void 0:t.parentElement)||a.scrollTo({behavior:"smooth",top:0})}n&&setTimeout((()=>{window.scrollTo(0,0)}),500)}),200)})),(0,H.U4)({},{action:s})}break;case"guard":switch(s){case"cancel":this.handleBack();break;case"info":this.setState({showInfo:!0,hiddenControls:!1,hiddenImages:!1,hiddenLazyElements:!1,hiddenVideo:!1}),this.setRenderTriggered(),this.sendNotificationToSelfWindow();break;case"apply":this.setState({hiddenControls:!0});break;case"init":this.setState({hiddenControls:!1})}}},this.setRenderTriggered=()=>{this.shouldRenderContent=!0}}handleApply(e){const{showInfo:t,hiddenControls:s,permission:a,playerError:r}=this.state;r||(s||c.Z.post({type:"guard",action:"apply",data:{permission:a?Xt._I.ALLOW:Xt._I.FORBID,actionSource:e}}),this.hideInfo(),this.setState({showGuard:!1}),t&&s&&((0,yt.PK)()||"#info"===location.hash&&history.back(),(0,H.U4)({},{action:"hide-info"})),requestAnimationFrame((()=>{window.scrollTo(0,0),this.passFocusToFrame()})))}passFocusToFrame(){c.Z.hasChild()&&c.Z.postToChild((0,pr.$m)())}componentDidMount(){c.Z.onAllMessages(fr,this.onAllMessages,{withHistory:!0}),this.handleEarlyEvents(),this.context.isAdvSplashScreenEnabled||this.initInfoWindow()}componentDidUpdate(e,t){t.showInfo===this.state.showInfo||this.state.showInfo||c.Z.post({type:"document-events",action:"hide-info"})}componentWillUnmount(){this.exitFullscreen(),c.Z.offAllMessages(fr,this.onAllMessages),document.removeEventListener("visibilitychange",this.handleVisibilityChange),window.removeEventListener("popstate",this.handleBackButton)}exitFullscreen(){}sendNotificationToSelfWindow(){c.Z.post({action:"open",type:"app-info"})}hideInfo(){this.changeDrawerStatus(cr.HIDDEN),setTimeout((()=>{this.setState({showInfo:!1,hiddenControls:!0,scrollToLeaderboard:!1,hiddenVideo:!0})}),200)}isGuardEnabled(){const{abt:{flags:e},platform:t,playPageData:{gameData:s},referrerClid:a,userRegionData:r}=this.context;return!(({flags:e,isConfirmedGuard:t,platform:s,referrerClid:a,search:r})=>{if(t||a===z.x2||(0,ct.bM)(e))return!0;if(vt.parse("?"===r.charAt(0)?r.slice(1):r)[mr.U])return!0;const n=(0,Pe.AK)(s);return!!(n.isStandalone&&n.isAndroidStandalone&&(0,ct.Iv)(e))})({flags:e,isConfirmedGuard:(0,Ne.pr)({gameData:s,userRegionData:r}),platform:t,referrerClid:a,search:this.props.location.search})}getInitHiddenControls(){return!this.isGuardEnabled()}getInitGuardState(){return!!(this.shouldRenderContent||this.withInfo||this.props.location.search.includes("leaderboard"))||(this.context.isAdvSplashScreenEnabled,!1)}initInfoWindow(){var e,t;const s=this.isGuardEnabled();this.withInfo||this.needToShowLeaderboard?(this.setState({hiddenControls:!1,hiddenImages:!1,showGuard:!0,showInfo:!0}),requestAnimationFrame((()=>{this.changeDrawerStatus(this.withInfo?cr.FULL:cr.SMALL)}))):(this.changeDrawerStatus(cr.HIDDEN),this.setState({showInfo:this.shouldRenderContent,showGuard:this.shouldRenderContent,hiddenControls:!s})),window.addEventListener("popstate",this.handleBackButton,!1),c.Z.post({type:"guard",action:"load",data:{startTime:null==(t=null==(e=window.performance)?void 0:e.timing)?void 0:t.navigationStart}})}scrollAfterLeaderboardFetching(e){const{leaderboardsLoaded:t}=this.props;t?requestAnimationFrame((()=>{var t;switch(e){case"leaderboard":this.setState({scrollToLeaderboard:!0});break;case"review":null==(t=this.feedbackTitleElement)||t.scrollIntoView({behavior:"smooth"})}})):setTimeout((()=>{this.scrollAfterLeaderboardFetching(e)}),100)}render(){return wr("game-page render"),this.shouldRenderContent?(wr("game-page render desktop"),o().createElement(gr,{game:this.props.game,handlers:{handleBack:this.handleBack,handleClose:this.handleClose,handlePermissionsChange:this.handlePermissionsChange,handlePlayButton:this.handlePlayButton,handleAuth:this.handleAuth,handleBackgroundClick:this.handleBackgroundClick},refs:{pageStartRef:this.pageStartRef,feedbackRef:this.feedbackRef,gameInstructionRef:this.gameInstructionRef},state:this.state})):null}}const br=(0,n.E)((0,d.$j)((function(e){var t,s;return{advDisabledByPartnersKit:e.advDisabledByPartnersKit,getText:e.getText,leaderboardsLoaded:(null==(t=e.leaderboards)?void 0:t.main.loaded)&&(null==(s=e.leaderboards)?void 0:s.friends.loaded),userData:e.userData}}))(yr));var kr=s(47484),Ar=s(90380),Er=Object.defineProperty,Sr=(e,t,s)=>(((e,t,s)=>{t in e?Er(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);const Ir=(0,g.M$)("AppPageBody",g.XG.Dev);class Pr extends L.P{constructor(e){super(e),Sr(this,"stackRef"),Sr(this,"state",{hasMounted:!1,canRenderGamePage:!0,showUxFeedback:!1,isShortcutVisible:!1}),Sr(this,"guardClosedPromiseWrapper",new r.Z),Sr(this,"onGuardMessage",(e=>{const{action:t}=e.data;"set-was-showed"===t&&this.resolveGuardPromise()})),Sr(this,"canShowUxFeedback",(()=>{var e;const{abt:t,isAutotests:s}=this.context,{isUxFeedbackForced:r}=this.props,n=(0,a.getDomainConfig)();this.setState({showUxFeedback:!(0,yt.PK)()&&Boolean(null==(e=n.feedbackSettings)?void 0:e.canShowSpeedButton)&&Boolean((0,ct._D)(t.flags))&&Boolean((0,nr.c)(this.context,r))&&!(0,re.$m)()&&!s})})),Sr(this,"showShortcutIfNeeded",(()=>{var e;const{appData:t}=this.props,s=null==(e=t.location)?void 0:e.entryQuery["redir-data"];if(s){const{card:e}=JSON.parse(s)||{};"your_games"===e&&this.setState({isShortcutVisible:!0})}})),Sr(this,"shortcutClose",(()=>{this.setState({isShortcutVisible:!1})})),this.stackRef=o().createRef()}componentDidMount(){this.initMessaging(),this.setState({hasMounted:!0}),(0,kr.UQ)((()=>{this.guardClosedPromiseWrapper.promise.then((()=>{this.gameLoadingFeedback()}))}))}componentDidUpdate(e){!e.isUxFeedbackForced&&this.props.isUxFeedbackForced&&this.canShowUxFeedback()}componentWillUnmount(){c.Z.offInternalMessage("guard",this.onGuardMessage)}initMessaging(){c.Z.onInternalMessage("guard",this.onGuardMessage)}resolveGuardPromise(){this.guardClosedPromiseWrapper.resolve(void 0),c.Z.offInternalMessage("guard",this.onGuardMessage)}renderProfilePopup(){const{showProfilePopup:e}=this.props;return e?o().createElement(ia.Z,null):null}gameLoadingFeedback(){var e;const{abt:{flags:t},isAutotests:s,uxFeedbackControllerInstance:r}=this.context,n=(0,Nt.dq)(z.jo);if(!(null==(e=(0,a.getDomainConfig)().feedbackSettings)?void 0:e.canShowSpeedButton)||!(0,ct._D)(t)||void 0===r||"true"===n.value||s)return void(0,Nt.Ur)(z.NY,"false");let i=null==r?void 0:r.onReady((()=>{Ir("uxFeedbackControllerInstance sendMessage"),null==r||r.sendMessage("event",{event:"game_loading_feedback"}),(0,Nt.Ur)(z.jo,"true"),(0,Nt.Ur)(z.NY,"true"),null==i||i()}));Ir("uxFeedbackControllerInstance",r),null==r||r.start(),this.props.dispatch((0,es.zN)(!0))}render(){Ir("render");const{appData:e,isAccountCompletionAvailable:t,middleLayerInGameShow:s,shouldShowAndroidShortcutDrawer:a}=this.props,{abt:{flags:r},hidePaymentsAndCurrency:n,isAdvSplashScreenEnabled:i,isGamesApp:d,isStickyEnabled:l,playPageData:c}=this.context,{showUxFeedback:h,hasMounted:u,canRenderGamePage:p}=this.state,{gameData:m}=c,{isSearchCrawler:v,lang:g,hasHeader:w}=e,f=(0,ct.Rk)(r);f&&!this.state.isShortcutVisible&&this.showShortcutIfNeeded(),Ir("showUxFeedback",h);let y="stack";if("undefined"!=typeof window){const e=document.querySelector(".stack");y=(null==e?void 0:e.className)||y}const b=u&&(0,ct.RM)(r,Ar.Z.userActivityPopup),k=c.isGameLoaderEnabled&&!0;let A=i?o().createElement(oe.Z,null):o().createElement(de.Z,null);return s&&(A=o().createElement(ze,null)),o().createElement(or.I,null,!d&&o().createElement(ee.Z,{type:"game"}),o().createElement(Qe,null),o().createElement(sr.Z,null),o().createElement(da.q,null),o().createElement(T,{lang:g}),o().createElement(D.Z,null),o().createElement(he,null),o().createElement(ir,null),o().createElement(Is,{isVisible:w}),o().createElement("div",{className:y,ref:this.stackRef},l&&o().createElement(C.Z,{hideAdvCloseButton:n,wrapperRef:this.stackRef}),o().createElement(J.Z,{page:"app"}),o().createElement(st.Z,null),o().createElement(xa,null),!s&&o().createElement(na.Z,{isBlackFadeout:!0}),o().createElement(X,null),o().createElement(et.Z,null),o().createElement("div",{className:"rotate-banner"}),o().createElement(ns,null,o().createElement(aa,null)),k&&A,o().createElement("div",{className:"shortcut"},u&&o().createElement(Qa,{type:"game"})),o().createElement(ra.Z,null),o().createElement(Sa,null),o().createElement(ie,null),o().createElement(ue.Z,null),o().createElement(me,null),(0,ct.XP)(r)&&o().createElement(oa.Z,null),(0,ct.XP)(r)&&this.renderProfilePopup(),Boolean((0,ct.xO)(r))&&o().createElement(tr.Z,null)),p&&(null==m?void 0:m.appID)?o().createElement(br,{game:m}):null,b&&o().createElement(ar.Z,null),o().createElement(tt.Z,null),u&&o().createElement(Q.H,null),o().createElement("div",{className:"gdpr-overlay"}),u&&!v&&t&&o().createElement(Ve,null),h&&o().createElement(rr,null),f&&a&&m&&o().createElement(er.D,{game:m,isVisible:this.state.isShortcutVisible,onClose:this.shortcutClose}))}}const Rr=(0,n.E)((0,d.$j)((function(e){var t,s;return{isAccountCompletionAvailable:e.userData.isAccountCompletionAvailable,isUxFeedbackForced:e.ui.isUxFeedbackForced,middleLayerInGameShow:null==(t=e.middleLayerInGameData)?void 0:t.show,showProfilePopup:null==(s=e.playToEarn)?void 0:s.uiState.showProfilePopup,shouldShowAndroidShortcutDrawer:e.shouldShowAndroidShortcutDrawer}}))(Pr))},23678:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var a=s(45112),r=s(40184),n=s(33119),i=s(5825),o=s(61224);const d=()=>{const e=(0,i.T)(),{abt:{flags:t},referrerClid:s}=(0,r.b)(),d=(0,i.C)((e=>e.advDisabledByPartnersKit));return(0,a.qR)((()=>{if(!d)return;const a=Date.now(),r=window.setInterval((()=>{const i=(0,o.kH)({flags:t,referrerClid:s,userAgent:window.navigator.userAgent});(void 0!==i||(0,o.$g)(a))&&(window.clearInterval(r),e((0,n.K0)(Boolean(i))))}),100);return()=>{window.clearInterval(r)}})),null}},68797:(e,t,s)=>{"use strict";s.d(t,{Z:()=>R});var a=s(38096),r=s(87363),n=s.n(r);const i="child-src 'self' blob: mc.yandex.ru; connect-src 'self' localhost.msup.yandex.ru mc.yandex.ru amc.yandex.ru an.yandex.ru jstracer.yandex.ru verify.yandex.ru *.verify.yandex.ru csp.yandex.net strm.yandex.ru strm.yandex.net *.strm.yandex.net favicon.yandex.net avatars.mds.yandex.net yandexmetrica.com www.google-analytics.com www.googletagmanager.com games-sdk.yandex.az games-sdk.yandex.by games-sdk.yandex.co.il games-sdk.yandex.com games-sdk.yandex.com.am games-sdk.yandex.com.ge games-sdk.yandex.com.tr games-sdk.yandex.ee games-sdk.yandex.fr games-sdk.yandex.kg games-sdk.yandex.kz games-sdk.yandex.lt games-sdk.yandex.lv games-sdk.yandex.md games-sdk.yandex.ru games-sdk.yandex.tj games-sdk.yandex.tm games-sdk.yandex.ua games-sdk.yandex.uz; default-src 'self'; font-src 'self' yastatic.net yastat.net an.yandex.ru fonts.gstatic.com; frame-src 'self' localhost yastatic.net; img-src 'self' data: blob: mc.yandex.ru amc.yandex.ru an.yandex.ru verify.yandex.ru *.verify.yandex.ru favicon.yandex.net avatars.mds.yandex.net games.games-test.yandex.ru games-sdk.yandex.az games-sdk.yandex.by games-sdk.yandex.co.il games-sdk.yandex.com games-sdk.yandex.com.am games-sdk.yandex.com.ge games-sdk.yandex.com.tr games-sdk.yandex.ee games-sdk.yandex.fr games-sdk.yandex.kg games-sdk.yandex.kz games-sdk.yandex.lt games-sdk.yandex.lv games-sdk.yandex.md games-sdk.yandex.ru games-sdk.yandex.tj games-sdk.yandex.tm games-sdk.yandex.ua games-sdk.yandex.uz; media-src 'self' data: blob: strm.yandex.ru *.strm.yandex.net; script-src 'self' 'unsafe-eval' 'unsafe-inline' blob: yandex.ru *.yandex.ru yastatic.net; style-src 'self' 'unsafe-eval' 'unsafe-inline' fonts.googleapis.com; report-uri https://csp.yandex.net/csp?from=games-game&project=games&yandex_login=&yandexuid=;";var o=s(42126),d=s(36880),l=s(97777),c=Object.defineProperty,h=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,m=(e,t,s)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,v=(e,t)=>{for(var s in t||(t={}))u.call(t,s)&&m(e,s,t[s]);if(h)for(var s of h(t))p.call(t,s)&&m(e,s,t[s]);return e};class g{constructor(e){this.REPORT_URL=`https://csp.yandex.net/csp?from=${encodeURIComponent(e)}-game-html&project=${encodeURIComponent(e)}`}getReportURL(e){return(0,o.Z)({url:this.REPORT_URL,params:v({yandexuid:(0,d.e)("yandexuid")||""},e)})}report(e,t){const s=this.getReportURL(t);return(0,l.Z)(s,e,{credentials:"omit"})}}var w=s(40184),f=s(43548),y=s(71522),b=s(37705);function k(){const e="production";switch(e){case"production":case"prestable":case"testing":return e;default:return"development"}}var A=s(76958);function E(e){return e===A.n.desktop?"desktop":"touch"}var S=s(47484),I=s(15771);function P(e){try{const{data:t}=e.data;if(function({blockedURI:e,originalPolicy:t}){return!!/^https?:\/\/log\.strm\.yandex\.ru/.test(e)||t===i}(t))return null;const{blockedURI:s,columnNumber:a,disposition:r,documentURI:n,effectiveDirective:o,lineNumber:d,originalPolicy:l,referrer:c,sample:h,sourceFile:u,statusCode:p,violatedDirective:m}=t;return JSON.stringify({"csp-report":{"document-uri":n,referrer:c,"violated-directive":m,"effective-directive":o,"original-policy":l,disposition:r,"blocked-uri":s,"line-number":d,"column-number":a,"source-file":u,"status-code":p,"script-sample":h}})}catch(e){(0,b.H)({message:"[CSP] Failed to create violation report"},e)}return null}const R=n().memo((e=>{const{page:t}=e,{deviceType:s,playPageData:n,abt:i,version:o}=(0,w.b)(),d=(0,r.useMemo)((()=>{const e={environment:k(),page:t,platform:E(s),version:String(o)};if("app"===t&&n){const t=String(n.gameInfo.appId);t&&(e.appId=t)}return e}),[s,t,n,o]),l=(0,r.useMemo)((()=>new g((0,a.getDomainConfig)().analytics.rumProject||"games")),[]),c=(0,r.useCallback)(((e,t)=>{if("violation"===e.data.action){const s=P(e);((0,I.jP)(i.flags)?S.EE:S.Bu)((()=>{s?l.report(s,d).then((e=>t({data:e}))):t({data:null})}))}}),[l,d,i]);return(0,r.useEffect)((()=>{const e=new URLSearchParams(window.location.search);if(Boolean(e.get("debug-mode"))||(0,y.m)()||Math.random()<.05)return f.Z.onExternalMessage("csp",c),function(){f.Z.offExternalMessage("csp",c)}}),[c]),null}))},24029:(e,t,s)=>{"use strict";s.d(t,{H:()=>o});var a=s(87363),r=s.n(a),n=s(89193),i=s(85375);const o=()=>(0,i.mv)()?r().createElement(n.Z,null):null},85375:(e,t,s)=>{"use strict";s.d(t,{Sy:()=>n,hw:()=>o,mv:()=>d,q:()=>i});var a=s(45254),r=s(93298);const n=()=>a.v.HasFlag(r.AV,r.aR.AdvertisementPanel),i=()=>a.v.HasFlag(r.AV,r.aR.LogPanel),o=()=>a.v.HasFlag(r.AV,r.aR.GameDeveloperPanel),d=()=>o()||i()||n()},67404:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var a=s(63904),r=s.n(a),n=s(87363),i=s.n(n),o=s(76103),d=s(85467),l=s(5825),c=s(36172),h=s(94671);const u=r().with("game-rating-description"),p=i().memo((({mix:e="",useNewText:t,hasWebAppsCategory:s,rating:a,withoutText:r,dataTestId:n})=>{const p=(0,d.T)();let m=p("game.rating").toLowerCase();const v=(0,l.C)(c.Up);return t&&(m=p(s?"game.rating.users.new":"game.rating.new")),0===a?null:i().createElement("div",{className:(0,h.E)(u(),e),"data-testid":n&&`${n}-GameRatingDescription`,title:p("game.rating")},i().createElement("div",{className:u("star-wrapper")},i().createElement(o.Z,{className:u("rating-star",{dark:v}),type:"rating-star"}),i().createElement("span",{className:u("rating")},function(e){if(e<=0)return"0";try{return new Intl.NumberFormat("ru-RU",{minimumFractionDigits:1,maximumFractionDigits:1}).format(e)}catch(e){}return String(e.toPrecision(2)).replace(".",",")}(a))),!r&&i().createElement("div",{className:u("text",{new:t})},m))}))},25873:(e,t,s)=>{"use strict";s.d(t,{Z:()=>m});var a=s(87363),r=s.n(a),n=s(59389),i=s(40184),o=s(85467),d=s(78308),l=s(14184),c=s(43548),h=s(91605),u=s(90295),p=s(89592);const m=()=>{const[e,t]=(0,a.useState)(void 0),s=(0,o.T)(),m=(0,i.b)();(0,a.useEffect)((()=>{function e(){var e,a,r;(null==(a=null==(e=window.YandexGamesSDK)?void 0:e.conflicts)?void 0:a.data.conflictInfo)&&(c.Z.offAllMessages("merge-conflicts",s),t(null==(r=window.YandexGamesSDK)?void 0:r.conflicts))}function s(t,s){"processing"===t.data.action&&e()}return c.Z.onAllMessages("merge-conflicts",s),e(),()=>{c.Z.offAllMessages("merge-conflicts",s)}}),[]);const v=null==e?void 0:e.data;return v?r().createElement(n.Z,{conflicts:v,onResolve:a=>{(0,h.NF)({},p.Ji.MERGE_CONFLICTS_RESOLVE),t(void 0);new d.Z(window.YandexGamesSDK.apiData).setResolveConflict({appID:m.playPageData.gameInfo.appId,authPriority:"account"===a,iGames:"account"===a?void 0:a}).then((()=>{null==e||e.callback(!0),c.Z.post({type:"message-box",action:"show",data:{message:s("merge-conflicts.success")}})})).catch((t=>{(0,l.fF)(t,{message:`SDK Api request error from ${u.Wv}`,type:"fetch"}),null==e||e.callback(!1),c.Z.post({type:"message-box",action:"show",data:{message:s("merge-conflicts.error"),type:"error"}}),console.warn("Data not applied")}))}}):null}},96665:(e,t,s)=>{"use strict";s.d(t,{P:()=>a});const a="MiddleLayerInGame"},73673:(e,t,s)=>{"use strict";s.d(t,{q:()=>i});var a=s(87363),r=s(40893);const n=[],i=()=>{const e=(0,a.useContext)(r.O),t=(0,a.useRef)(!1);return(0,a.useEffect)((()=>{e&&!t.current&&(t.current=!0,n.forEach((t=>{e.registerPopup(t)})))})),null}},33642:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var a=s(87363),r=s.n(a),n=s(40184),i=s(37557),o=s(63904),d=s.n(o),l=s(85467);const c=({className:e})=>r().createElement("img",{alt:"",className:e,src:'data:image/svg+xml,%3Csvg width="153" height="163" viewBox="0 0 153 163" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Cg opacity="0.5"%3E%3Crect x="2" y="-2" width="72" height="125" rx="14" transform="matrix(-1 0 0 1 153 4)" fill="%23CFCFDC" stroke="white" stroke-width="4"/%3E%3Cpath fill-rule="evenodd" clip-rule="evenodd" d="M128.965 8H130.6C135.64 8 138.161 8 140.086 8.98094C141.779 9.8438 143.156 11.2206 144.019 12.9141C145 14.8393 145 17.3595 145 22.4V106.6C145 111.64 145 114.161 144.019 116.086C143.156 117.779 141.779 119.156 140.086 120.019C138.161 121 135.64 121 130.6 121H99.4C94.3595 121 91.8393 121 89.9141 120.019C88.2206 119.156 86.8438 117.779 85.9809 116.086C85 114.161 85 111.64 85 106.6L85 22.4C85 17.3595 85 14.8393 85.9809 12.9141C86.8438 11.2206 88.2206 9.8438 89.9141 8.98094C91.8393 8 94.3595 8 99.4 8H101.035C101.012 8.16331 101 8.33025 101 8.50001C101 10.433 102.567 12 104.5 12L125.5 12C127.433 12 129 10.433 129 8.50001C129 8.33025 128.988 8.16331 128.965 8Z" fill="%23F4F4F6"/%3E%3C/g%3E%3Crect x="2" y="161" width="72" height="125" rx="14" transform="rotate(-90 2 161)" fill="%2390919D" stroke="white" stroke-width="4"/%3E%3Cpath fill-rule="evenodd" clip-rule="evenodd" d="M7.99999 138.965V140.6C7.99999 145.64 7.99999 148.161 8.98093 150.086C9.84379 151.779 11.2206 153.156 12.9141 154.019C14.8393 155 17.3595 155 22.4 155H106.6C111.64 155 114.161 155 116.086 154.019C117.779 153.156 119.156 151.779 120.019 150.086C121 148.161 121 145.64 121 140.6V109.4C121 104.36 121 101.839 120.019 99.9141C119.156 98.2206 117.779 96.8438 116.086 95.9809C114.161 95 111.64 95 106.6 95H22.4C17.3595 95 14.8393 95 12.9141 95.9809C11.2206 96.8438 9.84379 98.2206 8.98093 99.9141C7.99999 101.839 7.99999 104.36 7.99999 109.4V111.035C8.16329 111.012 8.33023 111 8.5 111C10.433 111 12 112.567 12 114.5L12 135.5C12 137.433 10.433 139 8.5 139C8.33023 139 8.16329 138.988 7.99999 138.965Z" fill="%23F4F4F6"/%3E%3Cpath d="M35.9999 69.6001C39.3484 72.9486 41.2258 74.826 44.5744 78.1745" stroke="%235641FF" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/%3E%3Cpath d="M52.8525 70.0004L44.7001 78.153" stroke="%235641FF" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/%3E%3Cpath d="M41.7002 76C41.7002 77.6569 43.0433 79 44.7002 79C46.357 79 47.7002 77.6569 47.7002 76H41.7002ZM68.7002 54C70.357 54 71.7002 52.6569 71.7002 51C71.7002 49.3431 70.357 48 68.7002 48V54ZM47.7002 76V63H41.7002V76H47.7002ZM56.7002 54H68.7002V48H56.7002V54ZM47.7002 63C47.7002 58.0294 51.7296 54 56.7002 54V48C48.4159 48 41.7002 54.7157 41.7002 63H47.7002Z" fill="%235641FF"/%3E%3C/svg%3E%0A'}),h=d().with("screen-manager-rotate-banner"),u=({orientation:e,children:t})=>{const s=(0,l.T)(),n=(0,a.useMemo)((()=>s("rotate.banner.description",{params:{orientation:s(`rotate.banner.description.orientation.${e}`)}}).replace("\\n","<br/>")),[e,s]);return r().createElement("div",{className:`${h({orientation:e})} with-play-game-header-fix`},r().createElement(c,{className:h("image")}),r().createElement("div",{className:h("title")},s("rotate.banner.action.text")),r().createElement("div",{className:h("description"),dangerouslySetInnerHTML:{__html:n}}),t)},p=({children:e})=>{const t=(0,i.C)((e=>e.ui.screenOrientationBannerVisible)),{playPageData:s}=(0,n.b)(),{orientation:a}=s.gameSettings.features||{},o=(e=>{if("landscape"===e||"portrait"===e)return e})(a);return t&&o?r().createElement(u,{children:e,orientation:o}):null}},57650:(e,t,s)=>{"use strict";s.d(t,{Z:()=>va});var a=s(87363),r=s.n(a),n=s(65751),i=s(98816),o=s(85383),d=s(61533),l=s(29994),c=s(45112),h=s(63904),u=s.n(h),p=s(93298);const m="google-adv-sticky-banner-",v=(u().with("google-sticky-adv-banner"),(0,p.M$)("AdsenseStickyBanner",p.XG.Adv));var g=s(39743),w=s(5e4),f=s(28705),y=s(49095);const b=u().with("google-sticky-adv-banner"),k=f.P5.COLUMN,A=({advLogger:e,block:t,blockType:s,hidden:n,location:i=y.rq.RIGHT,withSpinner:o,width:d,provider:l,refreshCounter:c,onAdvShowed:h,onClose:u})=>{const p=m+s,A=(0,a.useRef)(void 0),E=(0,a.useMemo)((()=>null==e?void 0:e.copy({advBlockId:t.slotId})),[e,t.slotId]),[S,I]=(0,a.useState)(o),{maxHeight:P,minHeight:R}=(0,a.useMemo)((()=>s===y.kq.DESKTOP?{minHeight:600}:{maxHeight:250}),[s]),T=(0,a.useMemo)((()=>{const e={maxWidth:d,width:d};return R&&(e.minHeight=R),(0,f.oi)(e)}),[R,d]);(0,a.useEffect)((()=>()=>{A.current&&l&&l.destroySlot(A.current)}),[l]);const C=(0,a.useCallback)((()=>{return e=void 0,s=null,a=function*(){if(l&&E)try{A.current&&(yield l.destroySlot(A.current)),v(`Create slot for ${p}`),E.demand({advBlockId:t.slotId,depth:0,provider:w.e.Adsense}),A.current=yield l.createSlot({adFormat:P?"fluid":"auto",blockId:t.slotId,clientId:t.clientId,divId:p,height:R||250,maxHeight:P,width:d}),E.request();const{isEmpty:e,slot:s}=yield l.preloadSlot({slot:A.current});if(e)return E.responseEmpty(),v(`#${p} empty.`),void u(f.JK.Desktop);E.response(),yield l.showSlot(s),E.show(),I(!1),h(),v(`Creative showed for ${p}`)}catch(e){v(`Failed to refresh ${p}`,e),u(f.JK.Desktop)}},new Promise(((t,r)=>{var n=e=>{try{o(a.next(e))}catch(e){r(e)}},i=e=>{try{o(a.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);o((a=a.apply(e,s)).next())}));var e,s,a}),[E,t,p,R,P,l,d,h,u]);return(0,a.useEffect)((()=>{!l||!E||c<0||C()}),[l,E,C,c]),r().createElement("div",{className:b({desktop:!0,[`desktop_${i}`]:!0,direction:k,hidden:n,"with-disable-ad-button":!0}),id:p,key:p,style:T},S&&r().createElement(g.y,{className:b("spinner"),key:`${p}-spinner`,position:"center",size:28,spinning:!0,view:"default"}))};var E=s(6006),S=s(85467),I=s(91605),P=s(909);const R=u().with("disable-ad-button"),T=()=>{const e=(0,S.T)(),t=(0,a.useRef)(null),s=(0,a.useRef)(null),n=(0,a.useCallback)((()=>{(0,P.Z)(),I.Eu.params({borrowParams:{adv:{sticky:{disableAdButtonClick:{size:"long"}}}}})}),[]),i=(0,a.useMemo)((()=>e("no-ads.disable.text")),[e]);return r().createElement("div",{className:R({}),ref:t},r().createElement(E.z,{className:R("button"),"data-testid":"DisableAd-Button",ref:s,size:24,view:"primary",onClick:n},i))};var C=s(47802),D=s(43548),L=s(65087),O=Object.defineProperty,x=Object.defineProperties,_=Object.getOwnPropertyDescriptors,B=Object.getOwnPropertySymbols,N=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable,$=(e,t,s)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,F=(e,t)=>{for(var s in t||(t={}))N.call(t,s)&&$(e,s,t[s]);if(B)for(var s of B(t))M.call(t,s)&&$(e,s,t[s]);return e},q=(e,t)=>x(e,_(t));const W=u().with("google-sticky-adv-banner"),Z=({advHidden:e,advLogger:t,blocks:s,canShowDesktopAdv:n,desktopAdvWidth:i,hideAdvCloseButton:o,innerHeight:l,provider:c,refreshCounter:h,stickyBannerLocation:{desktop:u},onAdvShowed:p,onClose:m,wrapperRef:v})=>{const[g,w]=(0,a.useState)(!(0,C.Ij)()),f=l>=700;(0,a.useEffect)((()=>{const e=e=>{w("enabled"===e.data.action)};return D.Z.onInternalMessage("header",e),()=>{D.Z.offInternalMessage("header",e)}}),[]);const b=(0,a.useMemo)((()=>(0,L.C)()),[]),k=(0,a.useMemo)((()=>({marginTop:g&&!o?-b:0,paddingTop:o?0:b,width:i})),[b,i,g,o]),E=(0,a.useMemo)((()=>({marginTop:g?-b:0,width:i})),[b,i,g]),S={advLogger:t,hidden:e||!n,location:u,provider:c,refreshCounter:h,width:i,onAdvShowed:p,onClose:m};return r().createElement("div",{className:W("desktop-wrapper",{hidden:e||!n,"with-disable-ad-button":!0}),style:k},!o&&(null==v?void 0:v.current)&&(0,d.createPortal)(r().createElement("div",{className:W("desktop-disable-ad-button-wrapper"),style:E},r().createElement(T,null)),v.current),l>=500&&r().createElement(A,q(F({},S),{block:s.desktop.main,blockType:y.kq.DESKTOP,withSpinner:!0})),f&&r().createElement(A,q(F({},S),{block:s.desktop.small,blockType:y.kq.DESKTOP_ADDITIONAL,withSpinner:!1})))};var G=s(27859);Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;f.P5.ROW;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var U=s(26667),H=s(45462),j=s(62011),z=s(35742),V=s(45331),K=s(99213),Y=s(5825),X=s(58432),J=s(93013),Q=s(73171),ee=s(51290),te=s(97553),se=s(37705),ae=s(13377),re=Object.defineProperty,ne=Object.defineProperties,ie=Object.getOwnPropertyDescriptors,oe=Object.getOwnPropertySymbols,de=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable,ce=(e,t,s)=>t in e?re(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,he=(e,t)=>{for(var s in t||(t={}))de.call(t,s)&&ce(e,s,t[s]);if(oe)for(var s of oe(t))le.call(t,s)&&ce(e,s,t[s]);return e},ue=(e,t)=>ne(e,ie(t));const pe=(0,j.Z)((({advHidden:e,appId:t,blocks:s,canShowDesktopAdv:n,canShowLandscapeAdv:i,canShowPortraitAdv:o,desktopAdvWidth:d,mobileAdvLandscapeHeight:l,mobileAdvSideLandscapeWidth:h,mobileAdvPortraitHeight:u,onClose:p,onAdvShowed:m,hideAdvCloseButton:g,stickyBannerLocation:y,intervalBetweenRefreshAd:b,isLandscapeSide:k,wrapperRef:A})=>{const E=(0,Y.C)((e=>e.advGameCanBeLoaded)),[S,I]=(0,a.useState)(),[P,R]=(0,a.useState)("object"==typeof window?window.innerHeight:0),T=(0,a.useRef)(null),C=(0,Q.D)(e),[D,L]=(0,a.useState)(-1),O=(0,a.useRef)(D),x=(0,a.useRef)(!1),_=(0,a.useRef)(!1),B=(0,a.useMemo)((()=>{const e=(0,X.KT)();return U.RQ.includes(e)?(0,U.WF)():s}),[s]);(0,a.useEffect)((()=>{O.current=D}),[D]),(0,a.useEffect)((()=>{const e=(0,J.D)((()=>{R(window.innerHeight)}),200);return window.addEventListener("resize",e,!0),()=>{window.removeEventListener("resize",e,!0)}}),[]);const N=(0,a.useCallback)((()=>{return e=void 0,t=null,s=function*(){try{I(yield(0,H.l)(z.oO.AdsenseResponsive)),v("Adsense script loaded.")}catch(e){(0,se.H)({block:ae.W.GOOGLE_ADS,prefix:"AdvStickyBanner error [adsense]:",message:"script failed to load"}),p(),m()}},new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));var e,t,s}),[p,m]);(0,a.useEffect)((()=>{E&&!S&&N()}),[E,S,N]);const M=(0,a.useCallback)((()=>{T.current=new ee.U({app_id:t,tag:w.$.STICKY}),T.current.tryOpen({provider:w.e.Adsense,reason:-1===O.current?te.p_.ONSPOT:te.p_.REFRESH}),L((e=>e+1)),x.current=!0,_.current=!1}),[t]),$=(0,a.useCallback)((()=>{_.current=!0,m()}),[m]),F=(0,a.useCallback)((e=>{if(_.current)return;let t;switch(e){case f.JK.Landscape:t={onlyLandscape:!0};break;case f.JK.Portrait:t={onlyPortrait:!0}}p(t)}),[p]);if((0,K.b)(M,Boolean(S)),(0,a.useEffect)((()=>{x.current&&C&&!e&&M()}),[e,C,M]),(0,a.useEffect)((()=>{}),[S,e,y,M]),(0,c.Yz)(M,!S||e?null:b),!B)return;const q={advHidden:e,advLogger:T.current,blocks:B,provider:S,refreshCounter:D,stickyBannerLocation:y,onAdvShowed:$,onClose:F};return r().createElement(Z,ue(he({},q),{canShowDesktopAdv:n,desktopAdvWidth:d,hideAdvCloseButton:g,innerHeight:P,wrapperRef:A}))}),V.Z,{blocks:e=>{var t;return null==(t=e.allAdvBlocks.adsense)?void 0:t.sticky}}),me={container:"StickyAdvContainer-critical-module__container--AeFEa",containerHidden:"StickyAdvContainer-critical-module__containerHidden--VBb0S",headerEnabled:"StickyAdvContainer-critical-module__headerEnabled--Rcyam",locationRight:"StickyAdvContainer-critical-module__locationRight--VoIlR",locationBottom:"StickyAdvContainer-critical-module__locationBottom--oThSu",banner:"StickyAdvContainer-critical-module__banner--mOURl",placementVertical:"StickyAdvContainer-critical-module__placementVertical--w5Bsm"},ve=({advLogger:e,onResponsePost:t,onFailed:s,refreshCounter:r})=>{const n=(0,a.useMemo)((()=>({})),[e]),i=(0,a.useCallback)((t=>{let s=n[t];return s||(s=e.copy({blockType:t}),n[t]=s),s}),[e,n]),o=(0,a.useCallback)(((e,t,{payloadBlockType:s})=>{t?i(s).waterfall({advBlockId:(0,z.Qq)(e)?e.blockId:"",provider:e.provider,depth:0,reason:te.p_.WATERFALL}):(i(s).tryOpen({provider:e.provider,reason:r>0?te.p_.REFRESH:te.p_.ONSPOT}),i(s).demand({advBlockId:(0,z.Qq)(e)?e.blockId:"unknown"}))}),[i,r]),d=(0,a.useCallback)(((e,{payloadBlockType:t})=>{i(t).request()}),[i]),l=(0,a.useCallback)((({isEmpty:e},s)=>{const{payloadBlockType:a}=s;e?i(a).responseEmpty():i(a).response(),null==t||t({isEmpty:e},s)}),[i,t]),c=(0,a.useCallback)(((e,{payloadBlockType:t})=>{i(t).show()}),[i]);return{onError:(0,a.useCallback)((({error:e},{payloadBlockType:t})=>{e instanceof C.lu&&e.params.isEmpty||i(t).error(e.message)}),[i]),onRequest:d,onResponse:l,onShow:c,onSkip:(0,a.useCallback)((({reason:e},{payloadBlockType:t})=>{i(t).skip(e)}),[i]),onWaterfallNext:o,onWaterfallFailed:(0,a.useCallback)(((e,{payloadBlockType:t,payloadPlacement:a})=>{null==s||s(a,t),(0,U._y)(`StickyAdv | ${t} | WaterfallFailed`,e)}),[s])}};var ge=s(57745);const we=()=>(0,ge.HX)().stickyAdv;var fe=s(55231),ye=s(25562),be=s(94671),ke=s(31136),Ae=s(15771),Ee=Object.defineProperty,Se=Object.getOwnPropertySymbols,Ie=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable,Re=(e,t,s)=>t in e?Ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;const Te=[z.oO.GoogleBlock],Ce=(0,a.forwardRef)((({blockType:e,flags:t,location:s,maxHeight:n,withSpinner:i=!1,provider:o,waterfallItem:d,onError:l,onRequest:c,onResponse:h,onShow:u,onSkip:p,onFailed:m},v)=>{const w="sticky_banner_"+e+"_"+r().useId(),f=(0,a.useRef)(null),b=(0,a.useRef)(null),[k,A]=(0,a.useState)(!1),[E,S]=(0,a.useState)(i),I=(0,a.useMemo)((()=>(0,Ae.ff)(t)),[t]);return(0,a.useEffect)((()=>{let a=null;var r,n,i;return r=void 0,n=null,i=function*(){var r,n,i,v,g,k,E,P,R,T;if(d&&(0,z.Qq)(d)&&o&&f.current&&b.current)try{if((0,ge.hP)(d)&&e===y.kq.DESKTOP_BOTTOM&&!(0,ye.TG)({canReturnEmptyArray:!0,maxAdvHeight:null!=(n=null==(r=f.current.parentElement)?void 0:r.clientHeight)?n:window.innerHeight,maxAdvWidth:null!=(v=null==(i=f.current.parentElement)?void 0:i.clientWidth)?v:window.innerWidth,sizes:d.sizes}).length)return void(null==p||p({reason:te.Jm.WATERFALL_ITEM_CONSTRAINTS,slot:a}));if((0,ge.y)(d)&&e===y.kq.DESKTOP_ADDITIONAL&&(null!=(g=b.current.clientHeight)?g:0)<50)return void(null==p||p({reason:te.Jm.NOT_ENOUGH_CONTAINER_SIZE,slot:a}));(0,U._y)("Sticky | Actualy create slot",w,d,b,f.current.clientHeight,f.current.clientWidth),A(!1);const l=((e,t)=>{for(var s in t||(t={}))Ie.call(t,s)&&Re(e,s,t[s]);if(Se)for(var s of Se(t))Pe.call(t,s)&&Re(e,s,t[s]);return e})({blockId:d.blockId,divId:w,location:s,withPageNumber:!1},(0,ge.hP)(d)?{size:(0,ye.TG)({sizes:d.sizes,maxAdvWidth:null!=(E=null==(k=f.current.parentElement)?void 0:k.clientWidth)?E:window.innerWidth,maxAdvHeight:null!=(R=null==(P=f.current.parentElement)?void 0:P.clientHeight)?R:window.innerHeight}),usePrevious:!0}:{size:[]});a=yield o.createSlot(l);let m=0,D=!0;const L=Te.includes(o.providerName)?I:0;do{null==c||c({slot:a});const e=yield o.preloadSlot({slot:a,flags:t}),{isEmpty:s}=e;if(null==h||h({slot:a,isEmpty:s},{payloadProductType:"productType"in e?null!=(T=e.productType)?T:"none":"unknown"}),!1===s){D=!1;break}if(!L)break;yield(0,ke.D)(fe.TE),m+=1}while(D&&m<=L);if(D)throw new C.lu("Slot is empty",{isEmpty:!0});S((()=>!1)),A(!0),yield o.showSlot(a),null==u||u({slot:a})}catch(e){null==l||l({error:e,slot:a}),null==m||m({error:e})}},new Promise(((e,t)=>{var s=e=>{try{o(i.next(e))}catch(e){t(e)}},a=e=>{try{o(i.throw(e))}catch(e){t(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(s,a);o((i=i.apply(r,n)).next())})),()=>{(0,U._y)("Sticky | Renderer clear",w),a&&o&&o.destroySlot(a)}}),[e,w,t,I,l,c,h,u,p,m,s,o,d]),r().createElement("div",{className:(0,be.E)(me.banner),"data-testid":"sticky-banner-"+e,ref:b,style:{maxHeight:!k&&n?n+"px":void 0}},E&&r().createElement(g.y,{position:"center",size:28,spinning:!0,view:"default"}),r().createElement("div",{id:w,ref:f}))})),De=(0,j.Z)(Ce,V.Z,{flags:e=>e.abt.flags,location:e=>e.location});var Le=s(13547),Oe=Object.defineProperty,xe=Object.getOwnPropertySymbols,_e=Object.prototype.hasOwnProperty,Be=Object.prototype.propertyIsEnumerable,Ne=(e,t,s)=>t in e?Oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;const Me=(0,a.memo)((0,j.Z)((({advLogger:e,flags:t,isVisible:s,onFailed:n,refreshCounter:i})=>{const o=we(),d=(0,a.useMemo)((()=>(0,Ae.oh)(t)?f.Aw:f.zc),[t]),l=(0,a.useMemo)((()=>{var e,t;return i<0?[]:G.Z.type.includes(f.JK.Portrait)?[...null!=(t=null==(e=null==o?void 0:o.blocks.desktop_bottom)?void 0:e.waterfall)?t:[]]:[]}),[o,i]),c=ve({advLogger:e,onFailed:n,refreshCounter:i}),h=s&&((0,f.yh)(t)||(0,f.nT)(t));return r().createElement("div",{className:(0,be.E)(me.container,me.locationBottom,h?"":me.containerHidden),style:{height:d}},r().createElement(Le.Z,((e,t)=>{for(var s in t||(t={}))_e.call(t,s)&&Ne(e,s,t[s]);if(xe)for(var s of xe(t))Be.call(t,s)&&Ne(e,s,t[s]);return e})({alwaysRender:!0,payloadBlockType:y.kq.DESKTOP_BOTTOM,payloadPlacement:f.JK.Desktop,waterfallList:l},c),r().createElement(De,{blockType:y.kq.DESKTOP_BOTTOM,withSpinner:!0})))}),V.Z,{flags:e=>e.abt.flags}));var $e=s(29747);function Fe(e,t){return e.some((e=>e.provider===t))}var qe=s(40581),We=s(90380),Ze=Object.defineProperty,Ge=Object.getOwnPropertySymbols,Ue=Object.prototype.hasOwnProperty,He=Object.prototype.propertyIsEnumerable,je=(e,t,s)=>t in e?Ze(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,ze=(e,t)=>{for(var s in t||(t={}))Ue.call(t,s)&&je(e,s,t[s]);if(Ge)for(var s of Ge(t))He.call(t,s)&&je(e,s,t[s]);return e};const Ve=(0,a.memo)((0,j.Z)((({advLogger:e,flags:t,isVisible:s,refreshCounter:n,showDisableAdButton:i,onFailed:o})=>{var d;const l=we(),[c,h]=(0,a.useState)(!(0,C.Ij)()),[u,p]=(0,a.useState)("object"==typeof window?window.innerHeight:0),[m,v]=(0,a.useState)(!1),g=(0,a.useRef)(-1),w=(0,a.useMemo)((()=>{var e,t,s,a;return n<0||!l?{[y.kq.DESKTOP]:[],[y.kq.DESKTOP_ADDITIONAL]:[]}:{[y.kq.DESKTOP]:[...null!=(t=null==(e=l.blocks[y.kq.DESKTOP])?void 0:e.waterfall)?t:[]],[y.kq.DESKTOP_ADDITIONAL]:[...null!=(a=null==(s=l.blocks[y.kq.DESKTOP_ADDITIONAL])?void 0:s.waterfall)?a:[]]}}),[n,l]);(0,a.useEffect)((()=>(v(!1),()=>{clearTimeout(g.current)})),[w]);const b=(0,a.useCallback)(((e,{payloadProductType:t})=>{(0,U._y)(`Sticky | Received ${t} pcode banner.`),f.U_.includes(t)||(g.current=window.setTimeout((()=>v(!0)),f.fE))}),[]),k=(0,a.useMemo)((()=>{let e=300;if(!Fe(w.desktop,z.oO.GoogleBlock)){const{innerWidth:t}=(0,qe.bY)();e=Math.max(t*(f.PV/100),240),e=Math.min(e,300),Fe(w.desktop,z.oO.AdsenseResponsive)&&(e=Math.max(e,$e.K))}const s=(0,Ae.$9)(t,We.Z.advStickyBannerDesktopWidth);return s&&(e=s),e}),[t,w.desktop]);(0,a.useEffect)((()=>{const e=e=>{h("enabled"===e.data.action)},t=(0,J.D)((()=>{p(window.innerHeight)}),200);return D.Z.onInternalMessage("header",e),window.addEventListener("resize",t,!0),()=>{D.Z.offInternalMessage("header",e),window.removeEventListener("resize",t,!0)}}),[]);const A=ve({advLogger:e,refreshCounter:n,onResponsePost:b,onFailed:o}),E=!Fe(w[y.kq.DESKTOP_ADDITIONAL],z.oO.GoogleBlock)||u>=700;return r().createElement("div",{className:(0,be.E)(me.container,me.locationRight,s?"":me.containerHidden,c&&i?me.headerEnabled:""),style:{width:k}},i&&r().createElement(T,null),u>=500&&(null==l?void 0:l.blocks[y.kq.DESKTOP])&&r().createElement(Le.Z,ze({alwaysRender:!0,payloadBlockType:y.kq.DESKTOP,payloadPlacement:f.JK.Desktop,waterfallList:w[y.kq.DESKTOP]},A),r().createElement(De,{blockType:y.kq.DESKTOP,maxHeight:(null==(d=w[y.kq.DESKTOP][0])?void 0:d.provider)!==z.oO.YandexBlock?600:void 0,withSpinner:!0})),E&&m&&(null==l?void 0:l.blocks[y.kq.DESKTOP_ADDITIONAL])&&r().createElement(Le.Z,ze({alwaysRender:!0,payloadBlockType:y.kq.DESKTOP_ADDITIONAL,payloadPlacement:f.JK.Desktop,waterfallList:w[y.kq.DESKTOP_ADDITIONAL]},A),r().createElement(De,{blockType:y.kq.DESKTOP_ADDITIONAL})))}),V.Z,{flags:e=>e.abt.flags,showDisableAdButton:e=>!e.hidePaymentsAndCurrency}));var Ke=Object.defineProperty,Ye=Object.getOwnPropertySymbols,Xe=Object.prototype.hasOwnProperty,Je=Object.prototype.propertyIsEnumerable,Qe=(e,t,s)=>t in e?Ke(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;const et=(0,a.memo)((0,j.Z)((({advLogger:e,refreshCounter:t,flags:s,isVisible:n,onFailed:i})=>{const o=we(),d=(0,a.useMemo)((()=>{var e,s;return t<0?[]:G.Z.type.includes(f.JK.Landscape)?[...null!=(s=null==(e=null==o?void 0:o.blocks.landscape_side)?void 0:e.waterfall)?s:[]]:[]}),[o,t]),l=(0,a.useMemo)((()=>{const e=(0,Ae.$9)(s,We.Z.advStickyBannerLandscapeWidth);return e||f.HZ}),[s]),c=ve({advLogger:e,refreshCounter:t,onFailed:i});return r().createElement("div",{className:(0,be.E)(me.container,me.placementSide,me.locationRight,n?"":me.containerHidden),style:{width:l}},r().createElement(Le.Z,((e,t)=>{for(var s in t||(t={}))Xe.call(t,s)&&Qe(e,s,t[s]);if(Ye)for(var s of Ye(t))Je.call(t,s)&&Qe(e,s,t[s]);return e})({alwaysRender:!0,payloadBlockType:y.kq.LANDSCAPE_SIDE,payloadPlacement:f.JK.Landscape,waterfallList:d},c),r().createElement(De,{blockType:y.kq.LANDSCAPE_SIDE,withSpinner:!0})))}),V.Z,{flags:e=>e.abt.flags}));var tt=Object.defineProperty,st=Object.getOwnPropertySymbols,at=Object.prototype.hasOwnProperty,rt=Object.prototype.propertyIsEnumerable,nt=(e,t,s)=>t in e?tt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,it=(e,t)=>{for(var s in t||(t={}))at.call(t,s)&&nt(e,s,t[s]);if(st)for(var s of st(t))rt.call(t,s)&&nt(e,s,t[s]);return e};const ot={landscape:[],landscape_additional:[],landscape_tablet_additional:[]},dt=(0,a.memo)((0,j.Z)((({advLogger:e,refreshCounter:t,flags:s,isVisible:n,onFailed:i})=>{const o=we(),[d,l]=(0,a.useState)(!0),[c,h]=(0,a.useState)(!1),u=(0,a.useRef)(-1),p="undefined"!=typeof window&&Math.max(window.innerWidth,window.innerHeight)>=f.kO,m=(0,a.useMemo)((()=>{var e,s,a,r,n,i;return t<0||!o?ot:G.Z.type.includes(f.JK.Landscape)?{landscape:[...null!=(s=null==(e=o.blocks.landscape)?void 0:e.waterfall)?s:[]],landscape_additional:[...null!=(r=null==(a=o.blocks.landscape_additional)?void 0:a.waterfall)?r:[]],landscape_tablet_additional:[...null!=(i=null==(n=o.blocks.landscape_tablet_additional)?void 0:n.waterfall)?i:[]]}:ot}),[t,o]),v=(0,a.useMemo)((()=>(0,L.C)()),[]),w=(0,a.useMemo)((()=>{const e=(0,Ae.$9)(s,We.Z.advStickyBannerLandscapeHeight);return e||f.qi}),[s]),b=(0,a.useCallback)(((e,{payloadProductType:t})=>{if(l(!1),(0,U._y)(`Sticky | Received ${t} pcode banner.`),t){if(f.iv.includes(t))return;u.current=window.setTimeout((()=>h(!0)),f.fE)}}),[]);(0,a.useEffect)((()=>()=>{clearTimeout(u.current)}),[]);const k=ve({advLogger:e,refreshCounter:t,onResponsePost:b,onFailed:i});return r().createElement("div",{className:(0,be.E)(me.container,me.placementVertical,(null==o?void 0:o.placements.mobileLandscape.includes(y.Xn.UPPER))?me.locationUpper:me.locationBottom,n?"":me.containerHidden),style:{height:w,left:-v,minWidth:`calc(100% + ${v}px)`}},d&&r().createElement(g.y,{key:"landscape-spinner",position:"center",size:28,spinning:!0,view:"default"}),r().createElement(Le.Z,it({alwaysRender:!0,payloadBlockType:y.kq.LANDSCAPE,payloadPlacement:f.JK.Landscape,waterfallList:m[y.kq.LANDSCAPE]},k),r().createElement(De,{blockType:y.kq.LANDSCAPE,withSpinner:!0})),(null==o?void 0:o.blocks.landscape_additional)&&c&&r().createElement(r().Fragment,null,p&&r().createElement(Le.Z,it({alwaysRender:!0,payloadBlockType:y.kq.LANDSCAPE_TABLET_ADDITIONAL,payloadPlacement:f.JK.Landscape,waterfallList:m[y.kq.LANDSCAPE_TABLET_ADDITIONAL]},k),r().createElement(De,{blockType:y.kq.LANDSCAPE_TABLET_ADDITIONAL,withSpinner:!0})),r().createElement(Le.Z,it({alwaysRender:!0,payloadBlockType:y.kq.LANDSCAPE_ADDITIONAL,payloadPlacement:f.JK.Landscape,waterfallList:m[y.kq.LANDSCAPE_ADDITIONAL]},k),r().createElement(De,{blockType:y.kq.LANDSCAPE_ADDITIONAL,withSpinner:!0}))))}),V.Z,{flags:e=>e.abt.flags}));var lt=s(22355),ct=Object.defineProperty,ht=Object.getOwnPropertySymbols,ut=Object.prototype.hasOwnProperty,pt=Object.prototype.propertyIsEnumerable,mt=(e,t,s)=>t in e?ct(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;const vt=(0,a.memo)((0,j.Z)((({advLogger:e,refreshCounter:t,flags:s,isVisible:n,onFailed:i})=>{const o=we(),d=(0,Y.C)(lt.y),l=(0,a.useMemo)((()=>{var e;const t=(0,Ae.$9)(s,We.Z.advStickyBannerPortraitHeight);if(t)return t;const{innerWidth:a,innerHeight:r}=(0,qe.bY)(),n=null!=(e=(0,Ae.$9)(s,We.Z.advStickyBannerMinHeightForHigherAd))?e:f.Gh,i=d?Math.max(window.screen.height,window.screen.width):Math.max(r,a);let o=f.qi;return i>=n&&(o=f.RH),o}),[s,d]),c=l===f.RH?y.kq.PORTRAIT_HIGH:y.kq.PORTRAIT,h=(0,a.useMemo)((()=>{var e,s;return t<0?[]:G.Z.type.includes(f.JK.Portrait)?[...null!=(s=null==(e=null==o?void 0:o.blocks[c])?void 0:e.waterfall)?s:[]]:[]}),[c,o,t]),u=ve({advLogger:e,refreshCounter:t,onFailed:i});return r().createElement("div",{className:(0,be.E)(me.container,me.placementPortrait,(null==o?void 0:o.placements.mobilePortrait.includes(y.Xn.UPPER))?me.locationUpper:me.locationBottom,n?"":me.containerHidden),style:{height:l}},(null==o?void 0:o.blocks[c])&&r().createElement(Le.Z,((e,t)=>{for(var s in t||(t={}))ut.call(t,s)&&mt(e,s,t[s]);if(ht)for(var s of ht(t))pt.call(t,s)&&mt(e,s,t[s]);return e})({alwaysRender:!0,payloadBlockType:c,payloadPlacement:f.JK.Portrait,waterfallList:h},u),r().createElement(De,{blockType:c,withSpinner:!0})))}),V.Z,{flags:e=>e.abt.flags}));var gt=s(40656),wt=Object.defineProperty,ft=Object.defineProperties,yt=Object.getOwnPropertyDescriptors,bt=Object.getOwnPropertySymbols,kt=Object.prototype.hasOwnProperty,At=Object.prototype.propertyIsEnumerable,Et=(e,t,s)=>t in e?wt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,St=(e,t)=>{for(var s in t||(t={}))kt.call(t,s)&&Et(e,s,t[s]);if(bt)for(var s of bt(t))At.call(t,s)&&Et(e,s,t[s]);return e},It=(e,t)=>ft(e,yt(t));const Pt=(0,a.memo)((0,j.Z)((({advHidden:e,appId:t,canShowDesktopAdv:s,canShowLandscapeAdv:n,canShowPortraitAdv:i,flags:o,isGamesApp:d,isGamesLiteApp:l,withWorldWideAdv:h,onClose:u,onAdvShowed:p})=>{const m=we(),[v,g]=(0,a.useState)(-1),b=(0,Q.D)(e),k=(0,a.useRef)(v),A=(0,a.useRef)(!1),E=(0,a.useRef)(!1),S=(0,a.useMemo)((()=>(0,Ae.RM)(o,We.Z.advHideEmptySticky)),[o]),I=(0,a.useMemo)((()=>new ee.U({app_id:t,tag:w.$.STICKY,refresh_count:v})),[t,v]),P=(0,a.useMemo)((()=>{const e=(0,Ae.$9)(o,We.Z.advStickyBannerRefreshInterval);return e||gt.yR}),[o,d,l,h]);(0,a.useEffect)((()=>{k.current=v}),[v]);const R=(0,a.useCallback)((()=>{g((e=>e+1)),A.current=!0}),[]),T=(0,a.useCallback)((()=>{E.current=!0,p()}),[p]),C=(0,a.useCallback)(((e,t)=>{if(E.current||!1===S)return;if(t===y.kq.DESKTOP_ADDITIONAL)return;let s;switch(e){case f.JK.Landscape:s={onlyLandscape:!0};break;case f.JK.Portrait:s={onlyPortrait:!0}}I.close(),u(s)}),[I,u,S]);if((0,K.b)(R,!e),(0,a.useEffect)((()=>{A.current&&b&&!e&&R()}),[e,b,R]),(0,a.useEffect)((()=>{if(e)return;const t=()=>{G.Z.isPortrait&&!(null==m?void 0:m.placements.mobilePortrait)||G.Z.isLandscape&&!(null==m?void 0:m.placements.mobileLandscape)||R()};return G.Z.addChangeListener(t),()=>{G.Z.removeChangeListener(t)}}),[e,m,R]),(0,c.Yz)(R,e?null:P),!m)return null;const D={advHidden:e,advLogger:I,refreshCounter:v,onAdvShowed:T,onFailed:C};return r().createElement(r().Fragment,null,m.blocks.desktop&&r().createElement(Ve,It(St({},D),{isVisible:!e&&s})),m.blocks.desktop_bottom&&r().createElement(Me,It(St({},D),{isVisible:!e&&s})),m.blocks.portrait&&r().createElement(vt,It(St({},D),{isVisible:!e&&i})),m.blocks.landscape&&r().createElement(dt,It(St({},D),{isVisible:!e&&n})),m.blocks.landscape_side&&r().createElement(et,It(St({},D),{isVisible:!e&&n})))}),V.Z,{appId:e=>e.playPageData.gameInfo.appId,flags:e=>e.abt.flags,isGamesApp:e=>e.isGamesApp,isGamesLiteApp:e=>e.isGamesLiteApp,withWorldWideAdv:e=>e.withWorldWideAdv&&!e.isOnlyRsyaAd}));var Rt=s(14408),Tt=s(38096),Ct=s(26108),Dt=s(36529),Lt=s(14184),Ot=s(33755),xt=s(58098),_t=s(59886),Bt=s(78569),Nt=s(42873),Mt=s(89592);const $t=(0,p.M$)("AdvStickyBanner",p.XG.Adv),Ft=({flags:e,stickyBlocks:t})=>{let s=(0,Tt.getDomainConfig)().adv.bidsServiceName;const a=(0,Ae.Ed)(e)?"dsail":"default",r={desktop:t.desktop,landscape:t.landscape,portrait:t.portrait,portrait_high:t.portrait_high};let n=qt(s,a,r.desktop);return n=function(e,t){const s=(0,Ae.QR)(t,We.Z.prebidDisabledBids);(0,Mt.GI)(s)&&e.forEach((e=>{e.bids=e.bids.filter((({bidder:e})=>!s.includes(e)))}));return e}(n,e),$t("getPrebidStickyAdUnits result",n),n};const qt=(e,t,s)=>[{code:s.main.blockId,mediaTypes:{banner:{sizes:s.main.sizes}},bids:Nt.U[e][t].sticky.desktop.sidebar_main},{code:s.small.blockId,mediaTypes:{banner:{sizes:s.small.sizes}},bids:Nt.U[e][t].sticky.desktop.sidebar_small}];var Wt=s(74762),Zt=s(65068),Gt=Object.defineProperty,Ut=Object.getOwnPropertySymbols,Ht=Object.prototype.hasOwnProperty,jt=Object.prototype.propertyIsEnumerable,zt=(e,t,s)=>t in e?Gt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Vt=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const Kt=u().with("google-sticky-adv-banner"),Yt=(0,p.M$)("GoogleStickyAdvBanner",p.XG.Adv),Xt="AdvStickyBanner error [google]:",Jt="google-adv-sticky-banner-",Qt=500,es=700,ts=2*gt.WT,ss=!0;function as(e,t){I.Eu.params({borrowParams:{adv:{sticky:{[e]:t}}}})}class rs extends V.P{constructor(){super(...arguments),this.clickLogger=new Zt.i({tag:w.$.STICKY,app_id:this.props.appId}),this.isAdditionalTabletLandscapeBlockEnabled="undefined"!=typeof window&&!1,this.allStickyGoogleAdvBlocks=this.context.allAdvBlocks.google.sticky,this.usePrebid=(0,Ae.AZ)(this.context.abt.flags),this.useMultipleAuction=(0,Ae.Ml)(this.context.abt.flags),this.prebidAdUnits=Ft({stickyBlocks:this.allStickyGoogleAdvBlocks,flags:this.context.abt.flags}),this.waitForAuction=null,this.advType=this.usePrebid?w.e.Prebid:w.e.Google,this.retries=(0,Ae.ff)(this.context.abt.flags),this.hasBeenShownAtLeastOnce=!1,this.slots={desktop:{},landscape:{},portrait:{}},this.timeToLoadAdv=(0,f.Qt)(this.context.abt.flags),this.headerHeight=(0,L.C)(),this.landscapeStyles=((e,t)=>{for(var s in t||(t={}))Ht.call(t,s)&&zt(e,s,t[s]);if(Ut)for(var s of Ut(t))jt.call(t,s)&&zt(e,s,t[s]);return e})({},this.props.isLandscapeSide?{width:this.props.mobileAdvSideLandscapeWidth}:{height:`${this.props.mobileAdvLandscapeHeight}px`,left:-this.headerHeight,minWidth:`calc(100% + ${this.headerHeight}px)`}),this.state={isHeaderEnabled:!(0,C.Ij)(),showLandscapeSpinner:!0,showSpinner:!0,windowInnerHeight:"object"==typeof window?window.innerHeight:0},this.isFirstTryOpen=!0,this.onShow=e=>{const{slot:t}=e,{stickyPlacement:s,adReqId:a,adSeqId:r,clickDaemon:n}=t;if(!s)return;this.props.isAlternateLogs?null==n||n.show():this.clickLogger.show(a,r,t.getClickUrl(),undefined)},this.onSlotRenderEnded=e=>{const{slot:t}=e,{stickyPlacement:s,stickyBlockType:a,clickDaemon:r}=t;if(!s||!a)return;Yt.spoiler(t.getAdUnitPath())("onSlotRenderEnded",a,`isEmpty = ${e.isEmpty}`),this.props.isAlternateLogs||this.clickLogger.response({adReqId:t.adReqId,depth:0,clickUrl:t.getClickUrl()||"",reason:t.getResponseInformation()?te.Ud.SUCCESS:te.Ud.EMPTY});const n=this.slots[s][a];if(clearTimeout(n.loadTimer),this.resetRefreshTimer(),e.isEmpty)return null==r||r.responseEmpty(),void this.onNoContent(t);null==r||r.response(),n.retries&&(n.retries=0),this.hasBeenShownAtLeastOnce=!0},this.resetRefreshTimer=()=>{Yt("Reset refresh timer",Date.now()),this.refreshTimer||as("startRefreshTimer",!0),clearTimeout(this.refreshTimer),this.refreshTimer=setTimeout((()=>{Yt.spoiler("refresh timer executed"),as("refreshTimerEnded",!0),clearTimeout(this.refreshTimer),this.refreshTimer=void 0,this.displaySlotsBatched(!0)}),this.props.intervalBetweenRefreshAd)},this.onSlotLoaded=({slot:e})=>{const{stickyPlacement:t,stickyBlockType:s}=e;if(!t||!s)return;Yt.spoiler(e.getAdUnitPath())("onSlotLoaded",s);const a=this.slots[t][s];switch(a.loaded=!0,clearTimeout(a.loadTimer),t){case f.JK.Desktop:this.setState({showSpinner:!1});break;case f.JK.Landscape:this.setState({showLandscapeSpinner:!1});break;case f.JK.Portrait:this.setState({showSpinner:!1})}},this.onSlotRequested=({slot:e})=>{const{stickyPlacement:t,stickyBlockType:s,clickDaemon:a}=e;if(!t||!s)return;Yt.spoiler(e.getAdUnitPath())("onSlotRequested",s);const r=this.slots[t][s];clearTimeout(r.loadTimer),r.loadTimer=setTimeout((()=>{r.loaded||((0,se.H)({block:ae.W.GOOGLE_ADS,prefix:Xt,message:`${t} timeout error`}),this.props.isAlternateLogs?null==a||a.error(`${t} timeout error`):this.clickLogger.error(e.adReqId,e.adSeqId,`${t} timeout error`),this.resetRefreshTimer(),!1!==(0,Ae.RM)(this.context.abt.flags,We.Z.advHideEmptySticky)&&this.onClose(e))}),this.timeToLoadAdv)},this.onSlotResponseReceived=({slot:e})=>{const{stickyPlacement:t,stickyBlockType:s}=e;t&&s&&(Yt.spoiler(e.getAdUnitPath())("onSlotResponseReceived",s),clearTimeout(this.slots[t][s].loadTimer))},this.prebidStartAuction=(0,Wt.P)((()=>Vt(this,null,(function*(){null===this.waitForAuction&&(Yt("[prebid_sticky] startAuction"),this.waitForAuction=new Ct.Z,yield(0,xt.BA)((e=>{e.requestBids({adUnits:this.prebidAdUnits,bidsBackHandler:this.prebidAuctionHandler,timeout:_t.ZV})})),this.prebidAuctionTimeout=setTimeout((()=>{Yt("[prebid_sticky] No auction handled, call empty function."),this.prebidAuctionHandler()}),f.kr))}))),_t.kw),this.prebidAuctionHandler=(e,t)=>Vt(this,null,(function*(){clearTimeout(this.prebidAuctionTimeout),Yt("[prebid_sticky] prebidAuctionHandler",e),t&&(0,Lt.fF)(new Error("[prebid_sticky] Auction finished with bidders timed out."));const s=(0,f.Dr)(this.prebidAdUnits);(0,Bt.H)({advTag:w.$.STICKY,adUnitCodes:s,bids:e}),yield(0,xt.BA)((e=>{var t;e.setTargetingForGPTAsync(s),null==(t=this.waitForAuction)||t.resolve()}))})),this.onWindowResize=(0,J.D)((()=>{this.setState({windowInnerHeight:window.innerHeight})}),200),this.changeOrientationListener=()=>{if(this.props.advHidden)return;let e;if(G.Z.isPortrait)e=f.JK.Portrait;else{if(!G.Z.isLandscape)return;e=f.JK.Landscape}for(const{slot:t}of Object.values(this.slots[e])){if(!t)return;if(t.stickyBlockType===y.kq.LANDSCAPE_TABLET_ADDITIONAL&&!this.isAdditionalTabletLandscapeBlockEnabled)return;this.tryShowAdv(t)}}}get slotsArray(){return Object.values(this.slots).map(Object.values).reduce(((e,t)=>e.concat(t)))}componentDidMount(){var e,t;this.setAdvBlocks(),this.setState({windowInnerHeight:window.innerHeight}),Yt("blockIds = ",this.blockIds),window.addEventListener("resize",this.onWindowResize,!0);const{desktop:s}=this.props.stickyBannerLocation;s&&(this.desktopAdvMinHeight="number"==typeof(null==(t=null==(e=this.allStickyGoogleAdvBlocks.desktop.main.sizes)?void 0:e[0])?void 0:t[1])?this.allStickyGoogleAdvBlocks.desktop.main.sizes[0][1]:600),this.props.advGameCanBeLoaded&&this.loadScripts(),D.Z.onInternalMessage("header",(e=>{this.setState({isHeaderEnabled:"enabled"===e.data.action})}))}componentWillUnmount(){window.removeEventListener("resize",this.onWindowResize,!0),G.Z.removeChangeListener(this.changeOrientationListener),clearTimeout(this.refreshTimer);const{googletag:e}=window;e&&(this.removeSlotsEventListeners(),this.slotsArray.forEach((t=>{clearTimeout(t.loadTimer),t.slot&&e.destroySlots([t.slot])})))}setAdvBlocks(){this.blockIds=this.allStickyGoogleAdvBlocks,this.props.useHighPortraitBlockIds&&this.allStickyGoogleAdvBlocks.portrait_high&&(this.blockIds.portrait=this.allStickyGoogleAdvBlocks.portrait_high)}addSlotsEventListeners(){var e;const t=null==(e=googletag.pubads)?void 0:e.call(googletag);t&&"function"==typeof t.addEventListener&&(t.addEventListener("slotRequested",this.onSlotRequested),t.addEventListener("slotResponseReceived",this.onSlotResponseReceived),t.addEventListener("slotOnload",this.onSlotLoaded),t.addEventListener("slotRenderEnded",this.onSlotRenderEnded),t.addEventListener("impressionViewable",this.onShow))}removeSlotsEventListeners(){var e;const t=null==(e=googletag.pubads)?void 0:e.call(googletag);t&&"function"==typeof t.removeEventListener&&(t.removeEventListener("slotRequested",this.onSlotRequested),t.removeEventListener("slotResponseReceived",this.onSlotResponseReceived),t.removeEventListener("slotOnload",this.onSlotLoaded),t.removeEventListener("slotRenderEnded",this.onSlotRenderEnded),t.removeEventListener("impressionViewable",this.onShow))}componentDidUpdate(e,t){var s,a;const{advGameCanBeLoaded:r,stickyBannerLocation:{desktop:n,mobilePortrait:i,mobileLandscape:o}}=this.props;if(e.advGameCanBeLoaded||!r||this.isScriptsLoaded||this.loadScripts(),n&&!e.isPageBlured&&this.props.isPageBlured)Object.values(this.slots.desktop).forEach((e=>{e.slot&&this.hideAdvSlot(e.slot)}));else if(n&&e.isPageBlured&&!this.props.isPageBlured)Object.values(this.slots.desktop).forEach((e=>{e.slot&&this.tryShowAdv(e.slot)}));else if(this.isScriptsLoaded&&n&&t.windowInnerHeight!==this.state.windowInnerHeight&&((null==(s=this.slots.desktop.desktop)?void 0:s.slot)&&t.windowInnerHeight<Qt&&this.state.windowInnerHeight>=Qt&&this.tryShowAdv(this.slots.desktop.desktop.slot),(null==(a=this.slots.desktop.desktop_additional)?void 0:a.slot)&&t.windowInnerHeight<es&&this.state.windowInnerHeight>=es&&this.tryShowAdv(this.slots.desktop.desktop_additional.slot)),this.isScriptsLoaded&&e.advHidden&&!this.props.advHidden||!e.canShowPortraitAdv&&this.props.canShowPortraitAdv||!e.canShowLandscapeAdv&&this.props.canShowLandscapeAdv){if(n&&Object.values(this.slots.desktop).forEach((e=>{e.slot&&this.tryShowAdv(e.slot)})),i){const e=this.slots.portrait.portrait;(null==e?void 0:e.slot)&&!e.loaded&&this.tryShowAdv(e.slot)}o&&Object.values(this.slots.landscape).forEach((e=>{e.slot&&(e.slot.stickyBlockType!==y.kq.LANDSCAPE_TABLET_ADDITIONAL||this.isAdditionalTabletLandscapeBlockEnabled)&&this.tryShowAdv(e.slot)}))}}onClose(e){const{stickyPlacement:t,stickyBlockType:s}=null!=e?e:{};switch(t&&s&&(this.slots[t][s].loaded=!1),this.props.isAlternateLogs&&this.clickDaemon.close(),t){case"desktop":return void this.props.onClose();case"portrait":return void this.props.onClose({onlyPortrait:!0});case"landscape":return void this.props.onClose({onlyLandscape:!0});default:this.props.onClose()}}onNoContent(e){var t;const{stickyPlacement:s,stickyBlockType:a,adReqId:r,adSeqId:n}=e;if(!s||!a)return;this.props.isAlternateLogs||this.clickLogger.noContent(r,n);const i=this.slots[s][a],o=null!=(t=i.retries)?t:0;if(o<this.retries)return Yt.spoiler(e.getAdUnitPath())(`${o+1} of ${this.retries} retry to refresh slot ${a}`),i.retries=o+1,clearTimeout(i.loadTimer),void setTimeout((()=>{this.tryShowAdv(e)}),ts);i.retries&&(i.retries=0),!1===(0,Ae.RM)(this.context.abt.flags,We.Z.advHideEmptySticky)||this.hasBeenShownAtLeastOnce||(Yt.spoiler(e.getAdUnitPath())(`Hide slot ${a} due no content`),this.onClose(e))}initGPT(){return Vt(this,null,(function*(){Yt("initGPT"),yield(0,Ot.Vg)();try{const{googletag:e}=window;this.addSlotsEventListeners(),this.defineSlots(),e.enableServices(),G.Z.addChangeListener(this.changeOrientationListener)}catch(e){(0,se.H)({message:"Trouble with getting google key values"},e)}}))}defineSlots(){const{stickyBannerLocation:{desktop:e,mobileLandscape:t,mobilePortrait:s},mobileAdvPortraitHeight:a,mobileAdvLandscapeHeight:r}=this.props;if(e){if(this.defineGPTSlot(this.blockIds.desktop.main.blockId,this.blockIds.desktop.main.sizes,f.JK.Desktop,y.kq.DESKTOP),this.defineGPTSlot(this.blockIds.desktop.small.blockId,this.blockIds.desktop.small.sizes,f.JK.Desktop,y.kq.DESKTOP_ADDITIONAL),this.blockIds.desktop.bottomBig&&(0,Ae.rl)(this.context.abt.flags)){const{innerWidth:e,innerHeight:t}=(0,qe.bY)(),s=this.blockIds.desktop.bottomBig.find((s=>(0,ye.TG)({canReturnEmptyArray:!0,sizes:s.sizes,maxAdvHeight:t,maxAdvWidth:e}).length>0));s&&this.defineGPTSlot(s.blockId,s.sizes,f.JK.Desktop,y.kq.DESKTOP_BOTTOM_BIG)}if(this.blockIds.desktop.bottomSmall&&(0,Ae.oh)(this.context.abt.flags)){const{innerWidth:e,innerHeight:t}=(0,qe.bY)(),s=this.blockIds.desktop.bottomSmall.find((s=>(0,ye.TG)({canReturnEmptyArray:!0,sizes:s.sizes,maxAdvHeight:t,maxAdvWidth:e}).length>0));s&&this.defineGPTSlot(s.blockId,s.sizes,f.JK.Desktop,y.kq.DESKTOP_BOTTOM_SMALL)}}else if(s&&this.defineGPTSlot(this.blockIds.portrait,[[320,a]],f.JK.Portrait,y.kq.PORTRAIT),t)switch(t){case y.Xn.BOTTOM:case y.Xn.UPPER:this.defineGPTSlot(this.blockIds.landscape,[[320,r]],f.JK.Landscape,y.kq.LANDSCAPE),this.defineGPTSlot(this.blockIds.landscape,[[320,r]],f.JK.Landscape,y.kq.LANDSCAPE_ADDITIONAL),this.isAdditionalTabletLandscapeBlockEnabled&&this.defineGPTSlot(this.blockIds.landscape,[[320,r]],f.JK.Landscape,y.kq.LANDSCAPE_TABLET_ADDITIONAL);break;case y.Xn.RIGHT:case y.Xn.LEFT:this.defineGPTSlot(this.blockIds.landscape,["fluid"],f.JK.Landscape,y.kq.LANDSCAPE_SIDE)}}defineGPTSlot(e,t,s,a){var r;const{googletag:n}=window;Yt.spoiler(e,s,a)("defineAndDisplayGPTSlot",`isErrorOnDisplaySlots = ${!n.pubads||!n.defineSlot}`);const i=null==(r=n.defineSlot(e,t,Jt+a))?void 0:r.addService(n.pubads());i?(i.stickyPlacement=s,i.stickyBlockType=a,this.slots[s][a]={loaded:!1,retries:0,slot:i}):((0,se.H)({block:ae.W.GOOGLE_ADS,prefix:Xt,message:"googletag couldn't create gptSlot"}),this.onClose())}displaySlotsBatched(e){return Vt(this,null,(function*(){var t;const s=[];this.props.isAlternateLogs&&(this.clickDaemon=new ee.U({app_id:this.props.appId,tag:w.$.STICKY}),this.clickDaemon.tryOpen({provider:w.e.Google,reason:e?te.p_.REFRESH:te.p_.ONSPOT})),this.slotsArray.forEach((e=>{e.slot&&(this.tryShowAdv(e.slot,!0),e.isBatched&&(e.isBatched=!1,s.push(e.slot)))})),this.usePrebid&&(yield this.prebidStartAuction(),yield null==(t=this.waitForAuction)?void 0:t.promise),googletag.pubads().refresh(s),this.usePrebid&&this.useMultipleAuction&&(this.waitForAuction=null)}))}loadScripts(){var e;if(Yt("loadScripts isLoaded=",this.isScriptsLoaded),this.isScriptsLoaded)return;this.props.isAlternateLogs&&(this.clickDaemon=new ee.U({app_id:this.props.appId,tag:w.$.STICKY}));const t=(0,Dt.D)(Ot.CX).then((()=>{throw new Error(`Scripts load timeout (${Ot.CX}ms)`)})),s=(0,xt.cQ)({cdnUrl:this.context.cdnUrl,flags:this.context.abt.flags,fullUrl:window.location.href,options:{isSlowCountry:this.context.isSlowCountry}}),a=(0,Ot.xq)({metrikaCounter:null==(e=(0,Tt.getDomainConfig)().analytics.counters)?void 0:e.metrika,parallel:(0,Ae.RM)(this.context.abt.flags,We.Z.prebidLoadAfterGpt)||!1,prebidScriptUrl:this.usePrebid?s:void 0});Promise.race([t,a]).then((e=>Vt(this,null,(function*(){var t;if(Yt("onScriptsLoaded: true"),e.prebid||(this.usePrebid=!1,null==(t=this.waitForAuction)||t.resolve()),e.gptError)throw e.gptError;this.isScriptsLoaded=!0,yield this.initGPT(),this.usePrebid&&(yield this.initPrebid()),yield this.displaySlotsBatched(!1)})))).catch((e=>{this.onScriptsLoadError(e)}))}onScriptsLoadError(e){Yt("onScriptsLoadError",e),(0,se.H)({block:ae.W.GOOGLE_ADS,prefix:Xt,message:"script failed to load"}),this.onClose(),this.props.onAdvShowed()}initPrebid(){return Vt(this,null,(function*(){Yt("[prebid_sticky] initPrebid"),yield(0,xt.OH)(),yield(0,xt.BA)((e=>Vt(this,null,(function*(){return e.addAdUnits(this.prebidAdUnits)}))))}))}showAdv(e,t=!1){const{googletag:s}=window,{stickyPlacement:a,stickyBlockType:r,adReqId:n}=e;if(!a||!r)return;Yt("showAdv",r);const i=this.slots[a][r];if(!i.retries){if(this.props.isAlternateLogs){const{stickyPlacement:t,stickyBlockType:s}=e,a=t&&s&&this.slots[t][s].loaded;this.clickDaemon.demand({advBlockId:e.getAdUnitPath(),depth:0,provider:w.e.Google,reason:a?te.p_.REFRESH:te.p_.ONSPOT})}else e.adSeqId=this.clickLogger.tryOpen(e.getAdUnitPath(),this.advType),this.clickLogger.demand(void 0,0,e.adSeqId);this.isFirstTryOpen&&(as("isFirstTryOpen",!0),this.isFirstTryOpen=!1)}this.props.isAlternateLogs?(e.clickDaemon=this.clickDaemon.copy(),e.clickDaemon.request()):e.adReqId=this.clickLogger.request({advtype:this.advType,advBlockId:e.getAdUnitPath(),depth:0,reason:te.p_.ONSPOT,prevReqId:n}),t?i.isBatched=!0:s.pubads().refresh([e]),this.props.onAdvShowed()}tryShowAdv(e,t=!1){const{advHidden:s,canShowDesktopAdv:a,canShowPortraitAdv:r,canShowLandscapeAdv:n}=this.props,{stickyPlacement:i,stickyBlockType:o}=e;if(!i||!o)return;Yt("tryShowAdv",o);const{flags:d}=this.context.abt;switch(o){case y.kq.DESKTOP:a&&!s&&this.state.windowInnerHeight>=Qt&&!(0,f.Ab)(d)&&this.showAdv(e,t);break;case y.kq.DESKTOP_ADDITIONAL:a&&!s&&this.state.windowInnerHeight>=es&&!(0,f.Ab)(d)&&this.showAdv(e,t);break;case y.kq.DESKTOP_BOTTOM_BIG:a&&!s&&(0,f.yh)(d)&&this.showAdv(e,t);break;case y.kq.DESKTOP_BOTTOM_SMALL:a&&!s&&(0,f.nT)(d)&&this.showAdv(e,t);break;case y.kq.PORTRAIT:r&&!s&&G.Z.isPortrait&&this.showAdv(e,t);break;case y.kq.LANDSCAPE_SIDE:case y.kq.LANDSCAPE:case y.kq.LANDSCAPE_ADDITIONAL:n&&!s&&G.Z.isLandscape&&this.showAdv(e,t);break;case y.kq.LANDSCAPE_TABLET_ADDITIONAL:this.isAdditionalTabletLandscapeBlockEnabled&&n&&!s&&G.Z.isLandscape&&this.showAdv(e,t)}}hideAdvSlot(e){Yt("hideAdvSlot"),googletag.pubads().clear([e])}renderBanner(e,t,s,a,n){const{showSpinner:i}=this.state,o=Jt+t,d=e===f.JK.Desktop,l=e===f.JK.Landscape,c=d?f.P5.COLUMN:f.P5.ROW,h=(0,f.oi)(a,n),u=this.props.advHidden||t===y.kq.PORTRAIT&&!this.props.canShowPortraitAdv||l&&!this.props.canShowLandscapeAdv||d&&!this.props.canShowDesktopAdv||t===y.kq.DESKTOP_BOTTOM_BIG&&!(0,f.yh)(this.context.abt.flags)||t===y.kq.DESKTOP_BOTTOM_SMALL&&!(0,f.nT)(this.context.abt.flags);return r().createElement("div",{className:Kt({[e]:!0,[`${e}_${s}`]:!0,direction:c,border_round:!d,hidden:u,"with-disable-ad-button":!(0,f.Ab)(this.context.abt.flags)}),id:o,key:o,style:h},!l&&t!==y.kq.DESKTOP_ADDITIONAL&&r().createElement(g.y,{className:Kt("spinner",{hidden:!i}),key:`${o}-spinner`,position:"center",size:28,spinning:!0,view:"default"}))}render(){var e;const{advHidden:t,canShowDesktopAdv:s,hideAdvCloseButton:a,desktopAdvWidth:n,isLandscapeSide:i,mobileAdvLandscapeHeight:o,mobileAdvSideLandscapeWidth:l,mobileAdvPortraitHeight:c,stickyBannerLocation:{desktop:h,mobileLandscape:u,mobilePortrait:p}}=this.props,{isHeaderEnabled:m,showLandscapeSpinner:v,windowInnerHeight:w}=this.state;if(h){const i={marginTop:m&&!a?-this.headerHeight:0,paddingTop:a?0:this.headerHeight,width:n},o={width:n,marginTop:m?-this.headerHeight:0},l=(0,Ae.oh)(this.context.abt.flags),c=(0,Ae.rl)(this.context.abt.flags);return r().createElement(r().Fragment,null,(l||c)&&this.renderBanner(f.JK.Desktop,l?y.kq.DESKTOP_BOTTOM_SMALL:y.kq.DESKTOP_BOTTOM_BIG,h,{height:l?f.Aw:f.zc,maxHeight:l?f.Aw:f.zc},{position:"absolute",bottom:0}),r().createElement("div",{className:Kt("desktop-wrapper",{hidden:t||!s||(0,f.Ab)(this.context.abt.flags),"with-disable-ad-button":ss}),style:i},!this.props.hideAdvCloseButton&&(null==(e=this.props.wrapperRef)?void 0:e.current)&&(0,d.createPortal)(r().createElement("div",{className:Kt("desktop-disable-ad-button-wrapper"),style:o},r().createElement(T,null)),this.props.wrapperRef.current),w>=Qt&&this.renderBanner(f.JK.Desktop,y.kq.DESKTOP,h,{maxWidth:n,width:n,minHeight:this.desktopAdvMinHeight}),w>=es&&this.renderBanner(f.JK.Desktop,y.kq.DESKTOP_ADDITIONAL,h,{maxWidth:n,width:n})))}const b=(0,f.Z4)("landscape",this.isAdditionalTabletLandscapeBlockEnabled);return r().createElement(r().Fragment,null,p&&this.renderBanner(f.JK.Portrait,y.kq.PORTRAIT,p,{height:c,maxHeight:c}),u&&r().createElement("div",{className:Kt("landscape-wrapper",{[u]:!0,"with-disable-ad-button":ss}),style:this.landscapeStyles},r().createElement(g.y,{className:Kt("spinner",{hidden:!v}),key:"landscape-spinner",position:"center",size:28,spinning:!0,view:"default"}),i&&this.renderBanner(f.JK.Landscape,y.kq.LANDSCAPE_SIDE,u,{width:l}),!i&&this.renderBanner(f.JK.Landscape,y.kq.LANDSCAPE,u,{height:o,maxHeight:o,minWidth:b}),!i&&this.isAdditionalTabletLandscapeBlockEnabled&&this.renderBanner(f.JK.Landscape,y.kq.LANDSCAPE_TABLET_ADDITIONAL,u,{height:o,maxHeight:o,minWidth:b}),!i&&this.renderBanner(f.JK.Landscape,y.kq.LANDSCAPE_ADDITIONAL,u,{height:o,maxHeight:o,minWidth:b})))}}const ns=(0,l.$j)((function(e){return{advGameCanBeLoaded:e.advGameCanBeLoaded}}))(rs);var is=s(96665);const os=new Set;function ds(e){!function(e,t){(0,se.H)({block:ae.W.ADV_STICKY,message:`${e}: ${t.message}`},t)}("NativeStickyApi error",e)}function ls(e){var t,s;return"function"==typeof(null==(s=null==(t=window.yandex)?void 0:t.ads)?void 0:s[e])}function cs(e){return function(...t){var s,a,r;return ls(e)?null==(r=null==(a=null==(s=window.yandex)?void 0:s.ads)?void 0:a[e])?void 0:r.call(a,...t).catch((e=>{throw ds(e),e})):function(e){const t=new Error(`Action "${e}" is not available`);return ds(t),Promise.reject(t)}(e)}}const hs={isActionAvailable:ls,hideStickyBanner:cs("hideStickyBanner"),refreshStickyBanner:cs("refreshStickyBanner"),showStickyBanner:e=>{const{blockId:t,mediation:s,position:a,orientation:r,dimension:n,revenueData:i}=e;return cs("showStickyBanner")(t,s,a,r,n,i)},stickyBannerIsShowing:cs("stickyBannerIsShowing")};var us=s(34711),ps=s(7991),ms=Object.defineProperty,vs=Object.getOwnPropertySymbols,gs=Object.prototype.hasOwnProperty,ws=Object.prototype.propertyIsEnumerable,fs=(e,t,s)=>t in e?ms(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,ys=(e,t)=>{for(var s in t||(t={}))gs.call(t,s)&&fs(e,s,t[s]);if(vs)for(var s of vs(t))ws.call(t,s)&&fs(e,s,t[s]);return e},bs=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const ks=(0,p.M$)("NativeStickyAdvBanner",p.XG.Adv);class As extends V.P{constructor(e,t){var s;super(e),this.isAdvHidden=r().createRef(),this.adReqIds={portrait:"",landscape:""},this.adSeqIds={portrait:"",landscape:""},this.refreshTimeoutIds={landscape:0,portrait:0},this.isAdNeedToRefresh={portrait:!1,landscape:!1},this.advHeight={portrait:f.qi,landscape:f.qi},this.revenueData={app_id:this.props.appId},this.revenueDataAsString="",this.clickLogger=new Zt.i({tag:w.$.STICKY,app_id:this.props.appId}),this.changeOrientationListener=()=>bs(this,null,(function*(){const e=G.Z.isPortrait?"portrait":"landscape";if(ks(`changeOrientationListener isAdNeedToRefresh${e}=${this.isAdNeedToRefresh[e]}`),this.isAdNeedToRefresh[e])return void this.updateAdv(e);if(!this.nativeStickyApi.isActionAvailable("stickyBannerIsShowing"))return;const t=yield this.nativeStickyApi.stickyBannerIsShowing();ks(`changeOrientationListener isAdvShowing=${t} advHidden=${this.isAdvHidden.current}`),t||this.isAdvHidden.current||this.openNativeAdvBanner(e)})),this.blockIds=(0,f.AO)({advBlocks:t.playPageData.gameSettings.advBlocks,flags:t.abt.flags,residenceInfo:null==(s=t.playPageData.gameSettings.advInfo)?void 0:s.residence_info,withWorldWideAdv:t.withWorldWideAdv,locations:this.props.stickyBannerLocation,useHighPortraitBlockIds:this.props.useHighPortraitBlockIds}),this.nativeStickyApi=hs,this.library=(0,f.dF)(t.abt.flags);const a=(0,us.X)(),n=(0,ps.W5)(),i=ys(ys({},a?{clid:a}:{}),n?{gclid:n}:{});Object.assign(this.revenueData,i),this.revenueDataAsString=JSON.stringify(this.revenueData),this.advHeight={portrait:e.mobileAdvPortraitHeight,landscape:e.isLandscapeSide?e.mobileAdvSideLandscapeWidth:e.mobileAdvLandscapeHeight}}componentDidUpdate(e){e.advHidden&&!this.props.advHidden&&this.tryShowAdv(),!e.advHidden&&this.props.advHidden&&this.hideAdv(),this.isAdvHidden.current=this.props.advHidden}componentWillUnmount(){G.Z.removeChangeListener(this.changeOrientationListener),window.clearTimeout(this.refreshTimeoutIds.landscape),window.clearTimeout(this.refreshTimeoutIds.portrait),this.onClose(!1)}tryShowAdv(){return bs(this,null,(function*(){if(this.clickDaemon=new ee.U({tag:w.$.STICKY,app_id:this.props.appId}),!this.nativeStickyApi.isActionAvailable("stickyBannerIsShowing"))return ks("tryShowAdv","ads.stickyBannerIsShowing is not a function"),void this.onClose();const e=yield this.nativeStickyApi.stickyBannerIsShowing();if(this.props.onAdvShowed(),e)return void ks("tryShowAdv","adv is showing");const{mobilePortrait:t,mobileLandscape:s}=this.props.stickyBannerLocation;this.props.isAlternateLogs&&this.clickDaemon.tryOpen({provider:w.e.Native,reason:te.p_.ONSPOT}),t&&G.Z.isPortrait?(this.props.isAlternateLogs?this.clickDaemon.demand({advBlockId:this.blockIds.portrait}):(this.adSeqIds.portrait=this.clickLogger.tryOpen(this.blockIds.portrait,w.e.Native),this.clickLogger.demand(void 0,0,this.adSeqIds.portrait)),this.openNativeAdvBanner("portrait")):s&&G.Z.isLandscape&&(this.props.isAlternateLogs?this.clickDaemon.demand({advBlockId:this.blockIds.landscape}):(this.adSeqIds.landscape=this.clickLogger.tryOpen(this.blockIds.landscape,w.e.Native),this.clickLogger.demand(void 0,0,this.adSeqIds.landscape)),this.openNativeAdvBanner("landscape"))}))}componentDidMount(){return bs(this,null,(function*(){ks(`blockIds = ${JSON.stringify(this.blockIds)}\n\n            revenueData=${this.revenueDataAsString}\n        `),yield this.tryShowAdv(),G.Z.addChangeListener(this.changeOrientationListener)}))}hideAdv(){this.nativeStickyApi.isActionAvailable("hideStickyBanner")?(this.nativeStickyApi.hideStickyBanner(),this.props.onAdvShowed()):ks("hideAdv","ads.hideStickyBanner is undefined")}onClose(e=!0){this.props.isAlternateLogs&&e&&this.clickDaemon.close(),this.props.isAlternateLogs||(this.adReqIds.portrait&&this.clickLogger.close(this.adReqIds.portrait,this.adSeqIds.portrait),this.adReqIds.landscape&&this.clickLogger.close(this.adReqIds.landscape,this.adSeqIds.landscape)),this.hideAdv(),this.props.onClose()}openNativeAdvBanner(e){if(!this.nativeStickyApi.isActionAvailable("showStickyBanner"))return ks("openNativeAdvBanner","ads.showStickyBanner is undefined"),void this.onClose();const{stickyBannerLocation:{mobilePortrait:t,mobileLandscape:s}}=this.props,a="portrait"===e?t:s;if(!a)return void ks("openNativeAdvBanner","ad position is a null");const r=function(e,t){return"upper"===t?t="bottom":"left"===t&&(t="right"),`${e}-${t}`}(e,a);if(os.has(r))return ks("openNativeAdvBanner","The previous show ended with an error"),void this.onClose();this.props.isAlternateLogs?this.clickDaemon.request({advBlockId:this.blockIds[e],reason:te.p_.ONSPOT}):this.adReqIds[e]=this.logRequest(e),this.nativeStickyApi.showStickyBanner({blockId:this.blockIds[e],mediation:this.library,position:a,orientation:e,dimension:this.advHeight[e],revenueData:{revenueData:this.revenueDataAsString}}).then((()=>{os.delete(r),this.props.isAlternateLogs?(this.clickDaemon.response(),this.clickDaemon.show()):(this.logResponse(e,te.Ud.SUCCESS),this.clickLogger.show(this.adReqIds[e],this.adSeqIds[e],void 0)),this.isAdNeedToRefresh[e]=!1,this.runUpdateAdvTimeout(e)})).catch((t=>{var s;os.add(r),this.props.isAlternateLogs?this.clickDaemon.error(null!=(s=t.message)?s:String(t)):this.logResponse(e,te.Ud.ERROR),ks(t),this.onClose()}))}runUpdateAdvTimeout(e){const t=G.Z.isPortrait?"portrait":"landscape";this.refreshTimeoutIds[e]=window.setTimeout((()=>{e===t?this.updateAdv(e):this.isAdNeedToRefresh[e]=!0}),this.props.intervalBetweenRefreshAd)}updateAdv(e){this.nativeStickyApi.isActionAvailable("refreshStickyBanner")?(this.props.isAlternateLogs?(this.clickDaemon=new ee.U({tag:w.$.STICKY,app_id:this.props.appId}),this.clickDaemon.tryOpen({provider:w.e.Native,reason:te.p_.REFRESH}),this.clickDaemon.demand({advBlockId:this.blockIds[e]}),this.clickDaemon.request()):(this.adSeqIds[e]=this.clickLogger.tryOpen(this.blockIds[e],w.e.Native),this.clickLogger.demand(void 0,0,this.adSeqIds[e]),this.adReqIds[e]=this.logRequest(e)),this.nativeStickyApi.refreshStickyBanner().then((()=>{this.props.isAlternateLogs?(this.clickDaemon.response(),this.clickDaemon.show()):(this.logResponse(e,te.Ud.SUCCESS),this.clickLogger.show(this.adReqIds[e],this.adSeqIds[e],void 0)),window.clearTimeout(this.refreshTimeoutIds[e]),this.isAdNeedToRefresh[e]=!1,this.runUpdateAdvTimeout(e)})).catch((t=>{var s;this.props.isAlternateLogs?this.clickDaemon.error(null!=(s=t.message)?s:String(t)):this.logResponse(e,te.Ud.ERROR),ks(t),this.onClose()}))):ks("updateAdv","ads.refreshAdvert is undefined")}logResponse(e,t){this.clickLogger.response({adReqId:this.adReqIds[e],reason:t})}logRequest(e){const t={advtype:w.e.Native,advBlockId:this.blockIds[e],depth:0,reason:te.p_.ONSPOT};return this.clickLogger.request(t)}render(){return null}}var Es=s(78740),Ss=s(95968),Is=s(38508),Ps=s(17061),Rs=s(79049),Ts=s(41811),Cs=Object.defineProperty,Ds=Object.defineProperties,Ls=Object.getOwnPropertyDescriptors,Os=Object.getOwnPropertySymbols,xs=Object.prototype.hasOwnProperty,_s=Object.prototype.propertyIsEnumerable,Bs=(e,t,s)=>t in e?Cs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Ns=(e,t)=>{for(var s in t||(t={}))xs.call(t,s)&&Bs(e,s,t[s]);if(Os)for(var s of Os(t))_s.call(t,s)&&Bs(e,s,t[s]);return e};const Ms=!0,$s=u().with("yandex-sticky-adv-banner"),Fs=(0,p.M$)("YandexStickyAdvBanner",p.XG.Adv);class qs extends V.P{constructor(){super(...arguments),this.gameBlockIds=(0,f.V0)({advBlocks:this.context.playPageData.gameSettings.advBlocks,appId:this.props.appId,flags:this.context.abt.flags,locations:this.props.stickyBannerLocation,useHighPortraitBlockIds:this.props.useHighPortraitBlockIds}),this.blockIds={desktop:"",desktop_additional:"",desktop_bottom_small:"R-I-394969-47",desktop_bottom_big:"R-I-394969-48",portrait:"",portrait_high:"",landscape:"",landscape_additional:""},this.containerIds={portrait:"yandex-adv-sticky-banner-portrait",portrait_high:"yandex-adv-sticky-banner-portrait",landscape:"yandex-adv-sticky-banner-landscape",landscape_additional:"yandex-adv-sticky-banner-landscape_additional",desktop:"yandex-adv-sticky-banner-desktop",desktop_additional:"yandex-adv-sticky-banner-desktop_additional",desktop_bottom_small:"yandex-adv-sticky-banner-desktop_bottom_small",desktop_bottom_big:"yandex-adv-sticky-banner-desktop_bottom_big"},this.useWhiteBackgroundOnDesktop=Boolean((0,Ae.pJ)(this.context.abt.flags)&&this.props.stickyBannerLocation.desktop),this.additionalLandscapeBlockEnabled=(0,Ae.Vr)(this.context.abt.flags)&&this.props.stickyBannerLocation.mobileLandscape!==y.Xn.RIGHT,this.timeToLoadAdv=(0,f.Qt)(this.context.abt.flags),this.clickDaemonAdvLog=new Zt.i({tag:w.$.STICKY,app_id:this.props.appId}),this.clickDaemon=new ee.U({app_id:this.props.appId,tag:w.$.STICKY}),this.loadedFlags={isDesktopAdvLoaded:!1,isLandscapeAdvLoaded:!1,isPortraitAdvLoaded:!1,isRefreshAdv:!1,isRefreshLandscapeAdv:!1},this.hasBeenShownAtLeastOnce=!1,this.scriptLoadPromiseWrapper=new Ct.Z,this.headerHeight=(0,L.C)(),this.landscapeWrapperStyles=this.props.isLandscapeSide?{}:{left:-this.headerHeight,width:`calc(100% + ${this.headerHeight}px)`},this.landscapeBlockStyles=this.props.isLandscapeSide?{width:this.props.mobileAdvSideLandscapeWidth}:{height:this.props.mobileAdvLandscapeHeight,maxHeight:this.props.mobileAdvLandscapeHeight},this.state={isAdditionalLandscapeMediaAdType:!1,isHeaderEnabled:!(0,C.Ij)(),isLandscapeMediaAdType:!1,isPortraitMediaAdType:!1,showDesktopAdditional:!1,showLandscapeAdditional:!1,showSpinner:!0},this.initAdvStickyBlocks=()=>{const{stickyBannerLocation:{desktop:e,mobileLandscape:t,mobilePortrait:s}}=this.props;if(e)return this.desktopAdvOptions=this.getAdvOptions(y.kq.DESKTOP,this.blockIds[y.kq.DESKTOP]),this.desktopAdditionalAdvOptions=this.getAdvOptions(y.kq.DESKTOP_ADDITIONAL,this.blockIds[y.kq.DESKTOP_ADDITIONAL]),this.desktopBottomSmallAdvOptions=this.getAdvOptions(y.kq.DESKTOP_BOTTOM_SMALL,this.blockIds[y.kq.DESKTOP_BOTTOM_SMALL]),this.desktopBottomBigAdvOptions=this.getAdvOptions(y.kq.DESKTOP_BOTTOM_BIG,this.blockIds[y.kq.DESKTOP_BOTTOM_BIG]),void this.showDesktopAdv();s&&(this.portraitAdvOptions=this.getAdvOptions(y.kq.PORTRAIT,this.blockIds[y.kq.PORTRAIT]),this.showAdv(y.kq.PORTRAIT)),t&&(this.landscapeAdvOptions=this.getAdvOptions(y.kq.LANDSCAPE,this.blockIds[y.kq.LANDSCAPE]),this.additionalLandscapeBlockEnabled&&(this.landscapeAdditionalAdvOptions=this.getAdvOptions(y.kq.LANDSCAPE_ADDITIONAL,this.blockIds[y.kq.LANDSCAPE_ADDITIONAL])),this.showAdv(y.kq.LANDSCAPE)),G.Z.addChangeListener(this.changeOrientationListener)},this.changeOrientationListener=()=>{G.Z.isPortrait?this.showAdv(y.kq.PORTRAIT):G.Z.isLandscape&&this.showAdv(y.kq.LANDSCAPE)},this.updateRefreshTimer=e=>{switch(e){case y.kq.DESKTOP_BOTTOM_BIG:case y.kq.DESKTOP_BOTTOM_SMALL:Fs("update refresh timer"),window.clearTimeout(this.refreshDesktopBottomTimeoutId),this.refreshDesktopBottomTimeoutId=window.setTimeout(this.handleDesktopRefreshTimeout,this.props.intervalBetweenRefreshAd);break;case y.kq.DESKTOP:Fs("update refresh timer"),window.clearTimeout(this.refreshTimeoutId),this.refreshTimeoutId=window.setTimeout(this.handleDesktopRefreshTimeout,this.props.intervalBetweenRefreshAd);break;case y.kq.PORTRAIT:Fs("update refresh timer"),window.clearTimeout(this.refreshTimeoutId),this.refreshTimeoutId=window.setTimeout((()=>{this.setState({showSpinner:!0},(()=>{this.refreshPortrait()}))}),this.props.intervalBetweenRefreshAd);break;case y.kq.LANDSCAPE:Fs("update refresh timer"),window.clearTimeout(this.refreshLandscapeTimeoutId),this.refreshLandscapeTimeoutId=window.setTimeout((()=>{this.refreshLandscape()}),this.props.intervalBetweenRefreshAd)}},this.handleDesktopRefreshTimeout=()=>{this.loadedFlags.isRefreshAdv=!0,this.loadedFlags.isDesktopAdvLoaded=!1,this.setShowState(y.kq.DESKTOP_ADDITIONAL,!1),this.destroyAdv(this.blockIds[y.kq.DESKTOP]),this.destroyAdv(this.blockIds[y.kq.DESKTOP_ADDITIONAL]),this.destroyAdv(this.blockIds[y.kq.DESKTOP_BOTTOM_SMALL]),this.destroyAdv(this.blockIds[y.kq.DESKTOP_BOTTOM_BIG]),Fs("refresh timer executed"),this.showDesktopAdv()},this.refreshLandscape=()=>{this.setShowState(y.kq.LANDSCAPE_ADDITIONAL,!1),this.destroyAdv(this.blockIds[y.kq.LANDSCAPE_ADDITIONAL]),this.destroyAdv(this.blockIds[y.kq.LANDSCAPE]),this.loadedFlags.isRefreshLandscapeAdv=!0,this.loadedFlags.isLandscapeAdvLoaded=!1,this.showAdv(y.kq.LANDSCAPE)},this.refreshPortrait=()=>{this.destroyAdv(this.blockIds[y.kq.PORTRAIT]),this.loadedFlags.isRefreshAdv=!0,this.loadedFlags.isPortraitAdvLoaded=!1,this.showAdv(y.kq.PORTRAIT)}}componentWillUnmount(){window.clearTimeout(this.refreshTimeoutId),window.clearTimeout(this.refreshDesktopBottomTimeoutId),window.clearTimeout(this.refreshLandscapeTimeoutId),window.clearTimeout(this.rejectTimeoutId),window.clearTimeout(this.additionalBlockTimeoutId),window.clearInterval(this.checkReadyIntervalId),G.Z.removeChangeListener(this.changeOrientationListener)}handleAdvBlockIdError(e){this.clickDaemonAdvLog.error(this.adReqId,this.adSeqId,"There is no blockId"),(0,se.H)({block:ae.W.ADV_STICKY,message:`AdvStickyBanner error [yandex]: There is no blockId for ${e}`})}tryInitAdvBlockId(e,t){return!!t&&(this.blockIds[e]=t,!0)}logTryOpenAndDemand(e){this.adSeqId=this.clickDaemonAdvLog.tryOpen(this.blockIds[e],w.e.Yandex),this.clickDaemonAdvLog.demand(void 0,0,this.adSeqId)}componentDidMount(){const{desktop:e,mobileLandscape:t,mobilePortrait:s}=this.props.stickyBannerLocation;if(e){const e=this.tryInitAdvBlockId(y.kq.DESKTOP,this.gameBlockIds.desktop);this.tryInitAdvBlockId(y.kq.DESKTOP_ADDITIONAL,this.gameBlockIds.desktop_additional),this.tryInitAdvBlockId(y.kq.DESKTOP_BOTTOM_SMALL,this.gameBlockIds.desktop_bottom_small),this.tryInitAdvBlockId(y.kq.DESKTOP_BOTTOM_BIG,this.gameBlockIds.desktop_bottom_big),e||(this.onClose({error:"desktop block not initialized"}),this.handleAdvBlockIdError(y.kq.DESKTOP))}if(s){this.tryInitAdvBlockId(y.kq.PORTRAIT,this.gameBlockIds.portrait)||(this.onClose({onlyPortrait:!0,error:"portrait block not initialized"}),this.handleAdvBlockIdError(y.kq.PORTRAIT))}if(t){const e=this.tryInitAdvBlockId(y.kq.LANDSCAPE,this.gameBlockIds.landscape);this.tryInitAdvBlockId(y.kq.LANDSCAPE_ADDITIONAL,this.gameBlockIds.landscape_additional),e||(this.onClose({onlyLandscape:!0,error:"landscape block not initialized"}),this.handleAdvBlockIdError(y.kq.LANDSCAPE))}this.props.advGameCanBeLoaded&&this.loadAdvScript(),D.Z.onInternalMessage("header",(e=>{this.setState({isHeaderEnabled:"enabled"===e.data.action})}))}componentDidUpdate(e){const{advGameCanBeLoaded:t,stickyBannerLocation:{desktop:s,mobilePortrait:a,mobileLandscape:r}}=this.props;this.loadedScript?(e.advHidden&&!this.props.advHidden||!e.canShowPortraitAdv&&this.props.canShowPortraitAdv||!e.canShowLandscapeAdv&&this.props.canShowLandscapeAdv)&&(s&&this.showDesktopAdv(),a&&this.showAdv(y.kq.PORTRAIT),r&&this.showAdv(y.kq.LANDSCAPE)):!e.advGameCanBeLoaded&&t&&this.loadAdvScript()}isAdditionalBlock(e){return[y.kq.DESKTOP_ADDITIONAL,y.kq.LANDSCAPE_ADDITIONAL].includes(e)}onAdLoadFailed(e){Fs("onAdLoadFailed",e),this.props.isAlternateLogs||this.clickDaemonAdvLog.noContent(this.adReqId,this.adSeqId);if(this.isAdditionalBlock(e))this.setShowState(e,!1);else if(!1===(0,Ae.RM)(this.context.abt.flags,We.Z.advHideEmptySticky))this.updateRefreshTimer(e);else{const t=e===y.kq.PORTRAIT,s=e===y.kq.LANDSCAPE;this.onClose({onlyLandscape:s,onlyPortrait:t})}}destroyAdv(e){var t,s;Fs("Ya.Context.AdvManager.destroy",e),null==(s=null==(t=window.Ya)?void 0:t.Context)||s.AdvManager.destroy({blockId:e})}logAdvRequest(e,t){var s;if(this.props.isAlternateLogs){this.clickDaemon=new ee.U({app_id:this.props.appId,tag:w.$.STICKY});const a=this.hasBeenShownAtLeastOnce?te.p_.REFRESH:te.p_.ONSPOT;this.clickDaemon.tryOpen({provider:w.e.Yandex,reason:a});const r=this.clickDaemon.copy();return t.clickDaemon=r,null==(s=t.setRequestClickDaemon)||s.call(t,r),r.demand({advBlockId:this.blockIds[e],reason:a,provider:w.e.Yandex,depth:0}),void r.request()}this.logTryOpenAndDemand(e),this.adReqId=this.clickDaemonAdvLog.request({advBlockId:this.blockIds[e],advtype:w.e.Yandex,reason:te.p_.ONSPOT,depth:0})}onScriptError({onlyLandscape:e,onlyPortrait:t}){this.clickDaemonAdvLog.response({adReqId:this.adReqId,reason:te.Ud.NOT_IMPL}),this.clickDaemonAdvLog.error(this.adReqId,this.adSeqId,"window.Ya.Context.AdvManager.render is not defined"),Fs("window.Ya.Context.AdvManager.render is not defined"),this.onClose({onlyPortrait:t,onlyLandscape:e})}showDesktopAdv(){(0,f.nT)(this.context.abt.flags)?this.showAdv(y.kq.DESKTOP_BOTTOM_SMALL):(0,f.yh)(this.context.abt.flags)?this.showAdv(y.kq.DESKTOP_BOTTOM_BIG):this.showAdv(y.kq.DESKTOP)}showAdv(e){return t=this,s=null,a=function*(){var t,s,a;if(this.props.advHidden)return void this.props.onAdvShowed();yield this.scriptLoadPromiseWrapper.promise;const{isDesktopAdvLoaded:r,isPortraitAdvLoaded:n,isLandscapeAdvLoaded:i}=this.loadedFlags,{canShowDesktopAdv:o,canShowPortraitAdv:d,canShowLandscapeAdv:l}=this.props;if(!(null==(a=null==(s=null==(t=window.Ya)?void 0:t.Context)?void 0:s.AdvManager)?void 0:a.render))return this.onScriptError({onlyLandscape:e===y.kq.LANDSCAPE,onlyPortrait:e===y.kq.PORTRAIT}),void this.props.onAdvShowed();switch(e){case y.kq.DESKTOP:o&&this.desktopAdvOptions&&!r&&(this.logAdvRequest(e,this.desktopAdvOptions),Fs("Ya.Context.AdvManager.render desktop",this.desktopAdvOptions),window.Ya.Context.AdvManager.render(this.desktopAdvOptions,(()=>{var t,s;null==(s=null==(t=this.desktopAdvOptions)?void 0:t.clickDaemon)||s.responseEmpty(),this.onAdLoadFailed(e)})));break;case y.kq.DESKTOP_ADDITIONAL:this.desktopAdditionalAdvOptions&&(this.logAdvRequest(e,this.desktopAdditionalAdvOptions),Fs("Ya.Context.AdvManager.render desktop",this.desktopAdditionalAdvOptions),window.Ya.Context.AdvManager.render(this.desktopAdditionalAdvOptions,(()=>{var t,s;null==(s=null==(t=this.desktopAdvOptions)?void 0:t.clickDaemon)||s.responseEmpty(),this.onAdLoadFailed(e)})));break;case y.kq.DESKTOP_BOTTOM_SMALL:this.desktopBottomSmallAdvOptions&&(this.logAdvRequest(e,this.desktopBottomSmallAdvOptions),Fs("Ya.Context.AdvManager.render desktop",this.desktopAdditionalAdvOptions),window.Ya.Context.AdvManager.render(this.desktopBottomSmallAdvOptions,(()=>{var t,s;null==(s=null==(t=this.desktopAdvOptions)?void 0:t.clickDaemon)||s.responseEmpty(),this.onAdLoadFailed(e)})));break;case y.kq.DESKTOP_BOTTOM_BIG:this.desktopBottomBigAdvOptions&&(this.logAdvRequest(e,this.desktopBottomBigAdvOptions),Fs("Ya.Context.AdvManager.render desktop",this.desktopAdditionalAdvOptions),window.Ya.Context.AdvManager.render(this.desktopBottomBigAdvOptions,(()=>{var t,s;null==(s=null==(t=this.desktopAdvOptions)?void 0:t.clickDaemon)||s.responseEmpty(),this.onAdLoadFailed(e)})));break;case y.kq.PORTRAIT:d&&this.portraitAdvOptions&&!n&&G.Z.isPortrait&&(this.logAdvRequest(e,this.portraitAdvOptions),Fs("Ya.Context.AdvManager.render portrait",this.portraitAdvOptions),window.Ya.Context.AdvManager.render(this.portraitAdvOptions,(()=>{var t,s;null==(s=null==(t=this.portraitAdvOptions)?void 0:t.clickDaemon)||s.responseEmpty(),this.onAdLoadFailed(e)})));break;case y.kq.LANDSCAPE:l&&this.landscapeAdvOptions&&!i&&G.Z.isLandscape&&(this.logAdvRequest(e,this.landscapeAdvOptions),Fs("Ya.Context.AdvManager.render landscape",this.landscapeAdvOptions),window.Ya.Context.AdvManager.render(this.landscapeAdvOptions,(()=>{var t,s;null==(s=null==(t=this.landscapeAdvOptions)?void 0:t.clickDaemon)||s.responseEmpty(),this.onAdLoadFailed(e)})));break;case y.kq.LANDSCAPE_ADDITIONAL:this.landscapeAdditionalAdvOptions&&(this.logAdvRequest(e,this.landscapeAdditionalAdvOptions),Fs("Ya.Context.AdvManager.render landscape additional",this.landscapeAdditionalAdvOptions),window.Ya.Context.AdvManager.render(this.landscapeAdditionalAdvOptions,(()=>{var t,s;null==(s=null==(t=this.landscapeAdditionalAdvOptions)?void 0:t.clickDaemon)||s.responseEmpty(),this.onAdLoadFailed(e)})))}this.props.onAdvShowed()},new Promise(((e,r)=>{var n=e=>{try{o(a.next(e))}catch(e){r(e)}},i=e=>{try{o(a.throw(e))}catch(e){r(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,i);o((a=a.apply(t,s)).next())}));var t,s,a}loadAdvScript(){window.yaContextCb?this.onAdvScriptLoaded():(0,Rs.x)({id:"yandexads-context",src:this.context.yaAdsScript}).then((()=>{this.onAdvScriptLoaded()})).catch((()=>{this.onAdvScriptError()}))}onAdvScriptLoaded(){var e,t,s;this.loadedScript=!0,this.scriptLoadPromiseWrapper.resolve(void 0),(null==(s=null==(t=null==(e=window.Ya)?void 0:e.Context)?void 0:t.AdvManager)?void 0:s.render)?this.initAdvStickyBlocks():(this.rejectTimeoutId=window.setTimeout((()=>{(0,se.H)({message:"AdvStickyBanner error [yandex]: script failed to load"}),window.clearInterval(this.checkReadyIntervalId),this.onClose({error:"script failed to load"})}),this.timeToLoadAdv),this.checkReadyIntervalId=window.setInterval((()=>{var e,t,s;(null==(s=null==(t=null==(e=window.Ya)?void 0:e.Context)?void 0:t.AdvManager)?void 0:s.render)&&(window.clearInterval(this.checkReadyIntervalId),window.clearTimeout(this.rejectTimeoutId),this.initAdvStickyBlocks())}),200))}setShowState(e,t){switch(e){case y.kq.DESKTOP_ADDITIONAL:this.setState({showDesktopAdditional:t});break;case y.kq.LANDSCAPE_ADDITIONAL:this.setState({showLandscapeAdditional:t})}}getAdvOptions(e,t){const s=e===y.kq.LANDSCAPE,a=e===y.kq.PORTRAIT,r=this.isAdditionalBlock(e),n=r?2:1,i=this,o=(0,Ps.V)(Ts.Je,this.context.location);let d=this.clickDaemon;var l,c;return{async:!0,blockId:t,clickDaemon:this.clickDaemon,pageNumber:n,disableRefresh:!0,extParams:(l=Ns({},o?{google_aid:o}:{}),c={utm_source_service:"games","distr-id":this.props.appId},Ds(l,Ls(c))),renderTo:`${this.containerIds[e]}`,statId:(0,X.Sn)(),onError:function(o){Fs(`onError code=${o.code}, text=${o.text}, type=${o.type}`);const l=(0,Is.M)(o,{blockId:t,pageId:n}),c=`${te.Ud.ERROR}_${l}`;i.props.isAlternateLogs?d.error(l):(i.clickDaemonAdvLog.response({adReqId:i.adReqId,reason:c}),i.clickDaemonAdvLog.error(i.adReqId,i.adSeqId,c)),r?i.setShowState(e,!1):!1===(0,Ae.RM)(i.context.abt.flags,We.Z.advHideEmptySticky)?i.updateRefreshTimer(e):i.onClose({onlyPortrait:a,onlyLandscape:s,clickDaemon:d})},onRender:function(s){Fs(`onRender ${t}`,s),i.props.isAlternateLogs?d.response():i.clickDaemonAdvLog.response({adReqId:i.adReqId,reason:te.Ud.SUCCESS,depth:0}),i.handleAdvRender(e,s.productType,i.props.isAlternateLogs?d:void 0)},setRequestClickDaemon:e=>{d=e}}}handleAdvRender(e,t,s){this.hasBeenShownAtLeastOnce=!0;const a=()=>{s?s.show():this.clickDaemonAdvLog.show(this.adReqId,this.adSeqId,void 0,this.loadedFlags.isRefreshAdv?"refresh":void 0)};switch(e){case y.kq.DESKTOP_ADDITIONAL:a();break;case y.kq.DESKTOP_BOTTOM_BIG:case y.kq.DESKTOP_BOTTOM_SMALL:a(),this.setState({showSpinner:!1});break;case y.kq.DESKTOP:{this.loadedFlags.isDesktopAdvLoaded=!0,a();let e=!1;f.U_.includes(t)||this.state.showDesktopAdditional||(this.additionalBlockTimeoutId=window.setTimeout((()=>this.showAdv(y.kq.DESKTOP_ADDITIONAL)),f.fE),e=!0),this.setState({showDesktopAdditional:e,showSpinner:!1});break}case y.kq.PORTRAIT:this.setState({showSpinner:!1,isPortraitMediaAdType:"direct"!==t}),this.loadedFlags.isPortraitAdvLoaded=!0,a();break;case y.kq.LANDSCAPE:let e=!1;const r="direct"!==t;!this.additionalLandscapeBlockEnabled||this.state.showLandscapeAdditional||f.iv.includes(t)||(this.additionalBlockTimeoutId=window.setTimeout((()=>this.showAdv(y.kq.LANDSCAPE_ADDITIONAL)),f.fE),e=!0),this.setState({showSpinner:!1,showLandscapeAdditional:e,isLandscapeMediaAdType:r}),this.loadedFlags.isLandscapeAdvLoaded=!0,s?s.show():this.clickDaemonAdvLog.show(this.adReqId,this.adSeqId,void 0,this.loadedFlags.isRefreshLandscapeAdv?"refresh":void 0);break;case y.kq.LANDSCAPE_ADDITIONAL:"direct"!==t&&this.setState({isAdditionalLandscapeMediaAdType:!0}),s?s.show():this.clickDaemonAdvLog.show(this.adReqId,this.adSeqId,void 0,this.loadedFlags.isRefreshLandscapeAdv?"refresh":void 0)}this.updateRefreshTimer(e)}onAdvScriptError(){this.scriptLoadPromiseWrapper.reject(void 0),(0,se.H)({block:ae.W.ADV_STICKY,message:"AdvStickyBanner error [yandex]: script failed to load"}),this.onClose({error:"script failed to load"}),this.props.onAdvShowed()}onClose(e){if(!this.adReqId){const{desktop:t,mobilePortrait:s}=this.props.stickyBannerLocation;let a;t&&(a=this.gameBlockIds.desktop),a=s?this.gameBlockIds.portrait:this.gameBlockIds.landscape,this.props.isAlternateLogs||this.clickDaemonAdvLog.errorNoRequest({adSeqId:this.adSeqId,provider:w.e.Yandex,advBlockId:a,error:(null==e?void 0:e.error)||"close without request"})}const t=null==e?void 0:e.clickDaemon;t&&!t.hadEvent(te.zL.REQUEST)&&t.error("Sticky banner close without any requests."),this.props.onClose(e),this.adReqId?this.clickDaemonAdvLog.close(this.adReqId,this.adSeqId):this.props.isAlternateLogs&&(t?t.close():this.clickDaemon.close())}renderBanner(e,t,s,a){const{canShowPortraitAdv:n,canShowLandscapeAdv:i}=this.props,{isPortraitMediaAdType:o,isLandscapeMediaAdType:d,isAdditionalLandscapeMediaAdType:l,showDesktopAdditional:c,showLandscapeAdditional:h,showSpinner:u}=this.state,p=(0,f.oi)(s,a),m=e===y.kq.LANDSCAPE||e===y.kq.LANDSCAPE_ADDITIONAL,v=e===y.kq.PORTRAIT,w=o&&v||d&&e===y.kq.LANDSCAPE||l&&e===y.kq.LANDSCAPE_ADDITIONAL,b=!c&&e===y.kq.DESKTOP_ADDITIONAL||!h&&e===y.kq.LANDSCAPE_ADDITIONAL||this.props.advHidden||v&&!n||m&&!i||e===y.kq.DESKTOP_BOTTOM_BIG&&!(0,f.yh)(this.context.abt.flags)||e===y.kq.DESKTOP_BOTTOM_SMALL&&!(0,f.nT)(this.context.abt.flags);return r().createElement("div",{className:$s({media:Boolean(w),[e]:t,border_round:Boolean(w),hidden:b,"white-bg":this.useWhiteBackgroundOnDesktop}),id:this.containerIds[e],key:e,style:p},!m&&r().createElement(g.y,{className:$s("spinner",{hidden:!u}),key:`${e}-spinner`,position:"center",size:28,spinning:!0,view:"default"}))}render(){var e;const{advHidden:t,canShowDesktopAdv:s,hideAdvCloseButton:a,desktopAdvWidth:n,isLandscapeSide:i,mobileAdvPortraitHeight:o,stickyBannerLocation:{desktop:l,mobileLandscape:c,mobilePortrait:h}}=this.props,{isHeaderEnabled:u}=this.state;if(l){const i={width:n,marginTop:u&&!a?-this.headerHeight:0,paddingTop:a?0:this.headerHeight},o={width:n,marginTop:u?-this.headerHeight:0},c=(0,Ae.oh)(this.context.abt.flags),h=(0,Ae.rl)(this.context.abt.flags);return r().createElement(r().Fragment,null,(c||h)&&this.renderBanner(c?y.kq.DESKTOP_BOTTOM_SMALL:y.kq.DESKTOP_BOTTOM_BIG,l,{height:c?f.Aw:f.zc,maxHeight:c?f.Aw:f.zc},{position:"absolute",bottom:0}),r().createElement("div",{className:$s("desktop-wrapper",{hidden:t||!s||(0,f.Ab)(this.context.abt.flags),"with-disable-ad-button":Ms}),style:i},!a&&(null==(e=this.props.wrapperRef)?void 0:e.current)&&(0,d.createPortal)(r().createElement("div",{className:$s("desktop-disable-ad-button-wrapper"),style:o},r().createElement(T,null)),this.props.wrapperRef.current),this.renderBanner(y.kq.DESKTOP,l,{}),this.renderBanner(y.kq.DESKTOP_ADDITIONAL,l,{})))}return r().createElement(r().Fragment,null,h&&this.renderBanner(y.kq.PORTRAIT,h,{height:o,maxHeight:o}),c&&r().createElement("div",{className:$s("landscape-wrapper",{[c]:!0}),style:Ns({},this.landscapeWrapperStyles)},this.renderBanner(y.kq.LANDSCAPE,c,this.landscapeBlockStyles),!i&&this.renderBanner(y.kq.LANDSCAPE_ADDITIONAL,c,this.landscapeBlockStyles)))}}const Ws=(0,l.$j)((function(e){return{advGameCanBeLoaded:e.advGameCanBeLoaded}}))(qs);var Zs,Gs=s(46211),Us=s(21466),Hs=s(50042),js=s(61874),zs=s(40895),Vs=s(35090),Ks=s(39732),Ys=s(52763),Xs=s(43190),Js=s(8393),Qs=Object.defineProperty,ea=Object.defineProperties,ta=Object.getOwnPropertyDescriptors,sa=Object.getOwnPropertySymbols,aa=Object.prototype.hasOwnProperty,ra=Object.prototype.propertyIsEnumerable,na=(e,t,s)=>t in e?Qs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,ia=(e,t)=>{for(var s in t||(t={}))aa.call(t,s)&&na(e,s,t[s]);if(sa)for(var s of sa(t))ra.call(t,s)&&na(e,s,t[s]);return e},oa=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const da=!0,la=(0,p.M$)("AdvStickyBannerManager",p.XG.Adv),ca="adv-sticky-banner";class ha extends V.P{constructor(e,t){super(e,t),this.desktopAdvWidth=f.q5,this.desktopAdvHeight=f.zc,this.mobileAdvPortraitHeight=f.qi,this.mobileAdvLandscapeHeight=f.qi,this.mobileAdvSideLandscapeWidth=f.HZ,this.intervalBetweenRefreshAd=gt.yR,this.isAdvStickyBannerEnabled=!1,this.minScreenWidthForDesktopAdv=f.ie,this.isAdvStickyEnabledOnStartByExp=!1,this.isReplaceSimilarGamesOnStickyBannerByExp=!1,this.forcedToHideRelatedAdv=!0===(0,Ae.RM)(this.context.abt.flags,We.Z.advStickyBannerForcedHideAd),this.isAlternateLogs=null==(Zs=(0,Ae.RM)(this.context.abt.flags,We.Z.advAlternateLogs))||Zs,this.adClosed=!1,this.useHighPortraitBlockIds=!1,this.isLandscapeSide=!1,this.stickyBannerLocation={desktop:null,mobileLandscape:null,mobilePortrait:null},this.services=[],this.isGoogleExp=(0,Rt.O_)(this.context.abt.flags),this.isYandexExp=(0,Rt.MH)(this.context.abt.flags),this.onStickyBannerMessage=e=>oa(this,null,(function*(){const{action:t,data:s}=e.data;"blur"===(null==s?void 0:s.reason)&&this.setState({isPageBlured:"hide"===t})})),this.onExternalMessage=(e,t)=>oa(this,null,(function*(){const{action:s}=e.data;switch(s){case"adv-show-sticky-banner":{if(la(`onExternalMessage: action: "${s}"`),this.adClosed=!1,!this.isAdvStickyBannerEnabled)return void t({data:{stickyAdvIsShowing:!1,reason:zs.$.ADV_IS_NOT_CONNECTED}});if(!this.canShowAdv())return void t({data:{stickyAdvIsShowing:!1,reason:zs.$.UNKNOWN}});this.initAdv();const e=this.state.canShowAdvStickyBanner?{}:{reason:zs.$.UNKNOWN};t({data:ia({stickyAdvIsShowing:this.state.canShowAdvStickyBanner},e)});break}case"adv-hide-sticky-banner":la(`onExternalMessage: action: "${s}"`),this.adClosed=!0,this.hideAdv(),t({data:{stickyAdvIsShowing:!1}});break;case"adv-status-sticky-banner":{if(!this.isAdvStickyBannerEnabled)return void t({data:{stickyAdvIsShowing:!1,reason:zs.$.ADV_IS_NOT_CONNECTED}});const e=this.state.canShowAdvStickyBanner&&!this.state.advStickyBannerHidden;la(`onExternalMessage: action: "${s}", stickyAdvIsShowing: ${e}`),t({data:{stickyAdvIsShowing:e}});break}}})),this.handleVisibilityChange=()=>{"hidden"===(null==document?void 0:document.visibilityState)?this.setHideState(!0):this.initAdv()},this.handleFullscreenChange=()=>{this.props.isFullscreenActive?this.hideAdv():this.initAdv()},this.handleDesktopResize=()=>{const e=()=>{(0,qe.bY)().innerWidth<=this.minScreenWidthForDesktopAdv&&!(0,f.Ab)(this.context.abt.flags)||this.isGoogleBottomStickyEnabled()&&!this.canShowGoogleBottomSticky()?this.hideAdv():this.initAdv()};if(!(0,Ae.$p)(this.context.abt.flags))return void e();const t=(0,f.Ab)(this.context.abt.flags)?y.rq.BOTTOM:y.rq.RIGHT;this.stickyBannerLocation.desktop!==t?(this.stickyBannerLocation.desktop=t,this.hideAdv(e)):e()},this.handleMobileResize=()=>{la("handleMobileResize",window.innerWidth,window.innerHeight,f.rv),this.state.advStickyBannerHidden||!(0,f.JY)({forcedToHideRelatedAdv:this.forcedToHideRelatedAdv,minLandscapeHeight:this.minHeightToHideLandscapeAdv,minLandscapeWidth:this.isLandscapeSide?f.rv:void 0,minPortraitHeight:this.minHeightToHidePortraitAdv})?this.state.advStickyBannerHidden&&this.initAdv():this.hideAdv()},this.onSubscriptionsMessage=e=>oa(this,null,(function*(){const{action:t}=e.data;if("changed"===t){(yield(0,js.K)())&&this.state.canShowAdvStickyBanner&&this.handleCloseAdv()}})),this.hideAdv=(e=(()=>{}))=>{this.removeDefaultClasses(),la("hideAdv"),this.setState({advStickyBannerHidden:!0,isGameFrameCanBeResizedInDesktop:!1,isGameFrameCanBeResizedInLandscape:!1,isGameFrameCanBeResizedInPortrait:!1},e),Ys.Z.removeResizeBlock(ca),this.removeBodyStickyResize()},this.handleCloseAdv=e=>{this.removeDefaultClasses(),D.Z.post({type:"sticky-manager",action:"on-hide"}),(null==e?void 0:e.onlyPortrait)&&(this.setState({isGameFrameCanBeResizedInPortrait:!1}),G.Z.isPortrait&&(Ys.Z.removeResizeBlock(ca),this.removeBodyStickyResize())),(null==e?void 0:e.onlyLandscape)&&(this.setState({isGameFrameCanBeResizedInLandscape:!1}),G.Z.isLandscape&&(Ys.Z.removeResizeBlock(ca),this.removeBodyStickyResize())),this.state.isGameFrameCanBeResizedInLandscape&&(null==e?void 0:e.onlyPortrait)||this.state.isGameFrameCanBeResizedInPortrait&&(null==e?void 0:e.onlyLandscape)||((0,d.flushSync)((()=>this.setState({canShowAdvStickyBanner:!1,isGameFrameCanBeResizedInDesktop:!1,isGameFrameCanBeResizedInPortrait:!1,isGameFrameCanBeResizedInLandscape:!1}))),Ys.Z.removeResizeBlock(ca),this.removeBodyStickyResize(),this.adClosed=!0)};const{gameSettings:{features:s,settings:a},gameInfo:{appId:r},request:{flags:n}}=this.context.playPageData;this.headerSelector="minified"===e.headerType?".play-game-minified-header":".play-game-header",this.middleLayerInGameSelector=`.${is.P}`;const{adv:i,stickyAdvDisabledOnStart:o}=(0,f.Lf)(a);this.isAdvStickyEnabledOnStartByExp=(0,f.KV)({isDesktop:da,flags:n}),this.isReplaceSimilarGamesOnStickyBannerByExp=(0,f.t9)({isDesktop:da,flags:n}),this.isAdvStickyBannerEnabled=!this.isParentWindow&&(this.isAdvStickyEnabledOnStartByExp||this.isReplaceSimilarGamesOnStickyBannerByExp||(0,f.uk)({adv:i,appId:r,isDesktop:da,flags:n,orientation:null==s?void 0:s.orientation}));const l=(0,Ae.$9)(n,We.Z.advStickyMinDesktopWidth);if(l&&(this.minScreenWidthForDesktopAdv=l),!i)return void(this.isAdvStickyBannerEnabled=!1);const c=(0,f.jx)({adv:i,flags:n,appId:r,orientation:null==s?void 0:s.orientation});this.state={advStickyBannerHidden:!this.canShowAdv(),canShowAdvStickyBanner:!1,isGameFrameCanBeResizedInDesktop:Boolean(c.desktop),isGameFrameCanBeResizedInLandscape:Boolean(c.mobileLandscape),isGameFrameCanBeResizedInPortrait:Boolean(c.mobilePortrait),isPageBlured:this.context.isAdvSplashScreenEnabled};{const e=this.isAdvStickyEnabledOnStartByExp?y.rq.RIGHT:c.desktop,t=(0,f.Ab)(n)?y.rq.BOTTOM:e;this.stickyBannerLocation={desktop:t,mobilePortrait:null,mobileLandscape:null}}this.adClosed=o&&!this.isAdvStickyEnabledOnStartByExp&&!this.isReplaceSimilarGamesOnStickyBannerByExp}addBodyStickyReady(){document.body.classList.add(Js.S.ready)}addBodyStickyIsGoogle(){document.body.classList.add(Js.S.isGoogle)}addBodyStickyResize(){document.body.classList.add(Js.S.resize)}removeBodyStickyResize(){document.body.classList.remove(Js.S.resize)}isGoogleBottomStickyEnabled(){const{abt:e}=this.context;return this.isGoogle&&((0,f.nT)(e.flags)||(0,f.yh)(e.flags))}canShowGoogleBottomSticky(){var e,t;const{abt:s}=this.context;return(0,f.nT)(s.flags)&&this.isGoogleBottomStickySizesInWindowViewport(null==(e=this.context.allAdvBlocks.google.sticky)?void 0:e.desktop.bottomSmall)||(0,f.yh)(s.flags)&&this.isGoogleBottomStickySizesInWindowViewport(null==(t=this.context.allAdvBlocks.google.sticky)?void 0:t.desktop.bottomBig)}isGoogleBottomStickySizesInWindowViewport(e){if(!e)return!1;const{innerWidth:t,innerHeight:s}=(0,qe.bY)();return(0,ye.TG)({canReturnEmptyArray:!0,maxAdvHeight:s,maxAdvWidth:t,sizes:e.reduce(((e,t)=>[...t.sizes,...e]),[])}).length>0}canShowAdv(){var e,t;const{abt:s,playPageData:a}=this.context,{settings:r}=a.gameSettings,{adv:o}=(0,f.Lf)(r);if(!o)return!1;if((0,Vs._G)())return!0;if((0,Ae.Ww)(s.flags,i.By.STICKY))return!1;if(la(`services = ${this.services}`),0===this.services.length)return!1;const{advDisabledByPartnersKit:d}=this.props,l=this.isDisabledBySubscription();if(la([`\nisAdDisabledBySubsciption = ${l}`,`\nadvDisabledByPartnersKit = ${d}`,`settings.adv = ${JSON.stringify(null==r?void 0:r.adv,null,2)}`].join("\n")),l||d)return this.removeDefaultClasses(),!1;const c=n.parse(this.props.location.search.slice(1)),h=(0,Ks.E)((0,Ps.V)("utm_medium")),u=(0,Ps.V)("clid")||(null==(e=window.YandexGamesSDK)?void 0:e.clid),p=(0,Us.k4)(h,u);return la(`isAdDisabledByUtm = ${p},\n\n            params.clid = ${c.clid},\n\n            window.YandexGamesSDK.clid = ${null==(t=window.YandexGamesSDK)?void 0:t.clid},\n\n            clid = ${u},\n\n            utmMedium = ${h}\n        `),!p&&(this.props.isFullscreenActive?(la("Desktop on fullscreen mode"),(0,se.H)({block:ae.W.ADV_STICKY,message:"AdvStickyBanner error: Desktop window on fullscreen mode",level:"info"}),!1):(0,qe.bY)().innerWidth<=this.minScreenWidthForDesktopAdv&&!(0,f.Ab)(s.flags)?(la("Desktop width too narrow"),(0,se.H)({block:ae.W.ADV_STICKY,message:"AdvStickyBanner error: Desktop width too narrow",level:"info"}),!1):this.isGoogleBottomStickyEnabled()&&!this.canShowGoogleBottomSticky()?(la("Desktop width too narrow to replace similar games"),(0,se.H)({block:ae.W.ADV_STICKY,message:"AdvStickyBanner error: Desktop width too narrow to replace similar games",level:"info"}),!1):!this.adClosed)}componentDidMount(){var e,t;const{allAdvBlocks:s,playPageData:a,abt:{flags:r},isGamesApp:n,isGamesLiteApp:i,isIOSGamesLiteApp:o,withWorldWideAdv:d}=this.context,{gameSettings:{settings:l}}=a,{adv:c,stickyAdvDisabledOnStart:h}=(0,f.Lf)(l);if(!c||!this.isAdvStickyBannerEnabled)return void this.removeDefaultClasses();{const{innerWidth:e,innerHeight:t,zoom:s}=(0,qe.bY)();(0,f.Ne)("canShow",{height:t,minScreenWidthForDesktopAdv:this.minScreenWidthForDesktopAdv,width:e,zoom:s})}this.services=(0,f.g)({advBlocks:s,flags:r,isGamesApp:n,isGamesLiteApp:i,isIOSGamesLiteApp:o,withWorldWideAdv:d}),this.isAdsense=this.services.includes(w.e.Adsense),this.isGoogle=this.services.includes(w.e.Google),this.isNative=this.services.includes(w.e.Native),this.isParentWindow=this.services.includes(w.e.ParentWindow),this.isYandex=this.services.includes(w.e.Yandex);this.isNative&&!(0,Hs.zg)(f.XK)||this.initParamsByViewport(),this.initExperimentParams(),this.validateAdvSize();const{desktop:u,mobilePortrait:p,mobileLandscape:m}=this.stickyBannerLocation;if(document.body.classList.add("sticky-inited"),u){if(this.addBodyStickyReady(),!(null==(t=null==(e=c.sticky)?void 0:e.desktop)?void 0:t.right)&&!this.isAdvStickyEnabledOnStartByExp&&!this.isReplaceSimilarGamesOnStickyBannerByExp)return;return(!h||this.isAdvStickyEnabledOnStartByExp||this.isReplaceSimilarGamesOnStickyBannerByExp)&&this.initAdv(),this.initMessaging(),window.addEventListener("resize",this.handleDesktopResize),void(i||document.addEventListener("visibilitychange",this.handleVisibilityChange))}(p||m)&&(this.isLandscapeSide=m===y.Xn.LEFT||m===y.Xn.RIGHT,h||this.initAdv(),!this.isNative&&(this.minHeightToHidePortraitAdv||this.minHeightToHideLandscapeAdv||this.mobileAdvSideLandscapeWidth)&&window.addEventListener("resize",this.handleMobileResize),G.Z.addChangeListener((()=>{(this.minHeightToHidePortraitAdv||this.minHeightToHideLandscapeAdv||this.isNative)&&this.handleMobileResize(),this.isNative||this.state.advStickyBannerHidden||!this.state.canShowAdvStickyBanner||this.resizeMobileGameBlock()})),this.initMessaging(),i||document.addEventListener("visibilitychange",this.handleVisibilityChange)),this.addBodyStickyReady()}componentDidUpdate(e,t){e.isFullscreenActive!==this.props.isFullscreenActive&&this.handleFullscreenChange(),t.advStickyBannerHidden!==this.state.advStickyBannerHidden&&D.Z.post({type:"sticky-manager",action:this.state.advStickyBannerHidden?"on-hide":"on-show"}),e.advDisabledByPartnersKit&&!this.props.advDisabledByPartnersKit&&this.initAdv()}get isFullscreenEnabled(){return Boolean(this.props.isFullscreenEnabled||Xs.w.available||(null==document?void 0:document[Ss.Z.fullscreenEnabled]))}addDesktopResize(){const e=(0,f.Ab)(this.context.abt.flags),t=e?0:-this.desktopAdvWidth,s=e?-this.desktopAdvHeight:0,a={width:t,height:s};Ys.Z.addResizeBlock(ca,{game:a,[`.${Es.Ek}`]:{width:t-Es.UG,height:s},[this.headerSelector]:a,[this.middleLayerInGameSelector]:a}),this.addBodyStickyResize()}initContainerToDisplayAdv(){if(this.isNative)return;if(this.isParentWindow)return;const{desktop:e}=this.stickyBannerLocation;if(e)return this.addDesktopResize(),void this.removeDefaultClasses();this.resizeMobileGameBlock()}initMessaging(){D.Z.onAllMessages("adv-manager",this.onExternalMessage),D.Z.onInternalMessage("subscriptions",this.onSubscriptionsMessage,{withHistory:!0}),((0,Ae.bF)(this.context.abt.flags)||this.context.isAdvSplashScreenEnabled)&&D.Z.onInternalMessage("sticky-banner",this.onStickyBannerMessage)}initParamsByViewport(){const{flags:e}=this.context.abt,{innerWidth:t,innerHeight:s}=(0,qe.bY)();return(0,Ae.$p)(e)?(this.desktopAdvHeight=(0,Ae.oh)(e)?f.Aw:f.zc,void(this.isGoogle&&this.addBodyStickyIsGoogle())):void(this.isGoogle?(this.desktopAdvHeight=0,this.desktopAdvWidth=f.q5,this.addBodyStickyIsGoogle()):(this.desktopAdvHeight=0,this.desktopAdvWidth=t*f.PV/100,this.isAdsense&&(this.desktopAdvWidth=Math.max(this.desktopAdvWidth,$e.K))))}initExperimentParams(){const{flags:e}=this.context.abt,t=(0,Ae.$9)(e,We.Z.advStickyBannerDesktopWidth),s=(0,Ae.$9)(e,We.Z.advStickyBannerPortraitHeight),a=(0,Ae.$9)(e,We.Z.advStickyBannerLandscapeHeight),r=(0,Ae.$9)(e,We.Z.advStickyBannerLandscapeWidth),n=(0,Ae.$9)(e,We.Z.advStickyBannerRefreshInterval),i=(0,Ae.$9)(e,We.Z.advStickyBannerMinPortraitViewportHeight),o=(0,Ae.$9)(e,We.Z.advStickyBannerMinLandscapeViewportHeight);t&&!this.isReplaceSimilarGamesOnStickyBannerByExp&&(this.desktopAdvWidth=t),s&&(this.mobileAdvPortraitHeight=s),a&&(this.mobileAdvLandscapeHeight=a),n&&(this.intervalBetweenRefreshAd=n),i&&(this.minHeightToHidePortraitAdv=i),o&&(this.minHeightToHideLandscapeAdv=o),r&&(this.mobileAdvSideLandscapeWidth=r)}validateAdvSize(){if(this.isParentWindow)return this.desktopAdvWidth=0,this.desktopAdvHeight=0,this.mobileAdvPortraitHeight=0,void(this.mobileAdvLandscapeHeight=0);this.desktopAdvWidth=Math.floor(Math.min(Math.max(this.desktopAdvWidth,f.Ic),f.q5)),this.desktopAdvHeight=Math.floor(Math.min(Math.max(this.desktopAdvHeight,f.Aw),f.zc)),f.RH<this.mobileAdvPortraitHeight&&(this.mobileAdvPortraitHeight=f.qi),f.VT<this.mobileAdvLandscapeHeight&&(this.mobileAdvLandscapeHeight=f.qi)}resizeMobileGameBlock(){const{mobilePortrait:e,mobileLandscape:t}=this.stickyBannerLocation,{isGameFrameCanBeResizedInPortrait:s,isGameFrameCanBeResizedInLandscape:a}=this.state;if(!s&&G.Z.isPortrait||!a&&G.Z.isLandscape)return Ys.Z.removeResizeBlock(ca),this.removeBodyStickyResize(),void this.removeDefaultClasses();const r=this.isLandscapeSide?this.mobileAdvSideLandscapeWidth:this.mobileAdvLandscapeHeight,n=G.Z.isPortrait?this.mobileAdvPortraitHeight:r;if(this.isLandscapeSide&&G.Z.isLandscape){const e=t===y.Xn.LEFT?-n-f.gG:-n-2*f.gG;return Ys.Z.addResizeBlock(ca,{game:ia({width:e},t===y.Xn.LEFT?{left:n+f.gG}:{})}),this.removeDefaultClasses(),void this.addBodyStickyResize()}if(e===y.Xn.UPPER&&G.Z.isPortrait||t===y.Xn.UPPER&&G.Z.isLandscape){const e={top:n+f.gG,height:-n-f.gG};Ys.Z.addResizeBlock(ca,ia({game:e},G.Z.isLandscape&&{[this.headerSelector]:e})),this.removeDefaultClasses(),this.addBodyStickyResize()}if(e===y.Xn.BOTTOM&&G.Z.isPortrait||t===y.Xn.BOTTOM&&G.Z.isLandscape){const e={height:-n-2*f.gG};Ys.Z.addResizeBlock(ca,{game:e,[this.headerSelector]:e}),this.removeDefaultClasses(),this.addBodyStickyResize()}}isDisabledBySubscription(){return!!Boolean(this.props.userData.login)&&this.props.isAdDisabledBySubscription}initAdv(){const e=this.canShowAdv();if(la("initAdv"),e&&!this.adClosed){const{desktop:e,mobileLandscape:t,mobilePortrait:s}=this.stickyBannerLocation;this.setState({advStickyBannerHidden:!1,canShowAdvStickyBanner:!0,isGameFrameCanBeResizedInDesktop:Boolean(e),isGameFrameCanBeResizedInPortrait:Boolean(s),isGameFrameCanBeResizedInLandscape:Boolean(t)},(()=>{this.initContainerToDisplayAdv()}))}}setHideState(e){this.setState({advStickyBannerHidden:e})}removeDefaultClasses(){var e;"function"==typeof(null==(e=Ys.Z)?void 0:e.removeDefaultClass)&&Ys.Z.removeDefaultClass(["sticky-desktop","sticky-mobile"])}renderBanner(){if(!this.isAdvStickyBannerEnabled)return null;if(!this.state.canShowAdvStickyBanner)return null;if(this.isParentWindow)return null;if(this.props.advDisabledByPartnersKit)return null;const{appId:e}=this.context.playPageData.gameInfo,{advStickyBannerHidden:t,isGameFrameCanBeResizedInDesktop:s,isGameFrameCanBeResizedInLandscape:a,isGameFrameCanBeResizedInPortrait:n,isPageBlured:i}=this.state,o={advHidden:i||t,appId:e,intervalBetweenRefreshAd:this.intervalBetweenRefreshAd,isAlternateLogs:this.isAlternateLogs,isPageBlured:i,isLandscapeSide:this.isLandscapeSide,mobileAdvLandscapeHeight:this.mobileAdvLandscapeHeight,mobileAdvPortraitHeight:this.mobileAdvPortraitHeight,mobileAdvSideLandscapeWidth:this.mobileAdvSideLandscapeWidth,stickyBannerLocation:this.stickyBannerLocation,useHighPortraitBlockIds:this.useHighPortraitBlockIds,onAdvShowed:this.removeDefaultClasses,onClose:this.handleCloseAdv};if(this.isNative)return r().createElement(As,ia({},o));const d={canShowDesktopAdv:s,canShowLandscapeAdv:a,canShowPortraitAdv:n,desktopAdvWidth:this.desktopAdvWidth,desktopAdvHeight:this.desktopAdvHeight,hideAdvCloseButton:this.props.hideAdvCloseButton,wrapperRef:this.props.wrapperRef};return this.isAdsense?r().createElement(pe,ia(ia({},o),d)):this.isGoogle?this.isGoogleExp?r().createElement(Pt,ia(ia({},o),d)):r().createElement(ns,((e,t)=>ea(e,ta(t)))(ia(ia({},o),d),{isPageBlured:i})):this.isYandex?this.isYandexExp?r().createElement(Pt,ia(ia({},o),d)):r().createElement(Ws,ia(ia({},o),d)):null}render(){return r().createElement("div",{className:"sticky-banner-container"},this.renderBanner())}}const ua=(0,o.E)((0,l.$j)((function(e){return{advDisabledByPartnersKit:e.advDisabledByPartnersKit,isAdDisabledBySubscription:(0,Gs.Ak)(e),isFullscreenActive:e.ui.isFullscreenActive,isFullscreenEnabled:e.ui.isFullscreenEnabled,userData:e.userData}}))(ha));var pa=s(53603),ma=s(75217);const va=r().memo((({hideAdvCloseButton:e,headerType:t,wrapperRef:s})=>{const n=(0,a.useContext)(V.Z),{isReady:i}=(0,pa.s)(),{abt:{flags:o}}=n;return(0,Ae.V)(o)&&!i||(0,ma.O)()?null:r().createElement(ua,{headerType:t,hideAdvCloseButton:e,wrapperRef:s})}))},13547:(e,t,s)=>{"use strict";s.d(t,{Z:()=>v});var a=s(87363),r=s(29994),n=s(45462),i=s(93298),o=Object.defineProperty,d=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,h=(e,t,s)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,u=(e,t)=>{for(var s in t||(t={}))l.call(t,s)&&h(e,s,t[s]);if(d)for(var s of d(t))c.call(t,s)&&h(e,s,t[s]);return e};const p=(0,i.M$)("Waterfall",i.XG.Adv,{background:"#1d9f16"}),m=(0,a.forwardRef)(((e,t)=>{var s=e,{onProviderLoaded:i,onWaterfallFailed:o,onWaterfallNext:h,onError:m=(({error:e,waterfallItem:t})=>{p(`Renderer ${null==t?void 0:t.provider} error:`,e)}),onRequest:v,onResponse:g,onShow:w,onSkip:f,children:y,waterfallList:b,alwaysRender:k}=s,A=((e,t)=>{var s={};for(var a in e)l.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&d)for(var a of d(e))t.indexOf(a)<0&&c.call(e,a)&&(s[a]=e[a]);return s})(s,["onProviderLoaded","onWaterfallFailed","onWaterfallNext","onError","onRequest","onResponse","onShow","onSkip","children","waterfallList","alwaysRender"]);const E=(0,a.useRef)(null),[S,I]=(0,a.useState)(null),P=(0,a.useRef)({onRequestRef:()=>{},onResponseRef:()=>{},onShowRef:()=>{},onErrorRef:()=>{},onFailedRef:()=>{},onSkipRef:()=>{},onWaterfallFailed:()=>{},onWaterfallNext:()=>{}}),[R,T]=(0,a.useState)(A);(0,a.useEffect)((()=>{(0,r.wU)(R,A)||T(A)}),[A,R]),(0,a.useEffect)((()=>{P.current.onWaterfallNext=h,P.current.onWaterfallFailed=o}),[h,o]);const C=(0,a.useCallback)((()=>{var e,t;const s=null!=S?S:null,a=S?b.indexOf(S)+1:0,r=b[a];if(void 0===r)return p.spoiler(b)("No items left:",r),void P.current.onWaterfallFailed(new Error("No waterfall items left"),R);I(r),p.spoiler(b)("Next:",r),null==(t=(e=P.current).onWaterfallNext)||t.call(e,r,s,R)}),[S,b,R]);(0,a.useMemo)((()=>{P.current.onFailedRef=C,P.current.onSkipRef=C}),[C]),(0,a.useEffect)((()=>{0!==b.length&&I(null)}),[b]),(0,a.useEffect)((()=>{0===b.length||S||C()}),[C,b,S]);const D=(0,a.useCallback)((e=>{p(`Provider ${null==S?void 0:S.provider} failed:`,e),S&&(null==m||m({error:e,waterfallItem:S,provider:null,slot:null},R)),C()}),[m,C,S,R]);(0,a.useImperativeHandle)(t,(()=>({rendererRef:E.current})));const L=(0,n.Z)(null==S?void 0:S.provider,D);(0,a.useMemo)((()=>{if(!S||!L)return;const e=e=>e?(t,s)=>{e(u({waterfallItem:S,provider:L},t),u(u({},R),s))}:()=>{};P.current.onRequestRef=e(v),P.current.onResponseRef=e(g),P.current.onShowRef=e(w),P.current.onErrorRef=e(m),P.current.onSkipRef=e(f)}),[m,v,g,w,f,L,R,S]);const{onRendererResponse:O,onRendererRequest:x,onRendererShow:_,onRendererError:B,onRendererFailed:N,onRendererSkip:M}=(0,a.useMemo)((()=>({onRendererResponse:(...e)=>{var t,s;return null==(s=(t=P.current).onResponseRef)?void 0:s.call(t,...e)},onRendererRequest:(...e)=>{var t,s;return null==(s=(t=P.current).onRequestRef)?void 0:s.call(t,...e)},onRendererShow:(...e)=>{var t,s;return null==(s=(t=P.current).onShowRef)?void 0:s.call(t,...e)},onRendererError:(...e)=>{var t,s;return null==(s=(t=P.current).onErrorRef)?void 0:s.call(t,...e)},onRendererFailed:(...e)=>{var t,s;return null==(s=(t=P.current).onFailedRef)?void 0:s.call(t,...e)},onRendererSkip:(...e)=>{var t,s;return null==(s=(t=P.current).onSkipRef)?void 0:s.call(t,...e)}})),[]);return(0,a.useEffect)((()=>{S&&L&&(null==i||i(S,L))}),[L,S,i]),S&&L||k?(0,a.cloneElement)(a.Children.only(y),{provider:L,ref:E,waterfallItem:S,onError:B,onFailed:N,onRequest:x,onResponse:O,onShow:_,onSkip:M}):null}));m.displayName="Waterfall";const v=(0,a.memo)(m)},45462:(e,t,s)=>{"use strict";s.d(t,{Z:()=>te,l:()=>ee});var a=s(26108),r=s(87363),n=s(88561),i=s(69110),o=s(35742),d=Object.defineProperty,l=Object.defineProperties,c=Object.getOwnPropertyDescriptors,h=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,m=(e,t,s)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,v=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));class g extends i.Z{constructor(){super(),this.providerName=o.oO.AdsenseBlock,this.providerLoaderName=o.Po.Adsense}get isAdBreakReady(){return n.Z.isAdBreakReady}init(){return v(this,null,(function*(){try{yield n.Z.load(),this._loadPromise.resolve(this)}catch(e){this._loadPromise.reject(e)}}))}createSlot(e){return v(this,arguments,(function*({blockId:e}){return{type:"preroll",name:"adsense_block_"+e}}))}preloadSlot({slot:e}){return new Promise(((t,s)=>{var a;adBreak((a=((e,t)=>{for(var s in t||(t={}))u.call(t,s)&&m(e,s,t[s]);if(h)for(var s of h(t))p.call(t,s)&&m(e,s,t[s]);return e})({},e),l(a,c({adBreakDone({breakStatus:a}){switch(a){case"notReady":s(new Error("Adsense provider not ready to display adv."));break;case"frequencyCapped":s(new Error("Adsense ad wasn't shown because the frequency cap."));break;case"invalid":s(new Error("Adsense placement was invalid and ignored for subsequent shows."));break;case"viewed":t({isEmpty:!1,slot:e});break;default:t({isEmpty:!0,slot:e})}}}))))}))}showSlot(e){return Promise.resolve()}destroySlot(e){return Promise.resolve()}}const w=new g;var f=s(29747),y=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));class b extends i.Z{constructor(){super(),this.providerName=o.oO.AdsenseRewarded,this.providerLoaderName=o.Po.Adsense}init(){return y(this,null,(function*(){try{yield n.Z.load(),this._loadPromise.resolve(this)}catch(e){this._loadPromise.reject(e)}}))}createSlot(e){return y(this,arguments,(function*({blockId:e}){return{name:e,type:"reward"}}))}preloadSlot(e){return y(this,arguments,(function*({slot:e}){const{type:t,name:s}=e;e.preloadPromise=new a.Z,e.showPromise=new a.Z;const r=new a.Z;return adBreak({type:t,name:s,beforeReward:t=>{var s;e.show=t,null==(s=e.preloadPromise)||s.resolve({isEmpty:!1,slot:e})},beforeAd:()=>{var t;null==(t=e.showPromise)||t.resolve({slot:e,waitForView:r.promise})},adDismissed:()=>{r.resolve({isDismissed:!0})},adViewed:()=>{r.resolve({isDismissed:!1})},adBreakDone:t=>{var s,a,r,n;const{breakStatus:i}=t;switch(i){case"notReady":null==(s=e.preloadPromise)||s.reject(new Error("Adsense provider not ready to display adv."));break;case"frequencyCapped":null==(a=e.preloadPromise)||a.reject(new Error("Adsense ad wasn't shown because the frequency cap."));break;case"invalid":null==(r=e.preloadPromise)||r.reject(new Error("Adsense placement was invalid and ignored for subsequent shows."));break;default:null==(n=e.preloadPromise)||n.reject(new Error(`Adsense error with break status "${i}"`))}}}),e.preloadPromise.promise}))}showSlot(e){return y(this,null,(function*(){if(!e.showPromise||!e.show)throw new Error(`No preloadSlot called for slot ${e.name}.`);return e.show(),e.showPromise.promise}))}destroySlot(e){return y(this,null,(function*(){return Promise.resolve()}))}}const k=new b;var A=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));class E extends i.Z{constructor(){super(...arguments),this.providerName=o.oO.DummyBlock,this.providerLoaderName=o.Po.Promo}init(){return A(this,null,(function*(){this._loadPromise.resolve(this)}))}createSlot(e){return A(this,arguments,(function*({divId:e}){return{divId:e}}))}preloadSlot(e){return A(this,null,(function*(){return{isEmpty:!1,slot:{divId:e.slot.divId}}}))}showSlot(e){return A(this,arguments,(function*({divId:e}){const t=document.getElementById(e);t&&(t.innerHTML='<div class="adv-feed-grid-dummy"></div>')}))}destroySlot(e){return Promise.resolve()}}const S=new E;var I=s(26667),P=s(73441),R=s(33755);class T extends P.G{init(){(0,R.S$)().then((()=>(0,R.Vg)())).then((()=>(0,R.bT)((e=>{return t=this,s=null,a=function*(){e.enableServices()},new Promise(((e,r)=>{var n=e=>{try{o(a.next(e))}catch(e){r(e)}},i=e=>{try{o(a.throw(e))}catch(e){r(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,i);o((a=a.apply(t,s)).next())}));var t,s,a})))).then((()=>this.loadPromise.resolve(this))).catch((e=>this.loadPromise.reject(e)))}}const C=new T;var D=s(83950);class L extends i.Z{constructor(){super(),this.providerName=o.oO.GoogleAnchor,this.providerLoaderName=o.Po.Google,this.googleSlotEvents={slotRenderEnded:new WeakMap,impressionViewable:new WeakMap},this.toggleAnchor=(e,t,s)=>{const a=new CustomEvent("toggleAnchor",{detail:{slot:e,open:t,creativeHeight:s}});this.dispatchEvent(a)}}init(){return e=this,t=null,s=function*(){var e,t;try{yield C.load(),yield(0,R.bT)((e=>{const t=e.pubads(),s=e=>{t.addEventListener(e,(t=>{const s=this.googleSlotEvents[e].get(t.slot);null==s||s(t)}))};s("slotRenderEnded"),s("impressionViewable")})),this.toggleObserver=(0,D.V)("anchor-toggle-observer",{threshold:[.1,1]}),this.addEventListener("toggleAnchor",this.onToggleAnchor),null==(e=this.loadPromise)||e.resolve(this)}catch(e){null==(t=this.loadPromise)||t.reject(e)}},new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));var e,t,s}onToggleAnchor(e){const{slot:t,open:s,creativeHeight:a}=e.detail;I.Ah.spoiler(t)("Toggle Anchor",s,"height",a);let r=s?a+24:0;document.documentElement.style.setProperty("--anchor-bottom-height",`${r}px`)}createSlot({blockId:e}){return(0,R.bT)((()=>{const t=googletag.defineOutOfPageSlot(e,googletag.enums.OutOfPageFormat.BOTTOM_ANCHOR);if(!t)throw new Error("Failed to create googletag slot.");const s=googletag.pubads();return t.addService(s),t}))}preloadSlot({slot:e}){return new Promise((t=>{this.onGoogleEvent(e,"slotRenderEnded",(s=>{var a,r;if(s.isEmpty)return t({isEmpty:!0,slot:e});const n=document.getElementById(s.slot.getSlotElementId());if(!n)return;const i=null!=(r=null==(a=s.size)?void 0:a[1])?r:0,o="number"==typeof i?i:0;this.toggleObserver.unobserve(n);let d=0;s.slot.isAnchorOpened=!1,this.toggleObserver.observe(n,(e=>{!1===s.slot.isAnchorOpened&&d<=e.intersectionRatio?(this.toggleAnchor(s.slot,!0,o),s.slot.isAnchorOpened=!0):!0===s.slot.isAnchorOpened&&d>=e.intersectionRatio&&(this.toggleAnchor(s.slot,!1,o),s.slot.isAnchorOpened=!1),d=e.intersectionRatio})),t({isEmpty:!1,slot:e})}));googletag.pubads().refresh([e])}))}showSlot(e){return new Promise((t=>{this.onGoogleEvent(e,"impressionViewable",(e=>{t()}))}))}destroySlot(e){return Promise.resolve()}onGoogleEvent(e,t,s){this.googleSlotEvents[t].set(e,s)}}const O=new L;class x extends i.Z{constructor(){super(),this.providerName=o.oO.GoogleBlock,this.providerLoaderName=o.Po.Google,this.isSlotRefreshable=!0,this.googleSlotEvents={slotRenderEnded:new WeakMap,impressionViewable:new WeakMap}}init(){return e=this,t=null,s=function*(){try{yield C.load(),yield(0,R.bT)((e=>{const t=e.pubads(),s=e=>{t.addEventListener(e,(t=>{const s=this.googleSlotEvents[e].get(t.slot);null==s||s(t)}))};s("slotRenderEnded"),s("impressionViewable")})),this._loadPromise.resolve(this)}catch(e){this._loadPromise.reject(e)}},new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));var e,t,s}createSlot({blockId:e,divId:t,size:s,usePrevious:a=!1}){return(0,R.bT)((()=>{var r;const n=googletag.pubads();let i=null;if(a&&(i=null!=(r=n.getSlots().find((e=>e.getSlotElementId()===t)))?r:null,i))return i;if(i=googletag.defineSlot(e,s,t),!i)throw new Error("Failed to create googletag slot.");return i.addService(n),i}))}preloadSlot({slot:e}){return new Promise((t=>{this.onGoogleEvent(e,"slotRenderEnded",(s=>{t({isEmpty:s.isEmpty,slot:e})})),this.showPromise=new Promise((t=>{this.onGoogleEvent(e,"impressionViewable",(e=>{t()}))}));googletag.pubads().refresh([e])}))}showSlot(e){if(!this.showPromise)throw new Error("provider.showSlot() should be called after .preloadSlot()");return this.showPromise}destroySlot(e){return Promise.resolve()}onGoogleEvent(e,t,s){this.googleSlotEvents[t].set(e,s)}}const _=new x;var B=s(40174),N=s(58432),M=s(17061),$=s(79049),F=s(41811),q=Object.defineProperty,W=Object.defineProperties,Z=Object.getOwnPropertyDescriptors,G=Object.getOwnPropertySymbols,U=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable,j=(e,t,s)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,z=(e,t)=>{for(var s in t||(t={}))U.call(t,s)&&j(e,s,t[s]);if(G)for(var s of G(t))H.call(t,s)&&j(e,s,t[s]);return e},V=(e,t)=>W(e,Z(t)),K=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));let Y=0;class X extends i.Z{constructor(){super(),this.providerName=o.oO.YandexBlock,this.providerLoaderName=o.Po.Yandex}init(){return K(this,null,(function*(){try{yield(0,$.x)({id:"yandexads-context",src:window.appData.yaAdsScript}),this._loadPromise.resolve(this)}catch(e){this._loadPromise.reject(e)}}))}createSlot(e){return K(this,arguments,(function*({blockId:e,darkTheme:t,disableRefresh:s=!1,divId:a,location:r,withPageNumber:n=!0}){const i=(0,M.V)(F.Je,r);return{async:!0,blockId:e,darkTheme:t,disableRefresh:s,pageNumber:n?Y++:void 0,extParams:V(z({},i?{google_aid:i}:{}),{utm_source_service:"games"}),renderTo:a,statId:(0,N.Sn)()}}))}preloadSlot(e){return K(this,arguments,(function*({flags:e,slot:t}){return new Promise(((s,a)=>{(0,B.Q$)({abtFlags:e,adOptions:V(z({},t),{onRender:e=>{const{productType:a}=e;s({isEmpty:!1,slot:t,productType:a})},onError:e=>{a(new Error("Unexpected ad slot error: "+e.text))}}),methodName:B.xn.RENDER,onAdLoadFailed:()=>{s({isEmpty:!0,slot:t})}})}))}))}showSlot(e){return K(this,null,(function*(){}))}destroySlot(e){return Promise.resolve()}}const J=new X;const Q={[o.oO.AdsenseBlock]:w,[o.oO.AdsenseResponsive]:f.Z,[o.oO.AdsenseRewarded]:k,[o.oO.GoogleAnchor]:O,[o.oO.GoogleBlock]:_,[o.oO.YandexBlock]:J,[o.oO.DummyBlock]:S},ee=e=>{return t=void 0,s=null,a=function*(){return Q[e].load()},new Promise(((e,r)=>{var n=e=>{try{o(a.next(e))}catch(e){r(e)}},i=e=>{try{o(a.throw(e))}catch(e){r(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,i);o((a=a.apply(t,s)).next())}));var t,s,a},te=(e,t)=>{const[s,n]=(0,r.useState)(void 0),i=(0,r.useMemo)((()=>e?(null==s?void 0:s.providerName)===e?s:(e=>{var t;const s=Q[e];return(null==(t=null==s?void 0:s.loadPromise)?void 0:t.state)!==a.C.Fulfilled?null:s})(e):null),[e,s]);return(0,r.useEffect)((()=>{let s=!1;return!i&&e&&ee(e).then((e=>{s||n(e)})).catch((e=>{s||t(e)})),()=>{s=!0}}),[e,i,t]),i}},62011:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var a=s(87363),r=s.n(a),n=Object.defineProperty,i=Object.defineProperties,o=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,h=(e,t,s)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,u=(e,t)=>{for(var s in t||(t={}))l.call(t,s)&&h(e,s,t[s]);if(d)for(var s of d(t))c.call(t,s)&&h(e,s,t[s]);return e};const p=function(e,t,s){return(0,a.forwardRef)(((n,d)=>{var l;const c=(0,a.useContext)(t),h={};for(const e in s)h[e]=null==(l=s[e])?void 0:l.call(s,c);return(0,a.useMemo)((()=>{return r().createElement(e,(t=u(u({},n),h),i(t,o({ref:d}))));var t}),[n,...Object.values(h)])}))}},88561:(e,t,s)=>{"use strict";s.d(t,{Z:()=>v});var a=s(46210),r=s(26667),n=s(14408),i=s(73441),o=s(57745),d=s(95025),l=s(5e4),c=s(37705),h=s(79049),u=s(13377);const p="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js";class m extends i.G{constructor(){super(...arguments),this.isAdBreakReady=!1}init(){return e=this,t=null,s=function*(){var e,t,s,i;window.adsbygoogle=window.adsbygoogle||[],window.adBreak=window.adConfig=function(e){var t;null==(t=window.adsbygoogle)||t.push(e)};try{null==(e=window.clickdaemonLog)||e.call(window,"adv_debug",{scope:"AdsenseProviderLoader",event:"load",step:"1"});const i=(0,a.hF)(window.location.href);yield(0,h.x)({async:!0,src:i?(0,a.zR)(i):p,id:"adsense-script",crossOrigin:"anonymous",onScriptCreated:e=>{var t,s;const{dataset:a}=e,r=function(){var e,t,s,a,r,n;const i=null==(s=null==(t=null==(e=window.appData)?void 0:e.advDataStore)?void 0:t.feedAdv)?void 0:s.common.waterfall,c=null==i?void 0:i.find(o.UJ);if(c)return c.clientId;const h=(0,d.gK)({flags:window.appData.abt.flags,withWorldWideAdv:window.appData.withWorldWideAdv}),u=[...h.interstitial,...h.rewarded].find((e=>e.provider===l.e.AdsenseResponsive));return u&&"clientId"in u?u.clientId:null==(n=null==(r=null==(a=window.appData)?void 0:a.allAdvBlocks)?void 0:r.adsense)?void 0:n.interstitial.clientId}();r||(0,c.H)({block:u.W.GOOGLE_ADS,message:"No clientId passed in Adsense script."}),a.adClient=r,a.adFormat="auto",a.adFrequencyHint="30s";const i=(0,n.aO)(null==(s=null==(t=window.appData)?void 0:t.abt)?void 0:s.flags);i&&(a.adChannel=i)}}),null==(t=window.clickdaemonLog)||t.call(window,"adv_debug",{scope:"AdsenseProviderLoader",event:"load",step:"2"}),(0,r._y)("Adsense script loaded."),adConfig({preloadAdBreaks:"on",sound:"off",onReady:()=>{var e;null==(e=window.clickdaemonLog)||e.call(window,"adv_debug",{scope:"AdsenseProviderLoader",event:"load",step:"4"})}}),(0,r._y)("Adsense adBreak ready."),this.isAdBreakReady=!0,this.loadPromise.resolve(this),null==(s=window.clickdaemonLog)||s.call(window,"adv_debug",{scope:"AdsenseProviderLoader",event:"load",step:"3"})}catch(e){null==(i=window.clickdaemonLog)||i.call(window,"adv_debug",{scope:"AdsenseProviderLoader",event:"load",step:"error"}),this.loadPromise.reject(e),function(){const e={};fetch(p).then((t=>{e.headers={};for(let[s,a]of t.headers.entries())"expires"!==s&&(e.headers[s]=a.substring(0,1e3));return e.ok=t.ok,e.redirected=t.redirected,e.status=t.status,e.statusText=t.statusText.substring(0,1e3),e.url=t.url.substring(0,1e3),t})).then((e=>e.text())).then((t=>e.text=t.substring(0,1e3))).then((()=>{e.fetched=!0})).catch((()=>e.fetched=!1)).finally((()=>{(0,c.H)({additional:e,block:u.W.GOOGLE_ADS,message:"[adv] checkScriptAvailability [adsbygoogle.js]"})}))}()}},new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));var e,t,s}}const v=new m},73441:(e,t,s)=>{"use strict";s.d(t,{G:()=>n});var a=s(26108),r=s(3436);class n extends r.R{constructor(){super()}load(){return this.loadPromise||(this.loadPromise=new a.Z,this.init()),this.loadPromise.promise}}},29747:(e,t,s)=>{"use strict";s.d(t,{K:()=>l,Z:()=>h});var a=s(26667),r=s(14408),n=s(88561),i=s(69110),o=s(35742),d=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const l=250;class c extends i.Z{constructor(){super(),this.providerName=o.oO.AdsenseResponsive,this.providerLoaderName=o.Po.Adsense}get isAdBreakReady(){return n.Z.isAdBreakReady}init(){return d(this,null,(function*(){var e,t,s,a,i,o,d,l;null==(e=window.clickdaemonLog)||e.call(window,"adv_debug",{scope:"AdsenseResponsiveProvider",event:"init",step:"1"});try{(0,r.rA)(null!=(a=null==(s=null==(t=window.appData)?void 0:t.abt)?void 0:s.flags)?a:{})&&this.initObserverForThirdPartyAdsenseAds(),yield n.Z.load(),null==(i=window.clickdaemonLog)||i.call(window,"adv_debug",{scope:"AdsenseResponsiveProvider",event:"init",step:"2"}),this._loadPromise.resolve(this),null==(o=window.clickdaemonLog)||o.call(window,"adv_debug",{scope:"AdsenseResponsiveProvider",event:"init",step:"3"})}catch(e){null==(d=window.clickdaemonLog)||d.call(window,"adv_debug",{scope:"AdsenseResponsiveProvider",event:"init",step:"4"}),this._loadPromise.reject(e)}null==(l=window.clickdaemonLog)||l.call(window,"adv_debug",{scope:"AdsenseResponsiveProvider",event:"init",step:"5"})}))}createSlot(e){return d(this,arguments,(function*({adFormat:e,blockId:t,clientId:s,divId:r,height:n,maxHeight:i,width:o}){const d=document.querySelector(`#${CSS.escape(r)}`);if(!d)throw new Error(`Container #${r} not found`);const l=document.createElement("ins");l.classList.add("adsbygoogle"),l.style.display="block",l.style.margin="auto",n=null!=n?n:d.clientHeight,o=null!=o?o:d.clientWidth,l.style.height=`${n}px`,l.style.width=`${o}px`,i&&(l.style.maxHeight=`${i}px`),(0,a._y)(`Create Adsense slot, height: ${n}px, width: ${o}px, adFormat: ${e}`);const{dataset:c}=l;return c.adClient=s,c.adSlot=t,e&&(c.adFormat=e),c.fullWidthResponsive="true",d.appendChild(l),this.createPreloadPromise(l),l}))}initObserverForThirdPartyAdsenseAds(){new MutationObserver((e=>{for(const t of e)if("childList"===t.type){const{addedNodes:e}=t;e.forEach((e=>{e instanceof HTMLElement&&e.classList.contains("adsbygoogle-noablate")&&e.remove()}))}})).observe(document.documentElement,{childList:!0})}createPreloadPromise(e){this.preloadPromise=new Promise((t=>{const s=new MutationObserver((s=>{for(const a of s){const s=a.target;switch(a.attributeName){case"data-ad-status":{const a=s.dataset.adStatus;return t("filled"===a?{isEmpty:!1,slot:e}:{isEmpty:!0,slot:e})}case"style":s.style.width="",this.fixHeightStyle(s)}}}));s.observe(e,{attributes:!0,attributeFilter:["data-ad-status","style"],attributeOldValue:!0}),e.parentNode&&s.observe(e.parentNode,{attributes:!0,attributeFilter:["style"]})}))}preloadSlot({slot:e}){return adBreak({}),this.preloadPromise}showSlot(e){return Promise.resolve()}destroySlot(e){return d(this,null,(function*(){return e.remove(),Promise.resolve()}))}fixHeightStyle(e){window.setTimeout((()=>{var t;let s=3,r=e;const n=["minHeight","height","maxHeight"];try{for(;s-- >0&&(r=null!=(t=null==r?void 0:r.parentElement)?t:null);)for(const e of n)r.style.removeProperty(e)}catch(e){(0,a._y)("Failed to fix height styles: ",e.message)}}),0)}}const h=new c},69110:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var a=s(26108),r=s(3436);class n extends r.R{get loadPromise(){return this._loadPromise}constructor(){super()}load(){return this._loadPromise||(this._loadPromise=new a.Z,this.init()),this._loadPromise.promise}}const i=n},32922:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});const a=s(48225).Z},76994:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var a=s(63904),r=s.n(a),n=s(87363),i=s.n(n),o=s(76103),d=s(91605),l=s(82027),c=s(96952),h=s(89592);const u=r().with("close-button");class p extends n.PureComponent{constructor(){super(...arguments),this.handleClick=e=>{e.preventDefault(),e.stopPropagation(),this.props.disabled||(0,c.D)((()=>{var e;this.props.onClick(l.hz.cross),(0,d.NF)({},h.Ji.CLOSE_BUTTON_CLICK,{source:null!=(e=this.props.source)?e:""})}))}}render(){const{color:e,disabled:t,mix:s,type:a}=this.props;return i().createElement(o.Z,{className:`${u({color:e,disabled:t,type:a})} ${s}`,size:"m",onClick:this.handleClick})}}p.defaultProps={mix:"",onClick:()=>{}}},88372:(e,t,s)=>{"use strict";s.d(t,{Z:()=>R});var a=s(85383),r=s(29994),n=s(45331),i=s(55968),o=s(33119),d=s(16527),l=s(43548),c=s(98343),h=s(74762),u=s(74085),p=s(91605),m=s(77901),v=s(4915),g=s(31085),w=s(70602),f=s(40656),y=s(93298),b=s(15771),k=s(89592);const A=(0,y.M$)("DisplayInstallation",y.XG.Popup),{answerTimeoutToInstallationInMs:E}=c.addToHomeScreenSettings,S=f.IZ,I=["show-api-prompt","show-shortcut-popup","show-standalone-api-prompt"];class P extends n.P{constructor(e,t){super(e,t),this.isPlayToEarn=!1,this.handleVisibilityChange=()=>{return e=this,t=null,s=function*(){!1===document.hidden&&(this.removeVisibilityChangeListener(),this.showInstallationPromptPromise())},new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));var e,t,s},this.appinstalledHandler=()=>{const e={type:this.props.type};this.sourceShortcut&&(e.source=this.sourceShortcut),A("appinstalled with params:",e),(0,p.NF)({},k.Ji.SHORTCUT_API_APPINSTALLED,e),this.isPlayToEarn&&this.sendPlayToEarnEvent(),w.Fj.apiAppInstalled((0,w.oU)({context:this.context,popupType:"system",source:this.sourceShortcut?(0,w.N7)(this.sourceShortcut):g.pR.CATALOG}))},this.shortcutManagerEventHandler=e=>{const{type:t,action:s,data:a}=e.data;if("shortcut-manager"===t)I.includes(s)&&a.source?this.sourceShortcut=a.source:this.sourceShortcut=void 0},this.disableShortcutButton=()=>{this.props.dispatch((0,o.tm)(!0))},this.waitForUserGestureToInstall=()=>{this.props.dispatch((0,o.I6)(!0))},this.stopWaitingForUserGestureToInstall=()=>{this.props.dispatch((0,o.I6)(!1))},this.showInstallationPromptCommonApi=e=>{const{shortcutEventPrompt:t,shortcutInstallationCb:s}=this.props,a=(0,m.RY)();A(`showInstallationPromptCommonApi with source = ${e}, shortcutEventPrompt = ${t}`),t&&(w.Fj.show((0,w.oU)({context:this.context,popupType:"system",source:(0,w.aV)(e)})),t.prompt().then((()=>{this.props.dispatch((0,o.FJ)(void 0)),(0,p.NF)({},k.Ji.SHORTCUT_PROMPT_SHOW,{showPromptSource:e}),this.installationChecker.updateInstallationData(e),t.userChoice.then((t=>{w.Fj.click((0,w.oU)({context:this.context,popupType:"system",source:(0,w.aV)(e),result:"accepted"===t.outcome?"accepted":"rejected"})),"accepted"===t.outcome?((0,p.NF)({},k.Ji.SHORTCUT_USER_CHOICE_ACCEPTED),this.disableShortcutButton(),this.props.dispatch((0,o.w0)()),this.isPlayToEarn&&a&&this.sendPlayToEarnEvent()):(this.props.dispatch((0,o.yf)(!0)),(0,p.NF)({},k.Ji.SHORTCUT_USER_CHOICE_DISMISSED)),null==s||s(t),this.props.dispatch(o.Nw)}))})).catch((()=>{this.waitForUserGestureToInstall()})))},this.showInstallationPromptPromise=()=>{const e={waitingPeriod:f.s2,maxCallCount:3};e.waitingPeriod=S,A("options",e),this.installationChecker.checkInstallationCapability(e)&&(this.props.dispatch((0,o.M4)(!1)),this.showInstallationPrompt(g.Wp.VisibilityChange),window.setTimeout((()=>{this.stopWaitingForUserGestureToInstall()}),E))},this.showInstallationPrompt=e=>{this.showInstallationPromptCommonApi(e)},this.installationChecker=new v.Z}addVisibilityChangeListener(){"catalog"===this.props.type&&((0,b.wy)(this.context.abt.flags).visibilitychange||(A("addEventListener visibilitychange"),document.addEventListener("visibilitychange",this.handleVisibilityChange)))}removeVisibilityChangeListener(){A("removeEventListener visibilitychange"),document.removeEventListener("visibilitychange",this.handleVisibilityChange)}addAppinstalledListener(){A("add appinstalled"),window.addEventListener("appinstalled",this.appinstalledHandler)}removeAppinstalledListener(){A("remove appinstalled"),window.removeEventListener("appinstalled",this.appinstalledHandler)}initMessaging(){"game"===this.props.type&&l.Z.onAllMessages("shortcut-manager",this.shortcutManagerEventHandler,{withHistory:!0})}removeMessaging(){"game"===this.props.type&&l.Z.offAllMessages("shortcut-manager",this.shortcutManagerEventHandler)}sendPlayToEarnEvent(){const{dispatch:e}=this.props;e((0,d.$B)(i.cb.CREATE_LINK_IN_CATALOGUE))}componentDidUpdate(e){this.props.shortcutButtonFlag!==e.shortcutButtonFlag?this.showInstallationPrompt(g.Wp.Button):this.props.shortcutGameFlag!==e.shortcutGameFlag?this.showInstallationPrompt(g.Wp.Game):this.props.shortcutPopupFlag!==e.shortcutPopupFlag?this.showInstallationPrompt(g.Wp.Popup):this.props.shortcutInstallerFlag!==e.shortcutInstallerFlag?this.showInstallationPrompt(g.Wp.ShortcutInstaller):this.props.shortcutInlineBannerFlag!==e.shortcutInlineBannerFlag?this.showInstallationPrompt(g.Wp.InlineBanner):this.props.shortcutRecentGamesFlag!==e.shortcutRecentGamesFlag?this.showInstallationPrompt(g.Wp.RecentGames):this.props.shortcutRecentGamesButtonFlag!==e.shortcutRecentGamesButtonFlag?this.showInstallationPrompt(g.Wp.MyGamesInlineShortcutButton):this.props.shortcutMyGamesInlineFlag!==e.shortcutMyGamesInlineFlag?this.showInstallationPrompt(g.Wp.MyGamesInlineShortcutPopup):this.props.shortcutMyGamesDrawerFlag!==e.shortcutMyGamesDrawerFlag&&this.showInstallationPrompt(g.Wp.MyGamesDrawerShortcutPopup),this.props.shortcutUserGesturePrompt&&!e.shortcutUserGesturePrompt&&this.logUserGesturePrompt()}logUserGesturePrompt(){const{shortcutUserGesturePrompt:e}=this.props;w.Fj.show((0,w.oU)({context:this.context,popupType:"system",source:g.pR.USER_GESTURE})),null==e||e.userChoice.then((e=>{w.Fj.click((0,w.oU)({context:this.context,popupType:"system",source:g.pR.USER_GESTURE,result:"accepted"===e.outcome?"accepted":"rejected"}))})).finally((()=>{this.props.dispatch((0,o.r7)(void 0))}))}componentDidMount(){var e;const{abt:t}=this.context;this.isPlayToEarn=(0,b.XP)(t.flags),this.initMessaging(),this.addVisibilityChangeListener(),this.addAppinstalledListener(),(0,u.Z)()&&(w.Fj.installed(),null==(e=this.props.history)||e.listen((0,h.P)((()=>{w.Fj.installed()}),10*f.WT)))}componentWillUnmount(){this.removeVisibilityChangeListener(),this.removeAppinstalledListener(),this.removeMessaging()}render(){return null}}const R=(0,a.E)((0,r.$j)((function(e){return{shortcutInlineBannerFlag:e.shortcutInlineBannerFlag,shortcutButtonFlag:e.shortcutButtonFlag,shortcutInstallerFlag:e.shortcutInstallerFlag,shortcutEventPrompt:e.shortcutEventPrompt,shortcutGameFlag:e.shortcutGameFlag,shortcutPopupFlag:e.shortcutPopupFlag,shortcutRecentGamesFlag:e.shortcutRecentGamesFlag,shortcutMyGamesInlineFlag:e.shortcutMyGamesInlineFlag,shortcutMyGamesDrawerFlag:e.shortcutMyGamesDrawerFlag,shortcutRecentGamesButtonFlag:e.shortcutRecentGamesButtonFlag,shortcutInstallationCb:e.shortcutInstallationCb,shortcutUserGesturePrompt:e.shortcutUserGesturePrompt}}))(P))},41233:(e,t,s)=>{"use strict";s.d(t,{Z:()=>w});var a=s(38096),r=s(63904),n=s.n(r),i=s(87363),o=s.n(i),d=s(4463),l=s(40184),c=s(85467),h=s(5825),u=s(36172),p=s(15771),m=s(2820),v=s(69838);const g=n().with("domain-logo"),w=({lazy:e,imageSize:t="m",textSize:s="m",showImage:r=!0,showText:n=!0,textColor:i,type:w})=>{const f=(0,c.T)(),y=(0,h.C)(u.Up),{cdnUrl:b,abt:k,rtl:A}=(0,l.b)(),{hostname:E,componentsSettings:{domainLogo:S}}=(0,a.getDomainConfig)(),I=Boolean(null==S?void 0:S.useSingleLogo),P=(null==S?void 0:S.textSizeLogo)||s,R=(0,d.TH)(),T=(0,p.aL)(k.flags)&&!(0,m.Fg)(R.pathname),C=`${b}/games-static/static-data/images/logo/`,D=f("common.service.name"),L=`${E}-text-${i||y?"light":"dark"}.svg`,O=`${C}${E}${T?"-new-year.png":".svg"}`,x=`${C}${L}`,_=!r&&I?"single":(null==S?void 0:S.sizeLogo)||t;let B=r||I,N=n&&!I;return w===v.q7.HEADER&&(B=!1,N=!0),o().createElement("div",{className:g()},B&&o().createElement("img",{alt:D,className:g("image",{size:_,png:T,rtl:A,singleLogo:I}),crossOrigin:"anonymous",loading:e?"lazy":void 0,src:O}),N&&o().createElement("img",{alt:D,className:g("text",{size:P}),crossOrigin:"anonymous",id:L,loading:e?"lazy":void 0,src:x}))}},29716:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var a=s(63904),r=s.n(a),n=s(87363),i=s.n(n),o=s(45331),d=s(68712),l=s(73320);const c=r().with("game-categories");class h extends n.Component{render(){const{categoryDataMappedByID:e}=this.context,{categoryIDs:t,mix:s="",withLink:a=!0,withIcon:r=!0}=this.props;return i().createElement("ul",{className:`${c()} ${s}`},t.map((t=>{const s=e[t];return s?i().createElement("li",{className:c("category"),key:s.name},i().createElement(d.Z,{name:s.name,title:s.title,type:l.q.CLEAR,withIcon:r,withLink:a})):null})))}}h.contextType=o.Z;const u=h},14555:(e,t,s)=>{"use strict";s.d(t,{Z:()=>Ie});var a=s(10576),r=s(63904),n=s.n(r),i=s(87363),o=s.n(i),d=s(45112),l=s(11180),c=Object.defineProperty,h=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,m=(e,t,s)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;const v={waterfall:[]},g=(0,i.createContext)(v),w=(0,i.createContext)((e=>e));var f=s(35742);const y=[300,250],b=n().with("splash-adv-block"),k=(0,i.forwardRef)((({blockNumber:e,provider:t,waterfallItem:s,onRequest:a,onResponse:r,onShow:n,onFailed:d},l)=>{const c="splash_adv_block_"+e;return(0,i.useEffect)((()=>{var i,o,l;i=void 0,o=null,l=function*(){var i;if(s)try{const o=t,d=(0,f.tq)(s)?null==(i=s.blockIds[e])?void 0:i.blockId:"unknown",l=yield o.createSlot({blockId:d,divId:c,size:y});null==a||a({slot:l});const{isEmpty:h}=yield o.preloadSlot({slot:l});if(null==r||r({slot:l,isEmpty:h}),h)throw new Error("Slot is empty");yield o.showSlot(l),null==n||n({slot:l})}catch(e){null==d||d(e)}},new Promise(((e,t)=>{var s=e=>{try{r(l.next(e))}catch(e){t(e)}},a=e=>{try{r(l.throw(e))}catch(e){t(e)}},r=t=>t.done?e(t.value):Promise.resolve(t.value).then(s,a);r((l=l.apply(i,o)).next())}))}),[e,c,d,a,r,n,t,s]),o().createElement("div",{className:`${b({gpt:!0})}`,id:c})}));var A=s(62011),E=s(45331),S=s(15771),I=s(90380);const P=n().with("splash-adv-block"),R=(0,i.forwardRef)((({blockNumber:e,provider:t,waterfallItem:s,onRequest:a,onResponse:r,onShow:n,onFailed:d,location:l,flags:c},h)=>{const u="splash_adv_block_"+e;return(0,i.useEffect)((()=>{var i,o,h;i=void 0,o=null,h=function*(){var i,o;if(!s)return;const h=t,p=(0,f.tq)(s)?null==(i=s.blockIds[e])?void 0:i.blockId:"unknown";try{const e=yield h.createSlot({blockId:p,divId:u,location:l,darkTheme:null!=(o=(0,S.RM)(c,I.Z.advGameLoaderDarkAdvTheme))&&o});null==a||a({slot:e});const{slot:t,isEmpty:s}=yield h.preloadSlot({slot:e,flags:c});if(null==r||r({slot:t,isEmpty:s}),s)throw new Error("Slot is empty");yield h.showSlot(t),null==n||n({slot:t})}catch(e){null==d||d(e)}},new Promise(((e,t)=>{var s=e=>{try{r(h.next(e))}catch(e){t(e)}},a=e=>{try{r(h.throw(e))}catch(e){t(e)}},r=t=>t.done?e(t.value):Promise.resolve(t.value).then(s,a);r((h=h.apply(i,o)).next())}))}),[e,u,c,a,r,n,d,l,t,s]),o().createElement("div",{className:P({rsya:!0}),id:u})})),T=(0,i.memo)((0,A.Z)(R,E.Z,{flags:e=>e.abt.flags,location:e=>e.location}));var C=Object.defineProperty,D=Object.defineProperties,L=Object.getOwnPropertyDescriptors,O=Object.getOwnPropertySymbols,x=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable,B=(e,t,s)=>t in e?C(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,N=(e,t)=>{for(var s in t||(t={}))x.call(t,s)&&B(e,s,t[s]);if(O)for(var s of O(t))_.call(t,s)&&B(e,s,t[s]);return e},M=(e,t)=>D(e,L(t));const $=(0,i.forwardRef)(((e,t)=>{var s;switch(null==(s=e.provider)?void 0:s.providerName){case f.oO.YandexBlock:return o().createElement(T,M(N({},e),{ref:t}));case f.oO.GoogleBlock:return o().createElement(k,M(N({},e),{ref:t}));default:return console.error("Unknown provider"),null}}));var F=s(13547),q=s(5e4),W=s(51290),Z=s(97553);const G=n().with("splash-adv"),U=({blockNumber:e,blocksCount:t,onAdvBlockLoadingFinished:s,onAdvShowed:a})=>{const r=(0,i.useContext)(g),n=(0,i.useMemo)((()=>new W.U({tag:q.$.SPLASH,blocks_count:t,block_number:e})),[t,e]),d=(0,i.useMemo)((()=>r.waterfall),[r]),[l,c]=(0,i.useState)(!1);(0,i.useMemo)((()=>{var e,t;d.length&&"undefined"!=typeof window&&n.tryOpen({reason:Z.p_.ONSPOT,provider:null!=(t=null==(e=d[0])?void 0:e.provider)?t:"none"})}),[n,d]);const h=(0,i.useCallback)(((t,s)=>{var a;const r=(0,f.tq)(t)?null==(a=t.blockIds[e])?void 0:a.blockId:"unknown";if(s){const e=d.indexOf(t);n.waterfall({advBlockId:r,provider:t.provider,depth:e,reason:Z.p_.WATERFALL})}else n.demand({advBlockId:r,provider:t.provider})}),[e,n,d]),u=(0,i.useCallback)((()=>{s(!1),a(!1),c(!0)}),[s,a]),p=(0,i.useCallback)((()=>{n.request()}),[n]),m=(0,i.useCallback)((({isEmpty:e})=>{e?n.responseEmpty():(n.response(),s(!0))}),[n,s]),v=(0,i.useCallback)((()=>{n.show(),a(!0)}),[n,a]);return o().createElement("div",{className:G("block-container",{failed:l})},o().createElement(F.Z,{waterfallList:d,onRequest:p,onResponse:m,onShow:v,onWaterfallFailed:u,onWaterfallNext:h},o().createElement($,{blockNumber:e})))};var H=s(57745),j=Object.defineProperty,z=Object.getOwnPropertySymbols,V=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable,Y=(e,t,s)=>t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var X=s(40581);const J=({blockWidth:e,maxBlocksCount:t,gap:s})=>{if("undefined"==typeof window)return t;const a=(0,X.bY)().innerWidth;let r=Math.floor(a/e);if(r<=1)return 1;return r*e+s*(r-1)>a&&r--,Math.min(r,t)},Q=n().with("splash-adv"),ee=function(e){return t=>{const[s,a]=(0,i.useReducer)(l.Z,v);return o().createElement(g.Provider,{value:s},o().createElement(w.Provider,{value:a},o().createElement(e,((e,t)=>{for(var s in t||(t={}))u.call(t,s)&&m(e,s,t[s]);if(h)for(var s of h(t))p.call(t,s)&&m(e,s,t[s]);return e})({},t))))}}((te=({onAdvLoadingFinished:e,onAdvShowed:t})=>{const s=(0,i.useRef)([]),a=(0,i.useRef)([]),r=(0,i.useMemo)((()=>new Array(J({maxBlocksCount:3,blockWidth:300,gap:15})).fill(0)),[]),n=(0,i.useCallback)((t=>{s.current.push(t),s.current.length>=r.length&&e(s.current.filter((e=>e)).length)}),[r.length,s,e]),d=(0,i.useCallback)((e=>{a.current.push(e),a.current.length>=r.length&&t()}),[r.length,t]);return o().createElement("div",{className:Q()},r.map(((e,t)=>o().createElement(U,{blockNumber:t,blocksCount:r.length,key:t,onAdvBlockLoadingFinished:n,onAdvShowed:d}))))},e=>{const t=(0,H.HX)(),s=(0,i.useContext)(w);return(0,i.useEffect)((()=>{var e;const a=null==(e=t.splashAdv)?void 0:e.common.waterfall;a&&s({waterfall:a})}),[t,t.splashAdv,s]),o().createElement(te,((e,t)=>{for(var s in t||(t={}))V.call(t,s)&&Y(e,s,t[s]);if(z)for(var s of z(t))K.call(t,s)&&Y(e,s,t[s]);return e})({},e))}));var te;const se=n().with("fake-splash-adv"),ae=({blocksCount:e})=>{const t=(0,i.useMemo)((()=>new Array(e).fill(1)),[e]);return o().createElement("div",{className:se()},t.map(((e,t)=>o().createElement("div",{className:se("block"),key:t}))))},re=n().with("play-button"),ne=({loaderVisible:e,onClick:t,text:s})=>o().createElement("div",{className:re({loading:e}),onClick:t},o().createElement("span",{className:re("text",{loading:e})},s));var ie=s(30367),oe=s(43548),de=s(47484);const le=e=>new Promise((t=>e(t))),ce=()=>le(de.EE).then((()=>"waitTTI")),he=e=>new Promise((t=>{const s=e=>{ie.UD.includes(e.data.action)&&(oe.Z.offAllMessages("game-measuring",s),t(e.data.action))};e&&ce().then(t),oe.Z.onAllMessages("game-measuring",s)})),ue=e=>{return t=void 0,s=null,a=function*(){const t=Promise.race([le(de.UQ).then((()=>"waitAllTTI")),he(e)]),[s]=yield Promise.all([t,ce()]);return s},new Promise(((e,r)=>{var n=e=>{try{o(a.next(e))}catch(e){r(e)}},i=e=>{try{o(a.throw(e))}catch(e){r(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,i);o((a=a.apply(t,s)).next())}));var t,s,a};var pe=s(79673),me=s(64295),ve=s(47802),ge=s(53603),we=s(40184),fe=s(85467),ye=s(604),be=s(69543),ke=s(73285),Ae=s(14228),Ee=s(41811);s(72007);const Se=n().with("adv-game-loader"),Ie=()=>{const{abt:{flags:e},playPageData:{gameInfo:{title:t}}}=(0,we.b)(),s=(0,fe.T)(),{setIsReady:r}=(0,ge.s)(),{hideGameLoaderCallback:n}=(0,me.p)(),l=(0,i.useRef)(null),[c,h]=(0,i.useState)({resultReceived:!1,enabled:!1}),[u,p]=(0,i.useState)(""),[m,v]=(0,i.useState)(!1),[g,w]=(0,i.useState)(0),[f,y]=(0,i.useState)(!1),[b,k]=(0,i.useState)(!1),[A,E]=(0,i.useState)(!1),[P,R]=(0,i.useState)(!0),T=Ee.xY.ADV_LOADER_DESKTOP,C=(0,i.useMemo)((()=>Boolean((0,S.RM)(e,I.Z.advGameLoaderStayOnLoad)||!c.resultReceived||c.enabled)),[e,c.enabled,c.resultReceived]),D=(0,i.useMemo)((()=>Boolean(C&&(m&&u||A))),[m,u,A,C]),L=(0,i.useMemo)((()=>s(D?"splash-screen.play":"splash-screen.loading")),[s,D]),O=(0,i.useCallback)((()=>{oe.Z.post((0,be.bS)({actionSource:ye.Q.PlayButton,permission:a._I.ALLOW}))}),[]),x=(0,i.useCallback)((e=>{oe.Z.post({type:"splash",action:"set-was-closed"}),oe.Z.post({type:"document-events",action:"hide-splash-screen"}),n(e),r(!0),R(!1),(0,ve.fX)()}),[n,r]),_=(0,i.useCallback)((()=>{D&&(O(),x("play click"))}),[O,x,D]),B=(0,i.useCallback)((e=>{0!==e?(w(e),window.setTimeout((()=>{y(!0)}),700)):v(!0)}),[]),N=(0,i.useCallback)((()=>{k(!0),window.setTimeout((()=>{v(!0)}),ie.PJ)}),[]);return(0,d.qR)((()=>(ue().then((e=>p(e))),(0,Ae.y)().then((e=>h({resultReceived:!0,enabled:e}))),l.current=window.setTimeout((()=>E(!0)),ie.v4),()=>{l.current&&clearTimeout(l.current)}))),(0,i.useEffect)((()=>{if(!P)return;const e=(({advLoaded:e,gameLoadedReason:t,hideTimeoutFinished:s,playButtonExists:a})=>s?"timeout":!a&&t&&e?t:null)({advLoaded:m,gameLoadedReason:u,hideTimeoutFinished:A,playButtonExists:C});!e||"timeout"===e&&C||x(e)}),[m,u,x,A,P,C]),P?o().createElement("div",{className:Se(),"data-type":"game-loader"},o().createElement("div",{className:Se("splash-adv-container",{"adv-showed":Boolean(f)})},o().createElement(ee,{onAdvLoadingFinished:B,onAdvShowed:N})),o().createElement("div",{className:Se("fake-adv-container",{"adv-loaded":Boolean(g),"adv-showed":Boolean(f&&b)})},g>0&&o().createElement(ae,{blocksCount:g})),o().createElement("div",{className:Se("preloading-content-container",{"adv-loaded":Boolean(g),"adv-failed":(A||m)&&!g,"game-loaded":D,"guard-enabled":c.enabled})},o().createElement(pe.Z,{iconSize:T,withBlur:!1,onClick:D?_:void 0}),o().createElement("span",{className:Se("preloading-content-title")},(0,ke.T)(t))),o().createElement("div",{className:Se("play-button-container",{"adv-loaded":Boolean(g),"adv-failed":(A||m)&&!g})},o().createElement(ne,{loaderVisible:!D,text:L,onClick:_}),o().createElement("div",{className:Se("guard-text-container",{hidden:!c.enabled})},o().createElement("div",{className:Se("guard-text")},s("guard.legal.text.v3"),o().createElement("a",{href:s("guard.license.link.href"),target:"_blank"},s("guard.license.link.text")))))):null}},30367:(e,t,s)=>{"use strict";s.d(t,{AK:()=>d,NS:()=>n,PJ:()=>c,UD:()=>i,lt:()=>o,v4:()=>l});var a=s(70135),r=s(40656);a.ur.GameReady;const n={"adv-show-fullscreen":{messageType:"adv-manager",hideReason:"advertisement"},[a.ur.GameReady]:{messageType:"game-measuring",hideReason:"gameReady"}},i=[a.ur.GameInit,a.ur.GameReady,a.ur.GameReadyForce],o=()=>["adv-manager","game-measuring"],d=()=>["adv-show-fullscreen",a.ur.GameReady],l=10*r.WT,c=3*r.WT},64865:(e,t,s)=>{"use strict";s.d(t,{Z:()=>b});var a=s(63904),r=s.n(a),n=s(87363),i=s.n(n),o=s(30367),d=s(79673),l=s(64295),c=s(53603),h=s(40184),u=s(85467),p=s(43548),m=s(70135),v=s(14228),g=s(47484),w=s(15771),f=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const y=r().with("game-loader"),b=()=>{const e=(0,h.b)(),{abt:{flags:t},playPageData:s}=e,a=(0,u.T)(),{setIsReady:r}=(0,c.s)(),[b,k]=(0,n.useState)(!1),[A,E]=(0,n.useState)(null),S=(0,n.useRef)(null),I=(0,n.useCallback)((()=>{E("click")}),[]),P=(0,w.Rg)(t),R=(0,n.useRef)(null),{hideGameLoaderCallback:T}=(0,l.p)(),C=(0,n.useCallback)((()=>f(void 0,null,(function*(){const e=new Promise((e=>f(void 0,null,(function*(){p.Z.onExternalMessage("game-measuring",(t=>{o.UD.includes(t.data.action)&&e(t.data.action)})),(0,g.UQ)((()=>e("waitAllTTI"))),(yield(0,v.y)())&&(0,g.EE)((()=>e("waitTTI")))})))),t=new Promise((e=>{(0,g.EE)((()=>e("waitTTI")))})),[s]=yield Promise.all([e,t]);return s}))),[]);return(0,n.useEffect)((()=>{var e,t,s,a,r;const n=(0,o.AK)(),i=null==(r=null==(a=null==(s=null==(t=null==(e=window.earlyEvents)?void 0:e.messages)?void 0:t.find((e=>{var t,s;return n.includes(null==(s=null==(t=e.data)?void 0:t.originalEvent)?void 0:s.action)})))?void 0:s.data)?void 0:a.originalEvent)?void 0:r.action;i?E(o.NS[i].hideReason):n.includes(m.ur.GameReady)&&C().then((e=>{E(e)}))}),[C]),(0,n.useEffect)((()=>{if(!b){const e=(0,o.lt)(),t=(0,o.AK)(),s=e=>{const{action:s}=e.data;t.includes(s)&&E(o.NS[s].hideReason)};return p.Z.onAllMessages(e,s),()=>{R.current&&p.Z.offAllMessages(e,s)}}}),[b]),(0,n.useEffect)((()=>{b&&S.current&&clearTimeout(S.current)}),[b]),(0,n.useEffect)((()=>{S.current=setTimeout((()=>{E("timeout"),S.current=null}),o.v4)}),[s.gameInfo.appId]),(0,n.useEffect)((()=>{!R.current&&A&&(R.current=A,p.Z.post({type:"document-events",action:"hide-splash-screen"}),r(!0),setTimeout((()=>{k(!0),T(A)}),250))}),[A,t,r,T]),b?null:i().createElement("div",{className:y({hidden:Boolean(A),transparent:P}),"data-type":"game-loader",onClick:I},i().createElement("div",{className:y("content")},i().createElement(d.Z,null)),i().createElement("div",{className:y("text")},a("common.loading")))}},79673:(e,t,s)=>{"use strict";s.d(t,{Z:()=>y});var a=s(39743),r=s(63904),n=s.n(r),i=s(87363),o=s.n(i),d=s(60295);var l=s(40184),c=s(11324),h=s(68199),u=s(41811),p=Object.defineProperty,m=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,w=(e,t,s)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;const f=n().with("preloading-content"),y=({onClick:e,iconSize:t,withBlur:s=!0})=>{var r;const n=(0,l.b)(),{playPageData:p,isSlowCountry:y}=n,b=null==(r=p.gameData)?void 0:r.media,k=(0,i.useRef)(null),[A]=function(e,t){const[s,a]=(0,i.useState)(!1),r=()=>{a(!0)};return(0,i.useEffect)((()=>{var a,n;!s&&(null==(a=null==e?void 0:e.current)?void 0:a.complete)&&(t&&(0,d.bS)(t,null==(n=null==e?void 0:e.current)?void 0:n.src),r())})),[r,s]}(k,"splash-screen");if(!b)return o().createElement(a.y,{size:46,spinning:!0,view:"default"});const E=y?u.xY.SIZE_84_LOW:t||u.xY.M,S=(0,c.Jn)(b,((e,t)=>{for(var s in t||(t={}))v.call(t,s)&&w(e,s,t[s]);if(m)for(var s of m(t))g.call(t,s)&&w(e,s,t[s]);return e})({size:E},(0,h.R)(y)?{cdnUrl:n.cdnUrl}:{})),I=s?`drop-shadow(0px 0px 70px ${b.icon.mainColor})`:void 0,P="function"==typeof e;return o().createElement("img",{alt:p.gameTitle,className:f("game-icon",{clickable:P}),crossOrigin:"anonymous",fetchpriority:"high",loading:"eager",ref:k,src:S,style:{filter:I,backgroundColor:(0,c.jl)(b,{size:E})},onClick:e,onLoad:A})}},64295:(e,t,s)=>{"use strict";s.d(t,{p:()=>l});var a=s(87363);const r=e=>()=>e?Date.now()-e:null;var n=s(43548),i=s(47484),o=s(93298);const d=(0,o.M$)("SplashScreen",o.XG.Dev),l=()=>{const e=(0,a.useRef)(null);return(0,a.useEffect)((()=>{if(!o.HQ)return;e.current=Date.now();const t=r(e.current),s=e=>{d("onGameMeasuringEvent",e.data.action)};return n.Z.onExternalMessage("game-measuring",s),(0,i.EE)((()=>d("waitTTI",t()))),(0,i.UQ)((()=>d("waitAllTTI",t()))),()=>{n.Z.offInternalMessage("game-measuring",s)}}),[]),{mountedTime:e,hideGameLoaderCallback:t=>{const s=r(e.current)();d(`Splash screen hide by ${t}. elapsed time: ${s}`)}}}},24919:(e,t,s)=>{"use strict";s.d(t,{Z:()=>h});var a=s(39743),r=s(63904),n=s.n(r),i=s(87363),o=s.n(i),d=s(45331);const l=n().with("image");class c extends i.Component{constructor(e){super(e),this.imgRef=o().createRef(),this.onLoad=()=>{this.setState({status:"loaded"})},this.onError=()=>{this.setState({status:"error"})},this.state={status:e.disableSpinner?"loaded":"loading"}}componentDidMount(){var e;(null==(e=this.imgRef.current)?void 0:e.complete)&&"loaded"!==this.state.status&&this.onLoad()}componentDidUpdate(e){var t;this.props.src!==e.src&&this.setState({status:"loading"}),(null==(t=this.imgRef.current)?void 0:t.complete)&&"loaded"!==this.state.status&&this.onLoad()}render(){const e=`${l("",{state:this.state.status})} ${this.props.className}`.trim();return o().createElement("div",{className:e},o().createElement("img",{alt:this.props.alt||"",className:l("img"),crossOrigin:this.props.crossOrigin,ref:this.imgRef,src:this.props.src,title:this.props.title,onError:this.onError,onLoad:this.onLoad}),o().createElement(a.y,{position:"center",size:this.props.size,spinning:"loading"===this.state.status,view:"default"}))}}c.contextType=d.Z;const h=c},65453:(e,t,s)=>{"use strict";s.d(t,{E6:()=>r,Oe:()=>i,Tp:()=>n,XB:()=>a});var a=(e=>(e.DEBUG="debug",e.ERROR="error",e.INFO="info",e.WARN="warn",e))(a||{});const r=1e4,n=200,i=10},5314:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var a=s(6006),r=s(63904),n=s.n(r),i=s(87363),o=s.n(i),d=s(29994),l=s(76994),c=s(65453);const h=n().with("message-box");class u extends i.PureComponent{constructor(){super(...arguments),this.state={destroyed:!1,visible:!1},this.handleClick=()=>{var e,t;this.toggleVisibility(!1),null==(t=(e=this.props).onClick)||t.call(e)},this.onSnooze=()=>{var e,t;this.toggleVisibility(!1),null==(t=(e=this.props).onSnooze)||t.call(e)}}componentDidMount(){const{autohide:e}=this.props;this.openingTimer=window.setTimeout((()=>this.toggleVisibility(!0)),c.Oe),e&&(this.hidingTimer=window.setTimeout((()=>this.toggleVisibility(!1)),c.E6))}componentWillUnmount(){window.clearTimeout(this.openingTimer),this.hidingTimer&&window.clearTimeout(this.hidingTimer),this.destroyTimer&&window.clearTimeout(this.destroyTimer)}toggleVisibility(e){var t,s;this.setState({visible:e}),e||(null==(s=(t=this.props).onClose)||s.call(t),this.destroyTimer=window.setTimeout((()=>{this.setState({destroyed:!0})}),c.Tp))}renderSnoozeButton(){return this.props.onSnooze?o().createElement(a.z,{className:h("snooze"),rounded:!0,size:24,view:"secondary",onClick:this.onSnooze},"😴 ",o().createElement("span",{className:h("snooze-title")},this.props.getText("common.hide").toLowerCase())):null}renderCloseButton(){return this.props.withCloseButton?o().createElement(l.Z,{type:"popup",onClick:this.handleClick}):null}renderContent(){return o().createElement("div",{className:h("content"),onClick:this.handleClick},this.props.children)}render(){const{level:e=c.XB.INFO}=this.props,{destroyed:t,visible:s}=this.state;return t?null:o().createElement("div",{className:h({level:e,visible:s})},this.renderSnoozeButton(),this.renderCloseButton(),this.renderContent())}}const p=(0,d.$j)((function(e){return{getText:e.getText}}))(u)},23404:(e,t,s)=>{"use strict";s.d(t,{Cn:()=>g,EC:()=>l,Iy:()=>u,Si:()=>c,Sk:()=>o,UG:()=>i,_u:()=>p,hL:()=>n,kn:()=>d,qS:()=>h,wt:()=>v,xd:()=>r,yt:()=>m});var a=s(5e4);const r={fullscreen:"fullscreen",desktop:"desktop"},n=15e3,i=15e3,o=3e4,d={countdown:"play-countdown",headerFix:"with-play-game-header-fix",modal:"play-modal",modalClose:"play-modal-close",modalFullscreen:"play-modal_fullscreen",modalInner:"play-modal__inner",modalVisible:"play-modal_visible",modalWithBlur:"play-modal_with-blur",modalWithHeader:"play-modal_with-header",noClickOverlay:"adv-no-click-overlay",yabroChromeLower79:"play-modal_yabro_chrome_lower_79"},l={start_fullscreen:"R-A-3462885-6",fullscreen:"R-A-3462885-2",rewarded:"R-A-3462885-1"},c="aab-adv_with_disable_adv_button",h="No adv to show now - it can happen sometimes\nTry reload page(Ctrl+F5) or open in different browser",u="No rewarded video to show now - it can happen sometimes\nTry reload page(Ctrl+F5) or open in different browser",p="Trouble with showing adv",m="Adv SDK error",v=[a.e.AdsenseResponsive,a.e.Google,a.e.GoogleInstream,a.e.GoogleManual,a.e.Native,a.e.Prebid,a.e.PrebidTGO,a.e.Yandex],g="adv_show_delay"},47802:(e,t,s)=>{"use strict";s.d(t,{lu:()=>ie,KW:()=>Ae,Sn:()=>Se,fl:()=>Ee,$3:()=>te,ss:()=>le,qu:()=>K,tq:()=>de,dh:()=>he,mx:()=>ce,el:()=>we,TE:()=>ue,zw:()=>ae,PS:()=>re,xK:()=>ge,uD:()=>ye,Ij:()=>ve,g5:()=>pe,ey:()=>Y,SW:()=>se,R4:()=>X,J4:()=>ne,U2:()=>Q,gp:()=>be,WL:()=>ee,HH:()=>me,fX:()=>fe});var a=s(23404),r=s(54814),n=s(14184),i=s(43548),o=Object.defineProperty,d=Object.defineProperties,l=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,p=(e,t,s)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,m=(e,t)=>{for(var s in t||(t={}))h.call(t,s)&&p(e,s,t[s]);if(c)for(var s of c(t))u.call(t,s)&&p(e,s,t[s]);return e},v=(e,t)=>d(e,l(t));function g(e){if(!(e instanceof Error))try{e=new Error(String(e))}catch(t){e=new Error("Unknown error object")}return v(m({},JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e)))),{stack:e.stack,name:e.name})}const w={gamesApp:{worldWide:72e3,default:12e4},web:{worldWide:6e4,default:6e4}};var f=s(50042);const y="screen-manager",b={ExitFullscreen:()=>({type:y,action:"exit-fullscreen"}),RequestFullscreen:()=>({type:y,action:"request-fullscreen"}),ToggleFullscreen:()=>({type:y,action:"toggle-fullscreen"}),GetState:()=>({type:y,action:"get-state"})};var k=s(69543),A=s(42126),E=s(5e4),S=s(76488),I=s(4212),P=s(17061),R=s(91605),T=s(77901),C=s(37705),D=s(27859),L=s(41811),O=s(93298),x=s(15771),_=s(90380),B=s(89592),N=s(29008),M=Object.defineProperty,$=Object.defineProperties,F=Object.getOwnPropertyDescriptors,q=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable,G=(e,t,s)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,U=(e,t)=>{for(var s in t||(t={}))W.call(t,s)&&G(e,s,t[s]);if(q)for(var s of q(t))Z.call(t,s)&&G(e,s,t[s]);return e},H=(e,t)=>$(e,F(t)),j=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const z=-90,V=90,K=(0,O.M$)("Adv manager",O.XG.Adv);function Y(e){console.warn("There is no partnerID: partnerId provides only on link in console. If you opened link from console then accept agreement in admin panel"),R.Eu.params({borrowParams:{advPartnerErrorData:{appId:e},errorText:"Empty partnerId"}})}function X(){const e=(0,A.Z)({url:window.location.href,removed:["a_delay"]});window.history.replaceState(null,document.title,e)}function J(){K("sendAdvClickGoal"),R.Eu.reachGoal(B.Ji.ADV_CLICK,{advType:"game",sdkVersion:2})}function Q(e,t){i.Z.post({type:"adv-debug-info",action:"set-debug-adv-block",data:{type:e,id:t}})}function ee(){i.Z.post({type:"adv-debug-info",action:"show-debug-info"})}function te(e,t,s){var a;const r=null!=(a=(0,x.mn)(s,`adv-blocks:${t}`))?a:(0,x.mn)(s,"adv-blocks");if(!r||"object"!=typeof r)return function(e,t,s){var a;const r=s[`adv-block:${t}`]||s["adv-block"]||(null==(a=s["adv-exp"])?void 0:a[t]);if(!r||"object"!=typeof r)return e;if((0,C.H)({additional:{flagValue:r},message:'Deprecated "adv-block" flag'}),!r.fullscreen&&!r.fullscreen_landscape&&!r.rewarded)return(0,n.fF)(new Error(`invalid adv experiment format, expected { fullscreen?: "R-I-12345", fullscreen_landscape?: "R-I-54321", rewarded?: "R-I-54321" } (at least one property), got:', ${r}`)),e;return Object.assign({},e,H(U({},r),{desktop:r,mobile:r}))}(e,t,s);return r.desktop&&"object"==typeof r.desktop||r.mobile&&"object"==typeof r.mobile||r.native&&"object"==typeof r.native?(0,I.T)(e,r):((0,n.fF)(new Error(`Invalid "adv-blocks" experiment format:', ${r}`)),e)}function se(e){if((0,T.qo)()){const t=e.style;t.width=`${window.innerWidth}px`,t.height=`${window.innerHeight}px`}const t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${t}px`);const s=window.pageYOffset;return window.scroll(0,0),s}function ae(){function e(){window.orientation===V?document.documentElement.style.removeProperty("--iphone-bangs-adv-padding-left"):document.documentElement.style.setProperty("--iphone-bangs-adv-padding-left","0"),window.orientation===z?document.documentElement.style.setProperty("--iphone-bangs-padding-right","1"):document.documentElement.style.setProperty("--iphone-bangs-padding-right","0")}e(),D.Z.addChangeListener(e)}function re(){i.Z.post({type:"adv-debug-info",action:"hide-debug-info"})}function ne(e,t){const s=t.querySelector(`.${e.modalContent}`);if(s){const e=s.firstElementChild;e&&e.addEventListener("click",J,!0)}}class ie extends Error{constructor(e,t={isEmpty:!1,isFinal:!1,wasShown:!1}){super(e),this.params=t}}function oe(e){try{return String(e.message||e).substring(0,100)}catch(e){}return""}function de(e,t){return(...s)=>{try{return e(...s)}catch(e){(0,n.Ts)(e,{additional:{origError:oe(e)},message:t})}}}function le(e){const{advElement:t,type:s,flags:r,appId:i,isIOS:o}=e,d=r[`no_click_${s}:${i}`]||r[`no_click_${s}`]||(o?100:0);if(!d)return;if(!t)return void(0,n.fF)(new Error("Cannot place no click overlay - advElement is null"));const l=document.createElement("div");l.className=a.kn.noClickOverlay,t.appendChild(l),setTimeout((()=>{t.removeChild(l)}),d)}function ce(e,t,s){const a=(0,x.$9)(t,_.Z.newAdvInterval);if("number"==typeof a)return a;return!S.XK&&parseInt(e||"0",10)||((r={withWorldWideAdv:Boolean(s),isGamesApp:(0,f.VP)()}).isGamesApp?r.withWorldWideAdv?w.gamesApp.worldWide:w.gamesApp.default:r.withWorldWideAdv?w.web.worldWide:w.web.default);var r}function he(e){if(e){const t=parseInt(e,10)||0;if(t>0)return t}const t=(0,P.V)("utm_source");if(t){if(["adv","google","yandex"].includes(t))return L.JH}return 0}function ue(e){return`play-modal_view-type_${e}`}function pe(e,t){const{additional:s,error:r,name:i,tag:o}=t;(0,n.fF)(r,{prefix:`${a.yt}: `,additional:{adv:H(U({},s),{name:i,service:e.serviceName,tag:o})}})}function me(){if(ve())return;i.Z.post({type:"play-game-header",action:"show"});const e=document.querySelector(".header-container"),t=document.querySelector(".stack"),s=document.querySelector(".menu__overlay");e&&(e.style.display=""),s&&(s.style.top=""),t&&(t.style.top="")}function ve(){return"no"===(0,P.V)("header")}function ge(){i.Z.post({type:"play-game-header",action:"hide"});const e=document.querySelector(".header-container"),t=document.querySelector(".stack"),s=document.querySelector(".menu__overlay");e&&(e.style.display="none"),s&&(s.style.top="0px"),t&&(t.style.top="0px")}function we(e){return`${a.kn.modal}_${e}`}function fe(){K("show sticky banner"),i.Z.post({type:"sticky-banner",action:"show",data:{reason:"blur"}})}function ye(e,t,s){var a;const n=null!=(a=t.getTimeoutExtraTime(r.QA.ServiceInit,s))?a:0;let i=(0,x.$9)(e,_.Z.adScriptInitTimeout)||3500+n;const o=(0,x.$9)(e,`adv_${t.serviceName}_init_timeout`);return void 0!==o&&(i=o+n,n&&K(`Note: Service ${t.serviceName} added extra init timeout: ${n} (total: ${i})`)),i}function be(e,t,s,n){var i;const o=null!=(i=s.getTimeoutExtraTime(t===E.$.INTERSTITIAL?r.QA.ShowFullscreen:r.QA.ShowRewarded,n))?i:0;let d=(t===E.$.INTERSTITIAL?a.hL:a.UG)+o;const l=(0,x.$9)(e,`adv_${s.serviceName}_show_timeout`);return void 0!==l&&(d=l+o,o&&K(`Note: Service ${s.serviceName} added extra showAdv timeout: ${o} (total: ${d})`)),d}function ke(e){i.Z.postToChild(e),i.Z.post(H(U({},e),{action:`debug-action-${e.action}`}))}function Ae(e,t){(0,x.bF)(t)&&e.addCallbacks({onOpen:()=>{K("hide sticky banner"),i.Z.post({type:"sticky-banner",action:"hide",data:{reason:"blur"}})},onClose:()=>{fe()}})}function Ee(e,t,s){return j(this,null,(function*(){if(t!==E.$.REWARDED)return;const a=(0,N.AK)(s);if(!a.isAndroid||a.isStandalone)return;const r=yield i.Z.post(b.GetState()),{screenOrientationWasLocked:n}=r.data;if(n)return;const o=()=>{D.Z.unlock().catch((()=>{}))};e.addCallbacks({onOpen:()=>{D.Z.lock().catch((()=>{}))},onClose:o,onError:o})}))}function Se(e,t){switch(t){case E.$.INTERSTITIAL:e.addCallbacks({onOpen:()=>ke(k.fB.AdvCallbackOpen()),onClose:e=>i.Z.postToChild(k.fB.AdvCallbackClose({wasShown:e})),onError:e=>ke(k.fB.AdvCallbackError({fromMethod:"showFullScreenAdv",error:g(e)})),onOffline:()=>ke(k.fB.AdvCallbackOffline())});break;case E.$.REWARDED:e.addCallbacks({onOpen:()=>ke(k.fB.RewardedVideoCallbackOpen()),onRewarded:()=>ke(k.fB.RewardedVideoCallbackRewarded()),onClose:()=>ke(k.fB.RewardedVideoCallbackClose()),onError:e=>ke(k.fB.RewardedVideoCallbackError({error:g(e),fromMethod:"onError"}))})}}},34967:(e,t,s)=>{"use strict";s.d(t,{Z:()=>hn});var a=s(63904),r=s.n(a),n=s(87363),i=s.n(n),o=s(45331),d=s(43548);const l=r().with("adv-debug-info");let c="",h="";class u extends o.P{constructor(e){super(e),this.switchDebugInfo=()=>{var e,t;const{isOverlayVisible:s}=this.state,{appId:a}=this.props;if(this.setState((e=>({isOverlayVisible:!e.isOverlayVisible}))),s)return;const r=[`Версия SDK: ${window.appData.version}`,`Реклама: ${c} - ${h}`,`Эксперименты: ${JSON.stringify(window.appData.abt.flags,null,2)}`,`UserAgent: ${navigator.userAgent}`,`AppID: ${a}`],n=`https://forms.yandex-team.ru/surveys/73978/?${[`answer_short_text_644835=${encodeURIComponent("Проблема с рекламой")}`,`answer_long_text_644836=${encodeURIComponent("\n\n===== отладочная информация:\n"+r.join("\n"))}`].join("&")}`,i=()=>{var e;const t="Логи метрики:\n\n"+(null==(e=window.metrikaLogs)?void 0:e.data.map((e=>`${e.type}${e.goal?` ${e.goal}`:""} - ${JSON.stringify(e.data)}`)).slice().reverse().join("\n\n"))||0;this.setState({metrikaLogsText:t}),navigator.clipboard.writeText(r.join("\n")+"\n\n"+t)};i(),window.metrikaLogs.onUpdate=i,null==(t=null==(e=null==window?void 0:window.Ya)?void 0:e.Rum)||t.logEventString("adv","butterfly manual report",{additional:r}),this.setState({logs:r,linkHref:n})},this.state={isVisible:!1,isOverlayVisible:!1,linkHref:"",logs:[],metrikaLogsText:""}}componentDidMount(){this.initMessaging()}initMessaging(){d.Z.onInternalMessage("adv-debug-info",(e=>{const{action:t}=e.data;switch(t){case"show-debug-info":this.setState({isVisible:!0});break;case"hide-debug-info":this.hide();break;case"set-debug-adv-block":c=e.data.data.type,h=e.data.data.id}}))}hide(){window.metrikaLogs.onUpdate=void 0,this.setState({isVisible:!1})}render(){const{logs:e,metrikaLogsText:t,isVisible:s,isOverlayVisible:a,linkHref:r}=this.state,{isDevFeaturesEnabled:n}=this.props;return n&&s?i().createElement("div",{className:l()},i().createElement("button",{className:l("button"),onClick:this.switchDebugInfo},"🐞"),a&&i().createElement("div",{className:l("overlay"),onClick:this.switchDebugInfo},i().createElement("div",{className:l("clipboard-notice")},"Данные скопированы в буфер обмена"),i().createElement("div",{className:l("data")},e.join("\n")),i().createElement("a",{href:r,target:"_blank"},"Тикет в StarTrek"),i().createElement("div",{className:l("metrika-logs")},t))):null}}const p=u;var m=s(14408),v=s(98816),g=s(26108),w=s(45462),f=s(35742),y=s(6006),b=s(39743),k=s(14375),A=s(47802),E=s(40184),S=s(85467),I=s(94671),P=s(96952),R=s(909),T=s(15771);const C="FullscreenBlock-module__container--suKYF",D="FullscreenBlock-module__hidden--FjMwl",L="FullscreenBlock-module__touchControls--FJKug",O="FullscreenBlock-module__spinner--ZgJZq",x="FullscreenBlock-module__desktopClose--vu832",_="FullscreenBlock-module__block--rJxBU",B="FullscreenBlock-module__blockDefaultPaddings--PcHqu",N="FullscreenBlock-module__blockSmallPaddings--FtXVj",M="FullscreenBlock-module__blockNoPaddings--uTgyK",$="FullscreenBlock-module__placeholder--hKxU_",F="FullscreenBlock-module__adsenseDefaultStyles--V8RS4";var q=Object.defineProperty,W=Object.defineProperties,Z=Object.getOwnPropertyDescriptors,G=Object.getOwnPropertySymbols,U=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable,j=(e,t,s)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,z=(e,t)=>{for(var s in t||(t={}))U.call(t,s)&&j(e,s,t[s]);if(G)for(var s of G(t))H.call(t,s)&&j(e,s,t[s]);return e},V=(e,t)=>W(e,Z(t));const K="fullscreenBlock_container",Y="fullscreenBlock_block";function X(e){return""===e?K:`${K}_${e}`}function J(e){return""===e?Y:`${Y}_${e}`}const Q={default:B,unset:M,small:N},ee=({advManager:e})=>{const t=(0,S.T)(),{abt:{flags:s}}=(0,E.b)(),a=(0,n.useMemo)((()=>({usePlaceholder:(0,T.Sf)(s),useLoader:(0,T.Z0)(s),controlsDelay:(0,T.sQ)(s)})),[s]),r=(0,n.useRef)([]),o=(0,n.useRef)(null),[l,c]=(0,n.useState)({isVisible:!1,loadedProviderBlock:null,showControls:!1,isHeaderEnabled:!(0,A.Ij)(),callbacks:{},visibleChange:!1}),[h,u]=(0,n.useState)([""]),[p,m]=(0,n.useState)(h[0]),v=(0,n.useCallback)((()=>{c((e=>V(z({},e),{isVisible:!1,loadedProviderBlock:null,callbacks:{}})))}),[]),g=(0,n.useCallback)((()=>{var e,t;(0,k.D)(),null==(t=(e=l.callbacks).onClose)||t.call(e),v()}),[v,l.callbacks]),w=(0,n.useCallback)((e=>{"Escape"===e.key&&l.isVisible&&(0,P.D)((()=>{g()}))}),[l.isVisible,g]),f=(0,n.useCallback)(((e,t)=>{const{action:s,data:a}=e.data;switch(s){case"show":{const{onOpen:e,onClose:s}=a;c((t=>V(z({},t),{isVisible:!0,visibleChange:!0,showControls:!1,callbacks:{onOpen:e,onClose:s}}))),t();break}case"show-block":{const{blockName:e}=a;m((()=>(t(),X(e))));break}case"hide":const{blockName:e}=null!=a?a:{};if(e&&p!==X(e))break;v();break;case"add-block":{const{blockName:e}=a;if(h.includes(e))return void t();u((s=>(r.current.push(t),[...s,e])));break}case"show-controls":c((e=>V(z({},e),{showControls:!0})));break;case"is-visible":t({data:{isVisible:l.isVisible}});break;case"slot-loaded":c((e=>V(z({},e),{loadedProviderBlock:a.blockName}))),t()}}),[h,p,v,l.isVisible]);(0,n.useEffect)((()=>(window.addEventListener("keydown",w),d.Z.onInternalMessage("adv-fullscreen-block",f),()=>{window.removeEventListener("keydown",w),d.Z.offInternalMessage("adv-fullscreen-block",f),o.current&&clearTimeout(o.current)})),[w,f]),(0,n.useEffect)((()=>{var e,t;l.isVisible&&l.visibleChange&&(null==(t=(e=l.callbacks).onOpen)||t.call(e),a.controlsDelay<1||(c(V(z({},l),{showControls:!1,visibleChange:!1})),o.current=window.setTimeout((()=>{c((e=>V(z({},e),{showControls:!0})))}),a.controlsDelay)))}),[a.controlsDelay,l]),(0,n.useEffect)((()=>{r.current.length&&(r.current.forEach((e=>{e()})),r.current.length=0)}),[h]);const B=(0,n.useCallback)((()=>{(0,P.D)((()=>{g()}))}),[g]),N=(0,n.useCallback)((()=>{(0,R.Z)()}),[]),M=e.isDisableAdButtonEnabled,q=0===a.controlsDelay||l.showControls,W=(0,T.Hr)(e.flags),Z=(0,T.Rw)(e.flags);return i().createElement("div",{className:(0,I.E)(C,void 0,l.isVisible?"visible":D,W?void 0:F),"data-testid":"adv-fullscreen-container"},i().createElement("div",null,i().createElement("div",{className:(0,I.E)(x,q?void 0:D),"data-testid":"adv-fullscreen-closeButton",onClick:B}),a.useLoader&&i().createElement(b.y,{className:(0,I.E)(O,q?D:void 0),key:"landscape-spinner",position:"center",size:32,spinning:!0,view:"default"}),h.map((e=>{const t=X(e);return i().createElement("div",{className:(0,I.E)(_,Q[Z],a.usePlaceholder?$:void 0,p===t?void 0:D,J(e),e===l.loadedProviderBlock?`${Y}_loaded`:void 0),key:t},i().createElement("div",{id:t}))}))),M?i().createElement("div",{className:(0,I.E)(L,q?void 0:D)},M&&i().createElement(y.z,{className:"","data-testid":"adv-fullscreen-closeButton",size:40,view:"secondary",onClick:N},t("header.popup.disable.ads")),i().createElement(y.z,{className:"","data-testid":"adv-fullscreen-closeButton",size:40,view:"primary",onClick:B},t("adv.close"))):null)};var te=s(93298);const se=(0,te.M$)("AdvAdsense",te.XG.Adv,{background:"#0c6c09"});var ae=s(5e4);class re{constructor(e,t){var s,a,r,n;this.service=e,this.initTime=Date.now(),this.lastShowedTimeByTag={[ae.$.INTERSTITIAL]:-1,[ae.$.REWARDED]:-1},this.skipsCounterByTag={[ae.$.INTERSTITIAL]:0,[ae.$.REWARDED]:0},this.initGuardApplyHandler();const{flags:i}=this.advManager,{checksCountCommon:o,showIntervalByTagMs:d,checksCountByTag:l,initDelayMs:c,guardDelayMs:h,showIntervalCommonMs:u}=null!=t?t:{};this.rules={showIntervalByTagMs:this.getRuleValue(m.LQ,d,0),showIntervalCommonMs:null!=(a=null!=(s=(0,m.OF)(this.service.serviceName,i))?s:u)?a:0,initDelayMs:this.getRuleValue(m.vp,c,0),guardDelayMs:this.getRuleValue(m.ro,h,0),checksCountByTag:this.getRuleValue(m.YS,l,0),checksCountCommon:null!=(n=null!=(r=(0,m.g3)(this.service.serviceName,i))?r:o)?n:0}}get advManager(){return this.service.advManager}get checkShowCounter(){return this.skipsCounterByTag[ae.$.INTERSTITIAL]+this.skipsCounterByTag[ae.$.REWARDED]}get lastShowedTime(){return Math.max(this.lastShowedTimeByTag[ae.$.INTERSTITIAL],this.lastShowedTimeByTag[ae.$.REWARDED])}getSkipReason({tag:e}){const t=this.calculateSkipReason({tag:e});return t&&this.skipsCounterByTag[e]++,t}calculateSkipReason({tag:e}){const{showIntervalCommonMs:t,showIntervalByTagMs:s,checksCountCommon:a,checksCountByTag:r,initDelayMs:n,guardDelayMs:i}=this.rules;return n[e]&&this.getTimeDiff(this.initTime)<n[e]?"init_delay":i[e]&&this.guardApplyTime&&this.getTimeDiff(this.guardApplyTime)<i[e]?"guard_delay":s[e]&&this.getTimeDiff(this.lastShowedTimeByTag[e])<s[e]?"show_interval_by_tag":t&&this.getTimeDiff(this.lastShowedTime)<t?"show_interval_common":r[e]&&this.skipsCounterByTag[e]<r[e]?"show_calls_by_tag":a&&this.checkShowCounter<a?"show_calls_common":null}getTimeDiff(e,t){return Math.abs((e||0)-(null!=t?t:Date.now()))}getRuleValue(e,t,s){var a,r,n,i;const{flags:o}=this.advManager;return{[ae.$.INTERSTITIAL]:null!=(r=null!=(a=e(ae.$.INTERSTITIAL,this.service.serviceName,o))?a:null==t?void 0:t[ae.$.INTERSTITIAL])?r:s,[ae.$.REWARDED]:null!=(i=null!=(n=e(ae.$.REWARDED,this.service.serviceName,o))?n:null==t?void 0:t[ae.$.REWARDED])?i:s}}initGuardApplyHandler(){return e=this,t=null,s=function*(){yield Promise.all([this.advManager.guardClosedPromiseWrapper.promise,this.advManager.splashScreenPromise.promise]).then((()=>this.guardApplyTime=Date.now()))},new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));var e,t,s}resetShowTimer(e){this.lastShowedTimeByTag[e]=Date.now()}}var ne=s(54814),ie=s(60295);const oe=(0,te.M$)("AdvService",te.XG.Adv);class de{constructor(e,t,s,a){this.advManager=e,this.options=t,this.serviceName=s,this.initPromise=new g.Z,this.initTime=Date.now(),this.lastAdReqId={[ae.$.INTERSTITIAL]:"",[ae.$.REWARDED]:""},this.canShowController=new re(this,a)}getLastAdReqId(e){return this.lastAdReqId[e]}getAdvBlockId(e,t){return"invalid_block"}isTagActive(e){return this.options.tags[e]!==ne.pP.Skip}isTagWaterfall(e){return this.options.tags[e]!==ne.pP.Onspot}onServiceLoaded(){this.initPromise.resolve(),(0,ie.s4)("play_adv_service_init",Date.now()-this.initTime,!0,{"-additional":encodeURIComponent(JSON.stringify({advtype:this.serviceName,options:this.options}))})}onServiceError(e){let t=null!=e?e:new Error("Service not initialized: Unhandled undefined error (safe)");e instanceof Error&&(e.message=`Service not initialized: ${e.message}`),(0,A.g5)(this,{error:t,additional:{error:e}}),this.initPromise.reject(t)}getTimeoutExtraTime(e,t){}checkCanShow(e,t){const s=this.canShowController.getSkipReason({tag:e});return s?(oe(`[${this.serviceName}] Skip service by reason: ${s}`),ne.Kc.Next):ne.Kc.Ok}get hasFullscreenAdv(){var e;return null==(e=this.advManager.advUsedBlocks.fullscreen)||e}get hasRewarderdAdv(){var e;return null==(e=this.advManager.advUsedBlocks.rewarded)||e}showRewardedVideo(e){return Promise.reject()}resetShowTimer(e){this.canShowController.resetShowTimer(e)}cancelShow(e){}}function le({querySelector:e,interval:t=100,rejectTimeout:s=3e3}){return new Promise(((a,r)=>{function n(){try{let t=document.querySelector(e);if(t)return a(t),!0}catch(e){return r(e),!1}}if(n())return;const i=window.setTimeout((()=>{d(),r(new Error("Can not find element"))}),s),o=window.setInterval((()=>{n()&&d()}),t);function d(){clearInterval(o),clearTimeout(i)}}))}var ce=s(51290),he=s(97553),ue=s(65068),pe=s(40656),me=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));class ve extends de{constructor(e,t){var s,a,r;const{serviceName:n}=t;if(![ae.e.Adsense,ae.e.AdsenseResponsive].includes(n))throw new Error(`Invalid service name: ${n}, kind of 'adsense' expected.`);super(e,t,n),this.isResponsive=!1,this.isResponsive=n===ae.e.AdsenseResponsive;const i=null==(s=e.waterfallQueue)?void 0:s[ae.$.INTERSTITIAL].find((e=>e.provider===ae.e.AdsenseResponsive)),{clientId:o,slotId:d}=(0,ne.hk)(i)?i:null!=(r=null==(a=e.allAdvBlocks.adsense)?void 0:a.interstitial)?r:{};this.clientId=null!=o?o:"invalid_block",this.slotId=null!=d?d:"invalid_block",this.init()}init(){return me(this,null,(function*(){try{const e=this.isTagActive(ae.$.INTERSTITIAL),t=this.isTagActive(ae.$.REWARDED),[s,a]=yield Promise.all([e?yield(0,w.l)(this.isResponsive?f.oO.AdsenseResponsive:f.oO.AdsenseBlock):null,t?yield(0,w.l)(f.oO.AdsenseRewarded):null]);e&&s&&(this.provider=s,yield le({querySelector:`.${C}`,interval:100,rejectTimeout:1500}),yield d.Z.post({type:"adv-fullscreen-block",action:"add-block",data:{blockName:this.serviceName},timeout:pe.WT})),t&&a&&(this.rewardedProvider=a),this.onServiceLoaded()}catch(e){this.onServiceError(e)}}))}getTimeoutExtraTime(e,t){switch(e){case ne.QA.ServiceInit:return 3*pe.WT;case ne.QA.ShowFullscreen:return 5*pe.yR}return super.getTimeoutExtraTime(e,t)}getAdvBlockId(e,t){switch(e){case ae.$.INTERSTITIAL:return this.isResponsive?this.slotId:this.clientId;case ae.$.REWARDED:return"adsense_rewarded"}return super.getAdvBlockId(e,t)}showFullscreenAdv(e){return me(this,arguments,(function*({adSeqId:e,callbacks:t,clickDaemon:s,depth:a,reason:r}){return new Promise(((n,i)=>me(this,null,(function*(){try{const{serviceName:o,isResponsive:l,clientId:c}=this,h=this.provider;if(!h)return void i(new Error("Adsense provider not loaded."));const u=this.getAdvBlockId(ae.$.INTERSTITIAL,r);let p,m="none",v=!1;l&&(yield d.Z.post({type:"adv-fullscreen-block",action:"show-block",data:{blockName:o},timeout:pe.WT}),yield d.Z.post({type:"adv-fullscreen-block",action:"show",data:{onClose:()=>{v&&(s instanceof ce.U||s.close(m,e),t.onClose(v)),p&&h.destroySlot(p)}}})),t.onOpen(!1),s instanceof ce.U?s.request({advBlockId:u}):m=s.request({advBlockId:u,advtype:this.serviceName,depth:a,reason:r}),se("Create slot",u,c,X(o)),p=yield h.createSlot({adFormat:"auto",blockId:u,clientId:c,divId:X(o),height:window.innerHeight-192,width:window.innerWidth-144});const{isEmpty:g,slot:w}=yield h.preloadSlot({slot:p});if(g)throw s instanceof ce.U?s.responseEmpty():s.response({adReqId:m,reason:he.Ud.EMPTY}),new A.lu("Slot is empty",{isEmpty:!0});s instanceof ce.U?s.response():s.response({adReqId:m,reason:he.Ud.SUCCESS}),v=!0,(0,T.Hr)(this.advManager.flags)&&d.Z.post({type:"adv-fullscreen-block",action:"slot-loaded",data:{blockName:o},timeout:pe.WT}),yield h.showSlot(w),s instanceof ce.U?s.show():(s.show(m,e),l||s.close(m,e)),l||t.onClose(!0),n()}catch(e){i(e)}}))))}))}showRewardedVideo({callbacks:e,clickDaemon:t,reason:s}){return new Promise(((a,r)=>me(this,null,(function*(){try{if(t instanceof ue.i)return void r(new Error("Invalid logger instance"));const{clientId:n,rewardedProvider:i}=this;if(!i)return void r(new Error("Provider not loaded."));const o=this.getAdvBlockId(ae.$.REWARDED,s);let d,l=!1;t.request({advBlockId:o}),se("Create rewarded slot",o,n),d=yield i.createSlot({blockId:o});const{isEmpty:c,slot:h}=yield i.preloadSlot({slot:d});if(c)throw t.responseEmpty(),new A.lu("Slot is empty",{isEmpty:!0});t.response(),a();const{waitForView:u}=yield i.showSlot(h);l=!0,e.onOpen(!0);const{isDismissed:p}=yield u;p||e.onRewarded(),e.onClose(l)}catch(e){r(e)}}))))}cancelShow(e){if(e===ae.$.INTERSTITIAL)d.Z.post({type:"adv-fullscreen-block",action:"hide",data:{blockName:this.serviceName}})}}var ge=s(14184),we=s(79049),fe=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));var ye=s(90380);const be=e=>{var t;return null!=(t=(0,T.RM)(e,ye.Z.advGoogleInstreamResponsiveContainer))&&t},ke="//imasdk.googleapis.com/js/sdkloader/ima3.js",Ae=[{width:1280,height:720},{width:854,height:480},{width:960,height:720},{width:640,height:480}],Ee=1e4;class Se{constructor(e,t){this.adsManager=e,this.adReqId=t,this.isComplete=!1,this.readyPromise=new g.Z,this.startedPromise=new g.Z,this.showPromise=new g.Z,this.onAdError=e=>{this.isComplete=!0,this.destroy(e)},this.onAdLoaded=()=>{this.readyPromise.resolve()},this.onAdStarted=()=>{this.startedPromise.resolve()},this.onAdComplete=()=>{this.isComplete||(this.isComplete=!0,this.showPromise.resolve())},this.destroy=e=>{this.readyPromise.reject(e),this.showPromise.reject(e),this.startedPromise.reject(e)},this.start=()=>{try{this.adsManager.start()}catch(e){return e}},this.adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError),this.adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,this.onAdLoaded),this.adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,this.onAdStarted),this.adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,this.onAdComplete),this.adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED,this.onAdComplete),this.readyPromise.promise.catch((()=>{})),this.startedPromise.promise.catch((()=>{})),this.showPromise.promise.catch((()=>{}))}}var Ie=s(65751),Pe=s(38096),Re=s(29483),Te=s(34711),Ce=s(31136);const De="https://pubads.g.doubleclick.net/gampad/ads?"+Object.entries({tfcd:0,sz:"640x360|640x480",gdfp_req:1,output:"vast",unviewed_position_start:1,env:"vp",vpos:"midroll",vad_type:"linear",max_ad_duration:5e4,vpa:"auto",vpmute:0,nofb:1,plcmt:1}).map((([e,t])=>`${e}=${encodeURIComponent(t)}`)).join("&"),Le=()=>{const{hostname:e}=(0,Pe.getDomainConfig)(),{hostname:t,pathname:s}=window.location;return`https://${t.replace(new RegExp(`(.+)(${(0,Re.h)(e)}.)`),"$2")}${s}`};function Oe(e){const t={appID:e},s=(0,Te.X)();return void 0!==s&&(t.clid=s),"&cust_params="+encodeURIComponent(Ie.stringify(t))}function xe(e){return(e=>De+"&"+Object.entries({iu:e,description_url:"https://yandex.com"}).map((([e,t])=>`${e}=${encodeURIComponent(t)}`)).join("&"))(e.blockId)+Oe(e.appID)}function _e(e){return(e=>De+"&"+Object.entries({iu:e,description_url:Le()}).map((([e,t])=>`${e}=${encodeURIComponent(t)}`)).join("&"))(e.blockId)+Oe(e.appID)}const Be=(e,t)=>{const s=(0,Ce.D)(e).then((()=>!0));return e=>{return a=void 0,r=null,n=function*(){(yield Promise.race([s,e]))&&t()},new Promise(((e,t)=>{var s=e=>{try{o(n.next(e))}catch(e){t(e)}},i=e=>{try{o(n.throw(e))}catch(e){t(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(s,i);o((n=n.apply(a,r)).next())}));var a,r,n}},Ne="adv-instream-render",Me=e=>({type:Ne,action:"show",data:e}),$e=e=>({type:Ne,action:"hide",data:e}),Fe=e=>({type:Ne,action:"get-size",data:e});var qe=s(27859),We=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const Ze=(0,te.M$)("GoogleInstreamPrerender",te.XG.Adv,{background:"#d486f2"});class Ge{constructor(e,t){this.service=e,this.adContainer=t,this.videoPlayer=document.createElement("video"),this.depth=0,this.createAdDisplayContainer=()=>{this.adDisplayContainer=new google.ima.AdDisplayContainer(this.adContainer,this.videoPlayer),this.adContainer.addEventListener("click",this.adContainerClick)},this.adContainerClick=()=>{this.adsManager&&this.adsManager.resume()},this.initAdsLoader=()=>{this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer),this.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onAdsManagerLoaded,!1),this.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError,!1)},this.onAdError=e=>{var t;const s=e.getError();Ze(s.getMessage()),(0,ge.fF)(s),null==(t=this.currentAdLoading)||t.reject(s),this.currentAdLoading=void 0,this.resetSDK()},this.resetSDK=()=>{var e,t,s;Ze("resetting sdk state"),null==(e=this.adsManager)||e.destroy(),null==(t=this.adsLoader)||t.contentComplete(),null==(s=this.adsLoader)||s.destroy(),this.initAdsLoader(),this.currentShow=void 0},this.onAdsManagerLoaded=e=>{var t;Ze("ad manager loaded");const s=new google.ima.AdsRenderingSettings;s.enablePreloading=!(0,T.Rb)(this.service.advManager.flags),this.adsManager=e.getAdsManager(this.videoPlayer,s),this.currentShow=new Se(this.adsManager,this.adReqId);const{width:a,height:r}=this.getRendererSize();this.adsManager.init(a,r,google.ima.ViewMode.NORMAL);this.service.advManager.getClickdaemonAdvLog(ae.$.INTERSTITIAL).response({adReqId:this.adReqId,depth:this.depth,reason:he.Ud.SUCCESS}),null==(t=this.currentAdLoading)||t.resolve(),this.currentAdLoading=void 0},this.setRendererSize=({width:e,height:t})=>{d.Z.post({type:"instream-fullscreen-render",action:"set-size",data:{width:e,height:t}})},this.getRendererSize=()=>{const e=this.isHeaderEnabled?-32:0,t=(qe.Z.isLandscape,e),s={width:window.innerWidth-4+0,height:window.innerHeight+t};return Ae.find((({width:e,height:t})=>e<=s.width&&t<=s.height))||s},this.onResizeHandler=()=>We(this,null,(function*(){var e;let t;if(this.isResponsiveContainer){t=(yield d.Z.post(Fe({tag:ae.$.INTERSTITIAL}))).data}else t=this.getRendererSize(),this.setRendererSize(t);null==(e=this.adsManager)||e.resize(t.width,t.height,google.ima.ViewMode.NORMAL)})),this.videoPlayer.setAttribute("playsinline","true"),this.isHeaderEnabled=!(0,A.Ij)(),this.isResponsiveContainer=be(e.advManager.flags),this.createAdDisplayContainer(),this.initAdsLoader(),this.setRendererSize(this.getRendererSize()),qe.Z.addChangeListener(this.onResizeHandler),window.addEventListener("resize",this.onResizeHandler)}prefetchAd(){var e;(0,T.Rb)(this.service.advManager.flags)||(this.loadAd(he.p_.PRELOAD),null==(e=this.currentAdLoading)||e.promise.catch((e=>{var t;Ze("prefetching failed");this.service.advManager.getClickdaemonAdvLog(ae.$.INTERSTITIAL).error(this.adReqId,this.adSeqId||"",(null==(t=null==e?void 0:e.getMessage)?void 0:t.call(e))||"")})))}loadAd(e){if(Ze(`asked to load an ad for ${e}`),this.currentAdLoading||this.currentShow)return;const t=new google.ima.AdsRequest,{advManager:s}=this.service,a=this.service.getAdvBlockId();!1===(0,T.RM)(this.service.advManager.flags,ye.Z.advDevInstreamDynamicPageUrl)?(t.adTagUrl=xe({appID:s.appId,blockId:a}),t.pageUrl="https://yandex.com/games"):(t.adTagUrl=_e({appID:s.appId,blockId:a}),t.pageUrl=Le());const r=this.getRendererSize();t.linearAdSlotWidth=r.width,t.linearAdSlotHeight=r.height,t.nonLinearAdSlotWidth=r.width,t.nonLinearAdSlotHeight=r.height,t.forceNonLinearFullSlot=!0;const n=s.getClickdaemonAdvLog(ae.$.INTERSTITIAL);this.adReqId=n.request({advBlockId:a,advtype:ae.e.GoogleInstream,depth:this.depth,reason:e}),this.currentAdLoading=new g.Z,this.adsLoader.requestAds(t)}getAdToShow(e,t){return We(this,null,(function*(){if(Ze("got call to show ads"),this.adSeqId=e,this.depth=t,this.currentShow||(this.currentAdLoading?Ze("ad is already loading, waiting for it"):(Ze("dont have any ad ready, trying to load it"),this.loadAd(he.p_.ONSPOT)),yield this.currentAdLoading.promise),this.adDisplayContainer.initialize(),Ze("ad display container initialized!"),!this.currentShow)throw new Error("there is no current show, that should not happen");Ze("ad data is ready, returning");const s=this.currentShow;return{showPromise:s.showPromise.promise.finally((()=>{this.resetSDK(),this.prefetchAd()})).catch((()=>{})),adReqId:s.adReqId,readyPromise:s.readyPromise.promise,startedPromise:s.startedPromise.promise,destroy:()=>s.destroy(),startAd:()=>{const e=s.start();if(e)throw Ze("error starting an ad"),(0,ge.fF)(e),s.destroy(),e}}}))}}var Ue=s(46210);function He({fullUrl:e}){const t=(0,Ue.Qs)(e);return t?(0,Ue.d2)(t):ke}var je=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const ze=(0,te.M$)("GoogleInstream",te.XG.Adv,{background:"#d486f2"});var Ve=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));class Ke{constructor(e,t){this.service=e,this.tag=t,this.imaAdsManager=null,this.waitForPreload=void 0,this.onImaAdsLoaderLoaded=null,this.onImaAdsLoaderError=null,this.debugLog=(0,te.M$)("GoogleInstreamPrerender",[te.XG.Adv,this.tag],{background:"#d486f2"}),this.onResizeHandler=()=>Ve(this,null,(function*(){var e;const{width:t,height:s}=yield this.getRendererSize();null==(e=this.imaAdsManager)||e.resize(t,s,google.ima.ViewMode.NORMAL)})),this.preload=e=>Ve(this,[e],(function*({advLogger:e=new ce.U({app_id:this.service.advManager.appId,tag:this.tag}),reason:t=he.p_.PRELOAD,depth:s=0}){var a,r;if(this.waitForPreload)return this.waitForPreload.promise;this.debugLog(`preload called (reason: ${t})`),e||(e=this.service.advManager.alternateLogs?new ce.U({app_id:this.service.advManager.appId,tag:this.tag}):this.service.advManager.getClickdaemonAdvLog(this.tag));const n=this.service.getAdvBlockId(this.tag,t),i=null!=(a=e.request({advBlockId:n,advtype:this.service.serviceName,provider:this.service.serviceName,depth:s,reason:t}))?a:"",o=new g.Z;this.waitForPreload=o;try{const a=new g.Z;o.promise.catch((()=>{this.debugLog("Resolve show promise due preload's promise rejection"),a.resolve()}));const{height:d,width:l}=yield this.getRendererSize(),c=new google.ima.AdsRequest;c.linearAdSlotWidth=c.nonLinearAdSlotWidth=l,c.linearAdSlotHeight=c.nonLinearAdSlotHeight=d,c.forceNonLinearFullSlot=!0,!1===(0,T.RM)(this.service.advManager.flags,ye.Z.advDevInstreamDynamicPageUrl)?(c.adTagUrl=xe({appID:this.service.advManager.appId,blockId:n}),c.pageUrl="https://yandex.com/games"):(c.adTagUrl=_e({appID:this.service.advManager.appId,blockId:n}),c.pageUrl=Le()),this.onImaAdsLoaderLoaded=t=>Ve(this,null,(function*(){var r;this.debugLog("preload response received",t);const n=new google.ima.AdsRenderingSettings,d=t.getAdsManager({currentTime:0,duration:0},n);d.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>{const t=e.getError(),s=new Error(`${t.getMessage()} [${t.getType()}]`);(0,A.g5)(this.service,{error:s}),o.state===g.C.Pending?o.reject(s):a.reject(s)})),d.addEventListener(google.ima.AdEvent.Type.LOADED,(t=>{this.debugLog("preload adv loaded (ready for playing)",t),o.resolve({adReqId:i,isEmpty:!1,advLogger:e,show:()=>(this.debugLog("show called"),d.start(),a.promise)})})),d.addEventListener(google.ima.AdEvent.Type.STARTED,(e=>{this.debugLog("adv started (video playing)",e)})),d.addEventListener(google.ima.AdEvent.Type.SKIPPED,(e=>{this.debugLog("adv skipped (clicked close button)",e)})),d.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(e=>{this.debugLog("adv finished (closed)",e),a.resolve()})),this.imaAdsManager=d,e instanceof ce.U?e.response():null==e||e.response({adReqId:i,depth:s,reason:he.Ud.SUCCESS}),this.imaDisplayContainer.initialize();const{height:l,width:c}=yield this.getRendererSize();this.debugLog(`rendererSize height: ${l}, width: ${c}`),null==(r=this.imaAdsManager)||r.init(c,l,google.ima.ViewMode.NORMAL)})),this.onImaAdsLoaderError=a=>{var r;null==(r=this.imaAdsManager)||r.destroy();const n=a.getError(),d=`${n.getMessage()} [${n.getType()}]`;if(this.debugLog("preload load error",d),n.getErrorCode()===google.ima.AdError.ErrorCode.VAST_NO_ADS_AFTER_WRAPPER)return e instanceof ce.U?e.responseEmpty():null==e||e.response({adReqId:i,depth:s,reason:he.Ud.EMPTY}),void o.resolve({adReqId:i,isEmpty:!0,advLogger:e});t===he.p_.PRELOAD&&(e instanceof ce.U?null==e||e.error(d):e.error(i,"",d)),o.reject(new Error(d))},null==(r=this.imaAdsLoader)||r.requestAds(c)}catch(e){o.reject(e)}return o.promise})),this.getRendererSize=()=>Ve(this,null,(function*(){const e=yield d.Z.post(Fe({tag:this.tag})),{data:{width:t,height:s}}=e;const a=(0,A.Ij)()?0:32,r={width:window.innerWidth,height:window.innerHeight-a};return Ae.find((({width:e,height:t})=>e<=r.width&&t<=r.height))||r})),this.debugLog("init"),this.videoElement=document.createElement("video"),this.videoElement.setAttribute("playsinline","true"),this.videoContainer=document.querySelector(`#advBlock_${ae.e.GoogleInstream}_${this.tag}`),this.videoContainer.addEventListener("click",(()=>{var e;try{null==(e=this.imaAdsManager)||e.resume()}catch(e){this.debugLog("videoContainer click resume error",e)}})),this.imaDisplayContainer=new google.ima.AdDisplayContainer(this.videoContainer,this.videoElement),this.imaAdsLoader=new google.ima.AdsLoader(this.imaDisplayContainer),this.imaAdsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(e=>{var t;return null==(t=this.onImaAdsLoaderLoaded)?void 0:t.call(this,e)}),!1),this.imaAdsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>{var t;return null==(t=this.onImaAdsLoaderError)?void 0:t.call(this,e)}),!1),qe.Z.addChangeListener(this.onResizeHandler),window.addEventListener("resize",this.onResizeHandler)}clear(){var e,t;null==(e=this.imaAdsManager)||e.destroy(),null==(t=this.waitForPreload)||t.resolve({adReqId:"",advLogger:void 0,isEmpty:!0}),delete this.waitForPreload}}var Ye=s(59886),Xe=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const Je=(0,te.M$)("GoogleInstream",te.XG.Adv,{background:"#d486f2"});const Qe="undefined"!=typeof document&&(0,m.vV)(window.appData.abt.flags)?class extends de{constructor(e,t){super(e,t,ae.e.GoogleInstream,{initDelayMs:{[ae.$.INTERSTITIAL]:Ee,[ae.$.REWARDED]:Ee}}),this.showFullscreenAdv=e=>Xe(this,[e],(function*({adSeqId:e,callbacks:t,clickDaemon:s,depth:a,reason:r,tag:n}){return new Promise(((i,o)=>Xe(this,null,(function*(){try{if(!this.interstitialPreload)throw new Error(`No ${n} preload created.`);const{adReqId:o,advLogger:l,isEmpty:c,show:h}=yield this.interstitialPreload.preload({advLogger:s,reason:r,depth:a});let u=this.lastAdReqId[ae.$.REWARDED]=null!=o?o:"";if(s instanceof ce.U&&l instanceof ce.U&&s.bindRequest(l),c||!h)throw new A.lu(Ye.XO.INSTREAM_EMPTY,{isEmpty:!0});i((()=>Xe(this,null,(function*(){s instanceof ue.i&&s.show(u,e),t.onOpen(!0),d.Z.post(Me({tag:ae.$.INTERSTITIAL})),yield h(),s instanceof ue.i&&s.close(u,e),t.onClose(!0)}))))}catch(e){o(e)}}))))})),this.showRewardedVideo=e=>Xe(this,[e],(function*({adSeqId:e,callbacks:t,clickDaemon:s,depth:a,reason:r,tag:n}){return new Promise(((i,o)=>Xe(this,null,(function*(){try{if(!this.rewardedPreload)throw new Error(`No ${n} preload created.`);const{adReqId:o,advLogger:l,isEmpty:c,show:h}=yield this.rewardedPreload.preload({advLogger:s,reason:r,depth:a});let u=this.lastAdReqId[ae.$.REWARDED]=null!=o?o:"";if(s instanceof ce.U&&l instanceof ce.U&&s.bindRequest(l),c||!h)throw new A.lu(Ye.XO.INSTREAM_EMPTY,{isEmpty:!0});i((()=>Xe(this,null,(function*(){s instanceof ue.i&&s.show(u,e),t.onOpen(!0),d.Z.post(Me({tag:ae.$.REWARDED})),yield h(),s instanceof ue.i&&s.rewarded(u,e),t.onRewarded(),s instanceof ue.i&&s.close(u,e),t.onClose(!0)}))))}catch(e){o(e)}}))))})),this.init()}getAdvBlockId(e,t){var s,a,r;return null!=(r=e===ae.$.REWARDED?null==(s=this.advManager.allAdvBlocks.instream)?void 0:s.rewarded:null==(a=this.advManager.allAdvBlocks.instream)?void 0:a.interstitial)?r:""}init(){return Xe(this,null,(function*(){try{yield(0,we.x)({id:"ima",src:ke}),google.ima.settings.setLocale(this.advManager.lang),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),this.isTagActive(ae.$.INTERSTITIAL)&&(yield le({querySelector:`#advBlock_${ae.e.GoogleInstream}_${ae.$.INTERSTITIAL}`,interval:100,rejectTimeout:1500}),this.interstitialPreload=new Ke(this,ae.$.INTERSTITIAL),(0,T.Rb)(this.advManager.flags)||this.interstitialPreload.preload({}).catch((e=>(0,A.g5)(this,{error:e})))),this.isTagActive(ae.$.REWARDED)&&(yield le({querySelector:`#advBlock_${ae.e.GoogleInstream}_${ae.$.REWARDED}`,interval:100,rejectTimeout:1500}),this.rewardedPreload=new Ke(this,ae.$.REWARDED),this.rewardedPreload.preload({}).catch((e=>(0,A.g5)(this,{error:e})))),this.onServiceLoaded()}catch(e){Je(e),this.onServiceError(e)}}))}onShowAdvFinished({tag:e}){var t,s;switch(this.cancelShow(e),e){case ae.$.INTERSTITIAL:(0,T.Rb)(this.advManager.flags)||null==(t=this.interstitialPreload)||t.preload({}).catch((e=>(0,A.g5)(this,{error:e,tag:ae.$.INTERSTITIAL})));break;case ae.$.REWARDED:null==(s=this.rewardedPreload)||s.preload({}).catch((e=>(0,A.g5)(this,{error:e,tag:ae.$.REWARDED})))}}cancelShow(e){var t,s;switch(d.Z.post($e({tag:e})),e){case ae.$.INTERSTITIAL:null==(t=this.interstitialPreload)||t.clear();break;case ae.$.REWARDED:null==(s=this.rewardedPreload)||s.clear()}}}:class extends de{constructor(e,t){super(e,t,ae.e.GoogleInstream,{initDelayMs:{[ae.$.INTERSTITIAL]:Ee,[ae.$.REWARDED]:Ee}}),this.allScriptsInited=new g.Z,this.allScriptsInited.promise.catch((()=>{})),this.init()}getAdvBlockId(){var e,t;return null!=(t=null==(e=this.advManager.allAdvBlocks.instream)?void 0:e.interstitial)?t:""}init(){return je(this,null,(function*(){try{let e;if(yield(0,we.x)({id:"ima",src:He({fullUrl:window.location.href})}),be(this.advManager.flags))e="advBlock_"+ae.e.GoogleInstream+"_"+ae.$.INTERSTITIAL;else{const{data:t}=yield d.Z.post({action:"update-block-id",data:{blockId:"advBlock_"+ae.e.GoogleInstream},type:"instream-fullscreen-render",timeout:1e3});e=t.blockId}const t=yield le({querySelector:`#${e}`,interval:100,rejectTimeout:1500});google.ima.settings.setLocale(this.advManager.lang),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),this.adContainer=t,this.adPrerender=new Ge(this,this.adContainer),this.adPrerender.prefetchAd(),this.allScriptsInited.resolve(),this.onServiceLoaded()}catch(e){ze(e),(0,ge.fF)(e),this.allScriptsInited.reject(),this.onServiceError()}}))}showFullscreenAdv({callbacks:e,clickDaemon:t,adSeqId:s,depth:a}){return new Promise(((r,n)=>je(this,null,(function*(){var i;let o;try{yield this.allScriptsInited.promise,o=yield this.adPrerender.getAdToShow(s,a)}catch(e){return void n()}try{const{startAd:a,destroy:n,adReqId:l,showPromise:c,readyPromise:h,startedPromise:u}=o;this.lastAdReqId.interstitial=l;const p=Be(7e3,(()=>{throw ze("Timer cutoff!"),n(),new Error("Video ad cutoff by timer")}));ze("waiting for ad to be ready"),yield p(h),ze("ad ready, playing");let m=!1;c.then((()=>{t instanceof ue.i&&t.close(l,s)})).catch((()=>{})).finally((()=>{var t;null==(t=e.onClose)||t.call(e,m),be(this.advManager.flags)?d.Z.post($e({tag:ae.$.INTERSTITIAL})):d.Z.post({type:"instream-fullscreen-render",action:"hide"})})),ze("calling manager to start ad"),a(),t instanceof ue.i&&t.show(l,s),be(this.advManager.flags)?d.Z.post(Me({tag:ae.$.INTERSTITIAL})):d.Z.post({type:"instream-fullscreen-render",action:"show"}),null==(i=e.onOpen)||i.call(e),m=!0,ze("waiting for playback to start"),yield p(u),r(),ze("ad playback started"),yield c}catch(e){n(e)}}))))}showRewardedVideo(){return je(this,null,(function*(){return Promise.reject(new Error("Not implemented exception!"))}))}},et=(0,te.M$)("GoogleManual",te.XG.Adv,{background:"#0c6c09"});var tt=s(33755),st=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));class at{constructor(e){this.service=e,this.waitForSlotReady=void 0,this.gptCallbacks={},(0,tt.bT)((e=>{const t=e.pubads();["slotRenderEnded","gameManualInterstitialSlotReady","gameManualInterstitialSlotClosed"].forEach((e=>{t.addEventListener(e,(t=>{var s,a;t.slot===this.slot&&(null==(a=(s=this.gptCallbacks)[e])||a.call(s,t))}))}))}))}defineSlot(){return st(this,null,(function*(){return(0,tt.bT)((e=>{const t=e.defineOutOfPageSlot(this.service.getAdvBlockId(ae.$.INTERSTITIAL),e.enums.OutOfPageFormat.GAME_MANUAL_INTERSTITIAL);if(!t)throw new Error("Failed to create googletag.Slot.");return t.addService(e.pubads()),this.slot=t,e.enableServices(),t}))}))}preload(){return st(this,arguments,(function*({reason:e=he.p_.PRELOAD,depth:t,clickDaemon:s}={}){if(this.waitForSlotReady)return this.waitForSlotReady.promise;et.spoiler(this)("Preload interstitial slot");const a=new g.Z;try{this.waitForSlotReady=a,s||(s=this.service.advManager.alternateLogs?new ce.U({app_id:this.service.advManager.appId,tag:ae.$.INTERSTITIAL}):this.service.advManager.getClickdaemonAdvLog(ae.$.INTERSTITIAL));let r="";s instanceof ue.i?r=null==s?void 0:s.request({advtype:this.service.serviceName,advBlockId:this.service.getAdvBlockId(ae.$.INTERSTITIAL),reason:e}):null==s||s.request({provider:this.service.serviceName,advBlockId:this.service.getAdvBlockId(ae.$.INTERSTITIAL),reason:e}),this.slot&&googletag.destroySlots([this.slot]),this.slot=yield this.defineSlot(),this.gptCallbacks.slotRenderEnded=e=>{if(e.isEmpty)return s instanceof ue.i?null==s||s.response({adReqId:r,depth:t,reason:he.Ud.EMPTY}):null==s||s.responseEmpty(),a.resolve({isEmpty:!0,adReqId:r,clickDaemon:s}),void delete this.waitForSlotReady;s instanceof ue.i?s.response({adReqId:r,depth:t,reason:he.Ud.SUCCESS}):null==s||s.response()};const n=new g.Z;this.gptCallbacks.gameManualInterstitialSlotReady=e=>{const{makeGameManualInterstitialVisible:t}=e;a.resolve({isEmpty:!1,adReqId:r,clickDaemon:s,waitForShow:()=>(t(),delete this.waitForSlotReady,n.promise)})},this.gptCallbacks.gameManualInterstitialSlotClosed=()=>{n.resolve()},googletag.pubads().refresh([this.slot])}catch(e){(0,A.g5)(this.service,{error:e})}return a.promise}))}show(){return st(this,null,(function*(){}))}cancel(){var e,t;et("Cancel preload promise"),null==(e=this.waitForSlotReady)||e.resolve({adReqId:"rejected",isEmpty:!1}),delete this.waitForSlotReady,this.slot&&(null==(t=googletag.destroySlots)||t.call(googletag,[this.slot]))}}var rt=s(78308),nt=s(37705),it=s(13377),ot=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));var dt=s(36529),lt=s(17254),ct=s(50042),ht=s(41811),ut=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const pt={[ht.y_.YANDEX]:{fullscreenBlockFlag:ye.Z.nativeFullscreenBlock,rewardedBlockFlag:ye.Z.nativeRewardedBlock},[ht.y_.APPODEAL]:{fullscreenBlockFlag:ye.Z.nativeAppodealFullscreenBlock,rewardedBlockFlag:ye.Z.nativeAppodealRewardedBlock},[ht.y_.APPLOVIN]:{fullscreenBlockFlag:ye.Z.nativeApplovinFullscreenBlock,rewardedBlockFlag:ye.Z.nativeApplovinRewardedBlock},[ht.y_.DEFAULT]:{fullscreenBlockFlag:ye.Z.nativeFullscreenBlock,rewardedBlockFlag:ye.Z.nativeRewardedBlock}};function mt(e){return ut(this,arguments,(function*({advBlocks:e,flags:t,residenceInfo:s}){var a,r,n,i;let o=ht.y_.DEFAULT,d=String(e.native_interstitial||""),l=String(e.native_rewarded||"");if(!Boolean(null==s?void 0:s.EU)){if((0,ct.zg)("22.1.2.848")&&(o=(0,T.di)(t,ye.Z.mediation)||o,d=(0,T.di)(t,ye.Z.nativeFullscreenBlock)||d,l=(0,T.di)(t,ye.Z.nativeRewardedBlock)||l,(0,T.sE)(t))){const e=null!=(n=yield null==(r=null==(a=window.yandex)?void 0:a.ads)?void 0:r.getLibraries())?n:[];o=1===e.length?e[0].name:ht.y_.DEFAULT;const s=pt[o];d=(0,T.di)(t,s.fullscreenBlockFlag)||d,l=(0,T.di)(t,s.rewardedBlockFlag)||l}(null==(i=window.clientMetadata)?void 0:i.isOnlyRsyaAd)&&(d=String(e.native_rsya_interstitial||""),l=String(e.native_rsya_rewarded||""),o=ht.y_.DEFAULT)}return{mediation:o,fullscreenBlock:d,rewardedBlock:l}}))}const vt="0",gt="R-V-5320861-1",wt="R-V-5356156-1";const ft=e=>e.split("-V-")[1].split("-")[0];function yt(e,t){return"string"==typeof e&&/R-V-[0-9]+-[0-9]/.test(e)?ft(e):(console.info(`[Native adv TV] Using fallback block ${t}`),ft(t))}var bt=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const kt=(0,te.M$)("NativeAdv",te.XG.Adv);function At(e){setTimeout((()=>function(e){return bt(this,arguments,(function*({advBlocks:e,flags:t,residenceInfo:s}){var a;const{mediation:r,fullscreenBlock:n}=yield mt({advBlocks:e,flags:t,residenceInfo:s}),i=new ue.i({tag:ae.$.INTERSTITIAL});kt(`Preload. mediation = ${r}, fullscreen = ${n}`);const o=i.request({advBlockId:n,advtype:ae.e.Native,reason:he.p_.PRELOAD});try{window.sessionStorage.setItem(ht.az,JSON.stringify(i.getRequestByAdReqId(o)))}catch(e){}const d=null==(a=window.yandex)?void 0:a.ads,l=()=>{i.response({adReqId:o,reason:he.Ud.NOT_IMPL})};let c;if((0,lt.x)()){const e=yt((0,T.Qx)(t)?n:void 0,gt);if(!d||!d.preloadInstreamAdv)return void l();c=d.preloadInstreamAdv(e,vt)}else{if(!d||!d.preloadFullscreenAdv)return void l();c=d.preloadFullscreenAdv(n,r)}c.then((()=>{i.response({adReqId:o,reason:he.Ud.SUCCESS})})).catch((e=>{i.response({adReqId:o,reason:`${he.Ud.ERROR}_${e.message}`}),console.error(e)}))}))}(e)),3e3)}var Et=s(7991),St=Object.defineProperty,It=Object.getOwnPropertySymbols,Pt=Object.prototype.hasOwnProperty,Rt=Object.prototype.propertyIsEnumerable,Tt=(e,t,s)=>t in e?St(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Ct=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const Dt=[];function Lt(e,t){return new Promise(((s,a)=>{Dt.push({type:e,operation:t,resolve:s,reject:a}),1===Dt.length&&function(){Ct(this,null,(function*(){for(;Dt.length>0;){const{operation:e,resolve:t,reject:s}=Dt[0];try{t(yield e())}catch(e){s(e)}Dt.splice(0,1)}}))}()}))}function Ot(e){let t;function s(){if(!t){const s=(0,Et.W5)();t=JSON.stringify(((e,t)=>{for(var s in t||(t={}))Pt.call(t,s)&&Tt(e,s,t[s]);if(It)for(var s of It(t))Rt.call(t,s)&&Tt(e,s,t[s]);return e})({app_id:e.appId,clid:(0,Te.X)()},s?{gclid:s}:{}))}return t}const a=window.appData.isGamesLiteApp;let r=null;function n(){return Ct(this,null,(function*(){return null===r&&(r=yield mt({advBlocks:e.advBlocks,flags:e.flags,residenceInfo:e.residenceInfo})),r}))}return{getFullscreenBlockId(){return Ct(this,null,(function*(){const{fullscreenBlock:e}=yield n();return e}))},getRewardedBlockId(){return Ct(this,null,(function*(){const{rewardedBlock:e}=yield n();return e}))},preloadFullscreenAdv(){return Ct(this,null,(function*(){const{mediation:e,fullscreenBlock:t}=yield n();if(console.info("[Native adv] preload",e,"fullscreen ad:",t),!t)return Promise.reject(new Error("No fullscreen block for preload"));const s=()=>{var s,a,r;return null==(r=null==(a=null==(s=window.yandex)?void 0:s.ads)?void 0:a.preloadFullscreenAdv)?void 0:r.call(a,t,e)};return a?s():Lt("preload",s)}))},preloadRewardedVideo(){return Ct(this,null,(function*(){const{mediation:e,rewardedBlock:t}=yield n();if(console.info("[Native adv] preload",e,"rewarded video:",t),!t)return Promise.reject(new Error("No rewarded block for preload"));const s=()=>{var s,a,r;return null==(r=null==(a=null==(s=window.yandex)?void 0:s.ads)?void 0:a.preloadRewardedVideo)?void 0:r.call(a,t,e)};return a?s():Lt("preload",s)}))},showFullscreenAdv(e){return Ct(this,arguments,(function*({onShowCalled:e}){const{mediation:t,fullscreenBlock:r}=yield n(),i=s();if(console.info("[Native adv] show",t,"fullscreen ad:",r,i),!r)return Promise.reject(new Error("No fullscreen block for show"));const o=()=>{var s,a,n,o,d;return(null==(a=null==(s=window.yandex)?void 0:s.ads)?void 0:a.showFullscreenAdv)&&e(),null==(d=null==(o=null==(n=window.yandex)?void 0:n.ads)?void 0:o.showFullscreenAdv)?void 0:d.call(o,r,t,{revenueData:i})};return a?o():Lt("show",o)}))},showRewardedVideo(e){return Ct(this,arguments,(function*({onShowCalled:e}){const{mediation:t,rewardedBlock:r}=yield n(),i=s();if(console.info("[Native adv] show",t,"rewarded video:",r,i),!r)return Promise.reject(new Error("No rewarded block for show"));const o=()=>{var s,a,n,o,d;return(null==(a=null==(s=window.yandex)?void 0:s.ads)?void 0:a.showRewardedVideo)&&e(),null==(d=null==(o=null==(n=window.yandex)?void 0:n.ads)?void 0:o.showRewardedVideo)?void 0:d.call(o,r,t,{revenueData:i})};return a?o():Lt("show",o)}))}}}var xt=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));var _t=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const Bt="Ad request completed successfully, but there are no ads available",Nt=3*pe.WT,Mt=3*pe.WT;var $t=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const Ft=(0,te.M$)("AdvPromo",void 0,{background:"#0c6c09"});class qt extends de{constructor(e,t,s=ae.e.Promo){super(e,t,s),this.lang=e.context.playPageData.request.lang,this.onServiceLoaded()}getAdvBlockId(e,t){return"onboarding_promo"}showFullscreenAdv(e){return $t(this,arguments,(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:a,depth:r}){return new Promise(((n,i)=>$t(this,null,(function*(){Ft.spoiler(a,r)("showFullscreenAdv",e);const o=this.lastAdReqId[ae.$.INTERSTITIAL]=t instanceof ue.i?t.request({advtype:this.serviceName,depth:r,advBlockId:this.getAdvBlockId(ae.$.INTERSTITIAL,a),reason:a}):"";t instanceof ce.U&&t.request(),d.Z.post({type:"adv-promo-block",action:"show",data:{advTag:ae.$.INTERSTITIAL,reason:a,onError:e=>{"Promo chunk wasnt loaded"===e.message?(t instanceof ue.i?t.error(o,s,e.message):t.error(e.message),n()):i(new Error(`PromoBlock error ${e.message}`))},onOpen:()=>{t.response({adReqId:o,depth:r,reason:he.Ud.SUCCESS}),t instanceof ue.i&&t.show(o,s),e.onOpen(),n()},onClose:()=>{t instanceof ue.i&&t.close(o,s),e.onClose()}}})}))))}))}showRewardedVideo(e){return $t(this,arguments,(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:a,depth:r}){return new Promise(((n,i)=>$t(this,null,(function*(){Ft("showRewardedVideo",e);const o=this.lastAdReqId[ae.$.REWARDED]=t instanceof ue.i?t.request({advtype:this.serviceName,depth:r,advBlockId:this.getAdvBlockId(ae.$.REWARDED,a),reason:a}):"";t instanceof ce.U&&t.request(),d.Z.post({type:"adv-promo-block",action:"show",data:{advTag:ae.$.REWARDED,onError:e=>{i(new Error(`PromoBlock error ${e.message}`))},onOpen:()=>{t.response({adReqId:o,depth:r,reason:he.Ud.SUCCESS}),t instanceof ue.i&&t.show(o,s),e.onOpen(),n()},onRewarded:()=>{t instanceof ue.i&&t.rewarded(o,s),e.onRewarded()},onClose:()=>{t instanceof ue.i&&t.close(o,s),e.onClose()}}})}))))}))}}var Wt=s(29011);var Zt=s(23404);const Gt="GameEvents";class Ut{constructor(){this.listeners=[],window.addEventListener("message",(e=>{e.data.source===Gt&&this.processEvent(e)}))}addListener(e){return this.listeners.push(e),()=>{this.removeListener(e)}}removeListener(e){this.listeners=this.listeners.filter((t=>t!==e))}processEvent(e){const{responseToId:t}=e.data;for(let s of this.listeners)if(!s.messageId||s.messageId===t){s.fn(e.data)&&this.removeListener(s)}}}function Ht({action:e,payload:t,responseToId:s,type:a}){const r=`${Date.now()}-${Math.random()}`;return window.parent.postMessage({action:e,id:r,payload:t,responseToId:s,source:Gt,type:a,ver:1},"*"),r}var jt=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const zt=(0,te.M$)("AdvParentWindow",void 0,{background:"#0c6c09"});var Vt=s(26667);function Kt(){const e=document.querySelector(`#${K}`);e&&(e.innerText="")}const Yt=(0,te.M$)("AdvPrebidTGO",te.XG.Adv,{background:"#0c6c09"});var Xt=s(25562),Jt=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));class Qt{constructor(e){var t,s;this.service=e,this.waitForSlotReady=void 0,this.retries=0,this.waitForSlotViewable=void 0,this.retries=(t=e.advManager.flags,null!=(s=(0,T.$9)(t,ye.Z.advGoogleInterstitialRetries))?s:2),(0,tt.bT)((e=>{e.pubads().addEventListener("slotRenderEnded",(e=>{var t;e.slot===this.slot&&(null==(t=this.onSlotRenderEnded)||t.call(this,e))})).addEventListener("impressionViewable",(e=>{var t;e.slot===this.slot&&(null==(t=this.onImpressionViewable)||t.call(this,e))}))}))}defineSlot(e){return(0,tt.bT)((t=>{const s=(0,Xt.iv)(this.service.advManager.flags);Yt(`defineSlot. filteredSizes=[${s.join(",")}]`);const a=t.defineSlot(this.service.getAdvBlockId(ae.$.INTERSTITIAL,e),s,X(this.service.serviceName));if(!a)throw new Error(Ye.XO.NO_SLOT);return a.addService(t.pubads()),a.retry=0,t.enableServices(),a}))}preload(e){return Jt(this,arguments,(function*({reason:e=he.p_.PRELOAD,depth:t,clickDaemon:s,beforeRequest:a}){let r=this.retries;if(void 0!==t&&(this.waitForSlotReady&&this.slot&&(Yt.tag("Retry")("Skip retry, due showAdv call"),this.slot.retry=1/0),r=0),this.waitForSlotReady)return this.waitForSlotReady.promise;void 0===t&&(t=0),Yt.spoiler(this)("Preload interstitial slot");const n=new g.Z;this.waitForSlotReady=n;const i=new g.Z;this.waitForSlotViewable=i,this.slot?this.slot.retry=0:(yield d.Z.post({type:"adv-fullscreen-block",action:"add-block",data:{blockName:this.service.serviceName},timeout:pe.WT}),this.slot=yield this.defineSlot(e)),a&&(yield a()),s||(s=this.service.advManager.alternateLogs?new ce.U({app_id:this.service.advManager.appId,tag:ae.$.INTERSTITIAL}):this.service.advManager.getClickdaemonAdvLog(ae.$.INTERSTITIAL));let o="";return s instanceof ue.i?o=s.request({advtype:this.service.serviceName,advBlockId:this.service.getAdvBlockId(ae.$.INTERSTITIAL,e),reason:e}):s&&s.request({provider:this.service.serviceName,advBlockId:this.service.getAdvBlockId(ae.$.INTERSTITIAL,e),reason:e}),this.onSlotRenderEnded=a=>{if(n.state===g.C.Pending)if(a.isEmpty){if(s instanceof ue.i?null==s||s.response({adReqId:o,depth:t,reason:he.Ud.EMPTY}):null==s||s.responseEmpty(),a.slot.retry<r)return Yt.tag("Retry")(`Retrying request, ${a.slot.retry+1} of ${this.retries}`),s instanceof ue.i?o=s.request({advtype:this.service.serviceName,advBlockId:this.service.getAdvBlockId(ae.$.INTERSTITIAL,e),reason:e}):null==s||s.request({provider:this.service.serviceName,advBlockId:this.service.getAdvBlockId(ae.$.INTERSTITIAL,e),reason:e}),a.slot.retry++,void googletag.pubads().refresh([this.slot]);n.resolve({isEmpty:!0,adReqId:o,clickDaemon:s}),delete this.waitForSlotReady,delete this.waitForSlotViewable}else null==s||s.response({adReqId:o,depth:t,reason:he.Ud.SUCCESS}),n.resolve({isEmpty:!1,adReqId:o,clickDaemon:s});else Yt("Ignore slot response, preload canceled.")},this.onImpressionViewable=()=>{i.resolve()},googletag.pubads().refresh([this.slot]),this.waitForSlotReady.promise}))}show(){return Jt(this,null,(function*(){if(!this.waitForSlotViewable)throw new Error("Call Preload.show() before preload()");Yt.spoiler(this)("Show interstitial slot"),yield d.Z.post({type:"adv-fullscreen-block",action:"show-block",data:{blockName:this.service.serviceName}}),yield this.waitForSlotViewable.promise,delete this.waitForSlotReady,delete this.waitForSlotViewable}))}cancel(){var e,t;Yt("Cancel preload promises"),null==(e=this.waitForSlotReady)||e.resolve({adReqId:"rejected",isEmpty:!1,clickDaemon:null}),null==(t=this.waitForSlotViewable)||t.resolve(),delete this.waitForSlotReady,delete this.waitForSlotViewable}}var es=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const ts={slotRenderEnded:"onSlotRenderEnded",rewardedSlotReady:"onRewardedSlotReady",rewardedSlotGranted:"onRewardedSlotGranted",rewardedSlotClosed:"onRewardedSlotClosed"};class ss{constructor(e){var t,s;this.service=e,this.slot=void 0,this.waitForSlotReady=void 0,this.retries=(t=this.service.advManager.flags,null!=(s=(0,T.$9)(t,ye.Z.advGoogleRewardedRetries))?s:0),(0,tt.bT)((()=>{const e=googletag.pubads();for(const t in ts)e.addEventListener(t,(e=>{var s;const{slot:a}=e;a===this.slot&&(null==(s=this[ts[t]])||s.call(this,e))}))})),qe.Z.addChangeListener((()=>{var e;null==(e=this.onOrientationChange)||e.call(this)}))}defineSlot({retry:e}){return(0,tt.bT)((()=>{const t=googletag.defineOutOfPageSlot(this.service.getAdvBlockId(ae.$.REWARDED),googletag.enums.OutOfPageFormat.REWARDED);if(!t)throw new Error(Ye.XO.NO_SLOT);return t.addService(googletag.pubads()),t.retry=e,t}))}preload(){return es(this,arguments,(function*({depth:e,clickDaemon:t,reason:s=he.p_.PRELOAD}={}){var a;if(this.waitForSlotReady)return this.retries&&this.slot&&void 0!==e&&(Yt.tag(["Retry","Rewarded"])("Skip retry, due showAdv call"),this.slot.retry=0),this.waitForSlotReady.promise;Yt.spoiler(this)("Preload rewarded slot");const r=new g.Z;this.waitForSlotReady=r;const n=new g.Z;let i,o=!1,d=!1;try{t||(t=this.service.advManager.alternateLogs?new ce.U({app_id:this.service.advManager.appId,tag:ae.$.REWARDED}):this.service.advManager.getClickdaemonAdvLog(ae.$.REWARDED)),this.slot&&googletag.destroySlots([this.slot]),this.slot=yield this.defineSlot({retry:void 0===e?this.retries:0}),void 0===e&&(e=0);let l=null!=(a=t.request({advBlockId:this.service.getAdvBlockId(ae.$.REWARDED,s),advtype:this.service.serviceName,provider:this.service.serviceName,depth:e,reason:s}))?a:"";const c=(a=0)=>es(this,null,(function*(){var r;this.slot&&googletag.destroySlots([this.slot]),this.slot=yield this.defineSlot({retry:a}),l=null!=(r=null==t?void 0:t.request({advBlockId:this.service.getAdvBlockId(ae.$.REWARDED,s),advtype:this.service.serviceName,depth:e,reason:s}))?r:"",googletag.pubads().refresh([this.slot])}));this.onOrientationChange=()=>{if(Yt.spoiler("orientationChange",d),o&&d&&this.slot)return googletag.destroySlots([this.slot]),n.resolve({wasShown:!0}),void delete this.waitForSlotReady;delete this.waitForSlotReady,c(0)},this.onSlotRenderEnded=s=>{if(s.isEmpty)return t instanceof ce.U?t.responseEmpty():null==t||t.response({adReqId:l,depth:e,reason:he.Ud.EMPTY}),this.retries&&s.slot.retry?(Yt.tag(["Retry","Interstitial"])(`Retrying request, ${this.retries-s.slot.retry+1} of ${this.retries}`),void c(s.slot.retry-1)):(r.resolve({adReqId:l,clickDaemon:t,isEmpty:!0}),delete this.waitForSlotReady,void(o&&n.resolve({wasShown:!0})));t instanceof ce.U?t.response():null==t||t.response({adReqId:l,depth:e,reason:he.Ud.SUCCESS})},this.onRewardedSlotReady=e=>{o?e.makeRewardedVisible():r.resolve({isEmpty:!1,adReqId:l,clickDaemon:t,waitForShow:t=>(i=t,o=!0,e.makeRewardedVisible(),n.promise)})},this.onRewardedSlotGranted=()=>{var e;null==(e=null==i?void 0:i.onRewarded)||e.call(i),d=!0},this.onRewardedSlotClosed=()=>{n.resolve({wasShown:!0}),delete this.waitForSlotReady},googletag.pubads().refresh([this.slot])}catch(e){(0,A.g5)(this.service,{error:e})}return this.waitForSlotReady.promise}))}show(){return es(this,null,(function*(){}))}cancel(){var e,t;Yt("Cancel rewarded preload"),null==(e=this.waitForSlotReady)||e.resolve({adReqId:"canceled",isEmpty:!1}),delete this.waitForSlotReady,this.slot&&(null==(t=googletag.destroySlots)||t.call(googletag,[this.slot]))}}var as=s(58098),rs=s(78569),ns=s(74762),is=s(89592),os=Object.defineProperty,ds=Object.defineProperties,ls=Object.getOwnPropertyDescriptors,cs=Object.getOwnPropertySymbols,hs=Object.prototype.hasOwnProperty,us=Object.prototype.propertyIsEnumerable,ps=(e,t,s)=>t in e?os(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,ms=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const vs="ca-pub-7899932632484219";var gs=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));var ws=s(26256);const fs={modal:"modal",rewardedVideo:"rewarded_video",modalVisible:"modal_visible",modalVisiblePreroll:"modal_visible_preroll",modalMedia:"modal__media",modalClose:"modal__close",modalBottom:"modal__bottom",modalButton:"modal__button",modalButtonClose:"modal__button_close",modalButtonDisableAdv:"modal__button_disable_adv",fullscreenButtonTop:"fullscreen_button_top",modalAdvCountdown:"modal__advCountdown",modalAdvCountdownCircle:"modal__advCountdownCircle",modalContent:"modal_content",modalContentOld:"modal__content_old",mobileCloseButton:"mobile_close_button",modalRewarded:"modal__rewarded",modalDesktopCountdown:"modal__desktop_countdown",modalWrap:"modal__wrap",modalContentSearchApplication:"modal__content_search-application",modalCloseSearchApplication:"modal__close_search-application",yandexAdaptive:"yandex-adaptive",withNativeClose:"with-native-close"},ys=20;var bs=s(91605),ks=s(76958),As=Object.defineProperty,Es=Object.getOwnPropertySymbols,Ss=Object.prototype.hasOwnProperty,Is=Object.prototype.propertyIsEnumerable,Ps=(e,t,s)=>t in e?As(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Rs=(e,t)=>{for(var s in t||(t={}))Ss.call(t,s)&&Ps(e,s,t[s]);if(Es)for(var s of Es(t))Is.call(t,s)&&Ps(e,s,t[s]);return e};const Ts=(0,te.M$)("YandexAdv",[te.XG.Adv],{background:"#d7bc29"});function Cs(){return Object.keys(fs).reduce(((e,t)=>(e[t]=`play-yandex-${fs[t]}`,e)),{})}function Ds(e,t,s){const a=e[`${t}SearchApplication`];return`${e[t]} ${s?a:""}`}function Ls(){var e,t,s;bs.Eu.params({borrowParams:{adv:{yaContextScriptLoad:Boolean(null==(s=null==(t=null==(e=window.Ya)?void 0:e.Context)?void 0:t.AdvManager)?void 0:s.render)}}})}function Os({advBlocks:e,deviceType:t,reason:s}){var a,r,n,i,o,d;if((0,lt.x)())return s===he.p_.START_FULLSCREEN?Zt.EC.start_fullscreen:Zt.EC.fullscreen;if(t===ks.n.desktop){const t=Rs(Rs({},e),e.desktop);return s===he.p_.START_FULLSCREEN&&null!=(a=t.start_fullscreen)?a:t.fullscreen}const l=Rs(Rs({},e),e.mobile);let c=l.fullscreen;return s===he.p_.START_FULLSCREEN?(c=null!=(r=l.start_fullscreen)?r:c,c=qe.Z.isLandscape?null!=(n=l.start_fullscreen_landscape)?n:c:null!=(i=l.start_fullscreen_portrait)?i:c):c=qe.Z.isLandscape?null!=(o=l.fullscreen_landscape)?o:c:null!=(d=l.fullscreen_portrait)?d:c,c}function xs({advBlocks:e,deviceType:t}){if((0,lt.x)())return Zt.EC.rewarded;if(t===ks.n.desktop){return Rs(Rs({},e),e.desktop).rewarded}return Rs(Rs({},e),e.mobile).rewarded}class _s{ready(){return(0,A.qu)("[adv.prerender] ready"),this.promise}}var Bs=s(40174),Ns=Object.defineProperty,Ms=Object.getOwnPropertySymbols,$s=Object.prototype.hasOwnProperty,Fs=Object.prototype.propertyIsEnumerable,qs=(e,t,s)=>t in e?Ns(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;class Ws extends Error{constructor({type:e,text:t,code:s},a,r={}){super(),this.message=`${a}: err.code=${s}`,this.additional=((e,t)=>{for(var s in t||(t={}))$s.call(t,s)&&qs(e,s,t[s]);if(Ms)for(var s of Ms(t))Fs.call(t,s)&&qs(e,s,t[s]);return e})({adv:{text:null==t?void 0:t.substr(0,100),code:s,type:e}},r)}}var Zs=s(38508),Gs=s(58432),Us=Object.defineProperty,Hs=Object.defineProperties,js=Object.getOwnPropertyDescriptors,zs=Object.getOwnPropertySymbols,Vs=Object.prototype.hasOwnProperty,Ks=Object.prototype.propertyIsEnumerable,Ys=(e,t,s)=>t in e?Us(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Xs=(e,t)=>{for(var s in t||(t={}))Vs.call(t,s)&&Ys(e,s,t[s]);if(zs)for(var s of zs(t))Ks.call(t,s)&&Ys(e,s,t[s]);return e},Js=(e,t)=>Hs(e,js(t));class Qs extends _s{constructor(e,t,s){super(),this.yandexAdvService=e,this._previousReason=he.p_.PRELOAD,this.previousPageNumber=0,this.depth=0;const{advBlocks:a}=e.advManager;Ts(`[adv.prerender] yandex init with advBlocks = ${JSON.stringify(a,null,"\t")}`),Ts(`[adv.prerender] reason = ${t}`),e.savedPageYOffset=(0,A.SW)(e.advContainer),this.promise=new Promise(((e,a)=>{this.next(t,s).then(e).catch(a)}))}get adReqId(){return this._adReqId}get previousReason(){return this._previousReason}next(e=this._previousReason,t){Ts("[adv.prerender] next"),this._previousReason!==e&&(this._previousReason=e);const{yandexAdvService:s}=this,{advBlocks:a,deviceType:r}=s.advManager;return this.promise=new Promise(((s,n)=>{this.previousPageNumber+=1;const i=Os({advBlocks:a,deviceType:r,reason:e});Ts(`[adv.prerender] advBlockId = ${i}`),d.Z.post({type:"yandex-fullscreen-render",action:"update-block-id",data:{blockId:i,pageNumber:this.previousPageNumber},timeout:1e3}).then((({data:e})=>{const{blockId:t}=e;return le({querySelector:`#${t}`,interval:100,rejectTimeout:1500})})).then((a=>{this.renderYaAdv(s,n,{advBlockId:i,reason:e,renderTo:a.id,clickDaemon:t})})).catch((e=>{s({hasContent:!1,err:e})}))})).catch((e=>({hasContent:!1,err:e}))),this.promise}renderYaAdv(e,t,{advBlockId:s,clickDaemon:a,reason:r,renderTo:n}){var i,o,l,c,h;Ts("[adv.prerender] renderYaAdv");const{depth:u}=this,{flags:p,isAdvDisabled:m}=this.yandexAdvService.advManager;null==(o=(i=this.yandexAdvService).destroyAdv)||o.call(i);try{if(m)return void e({hasContent:!1,noRequest:!0});if(this._adReqId=a instanceof ue.i?a.request({advBlockId:s,advtype:this.yandexAdvService.serviceName,depth:u,reason:r}):"",!(null==(h=null==(c=null==(l=window.Ya)?void 0:l.Context)?void 0:c.AdvManager)?void 0:h.render)){const e="window.Ya.Context.AdvManager.render is not defined";throw a instanceof ue.i&&(a.response({adReqId:this.adReqId,reason:he.Ud.NOT_IMPL}),a.error(this.adReqId,this.adSeqId,e)),new Error(e)}const{appId:t,deviceId:i}=this.yandexAdvService.advManager,o=this.previousPageNumber%ys;(0,A.U2)("РСЯ fullscreen",`${o}`),a instanceof ce.U&&(r===he.p_.WATERFALL?a.request():a.request({advBlockId:s,provider:this.yandexAdvService.serviceName,reason:r}));const v=Xs(Js(Xs({},(0,lt.x)()?{type:"fullscreen",platform:"desktop"}:{}),{async:!0,blockId:s,disableRefresh:!0,extParams:Js(Xs({},i?{google_aid:i}:{}),{utm_source_service:"games","distr-id":t}),pageNumber:o,renderTo:n,statId:(0,Gs.Sn)(),lazyLoad:!1,onError:t=>{Ts("[adv.prerender] onError");const r=(0,Zs.M)(t,{blockId:s,pageId:o});a instanceof ue.i&&a.response({adReqId:this.adReqId,depth:u,reason:`${he.Ud.ERROR}_${r}`}),(0,ge.fF)(new Ws(t,"Callback onError in fullscreen"),{additional:{advBlockId:s,pageId:o},prefix:Zt.yt}),e({hasContent:!1,err:new Error(r),clickDaemon:a})},onRender:t=>{a instanceof ue.i?a.response({adReqId:this.adReqId,depth:u,reason:he.Ud.SUCCESS}):a.response(),this.yandexAdvService.destroyAdv=()=>{var e,t;this.yandexAdvService.destroyAdv=void 0,null==(t=null==(e=window.Ya)?void 0:e.Context)||t.AdvManager.destroy({blockId:s})},e({hasContent:!0,isMediaAdv:"rtb"===t.product,clickDaemon:a})}}),(0,lt.x)()?{onClose:()=>{(0,P.D)((()=>{d.Z.post({type:"yandex-adv-service",action:"close-adv"})}))}}:{}),g=()=>{a instanceof ue.i?a.response({adReqId:this.adReqId,depth:u,reason:he.Ud.EMPTY}):null==a||a.responseEmpty(),e({hasContent:!1,clickDaemon:a})};Ts("[adv.prerender] Preload fullscreen ad - AdvManager.render"),(0,Bs.Q$)({abtFlags:p,adOptions:v,methodName:Bs.xn.RENDER,onAdLoadFailed:g})}catch(e){t(e)}}}var ea=Object.defineProperty,ta=Object.defineProperties,sa=Object.getOwnPropertyDescriptors,aa=Object.getOwnPropertySymbols,ra=Object.prototype.hasOwnProperty,na=Object.prototype.propertyIsEnumerable,ia=(e,t,s)=>t in e?ea(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,oa=(e,t)=>{for(var s in t||(t={}))ra.call(t,s)&&ia(e,s,t[s]);if(aa)for(var s of aa(t))na.call(t,s)&&ia(e,s,t[s]);return e},da=(e,t)=>ta(e,sa(t));class la extends _s{constructor(e,t,s){super(),this.yandexAdvService=e,this._previousReason=he.p_.PRELOAD,this.previousPageNumber=0,this.isProcessing=!1,this.depth=0;const{advBlocks:a}=e.advManager;Ts(`[adv.prerender] yandex init with advBlocks = ${JSON.stringify(a,null,"\t")}`),Ts(`[adv.prerender] startReason = ${t}`),e.savedPageYOffset=(0,A.SW)(e.advContainer),this.promise=new Promise(((e,a)=>{this.next(t,s).then(e).catch(a)}))}get adReqId(){return this._adReqId}get previousReason(){return this._previousReason}next(e=this._previousReason,t){var s;Ts("[adv.prerender] next"),this._previousReason!==e&&(this._previousReason=e);const{yandexAdvService:a}=this,{advBlocks:r}=a.advManager;return null==(s=a.destroyAdv)||s.call(a),Ts("[adv.prerender] isProcessing =",this.isProcessing),this.promise=new Promise(((s,a)=>{this.isProcessing=!0,this.previousPageNumber+=1;const n=Os({advBlocks:r,deviceType:this.getPlatform(),reason:e});Ts(`[adv.prerender] advBlockId = ${n}`),d.Z.post({type:"yandex-fullscreen-render",action:"update-block-id",data:{blockId:n,pageNumber:this.previousPageNumber},timeout:1e3}).then((({data:e})=>{const{blockId:t}=e;return le({querySelector:`#${t}`,interval:100,rejectTimeout:1500})})).then((r=>{this.renderYaAdv(s,a,{advBlockId:n,reason:e,renderTo:r.id,clickDaemon:t})})).catch((e=>{s({hasContent:!1,err:e})}))})).catch((e=>(this.isProcessing=!1,{hasContent:!1,err:e}))),this.promise}getRsyaPlatform(){var e,t,s,a;const r=null==(a=null==(s=null==(t=null==(e=window.Ya)?void 0:e.Context)?void 0:t.AdvManager)?void 0:s.getPlatform)?void 0:a.call(s);return null!=r?r:"desktop"}getPlatform(){return"touch"===this.getRsyaPlatform()?"mobile":"desktop"}renderYaAdv(e,t,{advBlockId:s,clickDaemon:a,reason:r,renderTo:n}){var i,o,d,l,c;Ts("[adv.prerender] renderYaAdv");const{depth:h}=this,{isAdvDisabled:u,flags:p}=this.yandexAdvService.advManager;let m=e;null==(o=(i=this.yandexAdvService).destroyAdv)||o.call(i);try{if(u)return void m({hasContent:!1,noRequest:!0});if(this._adReqId=a instanceof ue.i?a.request({advBlockId:s,advtype:this.yandexAdvService.serviceName,depth:h,reason:r}):"",!(null==(c=null==(l=null==(d=window.Ya)?void 0:d.Context)?void 0:l.AdvManager)?void 0:c.preload)){const e="window.Ya.Context.AdvManager.preload is not defined";throw a instanceof ce.U?a.error(e):(a.response({adReqId:this.adReqId,reason:he.Ud.NOT_IMPL}),a.error(this.adReqId,this.adSeqId,e)),new Error(e)}(0,A.U2)("РСЯ fullscreen",`${s}/${this.previousPageNumber%ys}`),a instanceof ce.U&&(r===he.p_.WATERFALL?a.request():a.request({advBlockId:s,provider:this.yandexAdvService.serviceName,reason:r}));let e,t=!1;const i=new Promise((t=>e=t));let o=!1;const{appId:v,deviceId:g}=this.yandexAdvService.advManager,w=this.previousPageNumber%ys,f={async:!0,blockId:s,disableRefresh:!0,extParams:da(oa({},g?{google_aid:g}:{}),{utm_source_service:"games","distr-id":v}),lazyLoad:!1,pageNumber:w,platform:this.getRsyaPlatform(),renderTo:n,statId:(0,Gs.Sn)(),type:"fullscreen",onClose:()=>{Ts("[adv.prerender] onClose"),this.isProcessing=!1,o=!1,this.yandexAdvService.hideFullscreenAdv(t)},onError:e=>{Ts("[adv.prerender] onError"),this.isProcessing=!1,o=!1;const t=String(e.text);(0,ge.fF)(new Ws(e,"Callback onError in fullscreen"),{additional:{advBlockId:s,pageId:w},prefix:Zt.yt}),a instanceof ce.U||a.response({adReqId:this._adReqId,depth:h,reason:`${he.Ud.ERROR}_${e.text}`}),m({hasContent:!1,err:new Error(t),clickDaemon:a})},onPreload:t=>{Ts("[adv.prerender] onPreload",m),o=!0,null==a||a.response({adReqId:this._adReqId,depth:h,reason:he.Ud.SUCCESS}),m({showPrerenderedAd:()=>(Ts("[adv.prerender] showPrerenderedAd"),t(),i),clickDaemon:a}),m=e},onRender:e=>{if(Ts("[adv.prerender] onRender; isPreloaded =",o),!o)return Ts("[adv.prerender] Called `onRender` before `onPreload`. Abort. Call `onAdLoadFailed`."),void y();this.yandexAdvService.destroyAdv=()=>{var e,t;this.yandexAdvService.destroyAdv=void 0,Ts("[adv.prerender] yandexAdvService.destroyAdv called"),null==(t=null==(e=window.Ya)?void 0:e.Context)||t.AdvManager.destroy({blockId:s})},t=!0,m({hasContent:!0,isMediaAdv:"rtb"===e.product,clickDaemon:a})}},y=()=>{Ts("[adv.prerender] onAdLoadFailed"),a instanceof ue.i?a.response({adReqId:this._adReqId,depth:h,reason:he.Ud.EMPTY}):null==a||a.responseEmpty(),this.isProcessing=!1,o=!1,m({hasContent:!1,clickDaemon:a})};Ts("[adv.prerender] Preload fullscreen ad - AdvManager.preload"),(0,Bs.Q$)({abtFlags:p,adOptions:f,methodName:Bs.xn.PRELOAD,onAdLoadFailed:y})}catch(e){t(e)}}}var ca=s(95025),ha=s(77901),ua=Object.defineProperty,pa=Object.defineProperties,ma=Object.getOwnPropertyDescriptors,va=Object.getOwnPropertySymbols,ga=Object.prototype.hasOwnProperty,wa=Object.prototype.propertyIsEnumerable,fa=(e,t,s)=>t in e?ua(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,ya=(e,t)=>{for(var s in t||(t={}))ga.call(t,s)&&fa(e,s,t[s]);if(va)for(var s of va(t))wa.call(t,s)&&fa(e,s,t[s]);return e},ba=(e,t)=>pa(e,ma(t)),ka=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const Aa=["direct","media-smart","media-image","media-creative","video-smart","auto-video-irect","video-creative","video-motion","media-creative-survey","video-creative-survey"];class Ea{constructor(e,t){this.yandexAdvService=e,this.pageNumber=0,this.isYandexSearchApp=(0,ha.qo)()}get adReqId(){return this._adReqId}next(e){const{flags:t}=this.yandexAdvService.advManager;t[ye.Z.preloadRewardedVideo]&&(this.preloadedRewardedVideo=this.preloadRewardedVideo())}getOnCloseOptionForTV(){return(0,lt.x)()?{onClose:()=>{var e,t;null==(t=null==(e=this.yandexAdvService)?void 0:e.advManager)||t.getClickdaemonAdvLog(ae.$.REWARDED).close(this.adReqId,this.adSeqId),this.hideVideoAdv(),"function"==typeof this.onClose&&this.onClose()}}:{}}preloadRewardedVideo(){const{appId:e,deviceId:t}=this.yandexAdvService.advManager,s=this.yandexAdvService.getAdvBlockId(ae.$.REWARDED);let a=()=>{},r=()=>{};const n=new Promise(((e,t)=>{a=e,r=t})),i=new Promise((n=>ka(this,null,(function*(){var i,o,l;try{const r=yield d.Z.post({type:"yandex-rewarded-render",action:"update-block-id",data:{blockId:s},timeout:1e3}),{data:{blockId:c}}=r,h=yield le({querySelector:`#${c}`,interval:100,rejectTimeout:1500});if(!(null==(l=null==(o=null==(i=window.Ya)?void 0:i.Context)?void 0:o.AdvManager)?void 0:l.preload))throw new Error("window.Ya.Context.AdvManager.preload is not defined");Ts("[adv.rerender] Preload rewarded video - AdvManager.preload");const u=ya(ba(ya({},(0,lt.x)()?{type:"rewarded",platform:"desktop"}:{}),{async:!0,blockId:s,disableRefresh:!0,extParams:ba(ya({},t?{google_aid:t}:{}),{utm_source_service:"games","distr-id":e}),pageNumber:this.pageNumber,renderTo:h.id,statId:(0,Gs.Sn)(),onError:(e={})=>{(0,ge.fF)(new Ws(e,"Callback onError in rewarded"),{prefix:Zt.yt})},onRender:e=>{e?e.product||(0,ge.fF)(new Error("Adv Rewarded: there is no data.product")):(0,ge.fF)(new Error("Adv Rewarded: there is no data")),Ts("[adv.rerender] Render preloaded rewarded"),a({hasContent:!0,productType:e.productType})},onPreload:e=>n({showRewardedCallback:e})}),this.getOnCloseOptionForTV()),p=()=>{(0,ge.fF)(new Error("Adv Rewarded: no content")),n({}),a({hasContent:!1})};(0,Bs.Q$)({abtFlags:this.yandexAdvService.advManager.flags,adOptions:u,methodName:Bs.xn.PRELOAD,onAdLoadFailed:p})}catch(e){n({}),r(e)}}))));return function(){return i.then((({showRewardedCallback:e})=>(null==e||e(),n)))}}resizeAdv(){this.yandexAdvService&&(this.yandexAdvService.savedPageYOffset=(0,A.SW)(this.yandexAdvService.advContainer))}hideVideoAdv(){var e,t;const{advManager:s}=this.yandexAdvService,{deviceType:a,advBlocks:r}=s,n=(0,lt.x)()?Zt.EC.rewarded:r.rewarded;(0,A.PS)(),a!==ks.n.desktop&&(0,A.HH)(),d.Z.post({type:"yandex-rewarded-render",action:"hide-rewarded"}),window.removeEventListener("resize",this.resizeAdv),window.scroll(0,this.yandexAdvService.savedPageYOffset),null==(t=null==(e=window.Ya)?void 0:e.Context)||t.AdvManager.destroy({blockId:n}),this.yandexAdvService.preloadRewardedAdv(he.p_.PRELOAD)}renderFakeRewarded({advBlockId:e,clickDaemon:t,depth:s,onRewardedForTV:a,previousRewardedPageNumber:r,reason:n}){const{advManager:i}=this.yandexAdvService,{appId:o,deviceId:l}=i;return new Promise(((i,c)=>ka(this,null,(function*(){var h,u,p;try{if(this._adReqId=t instanceof ce.U?"":t.request({advBlockId:e,advtype:this.yandexAdvService.serviceName,depth:s,reason:n}),!(null==(p=null==(u=null==(h=window.Ya)?void 0:h.Context)?void 0:u.AdvManager)?void 0:p.render))throw t instanceof ce.U||t.response({adReqId:this.adReqId,reason:he.Ud.NOT_IMPL}),new Error("window.Ya.Context.AdvManager.render is not defined");t instanceof ce.U&&t.request({advBlockId:e,reason:n,provider:this.yandexAdvService.serviceName});const m=yield d.Z.post({type:"yandex-rewarded-render",action:"update-block-id",data:{blockId:e},timeout:1e3}),{data:{blockId:v}}=m,g=yield le({querySelector:`#${v}`,interval:100,rejectTimeout:1500}),w=r%ys;(0,A.U2)("РСЯ rewarded",`${e}/${w}`),(0,A.WL)();const f=ya(ya(ba(ya({},(0,lt.x)()?{type:"rewarded"}:{}),{async:!0,blockId:e,disableRefresh:!0,extParams:ba(ya({},l?{google_aid:l}:{}),{utm_source_service:"games","distr-id":o}),lazyLoad:!1,pageNumber:w,renderTo:g.id,statId:(0,Gs.Sn)(),onError:(a={})=>{const r=(0,Zs.M)(a,{blockId:e,pageId:w});t instanceof ce.U||t.response({adReqId:this.adReqId,depth:s,reason:`${he.Ud.ERROR}_${r}`}),c(new Ws(a,"Callback onError in rewarded"))},onRender:e=>{e?e.product||(0,ge.fF)(new Error("Adv Rewarded: there is no data.product")):(0,ge.fF)(new Error("Adv Rewarded: there is no data")),t instanceof ce.U?t.response():t.response({adReqId:this.adReqId,depth:s,reason:(null==e?void 0:e.product)?he.Ud.SUCCESS:`${he.Ud.ERROR}_no-data-or-product`}),i({hasContent:!0,productType:e.productType})}}),(0,lt.x)()?{onRewarded:a}:{}),this.getOnCloseOptionForTV()),y=()=>{t instanceof ce.U||t.response({adReqId:this.adReqId,depth:s,reason:he.Ud.EMPTY}),(0,ge.fF)(new Error("Adv Rewarded: no content")),i({hasContent:!1})};(0,Bs.Q$)({abtFlags:this.yandexAdvService.advManager.flags,adOptions:f,methodName:Bs.xn.RENDER,onAdLoadFailed:y})}catch(e){c(e)}}))))}showRewardedVideo({callbacks:e,clickDaemon:t,adSeqId:s,depth:a}){const{onOpen:r,onRewarded:n,onClose:i}=e,o=Boolean(this.isYandexSearchApp),{advManager:l,cssClasses:c}=this.yandexAdvService,{deviceType:h,viewType:u,flags:p}=l,m=this.yandexAdvService.getAdvBlockId(ae.$.REWARDED),v=document.querySelector(`.${c.rewardedVideo}`),g=Number(p[ye.Z.rewardedVideoTimeout]);let w;this.adSeqId=s,this.onClose=i,w=!isNaN(g)&&g>0?g:20;let f=w;return window.addEventListener("resize",this.resizeAdv),h!==ks.n.desktop&&(0,A.xK)(),(u===Zt.xd.fullscreen||o)&&this.resizeAdv(),new Promise(((e,r)=>{this.pageNumber=((this.pageNumber||0)+1)%ys;const i=()=>{(p[ye.Z.preloadRewardedVideo]?this.preloadedRewardedVideo.bind(this):this.renderFakeRewarded.bind(this))({advBlockId:m,clickDaemon:t,depth:a,onRewardedForTV:(0,lt.x)()?e=>{t instanceof ce.U||l.getClickdaemonAdvLog(ae.$.REWARDED).rewarded(this.adReqId,s),!0===e&&(null==n||n())}:void 0,previousRewardedPageNumber:this.pageNumber,reason:he.p_.ONSPOT}).then(e).catch(r)};window.yaContextCb?(window.yaContextCb.push(i),Ts("[adv.rerender] new rewarded render on")):i()})).then((({hasContent:e,productType:a})=>{var o;if(Ts(`[adv.rerender] hasContent = ${e}, productType = ${a}`),!e)throw l.alternateLogs||l.getClickdaemonAdvLog(ae.$.REWARDED).noContent(this.adReqId,this.adSeqId),(0,ca.Cj)(l.waterfallQueue[ae.$.REWARDED],ae.e.Promo)||null==n||n(),new Error(Zt.Iy);a&&Aa.includes(a)&&(w=7,f-=13),t instanceof ce.U||l.getClickdaemonAdvLog(ae.$.REWARDED).show(this.adReqId,this.adSeqId),d.Z.post({type:"yandex-rewarded-render",action:"show-rewarded",data:{seconds:f}}).then((()=>{t instanceof ce.U||l.getClickdaemonAdvLog(ae.$.REWARDED).close(this.adReqId,s),this.hideVideoAdv(),null==i||i()})),(0,lt.x)()||d.Z.post({type:"yandex-rewarded-render",action:"on-rewarded"}).then((()=>{t instanceof ce.U||l.getClickdaemonAdvLog(ae.$.REWARDED).rewarded(this.adReqId,s),null==n||n()}));const h=(null==(o=this.yandexAdvService.advManager.context.uatraits)?void 0:o.OSFamily)===ht.k8.IOS;(0,A.ss)({advElement:document.querySelector(`#yandex_rtb_rewarded_${m}`),type:ae.$.REWARDED,flags:l.flags,appId:l.appId,isIOS:h}),(0,A.J4)(c,v),null==r||r()})).catch((e=>{throw this.hideVideoAdv(),e}))}}var Sa=Object.defineProperty,Ia=Object.defineProperties,Pa=Object.getOwnPropertyDescriptors,Ra=Object.getOwnPropertySymbols,Ta=Object.prototype.hasOwnProperty,Ca=Object.prototype.propertyIsEnumerable,Da=(e,t,s)=>t in e?Sa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,La=(e,t)=>{for(var s in t||(t={}))Ta.call(t,s)&&Da(e,s,t[s]);if(Ra)for(var s of Ra(t))Ca.call(t,s)&&Da(e,s,t[s]);return e},Oa=(e,t)=>Ia(e,Pa(t)),xa=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const _a=["media-creative-reach","media-image","media-creative","video-creative"];class Ba{constructor(e,t){this.yandexAdvService=e,this.advContainer=null,this.currentProductType="",this.pageNumber=0,qe.Z.addChangeListener((()=>{this.rerenderAdv()}))}get adReqId(){return this._adReqId}next(){}getRsyaPlatform(){var e,t,s,a;const r=null==(a=null==(s=null==(t=null==(e=window.Ya)?void 0:e.Context)?void 0:t.AdvManager)?void 0:s.getPlatform)?void 0:a.call(s);return null!=r?r:"desktop"}getPlatform(){return"touch"===this.getRsyaPlatform()?"mobile":"desktop"}rerenderAdv(){var e,t;const{advManager:s}=this.yandexAdvService,a=this.yandexAdvService.getAdvBlockId(ae.$.REWARDED);if(!this.yandexAdvService.isRewardedShowing||_a.includes(this.currentProductType))return;null==(t=null==(e=window.Ya)?void 0:e.Context)||t.AdvManager.destroy({blockId:a});const r=s.getClickdaemonAdvLog(ae.$.REWARDED),n=r.rerender(a,this.yandexAdvService.serviceName);r.demand(void 0,0,n),this.showRewardedVideo({callbacks:this.yandexAdvService.showAdvCallbacks[ae.$.REWARDED],clickDaemon:r,adSeqId:n,reason:he.p_.PRELOAD,tag:ae.$.REWARDED,initialTag:ae.$.REWARDED,depth:0})}hideRewarded(){var e,t;const{advManager:s}=this.yandexAdvService,{deviceType:a,flags:r}=s,n=this.yandexAdvService.getAdvBlockId(ae.$.REWARDED);(0,A.PS)(),a!==ks.n.desktop&&(0,A.HH)(),d.Z.post({type:"yandex-rewarded-render",action:"hide-rewarded"}),null==(t=null==(e=window.Ya)?void 0:e.Context)||t.AdvManager.destroy({blockId:n}),!1!==(0,T.RM)(r,ye.Z.rewardedPCodeAdvPreloadFs)&&(0,T.iH)(r)&&this.yandexAdvService.preloadFullscreenAdv(he.p_.PRELOAD)}renderRewarded({advBlockId:e,previousRewardedPageNumber:t,callbacks:s,depth:a,clickDaemon:r}){const{advManager:n}=this.yandexAdvService,{flags:i}=n;return new Promise(((n,o)=>xa(this,null,(function*(){var d,l,c;try{if(this._adReqId=r instanceof ce.U?"":r.request({advBlockId:e,advtype:this.yandexAdvService.serviceName,depth:0,reason:he.p_.ONSPOT}),!(null==(c=null==(l=null==(d=window.Ya)?void 0:d.Context)?void 0:l.AdvManager)?void 0:c.render))throw r instanceof ce.U||r.response({adReqId:this.adReqId,reason:he.Ud.NOT_IMPL}),new Error("window.Ya.Context.AdvManager.render is not defined");r instanceof ce.U&&r.request({advBlockId:e,reason:he.p_.ONSPOT,provider:this.yandexAdvService.serviceName});const h=t%ys;(0,A.U2)("РСЯ rewarded",`${e}/${h}`),(0,A.WL)();const{appId:u,deviceId:p}=this.yandexAdvService.advManager,m={async:!0,blockId:e,disableRefresh:!0,extParams:Oa(La({},p?{google_aid:p}:{}),{utm_source_service:"games","distr-id":u}),lazyLoad:!1,pageNumber:h,platform:this.getRsyaPlatform(),statId:(0,Gs.Sn)(),type:"rewarded",onError:(t={})=>{const s=(0,Zs.M)(t,{blockId:e,pageId:h});r instanceof ce.U||r.response({adReqId:this.adReqId,depth:a,reason:`${he.Ud.ERROR}_${s}`}),o(new Ws(t,"Callback onError in rewarded"))},onClose:()=>{var e;this.currentProductType="",this.yandexAdvService.isRewardedShowing=!1,r instanceof ce.U||r.close(this.adReqId,this.adSeqId),this.hideRewarded(),null==(e=s.onClose)||e.call(s)},onRewarded:e=>{e&&s.onRewarded&&(r instanceof ce.U||r.rewarded(this.adReqId,this.adSeqId),s.onRewarded())},onRender:e=>{e?e.product||(0,ge.fF)(new Error("Adv Rewarded: there is no data.product")):(0,ge.fF)(new Error("Adv Rewarded: there is no data")),r instanceof ce.U?r.response():r.response({adReqId:this.adReqId,depth:a,reason:(null==e?void 0:e.product)?he.Ud.SUCCESS:`${he.Ud.ERROR}_no-data-or-product`}),n({hasContent:!0,productType:e.productType})}},v=()=>{r instanceof ce.U||r.response({adReqId:this.adReqId,depth:a,reason:he.Ud.EMPTY}),(0,ge.fF)(new Error("Adv Rewarded: no content")),n({hasContent:!1})};(0,Bs.Q$)({abtFlags:i,adOptions:m,methodName:Bs.xn.RENDER,onAdLoadFailed:v})}catch(e){o(e)}}))))}showRewardedVideo({callbacks:e,clickDaemon:t,adSeqId:s,depth:a}){const{onRewarded:r,onOpen:n}=e,{advManager:i,cssClasses:o}=this.yandexAdvService,{deviceType:l,advBlocks:c}=i,h=xs({advBlocks:c,deviceType:this.getPlatform()});return this.adSeqId=s,this.advContainer=document.querySelector(`.${o.rewardedVideo}`),l!==ks.n.desktop&&(0,A.xK)(),this.yandexAdvService.isRewardedShowing=!0,new Promise(((s,r)=>xa(this,null,(function*(){this.pageNumber=((this.pageNumber||0)+1)%ys,window.yaContextCb?(window.yaContextCb.push((()=>{this.renderRewarded({advBlockId:h,previousRewardedPageNumber:this.pageNumber,callbacks:e,depth:a,clickDaemon:t}).then(s).catch(r)})),Ts("new rewarded render on")):this.renderRewarded({advBlockId:h,previousRewardedPageNumber:this.pageNumber,callbacks:e,depth:a,clickDaemon:t}).then(s).catch(r)})))).then((({hasContent:e,productType:a})=>{if(Ts(`[adv.rerender] hasContent = ${e}, productType = ${a}`),!e)throw t instanceof ce.U||i.getClickdaemonAdvLog(ae.$.REWARDED).noContent(this.adReqId,this.adSeqId),(0,ca.Cj)(i.waterfallQueue[ae.$.REWARDED],ae.e.Promo)||null==r||r(),new Error(Zt.Iy);t instanceof ce.U||i.getClickdaemonAdvLog(ae.$.REWARDED).show(this.adReqId,s),d.Z.post({type:"yandex-rewarded-render",action:"show-rewarded"}),this.currentProductType=a||"",null==n||n()})).catch((e=>{throw this.hideRewarded(),this.currentProductType="",this.yandexAdvService.isRewardedShowing=!1,e}))}}Ba.contextType=o.Z;var Na=s(93013),Ma=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));s(97507);const $a={adsense:ve,adsense_responsive:ve,crazy_games:class extends de{constructor(e,t){super(e,t,ae.e.CrazyGames),this.processShowResult=(e,t,s,a,r)=>{if("viewed"===s)return void a.response({adReqId:this.lastAdReqId[e],depth:t,clickUrl:"",reason:he.Ud.SUCCESS});const n=["error"].includes(s);a instanceof ue.i?a.response({adReqId:this.lastAdReqId[e],depth:t,clickUrl:"",reason:n?`${he.Ud.ERROR}_${s}`:he.Ud.EMPTY}):a.responseEmpty(),r(new A.lu(`CrazyGames returned ${s} status`,{isEmpty:!n}))},this.openWithLog=(e,t,s,a)=>{e instanceof ue.i&&e.show(t,s),null==a||a()},this.closeWithLog=(e,t,s,a)=>{e instanceof ue.i&&e.close(t,s),null==a||a(!0)},this.showFullscreenAdv=e=>fe(this,[e],(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:a,depth:r}){return new Promise(((n,i)=>{var o;const d=this.lastAdReqId[ae.$.INTERSTITIAL]=t instanceof ue.i?t.request({advBlockId:this.getAdvBlockId(ae.$.INTERSTITIAL),advtype:this.serviceName,depth:r,reason:a}):"";try{null==(o=window.CrazyGames)||o.SDK.ad.requestAd("midgame",{adError:e=>{(0,A.qu)("[CrazyGames] showFullscreenAdv error",e),this.processShowResult(ae.$.INTERSTITIAL,r,"error",t,i)},adFinished:()=>{this.closeWithLog(t,d,s,e.onClose),this.processShowResult(ae.$.INTERSTITIAL,r,"viewed",t,i)},adStarted:()=>{this.openWithLog(t,d,s,e.onOpen),n()}})}catch(e){this.processShowResult(ae.$.INTERSTITIAL,r,"error",t,i)}}))})),this.showRewardedVideo=e=>fe(this,[e],(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:a,depth:r}){return new Promise(((n,i)=>{var o;const d=this.lastAdReqId[ae.$.REWARDED]=t instanceof ue.i?t.request({advBlockId:this.getAdvBlockId(ae.$.REWARDED),advtype:this.serviceName,depth:r,reason:a}):"";try{null==(o=window.CrazyGames)||o.SDK.ad.requestAd("rewarded",{adError:e=>{(0,A.qu)("[CrazyGames] showRewardedVideo error",e),this.processShowResult(ae.$.REWARDED,r,"error",t,i)},adFinished:()=>{this.closeWithLog(t,d,s,e.onClose),this.processShowResult(ae.$.REWARDED,r,"viewed",t,i)},adStarted:()=>{this.openWithLog(t,d,s,e.onOpen),n()}})}catch(e){this.processShowResult(ae.$.REWARDED,r,"error",t,i)}}))})),this.loadCrazyGamesSDKScript()}loadCrazyGamesSDKScript(){return fe(this,null,(function*(){var e;try{if(yield(0,we.x)({id:"crazy-games-sdk",src:"https://sdk.crazygames.com/crazygames-sdk-v3.js"}),!(null==(e=window.CrazyGames)?void 0:e.SDK))throw new Error("No window.CrazyGames.SDK");yield window.CrazyGames.SDK.init();const{environment:t}=window.CrazyGames.SDK;if(!t||!["crazygames","local"].includes(t))throw new Error("Unexpected SDK environment: "+t);this.onServiceLoaded()}catch(e){(0,ge.fF)(e),this.onServiceError()}}))}getAdvBlockId(e,t){return"crazy_games_block_id"}},google_instream:Qe,google_manual:class extends de{constructor(e,t){super(e,t,ae.e.GoogleManual,{showIntervalCommonMs:2*pe.yR}),this.interstitialPreload=new at(this),this.showFullscreenAdv=e=>ot(this,[e],(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:a,depth:r}){return new Promise(((n,i)=>ot(this,null,(function*(){const{isEmpty:o,adReqId:d,clickDaemon:l,waitForShow:c}=yield this.interstitialPreload.preload({reason:a,depth:r,clickDaemon:t});this.lastAdReqId[ae.$.INTERSTITIAL]=d,t instanceof ce.U&&l instanceof ce.U&&t.bindRequest(l);const h=()=>{window.setTimeout((()=>{this.interstitialPreload.preload()}),.75*this.advManager.minIntervalBetweenAds)};if(o||!c)return h(),void i(new A.lu(Ye.XO.EMPTY_SLOT,{isEmpty:!0}));n(),t instanceof ue.i&&t.show(d,s),e.onOpen(!0),yield c(),t instanceof ue.i&&t.close(d,s),e.onClose(!0),h()}))))})),this.showRewardedVideo=()=>ot(this,null,(function*(){return Promise.reject("Not implemented")})),this.init()}init(){return ot(this,null,(function*(){try{yield(0,tt.S$)(),yield this.initGPT(),this.onServiceLoaded(),this.interstitialPreload.preload()}catch(e){this.onServiceError(e.message)}}))}getAdvBlockId(e){if(e===ae.$.INTERSTITIAL)return this.advManager.allAdvBlocks.google.manual;throw new Error(`AdvTag ${e} not supported by this service.`)}initGPT(){return ot(this,null,(function*(){yield(0,tt.Vg)(),yield(0,tt.bT)((e=>ot(this,null,(function*(){const{advManager:t}=this,s=yield new rt.Z(window.appData.apiData).getGoogleKeyValues({appID:t.appId,platform:t.context.platform,lang:t.lang}).catch((e=>{throw(0,nt.H)({block:it.W.GOOGLE_ADS,message:"Trouble with getting google key values"},e),e})),a=e.pubads();Object.entries(s).forEach((([e,t])=>{a.setTargeting(e,t)}))}))))}))}cancelShow(e){if(e===ae.$.INTERSTITIAL)this.interstitialPreload.cancel()}},native:class extends de{constructor(e,t){super(e,t,ae.e.Native),this.fullscreenPreloadAdStatus="not_preloaded",this.rewardedPreloadAdStatus="not_preloaded",this.fullscreenShowAdNumber=0,this.rewardedShowAdNumber=0,this.depth=0,this.adReqIds={fullscreen:"",rewarded:""},this.showFullscreenAdv=e=>_t(this,[e],(function*({adSeqId:e,callbacks:t,clickDaemon:s}){return new Promise(((a,r)=>_t(this,null,(function*(){var n;const{advManager:i}=this;this.fullscreenShowAdNumber+=1;const o=a=>{var r;t.onClose(a),i.callOnAdvClose(a),!a||s instanceof ce.U||s.close(this.adReqIds.fullscreen,e),"preloading"!==this.fullscreenPreloadAdStatus&&(this.preloadFullscreenAdvPromise=void 0),r=i.flags,!1!==(0,T.RM)(r,ye.Z.enablePreloadNativeFullscreen)&&this.preloadFullscreenAdv({clickDaemon:s})};try{t.onOpen(!1),a();const r=yield Promise.race([this.preloadFullscreenAdv({clickDaemon:s}),(0,dt.D)(Nt).then((()=>{throw new Error("Fullscreen preload timeout")}))]);s instanceof ce.U&&r instanceof ce.U&&s.bindRequest(r),yield this.nativeAdv.showFullscreenAdv({onShowCalled:()=>{s instanceof ce.U?s.show():s.show(this.adReqIds.fullscreen,e)}}),o(!0)}catch(a){String(a.message).includes(Bt)||String(null==(n=this.lastFullscreenError)?void 0:n.message).includes(Bt)?s instanceof ce.U||s.noContent(this.adReqIds.fullscreen,e):s instanceof ce.U?s.error(a.message):s.error(this.adReqIds.fullscreen,e,a.message),(0,A.g5)(this,{tag:ae.$.INTERSTITIAL,error:a,name:"Native fullscreen adv error",additional:{adNumber:this.fullscreenShowAdNumber}}),"not_preloaded"===this.fullscreenPreloadAdStatus?(0,A.g5)(this,{tag:ae.$.INTERSTITIAL,error:a,name:"ad was not preloaded",additional:{adNumber:this.fullscreenShowAdNumber}}):"preloading"===this.fullscreenPreloadAdStatus&&(0,A.g5)(this,{tag:ae.$.INTERSTITIAL,error:a,name:"ad is still preloading",additional:{adNumber:this.fullscreenShowAdNumber}}),t.onError(a),o(!1),r(a)}}))))})),this.showRewardedVideo=e=>_t(this,[e],(function*({adSeqId:e,callbacks:t,clickDaemon:s}){return new Promise(((a,r)=>_t(this,null,(function*(){var n;this.rewardedShowAdNumber+=1;const i=()=>{var e;t.onClose(),"preloading"!==this.rewardedPreloadAdStatus&&(this.preloadRewardedAdvPromise=void 0),e=this.advManager.flags,!1!==(0,T.RM)(e,ye.Z.enablePreloadNativeRewarded)&&this.preloadRewardedAdv({clickDaemon:s,reason:he.p_.PRELOAD})};try{t.onOpen(!1),a();const r=yield Promise.race([this.preloadRewardedAdv({clickDaemon:s,reason:he.p_.ONSPOT}),(0,dt.D)(Mt).then((()=>{throw new Error("Rewarded preload timeout")}))]);s instanceof ce.U&&r instanceof ce.U&&s.bindRequest(r),yield this.nativeAdv.showRewardedVideo({onShowCalled:()=>{s instanceof ce.U?s.show():s.show(this.adReqIds.rewarded,e)}}),s instanceof ce.U||(s.rewarded(this.adReqIds.rewarded,e),s.close(this.adReqIds.rewarded,e)),t.onRewarded(),i()}catch(a){String(a.message).includes(Bt)||String(null==(n=this.lastRewardedError)?void 0:n.message).includes(Bt)?s instanceof ce.U||s.noContent(this.adReqIds.rewarded,e):s instanceof ce.U?s.error(a.message):s.error(this.adReqIds.rewarded,e,a.message),String(a.message).includes("User closed ad before it's end.")&&(s instanceof ce.U?s.close():s.close(this.adReqIds.rewarded,e)),(0,A.g5)(this,{tag:ae.$.REWARDED,error:a,name:"Native rewarded video error",additional:{adNumber:this.rewardedShowAdNumber}}),"not_preloaded"===this.rewardedPreloadAdStatus?(0,A.g5)(this,{tag:ae.$.REWARDED,error:a,name:"ad was not preloaded",additional:{adNumber:this.rewardedShowAdNumber}}):"preloading"===this.rewardedPreloadAdStatus&&(0,A.g5)(this,{tag:ae.$.REWARDED,error:a,name:"ad is still preloading",additional:{adNumber:this.rewardedShowAdNumber}}),t.onError(a),i(),r(a)}}))))})),(0,lt.x)()?this.nativeAdv=function(e){const t=window.appData.isGamesLiteApp;let s=null;function a(){return xt(this,null,(function*(){return null!==s||(s=yield mt({advBlocks:e.advBlocks,flags:e.flags,residenceInfo:e.residenceInfo})),s}))}function r(t,s){return yt((0,T.Qx)(e.flags)?t:void 0,s)}return{getFullscreenBlockId(){return xt(this,null,(function*(){const{fullscreenBlock:e}=yield a();return e}))},getRewardedBlockId(){return xt(this,null,(function*(){const{rewardedBlock:e}=yield a();return e}))},preloadFullscreenAdv(){return xt(this,null,(function*(){const{fullscreenBlock:e}=yield a(),s=r(e,gt);console.info("[Native adv TV] preload","fullscreen instream pageId:",s);const n=()=>{var e,t,a;return null==(a=null==(t=null==(e=window.yandex)?void 0:e.ads)?void 0:t.preloadInstreamAdv)?void 0:a.call(t,s,vt)};return t?n():Lt("preload",n)}))},preloadRewardedVideo(){return xt(this,null,(function*(){const{rewardedBlock:e}=yield a(),s=r(e,wt);console.info("[Native adv TV] preload","rewarded instream pageId:",s);const n=()=>{var e,t,a;return null==(a=null==(t=null==(e=window.yandex)?void 0:e.ads)?void 0:t.preloadInstreamAdv)?void 0:a.call(t,s,vt)};return t?n():Lt("preload",n)}))},showFullscreenAdv(e){return xt(this,arguments,(function*({onShowCalled:e}){const{fullscreenBlock:s}=yield a(),n=r(s,gt);if(console.info("[Native adv TV] show","fullscreen instream pageId:",n,s),!s&&!n)return Promise.reject(new Error("No fullscreen block for show"));const i=()=>{var t,s,a,r,i;return(null==(s=null==(t=window.yandex)?void 0:t.ads)?void 0:s.showInstreamAdv)&&e(),null==(i=null==(r=null==(a=window.yandex)?void 0:a.ads)?void 0:r.showInstreamAdv)?void 0:i.call(r,n)};return t?i():Lt("show",i)}))},showRewardedVideo(e){return xt(this,arguments,(function*({onShowCalled:e}){const{rewardedBlock:s}=yield a(),n=r(s,wt);if(console.info("[Native adv TV] show","rewarded instream pageId:",n),!s)return Promise.reject(new Error("No rewarded block for show"));const i=()=>{var t,s,a,r,i;return(null==(s=null==(t=window.yandex)?void 0:t.ads)?void 0:s.showInstreamAdv)&&e(),null==(i=null==(r=null==(a=window.yandex)?void 0:a.ads)?void 0:r.showInstreamAdv)?void 0:i.call(r,n)};return t?i():Lt("show",i)}))}}}(this.advManager):this.nativeAdv=Ot(this.advManager),(0,lt.x)()&&!(0,T.dx)(e.flags)||this.init()}init(){this.onServiceLoaded();const{flags:e}=this.advManager;!this.hasFullscreenAdv||this.advManager.isInterstitialAdsTurnOff||function(e){return!1===(0,T.RM)(e,ye.Z.enablePreloadNativeFullscreenOnStart)}(e)||this.preloadFullscreenAdv({clickDaemon:this.advManager.alternateLogs?new ce.U({app_id:this.advManager.appId,tag:ae.$.INTERSTITIAL}):this.advManager.getClickdaemonAdvLog(ae.$.INTERSTITIAL)}),this.hasRewarderdAdv&&this.advManager.advBlocks.rewarded&&!function(e){return!1===(0,T.RM)(e,ye.Z.enablePreloadNativeRewardedOnStart)}(e)&&(this.preloadRewardedAdvTimer=setTimeout((()=>{this.preloadRewardedAdv({clickDaemon:this.advManager.alternateLogs?new ce.U({app_id:this.advManager.appId,tag:ae.$.REWARDED}):this.advManager.getClickdaemonAdvLog(ae.$.REWARDED),reason:he.p_.PRELOAD}),this.preloadRewardedAdvTimer=null}),15*pe.WT))}getAdvBlockId(e){var t,s;return e===ae.$.REWARDED?null!=(t=this.rewardedBlock)?t:super.getAdvBlockId(e):null!=(s=this.fullscreenBlock)?s:super.getAdvBlockId(e)}getTimeoutExtraTime(e,t){return e===ne.QA.ShowFullscreen||e===ne.QA.ShowRewarded?5e3:super.getTimeoutExtraTime(e,t)}withFullscreenBlockId(e){this.fullscreenBlock?e(this.fullscreenBlock):this.nativeAdv.getFullscreenBlockId().then((t=>{this.fullscreenBlock=t,e(t)}))}withRewardedBlockId(e){this.rewardedBlock?e(this.rewardedBlock):this.nativeAdv.getRewardedBlockId().then((t=>{this.rewardedBlock=t,e(t)}))}preloadFullscreenAdv({clickDaemon:e}){return this.preloadFullscreenAdvPromise||(this.preloadFullscreenAdvPromise=new Promise(((t,s)=>{this.withFullscreenBlockId((a=>{this.rawPreloadFullscreenAdv({fullscreenBlock:a,clickDaemon:e}).then((e=>{t(e)})).catch(s)}))}))),this.preloadFullscreenAdvPromise}rawPreloadFullscreenAdv(e){return _t(this,arguments,(function*({fullscreenBlock:e,clickDaemon:t}){this.lastFullscreenError=void 0,this.fullscreenPreloadAdStatus="preloading";try{const s=window.sessionStorage.getItem(ht.az),a=s?JSON.parse(s):void 0,r=null==a?void 0:a.ad_req_id;if(r)return sessionStorage.removeItem(ht.az),this.adReqIds.fullscreen=r,t instanceof ue.i?t.restoreRequest(a):t.request({adReqId:r,advBlockId:e}),this.fullscreenPreloadAdStatus="preloaded",t}catch(e){(0,A.g5)(this,{tag:ae.$.INTERSTITIAL,error:e,name:"Error while restore request from sessionStorage"})}return this.adReqIds.fullscreen=t instanceof ce.U?"":t.request({depth:this.depth,reason:he.p_.PRELOAD,advBlockId:e,advtype:ae.e.Native}),t instanceof ce.U&&t.request({advBlockId:e,provider:ae.e.Native,reason:he.p_.PRELOAD}),this.nativeAdv.preloadFullscreenAdv().then((()=>(t.response({adReqId:this.adReqIds.fullscreen,depth:this.depth,reason:he.Ud.SUCCESS}),this.fullscreenPreloadAdStatus="preloaded",t))).catch((e=>{throw this.lastFullscreenError=e,t instanceof ue.i?t.response({adReqId:this.adReqIds.fullscreen,depth:this.depth,reason:`${he.Ud.ERROR}_${e.message}`}):t.error(e.message),(0,A.g5)(this,{tag:ae.$.INTERSTITIAL,error:e,name:"preloading failed"}),this.fullscreenPreloadAdStatus="not_preloaded",kt("preloadFullscreenAdv",e.message),e}))}))}preloadRewardedAdv({clickDaemon:e,reason:t}){return this.preloadRewardedAdvTimer&&(clearTimeout(this.preloadRewardedAdvTimer),this.preloadRewardedAdvTimer=null),this.preloadRewardedAdvPromise||(this.preloadRewardedAdvPromise=new Promise(((s,a)=>{this.withRewardedBlockId((r=>{this.rawPreloadRewardedAdv({rewardedBlock:r,clickDaemon:e,reason:t}).then((e=>{s(e)})).catch(a)}))}))),this.preloadRewardedAdvPromise}rawPreloadRewardedAdv({rewardedBlock:e,clickDaemon:t,reason:s}){return this.lastRewardedError=void 0,this.rewardedPreloadAdStatus="preloading",this.adReqIds.rewarded=t instanceof ce.U?"":t.request({depth:this.depth,reason:s,advBlockId:e,advtype:ae.e.Native}),t instanceof ce.U&&t.request({advBlockId:e,provider:ae.e.Native,reason:s}),this.nativeAdv.preloadRewardedVideo().then((()=>(t.response({adReqId:this.adReqIds.rewarded,depth:this.depth,reason:he.Ud.SUCCESS}),this.rewardedPreloadAdStatus="preloaded",t))).catch((e=>{throw this.lastRewardedError=e,t instanceof ce.U?t.error(e.message):t.response({adReqId:this.adReqIds.rewarded,depth:this.depth,reason:`${he.Ud.ERROR}_${e.message}`}),(0,A.g5)(this,{tag:ae.$.REWARDED,error:e,name:"preloading failed"}),this.rewardedPreloadAdStatus="not_preloaded",kt("preloadRewardedVideo",e.message),e}))}},onboarding_promo:class extends qt{constructor(e,t){super(e,t,ae.e.OnboardingPromo),this.isNonWaterfallPromoTimeoutReady=!1,setTimeout((()=>{this.isNonWaterfallPromoTimeoutReady=!0}),Wt.q)}checkCanShow(e,t){return e===ae.$.REWARDED?super.checkCanShow(e,t):this.isOnboardingPromoReady()?(0,Wt.Q)()?super.checkCanShow(e,t):ne.Kc.NextRemove:ne.Kc.Next}isOnboardingPromoReady(){const{firstShowGuard:e}=this.advManager;return this.isNonWaterfallPromoTimeoutReady&&e.canShowAdv()}},parent_window:class extends de{constructor(e,t){if(super(e,t,ae.e.ParentWindow),window===window.parent)return this.parentWindowApiIsAlive=!1,void this.onServiceError(new Error("No parent window"));this.messageListener=new Ut,this.onServiceLoaded(),this.addStartLivenessListener()}addStartLivenessListener(){const e=Ht({action:"ping",type:"liveness"}),t=this.messageListener.addListener({fn:e=>{const{action:t,payload:a,type:r}=e;switch(r){case"liveness":"pong"===t&&(window.clearTimeout(s),this.parentWindowApiIsAlive=!0);break;case"error":this.parentWindowApiIsAlive=!1,zt("error",e);break;default:this.parentWindowApiIsAlive=!1,zt(`[${Date.now()}] Unknown message "${r}:${t}", payload = ${JSON.stringify(a)}`)}return!0},messageId:e}),s=window.setTimeout((()=>{t(),this.parentWindowApiIsAlive=!1}),2e3)}getAdvBlockId(e,t){return"parent_window"}checkCanShow(e,t){return void 0===this.parentWindowApiIsAlive?ne.Kc.Next:this.parentWindowApiIsAlive?super.checkCanShow(e,t):ne.Kc.NextRemove}showFullscreenAdv(e){return jt(this,arguments,(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:a,depth:r}){return new Promise(((n,i)=>jt(this,null,(function*(){zt.spoiler(a,r)("showFullscreenAdv",e);const o=this.lastAdReqId[ae.$.INTERSTITIAL]=t instanceof ue.i?t.request({advtype:this.serviceName,depth:r,advBlockId:this.getAdvBlockId(ae.$.INTERSTITIAL,a),reason:a}):"";t instanceof ce.U&&t.request();const d=Ht({action:"showInterstitial",type:"adv"}),l=this.messageListener.addListener({fn:a=>{const{action:d,payload:l,type:h}=a;switch(h){case"adv":if("showInterstitial"===d)switch(window.clearTimeout(c),zt("showInterstitial callback",a),l.status){case"close":return t instanceof ue.i&&t.close(o,s),e.onClose(),!0;case"empty":return t instanceof ce.U&&t.responseEmpty(),i(new A.lu(Zt.qS,{isEmpty:!0})),!0;case"error":return t instanceof ue.i&&t.error(o,s,l.error||""),t instanceof ce.U&&t.error(l.error||""),i(new Error(`ParentWindow error ${l.error||""}`)),!0;case"open":case"start":break;case"show":t.response({adReqId:o,depth:r,reason:he.Ud.SUCCESS}),t instanceof ue.i&&t.show(o,s),e.onOpen(),n();break;default:zt(`Unknown payload.status = "${l.status}"`)}break;case"error":return window.clearTimeout(c),zt("error",a),i(new Error(`ParentWindow error ${l.error||""}`)),!0;default:zt(`[${Date.now()}] Unknown message "${h}:${d}", payload = ${JSON.stringify(l)}`)}return!1},messageId:d}),c=window.setTimeout((()=>{l(),this.parentWindowApiIsAlive=!1,i(new Error("showInterstitial is not started"))}),5e3)}))))}))}showRewardedVideo(e){return jt(this,arguments,(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:a,depth:r}){return new Promise(((n,i)=>jt(this,null,(function*(){zt.spoiler(a,r)("showRewardedVideo",e);const o=this.lastAdReqId[ae.$.REWARDED]=t instanceof ue.i?t.request({advtype:this.serviceName,depth:r,advBlockId:this.getAdvBlockId(ae.$.REWARDED,a),reason:a}):"";t instanceof ce.U&&t.request();const d=Ht({action:"showRewarded",type:"adv"}),l=this.messageListener.addListener({fn:a=>{const{action:d,payload:l,type:h}=a;switch(h){case"adv":if("showRewarded"===d)switch(window.clearTimeout(c),zt("showRewarded callback",a),l.status){case"close":return t instanceof ue.i&&t.close(o,s),e.onClose(),!0;case"empty":return t instanceof ce.U&&t.responseEmpty(),i(new A.lu(Zt.qS,{isEmpty:!0})),!0;case"error":return t instanceof ue.i&&t.error(o,s,l.error||""),t instanceof ce.U&&t.error(l.error||""),i(new Error(`ParentWindow error ${l.error||""}`)),!0;case"open":case"start":break;case"rewarded":t instanceof ue.i&&t.rewarded(o,s),e.onRewarded();break;case"show":t.response({adReqId:o,depth:r,reason:he.Ud.SUCCESS}),t instanceof ue.i&&t.show(o,s),e.onOpen(),n();break;default:zt(`Unknown payload.status = "${l.status}"`)}break;case"error":return window.clearTimeout(c),zt("error",a),i(new Error(`ParentWindow error ${l.error||""}`)),!0;default:zt(`[${Date.now()}] Unknown message "${h}:${d}", payload = ${JSON.stringify(l)}`)}return!1},messageId:d}),c=window.setTimeout((()=>{l(),this.parentWindowApiIsAlive=!1,i(new Error("showRewarded is not started"))}),5e3)}))))}))}},prebid_tgo:class extends de{constructor(e,t){var s;super(e,t,ae.e.PrebidTGO),this.fullscreenSlot=null,this.interstitialPreloadTimeout=Vt.HF,this.useRewarded=!1,this.usePrebid=!0,this.usePreload=!1,this.useMultiAuction=!1,this.waitForAuction=new g.Z,this.startPrebidAuction=(0,ns.P)((()=>{if(Yt("Start prebid auction"),this.isPrebidAuctionRunning)return;this.isPrebidAuctionRunning=!0;const{pbjs:e}=window;this.prebidAuctionTimeout=window.setTimeout((()=>{Yt("No auction handled, call empty function."),this.prebidAuctionHandler()}),Ye.XI),e.que.push((()=>ms(this,null,(function*(){e.requestBids({adUnitCodes:[this.getAdvBlockId(ae.$.INTERSTITIAL)],bidsBackHandler:this.prebidAuctionHandler,timeout:Ye.ZV})}))))}),Ye.kw),this.prebidAuctionHandler=(e,t)=>{clearTimeout(this.prebidAuctionTimeout),t&&(0,ge.fF)(new Error("[prebid_sticky] Auction finished with bidders timed out.")),(0,rs.H)({advTag:ae.$.INTERSTITIAL,adUnitCodes:[this.getAdvBlockId(ae.$.INTERSTITIAL)],bids:e});const{pbjs:s,googletag:a}=window;a.cmd.push((()=>{s.que.push((()=>{s.setTargetingForGPTAsync([this.getAdvBlockId(ae.$.INTERSTITIAL)]),Yt("End prebid auction"),this.waitForAuction.resolve(),this.isPrebidAuctionRunning=!1}))}))},this.showFullscreenAdv=e=>ms(this,[e],(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:a,depth:r,initialTag:n}){return new Promise(((i,o)=>ms(this,null,(function*(){this.clearPreloadInterstitialTimer();let l="";this.usePreload||(l=this.lastAdReqId[ae.$.INTERSTITIAL]=t instanceof ue.i?t.request({advBlockId:this.getAdvBlockId(ae.$.INTERSTITIAL,a),advtype:this.serviceName,depth:r,reason:a}):"",this.usePrebid&&this.useMultiAuction&&(yield this.waitForAuction.promise)),yield(0,tt.bT)((()=>ms(this,null,(function*(){try{if(!this.usePreload){if(null===this.fullscreenSlot)return void o(new Error("Called showFullscreenAdv, while gptSlot not ready"));!function({slot:e,method:t,debugLog:s}){t===v.qb.CLEAR_BEFORE_REFRESH?e?(s("Clearing slot before refresh with googletag.pubads().clear"),googletag.pubads().clear([e])):s("No slot to clear"):t===v.qb.INNER_TEXT_BEFORE_REFRESH&&(s("Clearing slot before refresh with el.innerText"),Kt())}({method:this.clearSlotMethod,slot:this.fullscreenSlot,debugLog:Yt})}let c=!1;if(Yt("Call fullscreen show"),d.Z.post({type:"adv-fullscreen-block",action:"show",data:{onOpen:()=>{e.onOpen(!1)},onClose:()=>{t instanceof ue.i&&c&&(n===ae.$.REWARDED&&t.rewarded(l,s),t.close(l,s)),function({slot:e,method:t,debugLog:s}){t===v.qb.CLEAR_AFTER_ONCLOSE?e?(s("Clearing slot after onClose with googletag.pubads().clear"),googletag.pubads().clear([e])):(s("Clearing slot after onClose with googletag.pubads().clear"),s("No slot to clear")):t===v.qb.INNER_TEXT_AFTER_ONCLOSE&&(s("Clearing slot after onClose with el.innerText"),Kt())}({method:this.clearSlotMethod,slot:this.fullscreenSlot,debugLog:Yt}),(n!==ae.$.REWARDED||c)&&(e.onClose(c),this.preloadInterstitial())}}}),this.usePreload){const{isEmpty:e,adReqId:n,clickDaemon:o}=yield this.interstitialPreload.preload({reason:a,depth:r,clickDaemon:t});if(l=this.lastAdReqId[ae.$.INTERSTITIAL]=null!=n?n:"",t instanceof ce.U&&o instanceof ce.U&&t.bindRequest(o),e)throw new A.lu(Ye.XO.EMPTY_SLOT,{isEmpty:!0});c=!0,i(),yield this.interstitialPreload.show(),t instanceof ce.U?t.show():t instanceof ue.i&&t.show(l,s),d.Z.post({type:"adv-fullscreen-block",action:"show-controls",data:{blockName:this.serviceName}})}else{const e=Date.now();this.slotRenderEndedCallback=a=>{const n=Date.now()-e;Yt(`Googletag slot render time: ${n}ms`),(0,ie.s4)("play_prebid_interstitial_slot_render_time",n),a.isEmpty?(t instanceof ce.U?t.responseEmpty():(t.response({adReqId:l,depth:r,reason:he.Ud.EMPTY}),t.noContent(l,s)),o(new A.lu(Ye.XO.EMPTY_SLOT,{isEmpty:!0}))):(c=!0,t instanceof ce.U?t.response():t.response({adReqId:l,depth:r,reason:he.Ud.SUCCESS}),i()),this.usePrebid&&this.useMultiAuction&&googletag.cmd.push((()=>{this.startPrebidAuction()}))},t instanceof ce.U?(this.slotImpressionViewableCallback=()=>{t.show()},t.request()):t instanceof ue.i&&(this.slotImpressionViewableCallback=()=>{t.show(l,s)}),googletag.pubads().refresh([this.fullscreenSlot])}}catch(e){this.preloadInterstitial(),o(e)}}))))}))))})),this.showRewardedVideo=e=>ms(this,[e],(function*({callbacks:e,clickDaemon:t,adSeqId:s,depth:a,reason:r}){return new Promise(((n,i)=>ms(this,null,(function*(){try{const{isEmpty:i,adReqId:o,waitForShow:d,clickDaemon:l}=yield this.rewardedPreload.preload({depth:a,clickDaemon:t,reason:r});let c=this.lastAdReqId[ae.$.REWARDED]=null!=o?o:"";if(t instanceof ce.U&&l instanceof ce.U&&t.bindRequest(l),i||!d)throw new A.lu(Ye.XO.EMPTY_SLOT,{isEmpty:!0});n(),t instanceof ue.i&&t.show(c,s),e.onOpen(!0);const{wasShown:h}=yield d({onRewarded:()=>{t instanceof ue.i&&t.rewarded(c,s),e.onRewarded()}});t instanceof ue.i&&t.close(c,s),e.onClose(h)}catch(e){i(e)}}))))}));const{flags:a}=e;this.isTagActive(ae.$.INTERSTITIAL)&&(0,T.Wv)(a)||(this.usePrebid=!1),this.useMultiAuction=(0,T.A)(a),this.isTagActive(ae.$.REWARDED)&&(this.useRewarded=!0,this.rewardedPreload=new ss(this)),this.usePreload=!(0,T.Ye)(a),this.usePreload&&(this.interstitialPreload=new Qt(this)),this.clearSlotMethod=null!=(s=(0,Pe.getDomainConfig)().adv.clearSlotMethod)?s:(0,T.hs)(a),this.api=new rt.Z(window.appData.apiData),this.init()}getTimeoutExtraTime(e,t){if(e===ne.QA.ShowFullscreen&&t===he.p_.START_FULLSCREEN)return 2e3}getAdvBlockId(e,t=he.p_.ONSPOT){switch(e){case ae.$.INTERSTITIAL:return t===he.p_.START_FULLSCREEN?this.advManager.allPrebidAdvBlocks.preroll:this.advManager.allPrebidAdvBlocks.interstitial;case ae.$.REWARDED:return this.advManager.allPrebidAdvBlocks.rewarded;default:throw new Error(`AdvTag ${e} not supported by this service.`)}}init(){return ms(this,null,(function*(){var e,t;const s=(0,as.cQ)({cdnUrl:this.advManager.context.cdnUrl,flags:this.advManager.flags,fullUrl:window.location.href,options:{isSlowCountry:this.advManager.context.isSlowCountry}});yield(0,tt.xq)({metrikaCounter:null==(e=(0,Pe.getDomainConfig)().analytics.counters)?void 0:e.metrika,parallel:null!=(t=(0,T.RM)(this.advManager.flags,ye.Z.prebidLoadAfterGpt))&&t,prebidScriptUrl:this.usePrebid?s:void 0}).then((e=>{e.prebid||(this.usePrebid=!1,this.waitForAuction.resolve(),e.prebidError&&(0,A.g5)(this,{error:new Error(`Failed to load Prebid.js: ${e.prebidError.message}`)})),e.gpt?window.setTimeout((()=>{this.initGPT().then((()=>this.usePrebid?this.initPrebid():void 0)).then((()=>{this.interstitialPreloadTimeout===Vt.HF&&this.preloadInterstitial(),this.useRewarded&&this.hasRewarderdAdv&&this.rewardedPreload.preload().catch((e=>Yt("Preload error",e)))})).catch((e=>{Yt(e),this.onServiceError(e)}))}),0):(Yt(e.gptError),this.onServiceError(e.gptError))}))}))}initGPT(){return ms(this,null,(function*(){return yield(0,tt.Vg)(),(0,tt.bT)((e=>{var t,s;const a=e.pubads(),r=this.options.tags[ae.$.INTERSTITIAL]===ne.pP.Start?he.p_.START_FULLSCREEN:he.p_.ONSPOT;if(!this.usePreload){if(this.fullscreenSlot=null!=(s=null==(t=e.defineSlot(this.getAdvBlockId(ae.$.INTERSTITIAL,r),(0,Xt.iv)(this.advManager.flags),K))?void 0:t.addService(a))?s:null,!this.fullscreenSlot)throw new Error(Ye.XO.NO_SLOT);a.addEventListener("slotRenderEnded",(e=>{var t;const{slot:s}=e;s===this.fullscreenSlot&&(null==(t=this.slotRenderEndedCallback)||t.call(this,e))})).addEventListener("impressionViewable",(e=>{var t;const{slot:s}=e;s===this.fullscreenSlot&&(null==(t=this.slotImpressionViewableCallback)||t.call(this,e),d.Z.post({type:"adv-fullscreen-block",action:"show-controls"}))}))}e.enableServices(),this.onServiceLoaded()}))}))}initPrebid(){return ms(this,null,(function*(){yield(0,as.BA)((e=>ms(this,null,(function*(){yield(0,as.OH)();const t=(0,T.Ed)(this.advManager.flags)?"dsail":"default",s=((e,t)=>ds(e,ls(t)))(((e,t)=>{for(var s in t||(t={}))hs.call(t,s)&&ps(e,s,t[s]);if(cs)for(var s of cs(t))us.call(t,s)&&ps(e,s,t[s]);return e})({},(0,Ye.Vc)("desktop",t,this.advManager.flags)),{code:this.getAdvBlockId(ae.$.INTERSTITIAL)}),a=(0,T.QR)(this.advManager.flags,ye.Z.prebidExtraBids);if((0,is.GI)(a)){const e=a.reduce(((e,t)=>(Ye.Hf[t]&&e.push(Ye.Hf[t]),e)),[]);s.bids=[...s.bids,...e]}const r=(0,T.QR)(this.advManager.flags,ye.Z.prebidDisabledBids);(0,is.GI)(r)&&(s.bids=s.bids.filter((({bidder:e})=>!r.includes(e)))),Yt("interstitial ad units react",s),e.addAdUnits(s),e.onEvent("auctionEnd",(e=>{const t=e.auctionEnd-e.timestamp;Yt(`Prebid auction took: ${t}ms`),(0,ie.s4)("play_prebid_interstitial_auction_time",t)})),this.usePreload||window.googletag.cmd.push((()=>{this.startPrebidAuction()}))}))))}))}clearPreloadInterstitialTimer(){clearTimeout(this.interstitialPreloadTimeout)}preloadInterstitial(){this.usePreload&&(this.clearPreloadInterstitialTimer(),this.interstitialPreloadTimeout=window.setTimeout((()=>{this.interstitialPreload.preload({beforeRequest:this.usePrebid?()=>(this.waitForAuction.resolve(),this.waitForAuction=new g.Z,this.startPrebidAuction(),this.waitForAuction.promise):void 0})}),.75*this.advManager.minIntervalBetweenAds))}cancelShow(e){switch(e){case ae.$.INTERSTITIAL:d.Z.post({type:"adv-fullscreen-block",action:"hide"});break;case ae.$.REWARDED:this.rewardedPreload.cancel()}}onShowAdvFinished({tag:e}){switch(e){case ae.$.INTERSTITIAL:break;case ae.$.REWARDED:window.setTimeout((()=>{this.rewardedPreload.preload().catch((e=>Yt("Preload error",e)))}),.75*this.advManager.minIntervalBetweenAds)}}},promo:qt,transsion:class extends de{constructor(e,t){super(e,t,ae.e.Transsion),this.onScriptLoaded=e=>{var t,s;const{advManager:a}=this,{playPageData:r}=a.context;null==(s=window.h5sdk)||s.init(parseInt(r.gameInfo.appId,10),"","","","",{float:{env:"pre"},ga:{id:null==(t=(0,Pe.getDomainConfig)().analytics.counters)?void 0:t.ga},adsense:{client:e.dataset.adClient,"data-ad-channel":e.dataset.adChannel,"data-ad-frequency-hint":e.dataset.adFrequencyHint,callback:()=>{var e;null==(e=window.h5sdk)||e.adConfig({preloadAdBreaks:"on",sound:"off",onReady:()=>{this.onServiceLoaded()}})}}})},this.onScriptLoadedWithError=e=>{this.onServiceError(e)},this.processShowResult=({clickDaemon:e,depth:t,info:s,reject:a,resolve:r,tag:n})=>{if(["viewed","dismissed"].includes(s.breakStatus))return e.response({adReqId:this.lastAdReqId[n],depth:t,clickUrl:"",reason:he.Ud.SUCCESS}),void r();const i=!["noAdPreloaded","other","timeout"].includes(s.breakStatus);e.response({adReqId:this.lastAdReqId[n],depth:t,clickUrl:"",reason:i?`${he.Ud.ERROR}_${s.breakStatus}`:he.Ud.EMPTY}),a(new A.lu(`Transsion AdBreak returned ${s.breakStatus} status`,{isEmpty:!i}))},this.openWithLog=(e,t,s,a)=>()=>{e instanceof ue.i&&e.show(t,s),null==a||a(),this.api.sendAdvShow({advService:this.serviceName,googleKeyValues:this.googleKeyValues})},this.closeWithLog=(e,t,s,a)=>()=>{e instanceof ue.i&&e.close(t,s),null==a||a(!0)},this.showFullscreenAdv=e=>gs(this,[e],(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:a,depth:r}){return new Promise(((n,i)=>{var o,d,l;const{advManager:c}=this,h=null!=(o=(0,T.di)(c.flags,ye.Z.transsionFullscreenPlacementType))?o:"preroll",u=t instanceof ue.i?t.request({advBlockId:vs,advtype:this.serviceName,depth:r,reason:a}):"";"preroll"===h?null==(d=window.h5sdk)||d.adBreak({adBreakDone:a=>{"viewed"!==a.breakStatus&&"dismissed"!==a.breakStatus||(this.openWithLog(t,u,s,e.onOpen)(),this.closeWithLog(t,u,s,e.onClose)()),this.processShowResult({tag:ae.$.INTERSTITIAL,depth:r,info:a,clickDaemon:t,resolve:n,reject:i})},type:h}):null==(l=window.h5sdk)||l.adBreak({afterAd:this.closeWithLog(t,u,s,e.onClose),adBreakDone:e=>{this.processShowResult({tag:ae.$.INTERSTITIAL,depth:r,info:e,clickDaemon:t,resolve:n,reject:i})},beforeAd:()=>{this.openWithLog(t,u,s,e.onOpen)},type:h})}))})),this.showRewardedVideo=e=>gs(this,[e],(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:a,depth:r}){return new Promise(((n,i)=>{var o;const d=this.lastAdReqId[ae.$.REWARDED]=t instanceof ue.i?t.request({advBlockId:vs,advtype:this.serviceName,depth:r,reason:a}):"";null==(o=window.h5sdk)||o.adBreak({adDismissed:this.closeWithLog(t,d,s,e.onClose),afterAd:this.closeWithLog(t,d,s,e.onClose),adBreakDone:e=>{this.processShowResult({tag:ae.$.REWARDED,depth:r,info:e,clickDaemon:t,resolve:n,reject:i})},adViewed:e.onRewarded,beforeAd:()=>{this.openWithLog(t,d,s,e.onOpen)},beforeReward:e=>{e()},type:"reward"})}))})),this.api=new rt.Z(window.appData.apiData),this.init()}getAdvBlockId(e){return vs}getTimeoutExtraTime(e){return e===ne.QA.ServiceInit?5e3:1e4}init(){this.loadScript(),(0,tt.N5)().then((e=>{this.googleKeyValues=e}))}loadScript(){var e,t,s;window.t3wgame=!0;const{advManager:a}=this,{playPageData:r}=a.context;let n=(0,T.di)(a.flags,ye.Z.transsionAdChannel);if(!n){const{gameSettings:a}=r;(null==(s=null==(t=null==(e=null==a?void 0:a.advInfo)?void 0:e.adsense)?void 0:t.channel)?void 0:s.id)&&(n=a.advInfo.adsense.channel.id)}(0,we.x)({id:"transsion-script",dataset:{adChannel:n,adClient:vs,adFrequencyHint:"50s"},src:"https://www.hippoobox.com/static/sdk/adsdk_1.4.0.0.js"}).then((e=>{this.validateH5SdkObject(window.h5sdk)&&this.onScriptLoaded(e)})).catch((e=>{this.onScriptLoadedWithError(e)}))}validateH5SdkObject(e){if(!e||"object"!=typeof e)throw new Error("Can not find valid window.h5sdk");if("function"!=typeof e.init)throw new Error("window.h5sdk.init method is not a function");return!0}},yandex:class extends de{constructor(e,t){super(e,t,ae.e.Yandex),this.isFullscreenShowing=!1,this.isRewardedShowing=!1,this.showAdvCallbacks={[ae.$.INTERSTITIAL]:null,[ae.$.REWARDED]:null},this.closeAdvOnEscape=null,this.onScriptLoadedSuccessful=()=>{this.onScriptFinish((()=>{this.fullscreenPrerender||!this.isTagActive(ae.$.INTERSTITIAL)||this.isTagWaterfall(ae.$.INTERSTITIAL)||!this.hasFullscreenAdv||this.advManager.isAdvDisabled||(this.fullscreenPrerender=this.initFullscreenPrerender(this.options.tags[ae.$.INTERSTITIAL]===ne.pP.Start?he.p_.START_FULLSCREEN:he.p_.PRELOAD,this.getClickDaemon(ae.$.INTERSTITIAL))),this.isTagActive(ae.$.REWARDED)&&!this.isTagWaterfall(ae.$.REWARDED)&&this.hasRewarderdAdv&&this.initRewardedPrerender()})),this.onServiceLoaded()},this.onScriptLoadedWithError=e=>{Ls(),this.onServiceError(e)},this.debounceNewFullscreenAdvLoad=()=>{this.isRewardedShowing||(0,T.iH)(this.advManager.flags)||this.preloadFullscreenAdv(he.p_.PRELOAD)},this.cssClasses=Cs(),this.cssViewTypeClass=(0,A.TE)(e.viewType),this.debounceNewFullscreenAdvLoad=(0,Na.D)(this.debounceNewFullscreenAdvLoad,1e3),this.init()}init(){this.closeOnEscape(),this.initMessaging()}initMessaging(){d.Z.onInternalMessage("yandex-adv-service",(e=>{switch(e.data.action){case"close-adv":case"bottom-button-close-adv":this.hideFullscreenAdv(!0);break;case"adv-container-mounted":this.advContainer=document.querySelector(`.${Zt.kn.modal}.${(0,A.el)("yandex")}.${Zt.kn.modalFullscreen}`),this.loadScript(),this.initDOMEvents()}}))}initDOMEvents(){const{advManager:{viewType:e,flags:t}}=this;e===Zt.xd.fullscreen&&(window.addEventListener("resize",(()=>{this.savedPageYOffset=(0,A.SW)(this.advContainer)})),qe.Z.addChangeListener((()=>{this.isFullscreenShowing&&(0,T.iH)(t)?(Ts("Screen orientation was changed, set `rerenderForced = true` and hide/show."),this.hideFullscreenAdv(void 0,!0)):this.debounceNewFullscreenAdvLoad()})),(0,A.zw)())}loadScript(){Array.isArray(window.yandexContextAsyncCallbacks)||(window.yandexContextAsyncCallbacks=[]),window.yandexContextAsyncCallbacks.push(this.onScriptLoadedSuccessful),(0,we.x)({id:"yandexads-context",src:this.advManager.context.yaAdsScript}).catch(this.onScriptLoadedWithError)}getLastAdReqId(e){var t,s;return e===ae.$.INTERSTITIAL?null==(t=this.fullscreenPrerender)?void 0:t.adReqId:e===ae.$.REWARDED?null==(s=this.rewardedPrerender)?void 0:s.adReqId:this.lastAdReqId[e]}getTimeoutExtraTime(e,t){if(e===ne.QA.ShowFullscreen&&t===he.p_.WATERFALL)return 1500}startPrerenderDelayPromise(e){this.prerenderDelayPromise=new Promise((t=>{setTimeout((()=>{null==e||e(),t()}),2e3)}))}initFullscreenPrerender(e,t){if(this.fullscreenPrerender)return this.fullscreenPrerender;const{flags:s}=this.advManager;return Ts("initFullscreenPrerender, reason =",e),Ts(`isPreloadFullscreenAdvExperimentEnabled = ${(0,T.iH)(s)}`),(0,T.iH)(s)?new la(this,e,t):new Qs(this,e,t)}initRewardedPrerender(e=he.p_.PRELOAD){if(this.rewardedPrerender)return;const{advBlocks:t,flags:s}=this.advManager;t.rewarded&&(this.rewardedPrerender=(0,T.lv)(s)?new Ba(this,e):new Ea(this,e),this.preloadRewardedAdv(e))}onScriptFinish(e){Ls(),this.startPrerenderDelayPromise(e)}getAdvBlockId(e,t){if((0,lt.x)())return e===ae.$.REWARDED?Zt.EC.rewarded:Zt.EC.fullscreen;const{advBlocks:s,deviceType:a}=this.advManager;return e===ae.$.REWARDED?xs({advBlocks:s,deviceType:a}):Os({advBlocks:s,deviceType:a,reason:t})}closeOnEscape(){this.closeAdvOnEscape=e=>{"Escape"===e.key&&this.hideFullscreenAdv(!0)},window.addEventListener("keydown",this.closeAdvOnEscape)}hideFullscreenAdv(e,t){var s,a,r,n,i,o;this.screenUnlock(),this.isFullscreenShowing=!1,Ts("hideFullscreenAdv, rerenderForced =",t);const{advManager:l}=this;null==(s=this.destroyAdv)||s.call(this);const c=this.getClickDaemon(ae.$.INTERSTITIAL);if(t){this.preloadFullscreenAdv();const e=null!=(r=null==(a=this.fullscreenPrerender)?void 0:a.previousReason)?r:he.p_.PRELOAD;let t="";return c instanceof ue.i&&(t=c.tryOpen(this.getAdvBlockId(ae.$.INTERSTITIAL,e),this.serviceName),c.demand(void 0,0,t)),void this.showFullscreenAdv({callbacks:this.showAdvCallbacks[ae.$.INTERSTITIAL],clickDaemon:c,adSeqId:t,reason:e,depth:0,tag:ae.$.INTERSTITIAL,initialTag:ae.$.INTERSTITIAL})}(0,A.PS)(),this.closeAdvOnEscape&&(window.removeEventListener("keydown",this.closeAdvOnEscape),this.closeAdvOnEscape=null),l.deviceType!==ks.n.desktop&&(0,A.HH)(),d.Z.post({type:"yandex-fullscreen-render",action:"hide-fullscreen"}),window.scroll(0,this.savedPageYOffset),null==(n=this.fullscreenPrerender)||n.next(this.options.tags[ae.$.INTERSTITIAL]===ne.pP.Start?he.p_.PRELOAD:he.p_.PRELOAD_WATERFALL,c),e&&(null==(i=this.showAdvCallbacks[ae.$.INTERSTITIAL])||i.onClose(e),l.callOnAdvClose(e),(null==(o=this.fullscreenPrerender)?void 0:o.adSeqId)&&c.close(this.fullscreenPrerender.adReqId,this.fullscreenPrerender.adSeqId),(0,k.D)())}showAdvContainer(){const{advManager:e}=this,{flags:t}=e;this.isFullscreenShowing=!0;const{deviceType:s}=this.advManager;setTimeout((()=>{var a;window.focus(),s!==ks.n.desktop&&(0,A.xK)(),d.Z.post({type:"yandex-fullscreen-render",action:"show-fullscreen"}),this.savedPageYOffset=(0,A.SW)(this.advContainer);const r=(null==(a=this.advManager.context.uatraits)?void 0:a.OSFamily)===ws.k.IOS;s===ks.n.desktop?(0,A.ss)({advElement:this.advContainer.querySelector(`.${this.cssClasses.modalWrap}`),type:"fullscreen",flags:e.flags,appId:e.appId,isIOS:r}):(0,A.ss)({advElement:this.advContainer,type:"fullscreen",flags:e.flags,appId:e.appId,isIOS:r}),t.autoclose_adv&&setTimeout((()=>{this.hideFullscreenAdv(!0)}),t.autoclose_adv)}),0)}preloadFullscreenAdv(e){var t;null==(t=this.fullscreenPrerender)||t.next(e,this.getClickDaemon(ae.$.INTERSTITIAL))}preloadRewardedAdv(e){var t;null==(t=this.rewardedPrerender)||t.next(e)}showFullscreenAdv(e){return Ma(this,arguments,(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:a}){return new Promise(((r,n)=>Ma(this,null,(function*(){try{this.showAdvCallbacks[ae.$.INTERSTITIAL]=e,Ts("showFullscreenAdv"),this.screenLock(),this.fullscreenPrerender||(this.fullscreenPrerender=this.initFullscreenPrerender(a,t));const{fullscreenPrerender:n}=this;n.adSeqId=s,yield this.prerenderDelayPromise;const{hasContent:i,err:o,clickDaemon:d}=yield n.ready().then((e=>e.showPrerenderedAd?e.showPrerenderedAd():e));if(d&&t instanceof ce.U&&t.bindRequest(d),o)throw o;if(!i)throw new A.lu(Zt.qS,{isEmpty:!0});t instanceof ue.i&&t.show(n.adReqId,s),e.onOpen(),(0,A.WL)(),this.showAdvContainer(),r()}catch(e){this.screenUnlock(),n(e)}}))))}))}showRewardedVideo(e){return Ma(this,arguments,(function*({callbacks:e,clickDaemon:t,adSeqId:s,reason:a,depth:r}){return new Promise(((n,i)=>Ma(this,null,(function*(){var o;try{const{advManager:i}=this;if(this.showAdvCallbacks[ae.$.REWARDED]=e,!this.rewardedPrerender&&i.advBlocks.rewarded&&this.initRewardedPrerender(a),yield this.prerenderDelayPromise,!i.advBlocks.rewarded)throw new Error("partnerId is not defined, no rewarded video adv block available");yield null==(o=this.rewardedPrerender)?void 0:o.showRewardedVideo({callbacks:e,clickDaemon:t,adSeqId:s,reason:a,tag:ae.$.REWARDED,initialTag:ae.$.REWARDED,depth:r}),n()}catch(e){i(e)}}))))}))}screenLock(){const{advManager:{flags:e}}=this;(0,T.F7)(e)&&qe.Z.lock().catch((()=>{}))}screenUnlock(){const{advManager:{flags:e}}=this;(0,T.F7)(e)&&qe.Z.unlock().catch((()=>{}))}getClickDaemon(e){const{advManager:t}=this;return t.alternateLogs?new ce.U({app_id:t.appId,tag:e}):t.getClickdaemonAdvLog(e)}}},Fa=$a,qa=["onOpen","onRewarded","onClose","onError","onOffline"];const Wa=class{constructor(e,t){this.tag=e,this.clickDaemon=t,this.callbacks={},this.isOuterCallbacksMuted=!1,this.onOpen=(e=!0)=>{var t;e&&(null==(t=this.clickDaemon)||t.show()),this.safeCall("onOpen")},this.onRewarded=()=>{var e;null==(e=this.clickDaemon)||e.rewarded(),this.safeCall("onRewarded")},this.onClose=e=>{var t;e&&this.currentTag!==this.tag&&this.currentTag===ae.$.INTERSTITIAL&&this.onRewarded(),null==(t=this.clickDaemon)||t.close(),this.safeCall("onClose",void 0,e)},this.onOffline=()=>{this.safeCall("onOffline")},this.onError=e=>{this.safeCall("onError",!1,e)};for(const e of qa)this.callbacks[e]||(this.callbacks[e]=[]);this.currentTag=e}safeCall(e,t=!0,...s){if(this.isOuterCallbacksMuted)return void(0,A.qu)(`AdvCallbacks ${e} call skipped, due mute during waterfall.`);const a=this.callbacks[e];if(a)for(let r=0;r<a.length;r++){(0,A.tq)(a[r],`Error in callback ${e}: `).apply(null,s),t&&a.splice(r--,1)}}addCallbacks(e,t=!1){for(const s in e)t&&["onOpen","onRewarded"].includes(s)&&!this.callbacks[s].length?(0,A.tq)(e[s],`Error in callback ${s}`).apply(null):this.callbacks[s].push(e[s])}muteCallbacks(){this.isOuterCallbacksMuted=!0}unmuteCallbacks(){this.isOuterCallbacksMuted=!1}};var Za=s(35090);const Ga=pe.yR;class Ua{constructor(){this.setupCanShowAdv()}setupCanShowAdv(){this.canShowAdv=()=>!0,(0,Za.FN)()&&(this.canShowAdv=()=>(console.warn(`Warning: please, try to open advertising after ${Ga}ms`),!1),window.setTimeout((()=>{this.canShowAdv=()=>!0}),Ga))}}var Ha=s(92389),ja=s(21466),za=s(69543),Va=s(70135);var Ka=s(61224),Xa=s(14228),Ja=s(37918),Qa=Object.defineProperty,er=Object.defineProperties,tr=Object.getOwnPropertyDescriptors,sr=Object.getOwnPropertySymbols,ar=Object.prototype.hasOwnProperty,rr=Object.prototype.propertyIsEnumerable,nr=(e,t,s)=>t in e?Qa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,ir=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const or=(0,te.M$)("AdvManager",te.XG.Adv,{background:"seagreen"}),dr=or.tag("showAdv");class lr{constructor(e,t){var s,a,r,n,i,o,l,c;this.context=e,this.gameControl=t,this.callbacksToSdk={[ae.$.INTERSTITIAL]:null,[ae.$.REWARDED]:null},this.guardClosedPromiseWrapper=new g.Z,this.clickdaemonAdvLogs={},this._showAdvLock={[ae.$.INTERSTITIAL]:!1,[ae.$.REWARDED]:!1},this._lastShowTime={[ae.$.INTERSTITIAL]:0,[ae.$.REWARDED]:0},this.serviceInstances=void 0,this.splashScreenPromise=new g.Z,this.middleLayerInGamePromise=new g.Z,this.servicesBlocks={[ae.$.INTERSTITIAL]:{},[ae.$.REWARDED]:{}},this.handleVisibilityChange=()=>{or("handleVisibilityChange",document.visibilityState);const e=(0,T.$9)(this.flags,ye.Z.minInactivePlayTabTimeToShowAd);e&&("hidden"===document.visibilityState?this.inactiveTabTime=Date.now():this.inactiveTabTime>0&&Date.now()-this.inactiveTabTime>=e&&(or("show interstitial after inactive state"),this.showAdv(ae.$.INTERSTITIAL,{reason:he.p_.ONSPOT})))},this.onAdvManagerExternalMessage=(e,t)=>{const{action:s}=e.data;"get-disabled-state"===s&&t({data:{value:this.isInterstitialAdsDisabled}})},this.onGuardMessage=e=>{const{action:t}=e.data;"set-was-showed"===t&&this.resolveGuardPromise()},this.onSplashMessage=e=>{const{action:t}=e.data;"set-was-closed"===t&&this.resolveSplashScreenPromise()},this.onMiddleLayerMessage=e=>{const{action:t}=e.data;"close"===t&&this.resolveMiddleLayerPromise()},this.onSubscriptionsMessage=e=>{const{action:t}=e.data;"changed"===t&&this.readNoAdsSubscriptionValue()},this.onFrameMessage=e=>{const{action:t}=e.data;t===Va.ur.IframeLoaded&&(this.initServices(ae.$.INTERSTITIAL),this.initServices(ae.$.REWARDED),d.Z.offInternalMessage("frame",this.onFrameMessage))},this.deviceType=e.deviceType,this.allAdvBlocks=e.allAdvBlocks,this.allPrebidAdvBlocks=e.allAdvBlocks.prebid;const h=e.playPageData.gameSettings,u={advBlocks:h.advBlocks,partnerId:null!=(a=null==(s=h.advBlocks.desktop)?void 0:s.fullscreen)?a:h.advBlocks.fullscreen,rewardedVideoPartnerId:null!=(n=null==(r=h.advBlocks.desktop)?void 0:r.rewarded)?n:h.advBlocks.rewarded},{advBlocks:p={fullscreen:u.partnerId,rewarded:u.rewardedVideoPartnerId}}=u,{flags:m}=e.abt;this.flags=m,this.alternateLogs=null==(i=(0,T.RM)(m,ye.Z.advAlternateLogs))||i,this.withWorldWideAdv=Boolean(e.withWorldWideAdv);const w=(0,Za.pN)(["a_delay","clid",ht.Je,"min-interval-between-ads","utm_medium"]),f=(0,ja.k4)(w.utm_medium,w.clid);this.deviceId=w[ht.Je],this.appId=e.playPageData.gameInfo.appId,this.viewType=this.deviceType===ks.n.desktop?Zt.xd.desktop:Zt.xd.fullscreen,this.advBlocks=(0,A.$3)(p,this.appId,m),this.residenceInfo=null==(o=h.advInfo)?void 0:o.residence_info,this.advUsedBlocks=h.advUsedBlocks,this.startTime=Date.now(),this.lang=e.playPageData.request.lang,this.minIntervalBetweenAds=(0,A.mx)(w["min-interval-between-ads"],m,this.withWorldWideAdv),this.advDelay=(0,A.dh)(w.a_delay)||(0,T.$9)(m,ye.Z.advDelay)||Ja.JV[(0,Gs.KT)()]||(e.isTranssion?Zt.Sk:0),this.isRewardedAdsDisabled=f,this.isInterstitialAdsDisabled=f,this.isInterstitialAdsTurnOff=(0,T.Ww)(m,v.By.FULLSCREEN),this.isRewardedAdsTurnOff=(0,T.Ww)(m,v.By.REWARDED),this.isDisableAdButtonEnabled=(0,T.RM)(m,ye.Z.disableAdButton)||!1,this.firstShowGuard=new Ua,this.advBlocks.fullscreen||(null==(l=this.advBlocks.desktop)?void 0:l.fullscreen)||(null==(c=this.advBlocks.mobile)?void 0:c.fullscreen)||(0,A.ey)(this.appId),void 0!==w.a_delay&&(0,A.R4)(),f&&(this.reasonForDisablingAd="utm",this.sendAdvDisabledToChild(this.reasonForDisablingAd)),this.readNoAdsSubscriptionValue(),or("advUsedBlocks",this.advUsedBlocks),this.waterfallQueue=(0,ca.gK)({flags:this.flags,withWorldWideAdv:this.withWorldWideAdv}),or("waterfallQueue",this.waterfallQueue),this.initMessaging(),this.showStartFullscreenAdv(),(0,Xa.y)().then((e=>{e||this.resolveGuardPromise()})),e.isGamesApp&&!this.isInterstitialAdsTurnOff&&(0,ca.sf)(this.waterfallQueue.interstitial,ae.e.Native)&&At({advBlocks:this.advBlocks,flags:m,residenceInfo:this.residenceInfo}),this.guardClosedPromiseWrapper.promise.then((()=>{document.addEventListener("visibilitychange",this.handleVisibilityChange)})),this.logAdvDelayFlag=Boolean(window.appData.logAdvDelay)}get adOpenedType(){return this._adOpenedType}set adOpenedType(e){or(`Set adOpenedType to: ${e}`),this._adOpenedType=e}get showAdvLock(){return this._showAdvLock}get lastShowTime(){return this._lastShowTime}get isAllAdvDisabledByPartnersKit(){const{abt:{flags:e},referrerClid:t}=this.context;return(0,Ka.VX)({flags:e,referrerClid:t,userAgent:window.navigator.userAgent})}showStartFullscreenAdv(){if((0,T.Ww)(this.flags,v.By.START_FULLSCREEN))return;const e=(0,ca.C5)({advBlocks:this.advBlocks,flags:this.flags,withWorldWideAdv:this.withWorldWideAdv});e&&(or("Show fullscreen on start (preroll)"),this.callOnAdvClose(),this.showAdv(ae.$.INTERSTITIAL,{reason:he.p_.START_FULLSCREEN,sendToSDK:!1},e))}get isAdvDisabled(){return this.isInterstitialAdsDisabled||this.isInterstitialAdsTurnOff||!0===this.isAllAdvDisabledByPartnersKit}initServices(e,t=this.waterfallQueue[e],s=he.p_.ONSPOT){var a;const r=(a,r)=>{if(s===he.p_.START_FULLSCREEN&&e===r)return ne.pP.Start;switch((0,ca.Jt)(e===r?t:this.waterfallQueue[r],a)){case-1:return ne.pP.Skip;case 0:return ne.pP.Onspot;default:return ne.pP.Waterfall}},n=new Set;if(t.forEach((e=>n.add(e.provider))),this.serviceInstances=[...n].reduce(((e,t)=>{if(e[t])return e;try{const s=Fa[t];e[t]=new s(this,{tags:{[ae.$.INTERSTITIAL]:r(t,ae.$.INTERSTITIAL),[ae.$.REWARDED]:r(t,ae.$.REWARDED)},serviceName:t}),e[t].initPromise.promise.catch((()=>{})),or(`Service ${t} inited.`)}catch(e){(0,ge.fF)(e)}return e}),null!=(a=this.serviceInstances)?a:{}),!t.every((({provider:t})=>this.servicesBlocks[e][t]))){or.spoiler(this.serviceInstances)(`Services for tag ${e}:${s} inited`);for(const{provider:s}of t)this.servicesBlocks[e][s]=!0;d.Z.post({type:"play-adv-manager",action:"update-adv-services-list",data:this.servicesBlocks})}}updateDisableAdvButtonVisibility(e){if(!this.isDisableAdButtonEnabled)return;const t=(0,Ha._)("aab-adv");e?t.classList.contains(Zt.Si)&&t.classList.remove(Zt.Si):t.classList.contains(Zt.Si)||t.classList.add(Zt.Si)}sendAdvDisabledToChild(e){or("readNoAdsSubscriptionValue, this.isInterstitialAdsDisabled = ",this.isInterstitialAdsDisabled,", reason = ",e),d.Z.hasChild()&&d.Z.postToChild(za.fB.SetDisabledState({reason:e,value:this.isInterstitialAdsDisabled}))}readNoAdsSubscriptionValue(){d.Z.post({type:"subscriptions",action:"has",data:{key:"no_ads"}}).then((e=>{const{res:t}=e.data;this.updateDisableAdvButtonVisibility(t),"utm"!==this.reasonForDisablingAd&&this.isInterstitialAdsDisabled!==t&&(this.isInterstitialAdsDisabled=t,this.reasonForDisablingAd="subscription",this.sendAdvDisabledToChild(this.reasonForDisablingAd))}))}resolveGuardPromise(){this.guardClosedPromiseWrapper.resolve(void 0),d.Z.offInternalMessage("guard",this.onGuardMessage)}resolveSplashScreenPromise(){this.splashScreenPromise.resolve(void 0),d.Z.offInternalMessage("splash",this.onSplashMessage)}resolveMiddleLayerPromise(){this.middleLayerInGamePromise.resolve(void 0),d.Z.offInternalMessage("middle-layer",this.onMiddleLayerMessage)}initMessaging(){var e;d.Z.onInternalMessage("guard",this.onGuardMessage,{withHistory:!0}),d.Z.onInternalMessage("subscriptions",this.onSubscriptionsMessage,{withHistory:!0}),d.Z.onExternalMessage("adv-manager",this.onAdvManagerExternalMessage),d.Z.onInternalMessage("frame",this.onFrameMessage,{withHistory:!0}),this.context.isAdvSplashScreenEnabled?d.Z.onInternalMessage("splash",this.onSplashMessage):this.splashScreenPromise.resolve(void 0),(null==(e=this.context.middleLayerInGameData)?void 0:e.show)?d.Z.onInternalMessage("middle-layer",this.onMiddleLayerMessage):this.middleLayerInGamePromise.resolve(void 0),d.Z.onExternalMessage("adv-manager",((e,t)=>{switch(e.data.action){case"adv-show-fullscreen":this.callbacksToSdk[ae.$.INTERSTITIAL]=t,this.showAdv(ae.$.INTERSTITIAL,{reason:he.p_.ONSPOT});break;case"adv-show-rewarded-video":this.callbacksToSdk[ae.$.REWARDED]=t,this.showAdv(ae.$.REWARDED,{reason:he.p_.ONSPOT})}}))}callOnAdvClose(e=!1){or("callOnAdvClose",e),d.Z.post({type:"adv-manager",action:"on-adv-close",data:{wasShown:e}})}waitServiceInit(e,t){const{serviceName:s}=e;return e.initPromise.state!==g.C.Pending?e.initPromise.promise:Promise.race([e.initPromise.promise,(0,Ce.D)((0,A.uD)(this.flags,e,t)).then((()=>{throw new Error(`Ad script init timeout, serviceName: ${s}`)}))])}waitShowAdv(e,t,s){const a=(t===ae.$.INTERSTITIAL?e.showFullscreenAdv:e.showRewardedVideo).bind(e);return Promise.race([a(s),(0,Ce.D)((0,A.gp)(this.flags,t,e,s.reason)).then((()=>{throw new Error(`Ad showAdv(${t}) timeout, serviceName: ${e.serviceName}`)}))])}getClickdaemonAdvLog(e){let t=this.clickdaemonAdvLogs[e];return t||(t=new ue.i({tag:e,app_id:this.appId}),this.clickdaemonAdvLogs[e]=t),t}sendCallbackToSdk(e,t){var s,a;null==(a=(s=this.callbacksToSdk)[e])||a.call(s,{data:{error:t}}),this.callbacksToSdk[e]=null}showServiceAdv(e,t,s){return ir(this,arguments,(function*(e,t,s,{adSeqId:a,clickDaemon:r,depth:n,reason:i,initialTag:o}=s){var d;try{dr(`Service ${e.serviceName} start processing ${t}:${i}`),r instanceof ue.i?r.demand(he.o9.SKIP,n,a,{advtype:e.serviceName,advBlockId:e.getAdvBlockId(t,i)}):n?r.waterfall({provider:e.serviceName,advBlockId:e.getAdvBlockId(t,i),depth:n,reason:i,tag:o}):r.demand({provider:e.serviceName,advBlockId:e.getAdvBlockId(t,i),depth:0,reason:i}),yield Promise.all([this.guardClosedPromiseWrapper.promise,this.splashScreenPromise.promise,this.middleLayerInGamePromise.promise,this.waitServiceInit(e,i)]);const d=yield this.waitShowAdv(e,t,s);if("function"==typeof d)try{yield d()}catch(e){if(e instanceof Error){const t=new A.lu(e.message,((e,t)=>er(e,tr(t)))(((e,t)=>{for(var s in t||(t={}))ar.call(t,s)&&nr(e,s,t[s]);if(sr)for(var s of sr(t))rr.call(t,s)&&nr(e,s,t[s]);return e})({},e.params),{wasShown:!0}));throw t.stack=e.stack,t}throw e}return dr(`Service ${e.serviceName} processed ${t}:${i}`),{status:ne.mb.Ok}}catch(n){dr(`Service ${e.serviceName} ${t}:${i} error:`,n),s.callbacks.muteCallbacks(),n instanceof Error||(n=new Error("Unhandled undefined error (safe)")),null==(d=e.cancelShow)||d.call(e,t),(0,A.g5)(e,{additional:{adv:{advBlockId:e.getAdvBlockId(t,i)}},error:n,name:Zt._u,tag:t});const o=e.getLastAdReqId(t);return r instanceof ce.U?n instanceof A.lu&&n.params.isEmpty||r.error(n.message):o?r.error(o,a,n.message):r.errorNoRequest({adSeqId:a,advBlockId:e.getAdvBlockId(t,i),provider:e.serviceName,error:n.message}),n instanceof A.lu&&n.params.isEmpty?{status:ne.mb.Empty,error:n}:n instanceof A.lu&&n.params.wasShown?{status:ne.mb.FailedShow,error:n}:{status:ne.mb.Failed,error:n}}}))}mergeShowAdv(e,t,s,a){let r=this.showAdvLock[e];if(r){const[n,i]=r;if(n===he.p_.START_FULLSCREEN)return i.addCallbacks(t,!0),a&&(0,A.Sn)(i,e),dr(`showAdv ${e}:${s} was merged with ${e}:${n}`),!0}return!1}showAdv(e,t){return ir(this,arguments,(function*(e,t,s=this.waterfallQueue[e]){var a,r;dr.spoiler(t)(`showAdv ${e}:${t.reason}`);const n=this.logAdvDelay(e);let i,{reason:o}=t,{callbacks:l={},sendToSDK:c=!0}=t;if(this.mergeShowAdv(e,l,o,c))return;this.initServices(e,s,o);let h,u="";h=this.alternateLogs?new ce.U({tag:e,app_id:this.appId}):this.getClickdaemonAdvLog(e);const p=new Wa(e,h instanceof ce.U?h:void 0);p.addCallbacks(l),(0,A.fl)(p,e,this.context.platform).catch((()=>{})),(0,A.KW)(p,this.flags),c&&(0,A.Sn)(p,e);const m=()=>this.adOpenedType=null;p.addCallbacks({onClose:m,onError:m,onOffline:m});let v=0,g=0,w=ne.mb.Failed,f=e,y=h,b=[];p.addCallbacks({onClose:()=>{var t;dr("callOnShowAdvFinished"),d.Z.post({type:"play-adv-manager",action:"close-adv",data:{tag:e}});try{for(const a of b){const r=null==(t=this.serviceInstances)?void 0:t[a.provider];r&&r.onShowAdvFinished&&r.onShowAdvFinished({tag:a.tag||e,latestTag:f,initialTag:e,status:w,waterfallItems:s})}}catch(e){or("Failed to call AdvService.onShowAdvFinished, error:",e.message)}},onOpen:()=>null==n?void 0:n(g,f)});try{const t=()=>{var t,a;const r=s[v];if(!r)throw new A.lu(`No available waterfall item for tag ${e}:${o}`,{isFinal:!0});const n=null==(t=this.serviceInstances)?void 0:t[null==r?void 0:r.provider];if(!n)throw new A.lu(`No available service for tag ${e}:${o}, waterfall provider: ${null!=(a=null==r?void 0:r.provider)?a:ae.e.None}`,{isFinal:!0});return[n,r]};do{p.unmuteCallbacks();const[s,a]=t();if(i)dr(`Service ${i.serviceName} failed to show adv, go to waterfall. Next service: ${null==s?void 0:s.serviceName}`);else{h instanceof ce.U?h.tryOpen({reason:o,provider:s.serviceName}):u=h.tryOpen(s.getAdvBlockId(e,o),s.serviceName);const t=this.advDisabledCheck(e,u,p,h);if(t)return void this.sendCallbackToSdk(e,t);this._showAdvLock[e]=[o,p],this._lastShowTime[e]=Date.now()}this.adOpenedType=e,this.sendCallbackToSdk(e),i=s,[f,y]=a.tag?[a.tag,this.getClickdaemonAdvLog(e)]:[e,h],f!==p.currentTag&&(p.currentTag=f),g>0&&(o=he.p_.WATERFALL);const r=i.checkCanShow(e,o);if(r!==ne.Kc.Ok){dr(`Skip service ${i.serviceName} due canShowCheck: ${r}`),v++;continue}b.push(a),d.Z.post({type:"play-adv-manager",action:"show-adv",data:{tag:e,serviceName:i.serviceName}}),this.gamePauseResume(e,p);const{status:n,error:l}=yield this.showServiceAdv(i,f,{adSeqId:u,callbacks:p,clickDaemon:this.alternateLogs?h:y,depth:g++,tag:f,initialTag:e,reason:o});if(w=n,w===ne.mb.Ok)return void i.resetShowTimer(e);if(w===ne.mb.FailedRemove)this.waterfallQueue[e].splice(v,1);else{if(w===ne.mb.FailedShow)throw l||new A.lu(`Error after ${f} showAdv (service: ${i.serviceName})`,{isFinal:!0,wasShown:!0});v++}}while(i);throw new A.lu("No adv providers left.",{isFinal:!0})}catch(t){this.sendCallbackToSdk(e),this._lastShowTime[e]=0,p.unmuteCallbacks(),p.onError(t),t instanceof A.lu&&(t.params.isFinal||t.params.wasShown)&&(w===ne.mb.Empty?h.noContent(null!=(a=null==i?void 0:i.getLastAdReqId(e))?a:"",u):h instanceof ce.U?h.fail(t.message):h.fail(null!=(r=null==i?void 0:i.getLastAdReqId(e))?r:"",u,t.message)),p.onClose(!1),this.callOnAdvClose(!1),(0,ge.Ts)(t,{prefix:"Please, send this error sdk developers: "})}finally{this._showAdvLock[e]=!1}}))}gamePauseResume(e,t){let s;if(e===ae.$.INTERSTITIAL)s="adv_interstitial";else{if(e!==ae.$.REWARDED)return;s="adv_rewarded"}or("gamePause:",s),this.gameControl.gamePause(s),t.addCallbacks({onClose:()=>{or("gameResume:",s),this.gameControl.gameResume(s)}})}logAdvDelay(e){var t;return!this.logAdvDelayFlag||e!==ae.$.INTERSTITIAL&&e!==ae.$.REWARDED?null:(null==(t=null==Ya?void 0:Ya.Rum)||t.time(Zt.Cn),(t,s)=>{var a;return null==(a=null==Ya?void 0:Ya.Rum)?void 0:a.timeEnd(Zt.Cn,{"-additional":encodeURIComponent(JSON.stringify({tag:s,app_id:this.appId,depth:t,initialTag:e}))})})}advDisabledCheck(e,t,s,a){if(this.adOpenedType)return a.skip(he.Jm.ANOTHER_AD_OPENED,t),new Error("Another ad already opened");if(e===ae.$.INTERSTITIAL){if(this.isAdvDisabled){if(this.isInterstitialAdsDisabled)a.noAdv(t);else{let e;e=this.isInterstitialAdsTurnOff?he.Jm.INTERSTITIAL_ADS_TURN_OFF:this.isAllAdvDisabledByPartnersKit?he.Jm.ALL_ADS_DISABLED_BY_PARTNERS_KIT:he.Jm.UNKNOWN,a.skip(e,t)}return this.callOnAdvClose(!1),new Error("Skip interstitial.")}if(!this.firstShowGuard.canShowAdv()){const e=new Error("Cannot open the advertisement. Try again later.");return a.rateLimited("rate",t),this.callOnAdvClose(!1),e}const e=this.canOpenAdv(s);if(e)return a.rateLimited("rate",t),this.callOnAdvClose(!1),e}if(e===ae.$.REWARDED){const e=new Error("Skip rewarded.");if(this.isRewardedAdsTurnOff)return or("Skip rewarded"),this.skipRewarded({adSeqId:t,callbacks:s,reason:he.Jm.REWARDED_ADS_TURN_OFF}),e;if(this.isRewardedAdsDisabled)return or("Skip rewarded"),this.skipRewarded({adSeqId:t,callbacks:s,reason:he.Jm.UTM}),e;if(this.isAllAdvDisabledByPartnersKit)return or("Skip rewarded"),this.skipRewarded({adSeqId:t,callbacks:s,reason:he.Jm.ALL_ADS_DISABLED_BY_PARTNERS_KIT}),e}return null}skipRewarded({adSeqId:e,callbacks:t,reason:s}){["onOpen","onRewarded","onClose"].filter(Boolean).forEach(((e,s)=>{window.setTimeout((()=>{var s;return null==(s=t[e])?void 0:s.call(t)}),100*s)})),this.getClickdaemonAdvLog(ae.$.REWARDED).skip(s,e)}canOpenAdv(e){var t,s;const a=Date.now();if(!this.advBlocks.fullscreen&&!(null==(t=this.advBlocks.desktop)?void 0:t.fullscreen)&&!(null==(s=this.advBlocks.mobile)?void 0:s.fullscreen)){const e=`${Zt._u}: can not find block id`,t=`https://games.yandex.ru/console/application/${this.appId}`;return(0,ge.Ts)(new Error(`\nWhat you can do:\n1. Enable monetization: https://yandex.ru/dev/games/doc/dg/console/enable-monetization-docpage/\n2. Fill all fields in your draft ${t}#application-info-draft\n3. Ensure in Ads section ${t}#application-info-draft (bottom)\nthere is block id (like R-A-123456).\nIf state != work (created, for example), just wait 24 hours: block creation might take time\n`)),new Error(e)}if(this.lastShowTime[ae.$.INTERSTITIAL]&&a-this.lastShowTime[ae.$.INTERSTITIAL]<this.minIntervalBetweenAds){const e="Please, don't try to open advertising often than once per "+((r=this.minIntervalBetweenAds)<pe.WT?`${r} ms`:r%pe.WT!=0?`${Math.floor(r/pe.WT)} ${r%pe.WT} ms`:r/pe.WT+" s");return d.Z.post({action:"debug-action-guard",type:"adv-manager",data:{type:ae.$.INTERSTITIAL,minInterval:this.minIntervalBetweenAds,reason:"Called too often"}}),new Error(e)}var r;if(Math.abs(a-this.startTime)<this.advDelay){const e=`Adv was delayed on ${this.advDelay}ms`;return new Error(e)}if(!navigator.onLine&&!1===(0,T.RM)(this.context.abt.flags,ye.Z.advShowOnOffline)){const t="Adv can't be shown offline";return e.onOffline(),new Error(t)}return null}}const cr="GoogleInstreamBlock-module__block--UThhL",hr="GoogleInstreamBlock-module__hidden--w4W3T",ur="advBlock_"+ae.e.GoogleInstream,pr=({tag:e})=>{const t=(0,n.useRef)(null),[s,a]=(0,n.useState)(!1),r=(0,n.useCallback)(((s,r)=>{var n,i,o,d;const{action:l,data:{tag:c}}=s.data;if(c===e)switch(l){case"show":a(!0);break;case"hide":a(!1);break;case"get-size":r({data:{width:null!=(i=null==(n=t.current)?void 0:n.clientWidth)?i:null,height:null!=(d=null==(o=t.current)?void 0:o.clientHeight)?d:null}})}}),[e]);(0,n.useEffect)((()=>(d.Z.onInternalMessage("adv-instream-render",r),()=>{d.Z.offInternalMessage("adv-instream-render",r)})),[r]);const o=[cr,s?void 0:hr];return i().createElement("div",{className:(0,I.E)(...o),id:ur+"_"+e,ref:t})};const mr=s(33196).Z;var vr=s(52763),gr=s(4915),wr=s(31085),fr=Object.defineProperty,yr=Object.defineProperties,br=Object.getOwnPropertyDescriptors,kr=Object.getOwnPropertySymbols,Ar=Object.prototype.hasOwnProperty,Er=Object.prototype.propertyIsEnumerable,Sr=(e,t,s)=>t in e?fr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Ir=(e,t)=>{for(var s in t||(t={}))Ar.call(t,s)&&Sr(e,s,t[s]);if(kr)for(var s of kr(t))Er.call(t,s)&&Sr(e,s,t[s]);return e},Pr=(e,t)=>yr(e,br(t));const Rr=r().with("prowo-container"),Tr=()=>{const e=(0,n.useRef)(null),{isLegalEmbedPartner:t}=(0,E.b)(),s=(0,n.useRef)(new gr.Z),[a,r]=(0,n.useState)(0),[o,l]=(0,n.useState)({advTag:ae.$.INTERSTITIAL,callbacks:{},reason:he.p_.ONSPOT,visible:!1}),c=(0,n.useCallback)(((e,s,a)=>{var r;t?null==(r=a.onClose)||r.call(a):l((()=>({advTag:e,callbacks:a,reason:s,visible:!0})))}),[t]),h=(0,n.useCallback)((()=>{var e,t;(0,bs.NF)({},is.Ji.GAME_PROMO_OPEN),s.current.updateShowData(wr.Wp.GamePromo),null==(t=(e=o.callbacks).onOpen)||t.call(e)}),[o]),u=(0,n.useCallback)((()=>{var e,t,s,a;null==(t=(e=o.callbacks).onRewarded)||t.call(e),null==(a=(s=o.callbacks).onClose)||a.call(s),l(Pr(Ir({},o),{visible:!1}))}),[o]),p=(0,n.useCallback)((e=>{var t,s,a,r;null==(s=(t=o.callbacks).onClose)||s.call(t),null==(r=(a=o.callbacks).onError)||r.call(a,e),l(Pr(Ir({},o),{visible:!1}))}),[o]),m=(0,n.useCallback)(((e,t)=>{const{action:s,data:a}=e.data;if("show"!==s);else{const{advTag:e,reason:t,onOpen:s,onRewarded:r,onClose:n,onError:i}=a;c(e,t,{onError:i,onOpen:s,onRewarded:r,onClose:n})}}),[c]),v=(0,n.useCallback)(((e,t)=>{t.height!==a&&r(t.height)}),[a]);(0,n.useEffect)((()=>(d.Z.onInternalMessage("adv-promo-block",m),vr.Z.addResizeBlockListener("game",v,!0),()=>{d.Z.offInternalMessage("adv-promo-block",m),vr.Z.removeResizeBlockListener("game",v)})),[v,m]);const{advTag:g,reason:w,visible:f}=o;return f?i().createElement("div",{className:Rr({advType:g,"with-blur":!0}),ref:e,style:{height:a?`calc(100% + ${a}px)`:void 0}},i().createElement(mr,{advTag:g,auto:void 0,containerRef:e,errorProps:{onError:p},hide:u,reason:w,onShow:h})):null};var Cr=s(61533),Dr=Object.defineProperty,Lr=Object.defineProperties,Or=Object.getOwnPropertyDescriptors,xr=Object.getOwnPropertySymbols,_r=Object.prototype.hasOwnProperty,Br=Object.prototype.propertyIsEnumerable,Nr=(e,t,s)=>t in e?Dr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Mr=(e,t)=>{for(var s in t||(t={}))_r.call(t,s)&&Nr(e,s,t[s]);if(xr)for(var s of xr(t))Br.call(t,s)&&Nr(e,s,t[s]);return e},$r=(e,t)=>Lr(e,Or(t));const Fr=r().with("instream-renderer"),qr=({advManager:e})=>{const[t,s]=(0,n.useState)({isVisible:!1,blockId:"",isHeaderEnabled:!(0,A.Ij)(),width:0,height:0}),a=(0,n.useCallback)(((e,t)=>{const{action:a}=e.data;switch(a){case"show":s((e=>$r(Mr({},e),{isVisible:!0})));break;case"hide":s((e=>$r(Mr({},e),{isVisible:!1})));break;case"set-size":{const{width:t,height:a}=e.data.data;s((e=>$r(Mr({},e),{width:t,height:a})));break}case"update-block-id":{const{blockId:a}=e.data.data;(0,Cr.flushSync)((()=>s((e=>$r(Mr({},e),{blockId:a}))))),t({data:{blockId:a}});break}}}),[]);(0,n.useEffect)((()=>(d.Z.onInternalMessage("instream-fullscreen-render",a),()=>{d.Z.offInternalMessage("instream-fullscreen-render",a)})),[a]);const{viewType:r}=e,o=[Zt.kn.modal,Zt.kn.modalFullscreen,Zt.kn.modalWithBlur,(0,A.TE)(r),t.isVisible?Zt.kn.modalVisible:void 0,t.isHeaderEnabled?Zt.kn.modalWithHeader:void 0,t.isHeaderEnabled?Zt.kn.headerFix:void 0];return i().createElement("div",{className:(0,I.E)(...o)},i().createElement("div",{className:Fr("content"),style:{width:t.width,height:t.height}},i().createElement("div",{id:t.blockId})))};var Wr=s(45112),Zr=s(62011),Gr=s(28705),Ur=s(40895);const Hr=(0,te.M$)("AdvStickyParentWindow",void 0,{background:"#0c6c09"}),jr=(0,Zr.Z)((({appId:e,features:t,flags:s,settings:a})=>{const r=(0,n.useMemo)((()=>new Ut),[]),[i,o]=(0,n.useState)(!0),[l,c]=(0,n.useState)(!1),{adv:h}=(0,Gr.Lf)(a),u=(0,n.useMemo)((()=>!(0,T.Ww)(s,v.By.STICKY)&&(0,Gr.uk)({adv:h,appId:e,isDesktop:!0,flags:s,orientation:null==t?void 0:t.orientation})),[h,e,t,s]);return(0,n.useEffect)((()=>{const e=(e,t)=>{return s=void 0,a=null,n=function*(){const{action:s}=e.data;switch(s){case"adv-show-sticky-banner":{if(Hr(`onExternalMessage: action: "${s}"`),!u)return void t({data:{reason:Ur.$.ADV_IS_NOT_CONNECTED,stickyAdvIsShowing:!1}});const e=Ht({action:"setBannerAdvStatus",type:"adv",payload:{stickyAdvIsShowing:!0}});r.addListener({fn:e=>{var s;const{payload:a}=e,r=null==(s=a.stickyAdvIsShowing)||s;return c(!r),t({data:{reason:a.reason,stickyAdvIsShowing:r}}),!0},messageId:e});break}case"adv-hide-sticky-banner":{Hr(`onExternalMessage: action: "${s}"`);const e=Ht({action:"setBannerAdvStatus",type:"adv",payload:{stickyAdvIsShowing:!1}});r.addListener({fn:e=>{var s;const{payload:a}=e,r=null!=(s=a.stickyAdvIsShowing)&&s;return c(!r),t({data:{reason:a.reason,stickyAdvIsShowing:r}}),!0},messageId:e});break}case"adv-status-sticky-banner":if(Hr(`onExternalMessage: action: "${s}"`),!u)return void t({data:{reason:Ur.$.ADV_IS_NOT_CONNECTED,stickyAdvIsShowing:!1}});Hr(`Get stickyAdvIsShowing: ${!l}`),t({data:{stickyAdvIsShowing:!l}})}},new Promise(((e,t)=>{var r=e=>{try{o(n.next(e))}catch(e){t(e)}},i=e=>{try{o(n.throw(e))}catch(e){t(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,i);o((n=n.apply(s,a)).next())}));var s,a,n};return Hr("ParentWindowStickyAdvService init"),d.Z.onAllMessages("adv-manager",e),()=>{d.Z.offAllMessages("adv-manager",e)}}),[u,l,r]),(0,Wr.qR)((()=>{const a=(0,Gr.jx)({adv:h,appId:e,flags:s,orientation:null==t?void 0:t.orientation}),n={desktop:{landscape:a.desktop,portrait:a.desktop},mobile:{landscape:a.mobileLandscape,portrait:a.mobilePortrait}};Ht({action:"setBannerAdvSettings",type:"adv",payload:{enabled:u,locations:n}});const i=Ht({action:"ping",type:"liveness"}),d=r.addListener({fn:e=>{const{action:t,type:s}=e;switch(s){case"liveness":"pong"===t&&(window.clearTimeout(l),o(!0));break;case"error":o(!1),Hr("error",e)}return!0},messageId:i}),l=window.setTimeout((()=>{d(),o(!1)}),2e3)})),null}),o.Z,{appId:e=>e.playPageData.gameInfo.appId,features:e=>e.playPageData.gameSettings.features,flags:e=>e.abt.flags,settings:e=>e.playPageData.gameSettings.settings});var zr=s(29994),Vr=s(76994),Kr=s(65957);class Yr extends n.Component{constructor(e){super(e),this.additionalClasses="",this.closeButtonDeferredTime=0,this.onYandexFullscreenRenderMessage=(e,t)=>{const{action:s}=e.data;switch(s){case"update-block-id":this.setState({advBlockId:e.data.data.blockId,pageNumber:e.data.data.pageNumber},(()=>{t({data:{blockId:this.getBlockId()}})}));break;case"show-fullscreen":this.setState({isVisible:!0,seconds:0,withTimer:!1});break;case"hide-fullscreen":this.setState({isVisible:!1})}},this.onYandexFullscreenRenderMessageGames27265=(e,t)=>{const{action:s}=e.data;switch(s){case"update-block-id":this.setState({advBlockId:e.data.data.blockId,pageNumber:e.data.data.pageNumber},(()=>{t({data:{blockId:this.getBlockId()}})}));break;case"show-fullscreen":this.setState({isVisible:!0,seconds:0,withTimer:!1}),this.hideCloseButton(),this.setIsCloseButtonHiddenTimeout();break;case"hide-fullscreen":this.clearIsCloseButtonHiddenTimeout(),this.showCloseButton(),this.setState({isVisible:!1})}},this.handleClose=()=>{(0,P.D)((()=>{d.Z.post({type:"yandex-adv-service",action:"close-adv"})}))},this.handleBottomButtonClose=()=>{this.state.isCloseButtonHidden||(0,P.D)((()=>{d.Z.post({type:"yandex-adv-service",action:"bottom-button-close-adv"})}))},this.handleTouchMove=e=>{e.stopPropagation(),e.preventDefault()},this.handleButtonDisableAdvClick=()=>{(0,R.Z)()},this.setModalRef=()=>{d.Z.post({type:"yandex-adv-service",action:"adv-container-mounted"})},this.isYandexSearchApp=(0,ha.qo)(),this.state={advBlockId:"",pageNumber:1,isCloseButtonHidden:!1,isVisible:!1,inited:!1,seconds:0,withTimer:!1,isHeaderEnabled:!(0,A.Ij)()}}componentDidMount(){this.init(),this.initMessaging()}init(){var e;const{flags:t}=this.context.abt,{viewType:s}=this.props.advManager;this.closeButtonDeferredTime=Math.max(0,Math.min(5e3,null!=(e=(0,T.$9)(t,ye.Z.advCloseButtonDeferredTime))?e:0)),this.cssClasses=Cs();const a=[];s===Zt.xd.fullscreen&&t.new_adv_block&&a.push(`new_adv_block-${t.new_adv_block}`),this.additionalClasses=a.join(" "),this.setState({inited:!0,isCloseButtonHidden:Boolean(this.closeButtonDeferredTime)})}initMessaging(){this.closeButtonDeferredTime?d.Z.onInternalMessage("yandex-fullscreen-render",this.onYandexFullscreenRenderMessageGames27265):d.Z.onInternalMessage("yandex-fullscreen-render",this.onYandexFullscreenRenderMessage)}setIsCloseButtonHiddenTimeout(){this.clearIsCloseButtonHiddenTimeout(),this.isCloseButtonHiddenTimeout=window.setTimeout((()=>{this.showCloseButton()}),this.closeButtonDeferredTime)}clearIsCloseButtonHiddenTimeout(){this.isCloseButtonHiddenTimeout&&(window.clearTimeout(this.isCloseButtonHiddenTimeout),this.isCloseButtonHiddenTimeout=void 0)}hideCloseButton(){this.setState({isCloseButtonHidden:!0}),document.documentElement.dataset.pcodeCloseButtonHidden="true"}showCloseButton(){this.setState({isCloseButtonHidden:!1}),document.documentElement.dataset.pcodeCloseButtonHidden="false"}getBlockId(){const{advBlockId:e,pageNumber:t}=this.state;return`yandex_rtb_${e}_${t}`}renderModalContent(){const{cssClasses:e}=this,{advBlockId:t,isCloseButtonHidden:s,isVisible:a,withTimer:r}=this.state;if(!t||!e)return null;const{deviceType:n,isDisableAdButtonEnabled:o}=this.props.advManager,d=Boolean(this.isYandexSearchApp),{abt:{flags:l}}=this.context,{getText:c}=this.props,h=(0,T.qf)(l)||(0,T.iH)(l),u=i().createElement("span",{"aria-hidden":"true",className:`${Ds(e,"modalBottom",d)}`},i().createElement("span",{className:`${e.modalButton} ${e.modalButtonDisableAdv}`,onClick:this.handleButtonDisableAdvClick},c("header.popup.disable.ads")),i().createElement("span",{className:`${e.modalButton} ${e.modalButtonClose}`,onClick:this.handleBottomButtonClose},c("adv.close")));return n===ks.n.desktop?h?i().createElement("div",{className:`${Zt.kn.modalInner}`},i().createElement("div",{className:`${e.modalWrap} with-native-close`},i().createElement("div",{className:`${e.modalContent} ${e.yandexAdaptive} with-native-close`,id:this.getBlockId()}))):i().createElement("div",{className:`${Zt.kn.modalInner}`},i().createElement("div",{className:`${e.modalWrap}`},a&&r&&i().createElement("div",{className:Zt.kn.countdown},i().createElement(Kr.Z,{seconds:this.state.seconds,text:c("adv.timed.allow.skip.text"),onClose:this.handleClose})),i().createElement("div",{className:`${e.modalContent} ${e.yandexAdaptive}`,id:this.getBlockId()}),!r&&!s&&i().createElement(Vr.Z,{source:ht.h0.REWARDED_COUNTER,type:"adv-fullscreen",onClick:this.handleClose}),o?u:"")):h?i().createElement("div",{className:`${Zt.kn.modalInner}`},i().createElement("div",{className:`${Ds(e,"modalContent",d)} ${e.yandexAdaptive} with-native-close`,id:this.getBlockId()})):i().createElement("div",{className:`${Zt.kn.modalInner}`},i().createElement("div",{className:`${Ds(e,"modalContent",d)} ${e.yandexAdaptive}`,id:this.getBlockId()}),!(0,lt.x)()&&!s&&i().createElement("span",{"aria-hidden":"true",className:`${Ds(e,"modalClose",d)}`},i().createElement(y.z,{className:e.mobileCloseButton,"data-testid":"YandexFullscreenRender-Button",size:40,view:"primary",width:"max",onClick:this.handleClose},c("adv.close"))),o?u:null)}render(){const{additionalClasses:e,cssClasses:t}=this,{isVisible:s,inited:a,isHeaderEnabled:r}=this.state,{viewType:n}=this.props.advManager;if(!a)return null;const o=s?`${t.modalVisible} ${Zt.kn.modalVisible}`:"",d=[Zt.kn.modal,(0,A.el)("yandex"),Zt.kn.modalFullscreen,(0,A.TE)(n),t.modalMedia,o,e,Zt.kn.modalWithBlur,r?Zt.kn.modalWithHeader:void 0,r?Zt.kn.headerFix:void 0].join(" ").trim();return i().createElement("div",{className:d,ref:this.setModalRef,onTouchMove:this.handleTouchMove},this.renderModalContent())}}Yr.contextType=o.Z;const Xr=(0,zr.$j)((function(e){return{getText:e.getText}}))(Yr);var Jr=s(54093);class Qr extends o.P{constructor(e){super(e),this.isYaBroChromeLower79=window.appData.isYaBroOrSearchApp&&!(0,Jr.LR)(window.navigator.userAgent,Jr.t_,{major:79,minor:0}),this.onYandexRewardedRenderMessage=(e,t)=>{var s;const{action:a}=e.data;switch(a){case"update-block-id":this.setState({advBlockId:e.data.data.blockId},(()=>{t({data:{blockId:this.getBlockId()}})}));break;case"show-rewarded":this.setState({isVisible:!0,seconds:(null==(s=e.data.data)?void 0:s.seconds)||0}),this.onAdvCloseMessagingCallback=t;break;case"on-rewarded":this.onRewardedMessagingCallback=t;break;case"hide-rewarded":this.setState({isVisible:!1})}},this.handleAdvClose=()=>{var e;null==(e=this.onAdvCloseMessagingCallback)||e.call(this)},this.handleRewardedDone=()=>{var e;null==(e=this.onRewardedMessagingCallback)||e.call(this)},this.handleTouchMove=e=>{e.stopPropagation(),e.preventDefault()},this.setModalRef=()=>{d.Z.post({type:"yandex-adv-service",action:"adv-container-mounted"})},this.isYandexSearchApp=(0,ha.qo)(),this.state={advBlockId:"",inited:!1,isVisible:!1,seconds:0,isHeaderEnabled:!(0,A.Ij)()}}componentDidMount(){this.init(),this.initMessaging()}init(){this.isPCodeModal=(0,T.lv)(this.context.abt.flags),this.cssClasses=Cs(),this.setState({inited:!0})}initMessaging(){d.Z.onInternalMessage("yandex-rewarded-render",this.onYandexRewardedRenderMessage)}getBlockId(){const{advBlockId:e}=this.state;return`yandex_rtb_rewarded_${e}`}renderModalContent(){const{cssClasses:e}=this,{isVisible:t,seconds:s}=this.state,{advManager:{deviceType:a}}=this.props;return a===ks.n.desktop?i().createElement("div",{className:`${e.modalWrap}`},t&&i().createElement("div",{className:Zt.kn.countdown},i().createElement(Kr.Z,{seconds:s,onClose:this.handleAdvClose,onDone:this.handleRewardedDone})),i().createElement("div",{className:`${e.modalContent}`,id:this.getBlockId()})):i().createElement(i().Fragment,null,i().createElement("div",{className:Ds(e,"modalContent",Boolean(this.isYandexSearchApp)),id:this.getBlockId()}),t&&!(0,lt.x)()&&i().createElement(Kr.Z,{seconds:s,onClose:this.handleAdvClose,onDone:this.handleRewardedDone}))}renderModal(){const{advManager:e}=this.props,{cssClasses:t}=this,{isVisible:s,isHeaderEnabled:a}=this.state,r=s?`${t.modalVisible} ${Zt.kn.modalVisible}`:"",n=[Zt.kn.modal,t.rewardedVideo,t.yandexAdaptive,(0,A.TE)(e.viewType),t.modalMedia,r,Zt.kn.modalWithBlur,a?Zt.kn.modalWithHeader:void 0,a?Zt.kn.headerFix:void 0,this.isYaBroChromeLower79?Zt.kn.yabroChromeLower79:void 0].join(" ").trim();return i().createElement("div",{className:n,ref:this.setModalRef,onTouchMove:this.handleTouchMove},this.renderModalContent())}renderPCodeModal(){const{cssClasses:e}=this,{isVisible:t}=this.state,s=t?`${Zt.kn.modalVisible}`:"",a=[Zt.kn.modal,e.rewardedVideo,s,Zt.kn.modalWithBlur].join(" ").trim();return i().createElement("div",{className:a})}render(){const{inited:e}=this.state;return e?this.isPCodeModal?this.renderPCodeModal():this.renderModal():null}}var en=s(53603),tn=s(75217),sn=s(37341),an=Object.defineProperty,rn=Object.getOwnPropertySymbols,nn=Object.prototype.hasOwnProperty,on=Object.prototype.propertyIsEnumerable,dn=(e,t,s)=>t in e?an(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;const ln=r().with("aab-adv"),cn=(0,te.M$)("PlayAdvManager",te.XG.Adv),hn=()=>{const e=(0,E.b)(),{isReady:t}=(0,en.s)(),{abt:{flags:s},location:a,withWorldWideAdv:r}=e,[o,l]=(0,n.useState)(null),c=(0,n.useRef)(null),h=(0,sn.ff)();(0,n.useEffect)((()=>{const t=e=>{"update-adv-services-list"===e.data.action&&l(((e,t)=>{for(var s in t||(t={}))nn.call(t,s)&&dn(e,s,t[s]);if(rn)for(var s of rn(t))on.call(t,s)&&dn(e,s,t[s]);return e})({},e.data.data))};return d.Z.onInternalMessage("play-adv-manager",t),cn("Create AdvManager instance"),c.current=new lr(e,h),()=>{d.Z.offInternalMessage("play-adv-manager",t),cn("Destroy AdvManager instance")}}),[e,h]);const u=(0,n.useMemo)((()=>(0,tn.O)(a)),[a]),v=c.current,g=(0,n.useMemo)((()=>{if(!v||!o)return null;const e=(0,ca.gK)({flags:s,withWorldWideAdv:r}),t=o[ae.$.INTERSTITIAL],a=o[ae.$.REWARDED],n=t[ae.e.PrebidTGO]||t[ae.e.Adsense]||t[ae.e.AdsenseResponsive],d=Boolean(a[ae.e.GoogleInstream]&&e.rewarded.find((e=>e.provider===ae.e.GoogleInstream&&e.tag===ae.$.INTERSTITIAL)));return i().createElement(i().Fragment,null,t[ae.e.Yandex]&&i().createElement(Xr,{advManager:v}),o[ae.$.REWARDED][ae.e.Yandex]&&i().createElement(Qr,{advManager:v}),n&&i().createElement(ee,{advManager:v}),(t[ae.e.GoogleInstream]||d)&&((0,m.vV)(s)||be(s)?i().createElement(pr,{advManager:v,tag:ae.$.INTERSTITIAL}):i().createElement(qr,{advManager:v})),o[ae.$.REWARDED][ae.e.GoogleInstream]&&i().createElement(pr,{advManager:v,tag:ae.$.REWARDED}),i().createElement(Tr,null),u&&i().createElement(jr,null))}),[v,s,u,o,r]);return(0,T.V)(s)&&!t?null:v?i().createElement("div",{className:ln()},i().createElement(p,{appId:v.appId,isDevFeaturesEnabled:!1}),g):null}},29011:(e,t,s)=>{"use strict";s.d(t,{q:()=>p,Q:()=>f});var a=s(50042),r=s(48810);const n="count_of_user_visits";function i(){return!(0,r.dq)(n).wasError}var o=s(35090),d=s(82027),l=s(31261),c=s(4915),h=s(31085),u=s(39449);const p=15e3,m=1,v=1,g=5;function w(e){return!(e||(0,a.VP)()||(0,d.PK)()||!i()||function(){let e,t=(0,r.dq)(n);return i()?(t.value&&(e=Number(t.value)),(!e||e<0)&&(e=0),e):0}()>=g||!(0,l.uP)())}function f(){if((0,o.Oo)()||!w(null==(e=window.YandexGamesSDK)?void 0:e.game.info.hasWebAppsCategory))return!1;var e;return(new c.Z).checkShowCapability(h.Wp.GamePromo,{waitingPeriod:m*u.E$,maxShowCount:v,considerInstallation:!0})}},40174:(e,t,s)=>{"use strict";s.d(t,{xn:()=>y,Q$:()=>A});var a=s(47802),r=s(69106),n=s(17254),i=s(40656);class o extends Error{constructor(e,t){super(e),this.name=this.constructor.name,this.code=t,Object.setPrototypeOf(this,o.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,o)}}const d=o;var l=s(15771),c=s(90380),h=Object.defineProperty,u=Object.defineProperties,p=Object.getOwnPropertyDescriptors,m=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,w=(e,t,s)=>t in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,f=(e,t)=>{for(var s in t||(t={}))v.call(t,s)&&w(e,s,t[s]);if(m)for(var s of m(t))g.call(t,s)&&w(e,s,t[s]);return e},y=(e=>(e.PRELOAD="preload",e.RENDER="render",e))(y||{});const b=20*i.WT,k=["blockId","extParams"];const A=({abtFlags:e,adOptions:t,methodName:s,onAdLoadFailed:i,timeoutMs:o})=>{var h;const m=(0,r.Z)(i),v=(e=>{var t,s,r;const n=null==(s=null==(t=null==window?void 0:window.Ya)?void 0:t.Context)?void 0:s.AdvManager;if(n&&"object"==typeof n)return e in n||(0,a.qu)(`[adv.safeGuard] AdvManager method ${e} is undefined`),null==(r=n[e])?void 0:r.bind(n);(0,a.qu)("[adv.safeGuard] AdvManager is undefined")})(s);if(!v)return void m(new d("No such method","NO_SUCH_METHOD"));void 0===o&&(o=null!=(h=(0,l.$9)(e,c.Z.rsyaDefaultLoadTimeout))?h:b);const g=setTimeout((()=>{(0,a.qu)(`[adv.safeGuard] Error: No events were raised after Ya.Context.AdvManager.${s} in ${o} ms.`,{blockId:t.blockId}),m(new d("Timeout","TIMEOUT"))}),o),w=e=>(...s)=>(clearTimeout(g),(0,a.qu)("[adv.safeGuard] Timer cleared",{blockId:t.blockId}),null==e?void 0:e(...s));(0,a.qu)(`[adv.safeGuard] call "${s}" with options = `,function(e){return k.reduce(((t,s)=>(t[s]=e[s],t)),{})}(t));var y,A;v((y=f(f({},t),(0,n.x)()?{onRewarded:w(t.onRewarded)}:{}),A={onError:w(t.onError),onRender:w(t.onRender),onPreload:w(t.onPreload),onClose:w(t.onClose)},u(y,p(A))),w((()=>m(new d("No content","NO_CONTENT")))))}},54814:(e,t,s)=>{"use strict";s.d(t,{Kc:()=>i,QA:()=>d,hk:()=>r,mb:()=>o,pP:()=>n});var a=s(5e4);function r(e){return(null==e?void 0:e.provider)===a.e.AdsenseResponsive&&"slotId"in e}var n=(e=>(e.Onspot="onspot",e.Skip="skip",e.Start="start",e.Waterfall="waterfall",e))(n||{}),i=(e=>(e.Next="next",e.NextRemove="next_remove",e.Ok="ok",e))(i||{}),o=(e=>(e.Empty="empty",e.Failed="failed",e.FailedRemove="failed_remove",e.FailedShow="failed_show",e.Ok="ok",e))(o||{}),d=(e=>(e.ServiceInit="serviceInit",e.ShowFullscreen="showFullscreen",e.ShowRewarded="showRewarded",e))(d||{})},95025:(e,t,s)=>{"use strict";s.d(t,{C5:()=>N,Cj:()=>S,Jt:()=>P,gK:()=>k,sf:()=>I});var a=s(38096),r=s(26667),n=s(14408),i=s(29011),o=s(50042),d=s(5e4),l=s(75217),c=s(58432),h=s(17254),u=s(17061),p=s(31261),m=s(41811),v=s(15771),g=s(90380),w=s(2820),f=s(23404);const y=!0,b=["2753282","2753277"];function k({flags:e,withWorldWideAdv:t}){if((0,l.O)()){return{[d.$.INTERSTITIAL]:[{provider:d.e.ParentWindow}],[d.$.REWARDED]:[{provider:d.e.ParentWindow}]}}const s={[d.$.INTERSTITIAL]:_(d.$.INTERSTITIAL,e),[d.$.REWARDED]:_(d.$.REWARDED,e)},n={[d.$.INTERSTITIAL]:s[d.$.INTERSTITIAL]||O(d.$.INTERSTITIAL,{flags:e,withWorldWideAdv:t}),[d.$.REWARDED]:s[d.$.REWARDED]||O(d.$.REWARDED,{flags:e,withWorldWideAdv:t})};return s[d.$.INTERSTITIAL]&&function(e){const t=window.firstSeen;if(!t||!t.utm_source||!m.os.includes(t.utm_source))return;const s=P(e,d.e.GoogleManual);-1!==s&&e.splice(s,1)}(n[d.$.INTERSTITIAL]),D(e)?n:(s[d.$.INTERSTITIAL]||(R(n[d.$.INTERSTITIAL],d.$.INTERSTITIAL,{flags:e,withWorldWideAdv:t}),function(e){const{adv:{interstitial:{promo:t}}}=(0,a.getDomainConfig)();if(!(null==t?void 0:t.onboardingEnabled))return;if(!(0,i.Q)())return;e[d.$.INTERSTITIAL].unshift({provider:d.e.OnboardingPromo})}(n),T(n[d.$.INTERSTITIAL],{flags:e}),C(n[d.$.INTERSTITIAL])),s[d.$.REWARDED]||(R(n[d.$.REWARDED],d.$.REWARDED,{flags:e,withWorldWideAdv:t}),function(e,{flags:t}){if(!(0,v.dA)(t))return;const s=P(e,d.e.PrebidTGO);if(-1===s)return;e.splice(s+1,0,{provider:d.e.PrebidTGO,tag:d.$.INTERSTITIAL})}(n[d.$.REWARDED],{flags:e}),function(e,{withWorldWideAdv:t}){0;if(L(t))return;e.push({provider:d.e.GoogleInstream,tag:d.$.INTERSTITIAL})}(n[d.$.REWARDED],{withWorldWideAdv:t}),T(n[d.$.REWARDED],{flags:e}),C(n[d.$.REWARDED])),B(n[d.$.INTERSTITIAL],e),B(n[d.$.REWARDED],e),A(n[d.$.INTERSTITIAL],d.$.INTERSTITIAL,{flags:e}),A(n[d.$.REWARDED],d.$.REWARDED,{flags:e}),E(n[d.$.INTERSTITIAL],d.$.INTERSTITIAL,{flags:e}),E(n[d.$.REWARDED],d.$.REWARDED,{flags:e}),function(e){const t=(0,c.KT)();if(!r.RQ.includes(t))return;e.length=0,e.push({provider:d.e.AdsenseResponsive,clientId:"ca-pub-8160201538288120",slotId:"3182579723"})}(n[d.$.INTERSTITIAL]),{[d.$.INTERSTITIAL]:n[d.$.INTERSTITIAL],[d.$.REWARDED]:n[d.$.REWARDED]})}function A(e,t,{flags:s}){void 0!==(t===d.$.INTERSTITIAL?(0,n.vy)(s):(0,n.P2)(s))&&(e.length=0,e.push({provider:d.e.AdsenseResponsive}))}function E(e,t,{flags:s}){const a=(0,c.KT)();r.Y8.includes(a)&&(t===d.$.REWARDED&&(0,n.xP)(s)||(e.length=0,e.push({provider:d.e.AdsenseResponsive})))}function S(e,t){const s=e[e.length-1];return(null==s?void 0:s.provider)===t}function I(e,t){return e.some((e=>e.provider===t))}function P(e,t){return e.findIndex((e=>e.provider===t))}function R(e,t,{flags:s,withWorldWideAdv:r}){var i;if(L(r))return;const{adv:o}=(0,a.getDomainConfig)(),l=null==(i=o[t].google.instream)?void 0:i.desktop,c=t===d.$.INTERSTITIAL?(0,v.oO)(s):(0,n.CE)(s);(null!=c?c:null==l?void 0:l.enabled)&&e.unshift({provider:d.e.GoogleInstream})}function T(e,{flags:t}){const s=(0,v.RM)(t,g.Z.disableYandexWaterfall)||!1,a=(0,c.KT)();s||b.includes(a)||S(e,d.e.Yandex)||e.push({provider:d.e.Yandex})}function C(e){const{adv:{interstitial:{promo:t}}}=(0,a.getDomainConfig)();(0,p.uP)()&&(null==t?void 0:t.waterfallEnabled)&&e.push({provider:d.e.Promo})}function D(e){var t;if((0,v.RM)(e,g.Z.disableNativeAdv)||!1)return!1;return!!((null==(t=window.yandex)?void 0:t.ads)&&(0,o.zg)("21.9.0.1638")&&(0,o.VP)())}function L(e){var t;return!e||(null==(t=window.clientMetadata)?void 0:t.isOnlyRsyaAd)}function O(e,{flags:t,withWorldWideAdv:s}){if(D(t)){return(0,h.x)()&&(0,v.LI)(t)?[{provider:d.e.Yandex}]:[{provider:d.e.Native}]}const a=(0,u.V)("utm_source");return a===d.e.Transsion?[{provider:d.e.Transsion}]:a===d.e.CrazyGames?[{provider:d.e.CrazyGames}]:L(s)?[{provider:d.e.Yandex}]:[{provider:d.e.PrebidTGO}]}function x(e){return e&&"object"==typeof e&&e.provider&&"string"==typeof e.provider}function _(e,t){const s=(0,v.QR)(t,`adv_${e}_waterfall`);return s&&s.every(x)?s:null}function B(e,t){if("undefined"==typeof window)return e;const{pathname:s}=window.location,a=(0,w.eT)(s),r=(0,w.Fg)(s)&&(0,v.bV)(t);return!a&&!r||(0,v.VG)(t)||[...e].forEach((t=>{if(!f.wt.includes(t.provider)){const s=e.indexOf(t);-1!==s&&e.splice(s,1)}})),e}function N({advBlocks:e,flags:t,withWorldWideAdv:s}){var a;const r=_("start_fullscreen",t);if(r)return B(r,t);const n=function({flags:e}){if(y)return null;const t=(0,v.QR)(e,g.Z.advPrerollPerClid);if(!t)return null;const s=(0,c.KT)();return s&&(a=s,t.some((e=>a===String(e))))?[{provider:d.e.PrebidTGO}]:null;var a}({flags:t});return n?B([...n],t):e.start_fullscreen?D(t)?[{provider:d.e.Native}]:!s||(null==(a=window.clientMetadata)?void 0:a.isOnlyRsyaAd)?[{provider:d.e.Yandex},{provider:d.e.Promo}]:null:null}},40532:(e,t,s)=>{"use strict";s.d(t,{Z:()=>g});var a=s(87363),r=s.n(a),n=s(29994),i=s(5314),o=s(65453),d=s(14184),l=s(43548),c=s(71522),h=s(93298);const u="fetch-limits";var p=(e=>(e.LIMIT_EXCEEDING="limit-exceeding",e))(p||{});const m=(0,h.M$)("PlayFetchLimits",h.XG.Popup);class v extends a.Component{constructor(e){super(e),this.actionToMethodMap={"leaderboard/entries":"leaderboard.getLeaderboardEntries()","leaderboard/score":"leaderboard.setLeaderboardScore()","player-info/get-data":"player.getData()","player-info/set-data":"player.setData()","player-info/increment-stats":"player.incrementStats()","player-info/stats":"player.getStats()","player-info/set-stats":"player.setStats()"},this.onFetchInternalMessage=e=>{const{action:t}=e.data;if(t!==p.LIMIT_EXCEEDING)return;const{data:{url:s,method:a}}=e.data;this.onLimitExceeding({method:a,url:s})},this.onMessageBoxClick=()=>{const{warningMessage:e}=this.state;if(e)try{navigator.clipboard.writeText(e)}catch(e){}},this.onMessageBoxClose=()=>{this.setState({warningMessage:void 0})},this.onMessageBoxSnooze=()=>{this.onMessageBoxClose(),this.setState({snooze:!0})},this.state={snooze:!1,warningMessage:void 0}}componentDidMount(){l.Z.onInternalMessage(u,this.onFetchInternalMessage)}componentWillUnmount(){l.Z.offInternalMessage(u,this.onFetchInternalMessage)}onLimitExceeding(e){const t=this.getLimitErrorText(e);(0,d.Ts)(new Error(t)),((0,c.m)()||h.HQ)&&this.setState({warningMessage:t})}getLimitErrorText({method:e,url:t}){var s;if(t){let e=t;try{e=new URL(t).pathname}catch(e){}return m(`onLimitExceeding, url = ${t}`),this.props.getText("game-sdk.fetch-limits.warn.text",{params:{url:e}})}return e=null!=(s=this.actionToMethodMap[e])?s:e,m(`onLimitExceeding, method = ${e}`),this.props.getText("game-sdk.fetch-limits.warn.method.text",{params:{method:e}})}render(){const{snooze:e,warningMessage:t}=this.state;return e||!t?null:r().createElement(i.Z,{autohide:!1,level:o.XB.ERROR,withCloseButton:!0,onClick:this.onMessageBoxClick,onClose:this.onMessageBoxClose,onSnooze:this.onMessageBoxSnooze},t)}}const g=(0,n.$j)((function(e){return{getText:e.getText}}))(v)},31416:(e,t,s)=>{"use strict";s.d(t,{Z:()=>k});var a=s(38096),r=s(87363),n=s.n(r),i=s(40562),o=s(63904),d=s.n(o),l=s(45331),c=s(85467),h=s(5825),u=s(36172),p=s(68108),m=s(15771),v=s(69838),g=s(44865);const w=d().with("play-game-logo"),f=({type:e})=>{const t=(0,h.C)(u.Up),{lang:s,referrer:a,abt:o,cdnUrl:d,playPageData:{gameInfo:{categoryNames:f}},rtl:y}=(0,r.useContext)(l.Z),b=(0,c.T)(),k=b("common.company.name"),A=b("common.service.short_name"),E=(0,m.XP)(o.flags),S=(0,v._B)({cdnUrl:d,darkTheme:t,fullLogo:e!==v.q7.GUARD&&e!==v.q7.AVATAR,text:k,type:e,lang:s,rtl:y}),I=(0,i.K)(s),P=(0,r.useMemo)((()=>(0,p.sD)(a)),[a]);if(e===v.q7.GUARD){const{serviceType:a}=(0,g.Vk)(f),r=(a===v.CF.WEBAPPS_CATEGORY_SERVICE_NAME?b("common.service.app_name"):b("common.service.short_name")).replace(/\s/g,"%20"),i=(0,v._B)({cdnUrl:d,darkTheme:t,isWhiteLabelPartner:P,text:r,type:e,lang:s,rtl:y});return n().createElement("span",{className:w()},n().createElement("img",{alt:A,className:w("service",{type:e,lang_ru:I}),crossOrigin:"anonymous",loading:"lazy",src:i}))}if(e===v.q7.AVATAR)return P?null:n().createElement("div",{className:w()},n().createElement("img",{alt:k,className:w("company",{type:e,lang_ru:I}),crossOrigin:"anonymous",src:S}));const R=(0,v._B)({cdnUrl:d,darkTheme:t,isWhiteLabelPartner:P,text:A,type:e,lang:s,rtl:y});return n().createElement(n().Fragment,null,n().createElement("img",{alt:A,className:w("service",{type:e,lang_ru:I,small:E,whitelabel:P}),crossOrigin:"anonymous",src:R}))};var y=s(41233);const b=({type:e})=>{switch(e){case v.q7.MENU:return n().createElement(y.Z,{showImage:!1,textSize:"m"});case v.q7.HEADER:return n().createElement(y.Z,{showImage:!1,textColor:"light",textSize:"s",type:e});case v.q7.GUARD:return n().createElement(y.Z,{imageSize:"s",textSize:"m"});case v.q7.AVATAR:return n().createElement(y.Z,{imageSize:"m",showText:!1});default:return n().createElement(y.Z,{showImage:!1,textSize:"m"})}},k=({type:e})=>{const{hostname:t}=(0,a.getDomainConfig)();return t!==a.EDomain.Yandex?n().createElement(b,{type:e}):n().createElement(f,{type:e})}},29758:(e,t,s)=>{"use strict";s.d(t,{Z:()=>j});var a=s(63904),r=s.n(a),n=s(87363),i=s.n(n),o=s(4463),d=s(29994),l=s(77123),c=s(45331),h=s(43548),u=s(58432),p=s(43190),m=s(41811),v=s(93298);const g=r().with("screen-manager-cover"),w=(0,v.M$)("ScreenManagerCover",v.XG.Popup);class f extends n.Component{constructor(){super(...arguments),this.state={visible:!0,playit:!1},this.onVisibilityChange=()=>{document.hidden&&this.setState({visible:!0})},this.onClick=()=>{this.setState({visible:!1}),h.Z.post({type:"screen-manager",action:"request-fullscreen"})}}componentDidMount(){if(w("componentDidMount"),p.w.available)return void this.setState({visible:!1});const e=(0,u.KT)();m.AY.includes(e)&&"landscape"===this.gameOrientation&&this.setState({playit:!0}),this.addListeners()}get gameOrientation(){var e;return null==(e=this.context.playPageData.gameSettings.features)?void 0:e.orientation}componentDidUpdate(e){!e.isFullscreenActive&&this.props.isFullscreenActive&&this.setState({visible:!0})}componentWillUnmount(){w("componentWillUnmount"),this.removeListeners()}addListeners(){document.addEventListener("visibilitychange",this.onVisibilityChange)}removeListeners(){document.removeEventListener("visibilitychange",this.onVisibilityChange)}render(){return this.state.visible&&!this.props.isFullscreenActive?i().createElement("div",{className:g({playit:this.state.playit}),onClick:this.onClick,onTouchEnd:this.onClick}):null}}f.contextType=c.Z;const y=(0,d.$j)((function(e){return{isFullscreenActive:e.ui.isFullscreenActive}}))(f);var b=s(95968),k=s(90043),A=s(14184),E=s(69543),S=s(35090),I=s(91605),P=s(77901),R=s(27859),T=s(40656),C=s(15771);const D=(0,v.M$)("ScreenManager",v.XG.Dev);class L extends n.Component{constructor(e){super(e),this.onMessage=(e,t)=>{switch(e.data.action){case"request-fullscreen":this.requestFullscreen({force:!0}).then((()=>{t()})).catch((e=>{t({error:e})}));break;case"exit-fullscreen":this.exitFullscreen().then((()=>{this.unlockScreenOrientation(),t()})).catch((e=>{t({error:e})}));break;case"toggle-fullscreen":this.toggleFullscreen().then((()=>{this.unlockScreenOrientation(),t()})).catch((e=>{t({error:e})}));break;case"rotate-banner-add":this.addScreenOrientationBanner();break;case"rotate-banner-remove":this.removeScreenOrientationBanner();break;case"get-state":this.isFullscreen().then((e=>{t({data:{isFullscreen:e,screenOrientationWasLocked:this.state.screenOrientationWasLocked}})})).catch((()=>{t({data:{isFullscreen:!1,screenOrientationWasLocked:this.state.screenOrientationWasLocked}})}));break;case"fullscreen-supported":t({data:{isFullscreenSupported:this.isFullscreenSupported}})}},this.updateFullscreenState=()=>{this.isFullscreen().then((e=>this.props.setIsFullscreenActive(e)))},this.state={screenOrientationWasLocked:!1,withCover:!1}}get gameFeatures(){return this.context.playPageData.gameSettings.features||{}}get fullScreenValue(){const{fullscreen:e}=this.gameFeatures;return"boolean"==typeof e?e:"desktop"!==this.context.deviceType}get gameOrientation(){const{orientation:e}=this.gameFeatures;if("landscape"===e||"portrait"===e)return e}componentDidMount(){D("componentDidMount"),this.props.setIsFullscreenEnabled(this.isFullscreenSupported()),this.addFullscreenListener(),this.updateFullscreenState(),this.initMessaging(),this.initCover(),this.initFullscreen(),this.initScreenOrientation()}componentWillUnmount(){D("componentWillUnmount"),this.removeFullscreenListener(),this.destroyMessaging()}addFullscreenListener(){var e;p.w.available?null==(e=(0,p.u)())||e.addEventListener("fullscreenchange",this):document.addEventListener(b.Z.fullscreenchange,this)}removeFullscreenListener(){var e;p.w.available?null==(e=(0,p.u)())||e.removeEventListener("fullscreenchange",this):document.removeEventListener(b.Z.fullscreenchange,this)}initMessaging(){h.Z.onExternalMessage("screen-manager",this.onMessage),h.Z.onInternalMessage("screen-manager",this.onMessage)}destroyMessaging(){h.Z.offExternalMessage("screen-manager",this.onMessage),h.Z.offInternalMessage("screen-manager",this.onMessage)}initCover(){this.isFullscreenEnabled()&&(p.w.available||(this.setState({withCover:!0}),(0,S.g)()||this.requestFullscreen().catch((()=>{}))))}initFullscreen(){this.isFullscreenEnabled()&&((0,S.g)()||this.requestFullscreenForYandexPlatforms(),window.addEventListener("blur",this))}initScreenOrientation(){this.updateScreenOrientationBanner(),R.Z.isSupported&&R.Z.addChangeListener(this)}handleEvent(e){const{type:t}=e;t===R.Z.changeEventName?this.handleScreenOrientationChange():t===b.Z.fullscreenchange?(this.updateFullscreenState(),this.handleFullscreenChange()):"blur"===t?(window.removeEventListener("blur",this),window.setTimeout((()=>{var e,t,s;!(null==(e=document.activeElement)?void 0:e.toString().includes("HTMLIFrameElement"))&&"IFRAME"!==(null==(s=null==(t=document.activeElement)?void 0:t.tagName)?void 0:s.toUpperCase())||(0,S.g)()||this.requestFullscreen().catch((()=>{}))}),0)):(0,A.fF)(new Error(`Unknown event '${t}'`))}handleScreenOrientationChange(){!1===this.updateScreenOrientationBanner()&&this.requestFullscreen().catch((()=>{}))}handleFullscreenChange(){this.isFullscreen().then((e=>{h.Z.hasChild()&&h.Z.postToChild(E.vP.Fullscreenchange({isFullscreen:e})),h.Z.post({type:"screen-manager",action:"fullscreenchange",data:{isFullscreen:e}}),window.setTimeout((()=>{e&&this.lockScreenOrientation()}),T.WT)})).catch((e=>{(0,A.fF)(e)}))}isFullscreenSupported(){return p.w.available||Boolean(document[b.Z.fullscreenEnabled])}needScreenCover(){const e=(0,u.KT)();return m.AY.includes(e)&&"landscape"===this.gameOrientation}isFullscreenEnabled(){const{abt:{flags:e},playPageData:{gameInfo:t}}=this.context,{appId:s}=t;if((0,C.Nm)(e))return!1;if(function(e){return["100714"].includes(e)}(s))return!1;if(window.parent!==window)return!1;const a=(0,u.KT)();return!m.XL.includes(a)&&((!m.AY.includes(a)||"portrait"!==this.gameOrientation)&&Boolean(this.fullScreenValue&&this.isFullscreenSupported()))}get fullscreenElement(){return document[b.Z.fullscreenElement]}isFullscreen(){return p.w.available?p.w.isFullscreen():Promise.resolve(Boolean(this.fullscreenElement))}requestFullscreen({force:e}={}){return e||this.isFullscreenEnabled()?new Promise(((e,t)=>{this.isFullscreen().then((s=>{s?e():this.fullscreenMethodCallWrapper("requestFullscreen").then(e).catch(t)})).catch(t)})):Promise.resolve()}requestFullscreenForYandexPlatforms(){((0,P.RY)()||(0,P.XQ)()||(0,P.V5)())&&this.requestFullscreen().catch((()=>{}))}exitFullscreen(){return this.fullscreenMethodCallWrapper("exitFullscreen")}toggleFullscreen(){return this.isFullscreen().then((e=>e?this.exitFullscreen().then((()=>{this.needScreenCover()||this.setState({withCover:!1}),this.unlockScreenOrientation()})):this.requestFullscreen({force:!0})))}fullscreenMethodCallWrapper(e){return new Promise(((t,s)=>{if(p.w.available)return void p.w[e]().then(t).catch(s);let a,r;if("exitFullscreen"===e?(a=document,r=document[b.Z.exitFullscreen]):(a=document.documentElement,r=a[b.Z[e]]),r)try{Promise.resolve(r.call(a,{navigationUI:"hide"})).then((()=>t())).catch((e=>s(e)))}catch(e){s(e)}else s(new Error("Fullscreen is not supported"))}))}isScreenOrientationSupported(){const{deviceType:e}=this.context;return"desktop"!==e&&"tv"!==e&&R.Z.isSupported}isScreenOrientationEnabled(){return Boolean(this.gameOrientation&&this.isScreenOrientationSupported()&&!(0,C.t7)(this.context.abt.flags))}addScreenOrientationBanner(){I.Eu.params({orientationBanner:{show:!0,correctOrientation:this.gameOrientation,currentOrientation:R.Z.isSupported?(0,R.a)(R.Z.type):void 0}}),this.props.setIsOrientationBannerVisible(Boolean(this.gameOrientation))}removeScreenOrientationBanner(){I.Eu.params({orientationBanner:{show:!1,isLockedForcefully:this.state.screenOrientationWasLocked,correctOrientation:this.gameOrientation,currentOrientation:R.Z.isSupported?(0,R.a)(R.Z.type):void 0}}),this.props.setIsOrientationBannerVisible(!1)}updateScreenOrientationBanner(){if(this.isScreenOrientationEnabled())return R.Z.type.startsWith(String(this.gameOrientation))?(this.removeScreenOrientationBanner(),!1):(this.addScreenOrientationBanner(),!0)}screenOrientationIsLockable(){return R.Z.isLockable&&this.fullscreenElement&&this.isScreenOrientationEnabled()}lockScreenOrientation(){this.screenOrientationIsLockable()&&R.Z.lock(this.gameOrientation).then((()=>{this.setState({screenOrientationWasLocked:!0}),this.props.setScreenOrientationLocked(!0)})).catch((e=>{console.debug(e),this.updateScreenOrientationBanner()}))}unlockScreenOrientation(){this.state.screenOrientationWasLocked&&R.Z.unlock().then((()=>{this.setState({screenOrientationWasLocked:!1}),this.props.setScreenOrientationLocked(!1)})).catch((e=>{console.debug(e)}))}render(){const{withCover:e}=this.state;return[e&&i().createElement(y,{key:"screen-manager-cover"})]}}L.contextType=c.Z;const O=(0,d.$j)(null,(function(e){return(0,l.DE)({setIsFullscreenActive:k.hu,setIsFullscreenEnabled:k.rV,setScreenOrientationLocked:k.ht,setIsOrientationBannerVisible:k.f_},e)}))(L);var x=s(40184),_=s(26891),B=s(65562);function N({abt:e,appId:t,baseHost:s,baseUrl:a,deviceType:r,gameSrc:n,hasExternalURL:i,s3PreloaderHelperPath:o,sdkHash:d,search:l,uatraits:c}){var h;const u=["draft"],p=new URL(n),m=new URLSearchParams(p.hash.slice(1));Array.from(new URLSearchParams(l.slice(1)).entries()).forEach((([e,t])=>{u.includes(e)&&null!==t?m.append(e,t):p.searchParams.has(e)||p.searchParams.append(e,t)})),i?(p.searchParams.set("sdk",`https://games.s3.yandex.net/sdk/_/v2.${d}.js`),p.searchParams.set("sdk_origin","sdk.games.s3.yandex.net")):p.searchParams.set("sdk",`/sdk/_/v2.${d}.js`),m.has("app-id")||m.append("app-id",t),m.append("device-type",r),p.hash=m.toString(),/[?&]csp_test=true/.test(l)&&(p.pathname=p.pathname.replace("index.html","index-csp.html"));const v=p.toString();let g=v;if((0,B.G)(c)||(0,B.g)(c)){const e=(0,_.V)(g);if(e){g=e+(o.startsWith("/")?o.substring(1):o)+"?retpath="+encodeURIComponent(v)}}return g=(null==(h=null==e?void 0:e.flags)?void 0:h.clear_iframe_utm)?(e=>{const t=new URL(e);return Array.from(t.searchParams.keys()).forEach((e=>{0===e.indexOf("utm_")&&t.searchParams.delete(e)})),t.href})(g):g,{frameSrc:g,originSrc:v}}var M=Object.defineProperty,$=Object.defineProperties,F=Object.getOwnPropertyDescriptors,q=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable,G=(e,t,s)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;const U=r().with("game"),H=()=>{var e;const t=(0,x.b)(),s=(0,o.TH)(),{abt:a,playPageData:r,baseHost:d,baseUrl:l,requestId:c,uatraits:h,isAndroidTV:u,deviceType:p,isMiddleLayerInGameExp:m,isTranssion:v}=t,{gameSrcDocument:g}=r;let w,f=r.iframeAllow+"accelerometer; gyroscope;";const y=(0,n.useMemo)((()=>(0,C.MA)(a.flags)||v||m),[a.flags,m,v]);let b=(0,n.useMemo)((()=>s.search),[]),k=(0,n.useMemo)((()=>{var e;const{frameSrc:t}=N({abt:a,appId:r.gameInfo.appId,baseHost:d,baseUrl:l,deviceType:p,gameSrc:r.gameSrc,hasExternalURL:Boolean(null==(e=r.gameData)?void 0:e.hasExternalURL),s3PreloaderHelperPath:r.s3PreloaderHelperPath,sdkHash:r.sdkHash,search:y?b:s.search,uatraits:h});return t}),[a,d,l,p,s.search,null==(e=r.gameData)?void 0:e.hasExternalURL,r.gameInfo.appId,r.gameSrc,r.s3PreloaderHelperPath,r.sdkHash,b,y,h]);const A=(0,n.useCallback)((()=>{var e;"undefined"!=typeof window&&(null==(e=window.onGameFrameLoad)||e.call(window))}),[]),E=(0,n.useCallback)((e=>{var t;"undefined"!=typeof window&&(null==(t=window.onGameFrameError)||t.call(window,e))}),[]);let S=k;if(g){const e=new URL(k),t=new URL(g);t.hash=e.hash,S=t.toString()}return i().createElement("div",{className:U()},i().createElement(O,null),i().createElement("iframe",(I=((e,t)=>{for(var s in t||(t={}))W.call(t,s)&&G(e,s,t[s]);if(q)for(var s of q(t))Z.call(t,s)&&G(e,s,t[s]);return e})({},(0,C.B7)((null==a?void 0:a.flags)||{})&&{"referrer-policy":"no-referrer"}),P={allow:f,"data-allowed-origins":JSON.stringify([r.gameOrigin,d]),"data-origin-src":k,id:"game-frame",name:c,sandbox:w,src:S,style:{},onError:E,onLoad:A},$(I,F(P)))));var I,P},j=H},82346:(e,t,s)=>{"use strict";s.d(t,{G0:()=>A,GP:()=>E,IR:()=>S,QU:()=>P,WM:()=>R,Xp:()=>w,Zn:()=>I,qj:()=>b,wv:()=>f});var a=s(75856),r=s(59986),n=s(14184),i=s(11815),o=s(80856),d=s(42126),l=s(34711),c=s(76488),h=s(40656),u=s(93298),p=s(89592);const m=60*h.WT;let v={time:0,data:{products:[]}};const g=(0,u.M$)("Payments",u.XG.Dev);function w(e){const t=v.lang||e.lang;return new Promise(((e,s)=>{Math.abs(v.time-Date.now())<m&&v.lang===t?e({products:v.data.products}):(0,r.ix)(`products?lang=${encodeURIComponent(t)}`).then((s=>{v={data:s,lang:t,time:Date.now()},e({products:v.data.products})})).catch((e=>{(0,n.fF)(e,{sourceMethod:"getProducts",message:`${p.EW} getProducts error`,type:"fetch"}),s(e)}))}))}const f=(0,a.Z)((function({id:e,lang:t}){return new Promise(((s,a)=>{(0,r.ix)(`products?id=${encodeURIComponent(e)}&lang=${encodeURIComponent(t)}`).then((e=>{var t,a;if(!c.XK){const s=null==(t=window.YandexGamesSDK)?void 0:t.request.experiments.new_payments_balance;void 0!==s&&""!==s&&(e.balance=parseInt(s,10)||0);const r=null==(a=window.YandexGamesSDK)?void 0:a.request.experiments.new_payments_mockable;void 0!==r&&(e.mockable=r||!1)}g("getProduct responseData",e),s(e)})).catch((e=>{(0,n.fF)(e,{sourceMethod:"getProduct",message:`${p.EW} getProduct error`,type:"fetch"}),a(e)}))}))}));function y(e){const t=String((0,l.X)()||"");return t?(0,d.Z)({url:e,params:{clid:t}}):e}const b=(0,a.Z)((function({developer_payload:e,id:t,mock:s,signed:a=!1}){return new Promise(((i,o)=>{(0,r.hB)(y("buy"+(a?"-signed":"")),{id:t,mock:s,developer_payload:e}).then((e=>{"error"in e?o(new Error(e.error)):i(e)})).catch((e=>{(0,n.fF)(e,{sourceMethod:"buyProduct",message:`${p.EW} buyProduct error`,type:"fetch"}),o(e)}))}))})),k=Object.create(null),A=(0,a.Z)((function({token:e}){return g("consumePurchase",e),e in k||(k[e]=new Promise(((t,s)=>{(0,r.hB)("consume",{token:e}).then((a=>{delete k[e],g("consumePurchase responseData",a),a.token?t(a.token):s(new i.Z({code:"CANNOT_CONSUME_PURCHASE",message:"Can not consume purchase."}))})).catch((t=>{delete k[e],(0,n.fF)(t,{sourceMethod:"consumePurchase",message:`${p.EW} consumePurchase error`,type:"fetch"}),s(t)}))}))),k[e]}));function E({paymentsConfig:e,defaultLang:t}){return new Promise(((s,a)=>{(0,r.ix)(`purchased${e.signed?"-signed":""}?lang=${encodeURIComponent(e.lang||t)}`).then((e=>{const{data:t,signature:a}=(0,o.c)(e);s({data:t,signature:a})})).catch((e=>{(0,n.fF)(e,{sourceMethod:"getPurchases",message:`${p.EW} getPurchases error`,type:"fetch"}),a(e)}))}))}function S({lang:e}){return new Promise(((t,s)=>{(0,r.w$)(`products?lang=${encodeURIComponent(e)}`).then((({data:e})=>{g("fetchCurrencyData response",e),t(e)})).catch((e=>{(0,n.fF)(e,{sourceMethod:"getCurrencyProducts",message:`${p.EW} getCurrencyProducts error`,type:"fetch"}),s(e)}))}))}function I({id:e,lang:t,getText:s,cdnUrl:a}){return new Promise(((i,o)=>{(0,r.lB)(`products?lang=${encodeURIComponent(t)}`).then((t=>{var d,l,h,u,m;const v=t.data.find((t=>t.id===e));if(!v)return void o(new Error(`Product with id "${e}" not found.`));const g=v.info.price,w=v.info.pricePlus,f=Boolean(null==(h=null==(l=null==(d=window.YandexGamesSDK)?void 0:d.game)?void 0:l.player)?void 0:h.hasYaPlus)&&"number"==typeof w&&w<g&&w>=0?w:g,y={balance:-1,product:{description:s(`purchase.description.${e}`),id:e,image:{url_prefix:`${a}/games-static/static-data/images/payments/subscriptions/${e}.svg`},price:f,pricePlus:w,priceRegular:g,title:s(`purchase.title.${e}`)}};if(!c.XK){const{experiments:e={}}=null==(u=window.YandexGamesSDK)?void 0:u.request,t=e.new_payments_balance;void 0!==t&&""!==t&&(y.balance=parseInt(t,10)||0);const s=e.new_payments_mockable;void 0!==s&&(y.mockable=s||!1)}(null==(m=window.YandexGamesSDK)?void 0:m.isSearchCrawler)||new Promise(((e,t)=>{(0,r.EG)().then((t=>{e(t.value)})).catch((e=>{(0,n.fF)(e,{sourceMethod:"getBalance",message:`${p.EW} getBalance error`,type:"fetch"}),t(e)}))})).then((e=>{y.balance=e,i(y)})).catch(o)})).catch((e=>{(0,n.fF)(e,{sourceMethod:"getPlatformProduct",message:`${p.EW} getPlatformProduct error`,type:"fetch"}),o(e)}))}))}const P=(0,a.Z)((function({developer_payload:e,id:t,mock:s}){return new Promise(((a,i)=>{(0,r.$)(y("buy"),{id:t,mock:s,developer_payload:e}).then((e=>{"failure"===e.status?i(new Error(e.message)):a(e)})).catch((e=>{(0,n.fF)(e,{sourceMethod:"buyPlatformProduct",message:`${p.EW} buyPlatformProduct error`,type:"fetch"}),i(e)}))}))}));function R(){return new Promise(((e,t)=>{(0,r.KL)().then((t=>{e(t.code)})).catch((e=>{(0,n.fF)(e,{sourceMethod:"getRecoveryCode",message:`${p.EW} getRecoveryCode error`,type:"fetch"}),t(e)}))}))}},75856:(e,t,s)=>{"use strict";s.d(t,{Z:()=>v});var a=s(96452),r=s(43548),n=Object.defineProperty,i=Object.defineProperties,o=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,h=(e,t,s)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,u=(e,t)=>{for(var s in t||(t={}))l.call(t,s)&&h(e,s,t[s]);if(d)for(var s of d(t))c.call(t,s)&&h(e,s,t[s]);return e},p=(e,t)=>i(e,o(t));function m(e,t={}){return r.Z.post({type:"auth",action:e,data:p(u({},t),{initializer:"auth-fetch-wrapper"})})}function v(e){return function(...t){return new Promise(((s,r)=>{e(...t).then(((...e)=>{s(...e)})).catch((n=>{(0,a.ZR)(n)?(m("set-auth",{hasAuth:!1}),m("auth-dialog-open").then((({errorInstance:a})=>{if(a)throw a;e(...t).then(s).catch(r)})).catch(r)):r(n)}))}))}}},59986:(e,t,s)=>{"use strict";s.d(t,{$:()=>L,EG:()=>I,KL:()=>D,U:()=>T,hB:()=>P,ix:()=>S,lB:()=>C,w$:()=>R});var a=s(31320),r=s(75856),n=s(43876),i=s(40656),o=s(93298),d=s(90295),l=Object.defineProperty,c=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,p=(e,t,s)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,m=(e,t)=>{for(var s in t||(t={}))h.call(t,s)&&p(e,s,t[s]);if(c)for(var s of c(t))u.call(t,s)&&p(e,s,t[s]);return e};const v="/purchases/app",g="/purchases/platform",w="/purchases/currency",f=2*i.yR,y=()=>f*(0,a.n)(),b="/currency/balance",k=3*i.WT,A=()=>k*(0,a.n)(),E=(0,o.M$)("Payments fetch",o.XG.Dev);function S(e){return(0,n.rQ)({apiPath:`${v}/${e}`,timeout:y(),options:{credentials:"include",headers:{Accept:"application/json"},method:"GET",referrerPolicy:"no-referrer-when-downgrade"}})}function I(){return(0,n.rQ)({apiPath:b,timeout:A(),options:{credentials:"include",headers:{Accept:"application/json"},method:"GET",referrerPolicy:"no-referrer-when-downgrade"}})}const P=(0,r.Z)((function(e,t){return(0,n.rQ)({apiPath:`${v}/${e}`,timeout:y(),options:{body:JSON.stringify(t),credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",referrerPolicy:"no-referrer-when-downgrade"}})}));function R(e){return(0,n.rQ)({apiPath:`${w}/${e}`,timeout:y(),options:{credentials:"include",headers:{Accept:"application/json"},method:"GET",referrerPolicy:"no-referrer-when-downgrade"}})}const T=(0,r.Z)((function(e,t,s={}){return E("postCurrencyData",JSON.stringify(t,null,"\t")),(0,n.rQ)({apiPath:`${w}/${e}`,timeout:y(),options:{body:JSON.stringify(t),credentials:"include",headers:m({Accept:"application/json","Content-Type":"application/json"},s),method:"POST",referrerPolicy:"no-referrer-when-downgrade"}})}));function C(e){return(0,n.rQ)({apiPath:`${g}/${e}`,timeout:y(),options:{credentials:"include",headers:{Accept:"application/json"},method:"GET",referrerPolicy:"no-referrer-when-downgrade"}})}function D(){return(0,n.rQ)({apiPath:`/${d.tw}`,timeout:y(),options:{credentials:"include",headers:{Accept:"application/json"},method:"GET",referrerPolicy:"no-referrer-when-downgrade"}})}const L=(0,r.Z)((function(e,t){return(0,n.rQ)({apiPath:`${g}/${e}`,timeout:y(),options:{body:JSON.stringify(t),credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",referrerPolicy:"no-referrer-when-downgrade"}})}))},58e3:(e,t,s)=>{"use strict";s.d(t,{E:()=>r});var a=s(96452);function r(e){return(0,a.f1)(e)?new a.ZP.AuthError({code:"UNAUTHORIZED",message:"Unauthorized"}):new a.ZP.PaymentsError({code:"PAYMENT_FAILURE",message:"Payment failure"})}},97976:(e,t,s)=>{"use strict";s.d(t,{Z:()=>E});var a=s(63904),r=s.n(a),n=s(87363),i=s.n(n),o=s(29994),d=s(45331),l=s(32922),c=s(82346),h=s(58e3);const u=s(69833).Z;var p=s(83388),m=s(68409),v=s(43548),g=s(14184),w=s(50042);const f=function(){const e=(0,w.Au)(),t=(0,w.H$)(),s=(0,w.Um)(),a=(0,w.q7)();try{if(window.yandex&&window.yandex.app&&"function"==typeof PaymentRequest&&t&&(e||a&&s))return!0}catch(e){(0,g.fF)(e)}return!1};var y=s(76488),b=s(41952);const k=r().with("play-payments");class A extends d.P{constructor(e,t){super(e),this.paymentsRootRef=i().createRef(),this.onExternalPaymentsMessage=(e,t)=>{const{action:s,data:a}=e.data;switch(s){case"get-env":t({data:{paymentMode:f()?"":void 0}});break;case"get-catalog":const{lang:e}=a;(0,c.Xp)({lang:e||this.state.defaultLang}).then((e=>{t({data:e})})).catch((e=>{t({error:(0,h.E)(e)})}));break;case"purchase-start":{if(this.state.purchaseDialog||this.state.balanceDialog)return void this.trembleDialog();const{paymentsConfig:e,purchaseConfig:s}=a;this.purchaseStartMessagingCallback=t,this.setState({dialogType:p.Z.PURCHASE,balanceDialog:null,purchaseDialog:{basicSupportPaymentRequest:this.state.basicSupportPaymentRequest,isPlatformPurchase:!1,paymentsConfig:e,purchaseConfig:s}});break}case"get-purchases":{const{paymentsConfig:e}=a;(0,c.GP)({paymentsConfig:e,defaultLang:this.state.defaultLang}).then((({data:e,signature:s})=>{t({data:{data:e,signature:s}})})).catch((e=>{t({error:(0,h.E)(e)})}));break}case"purchase-consume":{const{token:e}=a;(0,c.G0)({token:e}).then((e=>{t({data:{token:e}})})).catch((e=>{t({error:(0,h.E)(e)})}));break}}},this.onInternalPaymentsMessage=(e,t)=>{const{action:s,data:a}=e.data;switch(s){case"balance-refill":{const{paymentsConfig:e}=a;this.openBalanceDialog(e);break}case"purchase-start":this.onExternalPaymentsMessage(e,t);break;case"platform-purchase-start":this.startPlatformPurchase(a,t)}},this.onBalanceSuccess=()=>{this.setState({balanceDialog:null})},this.onBalanceError=e=>{y.XK||console.warn(e),this.setState({balanceDialog:null})},this.onPurchaseSuccess=e=>{var t;null==(t=this.purchaseStartMessagingCallback)||t.call(this,{data:e}),this.setState({purchaseDialog:null})},this.onPurchaseError=e=>{var t;null==(t=this.purchaseStartMessagingCallback)||t.call(this,e),this.setState({purchaseDialog:null})},this.onPlatformPurchaseSuccess=e=>{var t;null==(t=this.startPlatformMessagingCallback)||t.call(this,{data:e}),this.setState({purchaseDialog:null}),v.Z.post({type:"payments",action:"platform-purchase-success",data:e})},this.onPlatformPurchaseError=e=>{var t;null==(t=this.startPlatformMessagingCallback)||t.call(this,e),this.setState({purchaseDialog:null})},this.trembleDialog=()=>{this.setState({isTrembling:!1},(()=>{requestAnimationFrame((()=>{this.setState({isTrembling:!0}),window.setTimeout((()=>{this.setState({isTrembling:!1})}),2e3)}))}))},this.handleCreateBalanceRefilled=e=>{this.setState({balanceRefilled:e})},this.handleBalanceRefilledClose=()=>{var e,t;null==(t=null==(e=this.state.balanceRefilled)?void 0:e.onClose)||t.call(e),this.setState({balanceRefilled:null})},this.handleBalanceRefilledBuyMore=()=>{v.Z.post({type:"payments",action:"balance-refill",data:{paymentsConfig:{lang:this.context.lang}}}),this.handleBalanceRefilledClose()},this.renderContent=()=>i().createElement(i().Fragment,null,this.renderBalanceRefilled(),this.renderDialog()),this.state={balanceDialog:null,balanceRefilled:null,dialogType:p.Z.BALANCE,purchaseDialog:null,basicSupportPaymentRequest:!1,isTrembling:!1,defaultLang:t.lang,hasMounted:!1}}componentDidMount(){this.setState({basicSupportPaymentRequest:f(),hasMounted:!0}),this.initMessaging()}initMessaging(){v.Z.onExternalMessage("payments",this.onExternalPaymentsMessage),v.Z.onInternalMessage("payments",this.onInternalPaymentsMessage)}startPlatformPurchase(e,t){if(this.props.disablePlatformPurchase)return;if(this.state.purchaseDialog||this.state.balanceDialog)return void this.trembleDialog();const{paymentsConfig:s,purchaseConfig:a}=e;this.startPlatformMessagingCallback=t,this.setState({dialogType:p.Z.PURCHASE,balanceDialog:null,purchaseDialog:{basicSupportPaymentRequest:this.state.basicSupportPaymentRequest,paymentsConfig:s,purchaseConfig:a,isPlatformPurchase:!0}})}openBalanceDialog(e){this.state.purchaseDialog||this.state.balanceDialog?this.trembleDialog():this.setState({dialogType:p.Z.BALANCE,purchaseDialog:null,balanceDialog:{basicSupportPaymentRequest:this.state.basicSupportPaymentRequest,paymentsConfig:e}})}renderBalanceRefilled(){const{balanceRefilled:e,purchaseDialog:t}=this.state,{balance:s}=this.props;if(e){const a=t?"balance-refilled.ok":"balance-refilled.return-to-game";return i().createElement(l.Z,{balance:"number"==typeof s?s:void 0,diff:Number(e.diff),imgSrc:e.img,isPurchase:Boolean(t),isRetpathUser:!0,orderPrice:e.orderPrice,passportOrigin:b._4.GamesBalanceRefilled,playRecoveryCode:e.recoveryCode,returnButtonText:this.props.getText(a),onBuyMore:this.handleBalanceRefilledBuyMore,onClose:this.handleBalanceRefilledClose})}return null}renderDialog(){const{hideAuthDialog:e}=this.props,{balanceDialog:t,purchaseDialog:s,isTrembling:a,dialogType:r}=this.state;return t?i().createElement(u,{basicSupportPaymentRequest:t.basicSupportPaymentRequest,dialogType:r,hideAuthDialog:e,isTrembling:a,paymentsConfig:t.paymentsConfig,rootRef:this.paymentsRootRef,onBalanceError:this.onBalanceError,onBalanceSuccess:this.onBalanceSuccess,onCreateBalanceRefilled:this.handleCreateBalanceRefilled}):s?i().createElement(u,{basicSupportPaymentRequest:s.basicSupportPaymentRequest,dialogType:r,hideAuthDialog:e,isPlatformPurchase:s.isPlatformPurchase,isTrembling:a,paymentsConfig:s.paymentsConfig,purchaseConfig:s.purchaseConfig,rootRef:this.paymentsRootRef,onCreateBalanceRefilled:this.handleCreateBalanceRefilled,onPlatformPurchaseError:this.onPlatformPurchaseError,onPlatformPurchaseSuccess:this.onPlatformPurchaseSuccess,onPurchaseError:this.onPurchaseError,onPurchaseSuccess:this.onPurchaseSuccess}):null}render(){return this.state.hasMounted?i().createElement("div",{className:k(),ref:this.paymentsRootRef},this.renderContent()):null}}const E=(0,o.$j)((function(e){return{balance:(0,m.n)(e),getText:e.getText}}))(A)},83388:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var a=(e=>(e.BALANCE="balance",e.PURCHASE="purchase",e))(a||{})},78740:(e,t,s)=>{"use strict";s.d(t,{Ek:()=>i,SA:()=>n,UG:()=>d,VM:()=>h,Vs:()=>l,b3:()=>a,cC:()=>c,gK:()=>r,lX:()=>o});const a="similar_games",r="game_promo_similar_games",n="play-similar-games",i="play-similar-games-stubs",o=107,d=20,l="similar_games_count",c="similar_games_proxy",h="yandexGames_similar_games_close"},4230:(e,t,s)=>{"use strict";s.d(t,{_Z:()=>E,ii:()=>S,kr:()=>k,xG:()=>b});var a=s(67748),r=s.n(a),n=s(34711),i=s(35090),o=s(48810),d=s(78740),l=Object.defineProperty,c=Object.defineProperties,h=Object.getOwnPropertyDescriptors,u=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,v=(e,t,s)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,g=(e,t)=>{for(var s in t||(t={}))p.call(t,s)&&v(e,s,t[s]);if(u)for(var s of u(t))m.call(t,s)&&v(e,s,t[s]);return e},w=(e,t)=>c(e,h(t));const f=e=>{let t;try{t=JSON.parse(e)}catch(e){t=[]}return Array.isArray(t)?t:[]},y=(e,t)=>{const s=Array.isArray(e)?e:f(e);t&&s.push(t),(0,o.Ur)(d.VM,JSON.stringify(s))};function b(e){const t=(0,o.dq)(d.VM);t.wasError||!t.value?(0,o.Ur)(d.VM,JSON.stringify([e])):y(t.value,e)}function k(e,t){return void 0===e||0===t.length?t:t.length>e?t=t.slice(0,e):(t.length<e&&(t=[...Array(Math.ceil(e/t.length))].reduce(((e,s,a)=>e.concat(t.map(((e,s)=>w(g({},e),{appID:e.appID+a,title:e.title+` (${a*t.length+s+1})`}))))),[]).slice(0,e)),t)}const A=["played","user_profile_recent_games"];function E({appId:e,hasMounted:t,inGamePage:s,isDistGame:a,locationHash:l,locationSearch:c,showExceptNavigationFromPlayedGames:h,showOnRedirectFromCatalog:u}){if(a)return!1;const p=r().parse(c.slice(1));if("distrib"===p.utm_source||p.clid)return!1;if(s)return!0;if(!t)return!0;if((0,n.X)())return!1;if(h){const e=r().parse(l);if(e.pos&&"string"==typeof e.pos)try{if(A.includes(JSON.parse(e.pos).listType))return!1}catch(e){}}else if(!u&&(0,i.Oo)())return!1;const m=(0,o.dq)(d.VM);if(!m.wasError&&m.value){if(f(m.value).includes(e))return!1}return!0}function S(){"undefined"!=typeof document&&document.body.classList.contains("with-similar-games")&&document.body.classList.remove("with-similar-games")}},1481:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var a=s(87363);const r=({onError:e})=>((0,a.useEffect)((()=>{null==e||e(new Error("Promo chunk wasnt loaded"))}),[e]),null)},65957:(e,t,s)=>{"use strict";s.d(t,{Z:()=>b});var a=s(46210),r=(s(6006),s(63904)),n=s.n(r),i=s(87363),o=s.n(i),d=s(45112),l=s(76994),c=s(45331);const h=n().with("progress-ring");class u extends i.Component{render(){const e=100-Math.min(100,((this.props.current||0)-1)/(this.props.total-1)*100),t=24,s=42*Math.PI,a=s-e/100*s;return o().createElement("div",{className:h()},o().createElement("svg",{height:48,width:48},o().createElement("circle",{className:h("circle-background"),cx:t,cy:t,fill:"transparent",r:21,strokeDasharray:`${s} ${s}`,strokeWidth:3}),o().createElement("circle",{className:h("circle"),cx:t,cy:t,fill:"transparent",r:21,strokeDasharray:`${s} ${s}`,strokeDashoffset:a,strokeWidth:3})),o().createElement("span",{className:h("countdown")},this.props.current))}}u.contextType=c.Z;var p=s(40184),m=s(85467),v=s(41811),g=s(40656),w=s(15771),f=s(90380);const y=n().with("rewarded-counter"),b=({onClose:e,onDone:t,paused:s=!1,seconds:r,text:n})=>{const c=(0,m.T)(),{abt:{flags:h}}=(0,p.b)(),{current:b}=(0,i.useRef)(null!==(0,a.mm)(window.location.href)),[k,A]=(0,i.useState)(b?1:Math.floor(r)),E=k>0;return(0,d.Yz)((()=>{(!0!==(0,w.RM)(h,f.Z.advStopRewardedCounterOnLeave)||!document.hidden&&document.hasFocus())&&A((e=>e-1))}),E&&!s?g.WT:null),(0,i.useEffect)((()=>{E||null==t||t()}),[E,t]),E?o().createElement("div",{className:y()},o().createElement("span",{className:y("text")},n||c("adv.rewarded.countdown.text")),o().createElement(u,{current:Math.max(0,k),total:r})):o().createElement("div",{className:y()},o().createElement(l.Z,{source:v.h0.REWARDED_COUNTER,type:"rewarded",onClick:e}))}},95968:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var a=s(95178);const r={fullscreenEnabled:(0,a.Z)("fullscreenEnabled"),fullscreenElement:(0,a.Z)("fullscreenElement"),requestFullscreen:(0,a.Z)("requestFullscreen"),exitFullscreen:(0,a.Z)("exitFullscreen"),fullscreenchange:(0,a.Z)("fullscreenchange")}},15987:(e,t,s)=>{"use strict";s.d(t,{w:()=>a});var a=(e=>(e.MENU="menu",e.TIMER="timer",e))(a||{})},29810:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var a=s(87363),r=s(29994),n=s(77123),i=s(46986),o=s(96821),d=s(69136);const l=(0,r.$j)((function(e){return{appState:e}}),(function(e){return(0,n.DE)({fetchUserBalance:i.Zc,setUserBalance:i.v},e)}))((e=>{const{fetchUserBalance:t,setUserBalance:s}=e,r="undefined"!=typeof window,{appState:n}=e,i=n.userData.uid,l=(0,a.useRef)(i),c=(0,a.useMemo)((()=>{if(!r)return!1;return(0,o.Z)((()=>n)).sse||!1}),[n,r]);return(0,a.useEffect)((()=>{c&&l.current!==i&&(l.current=i,c.changeAuth(i))}),[c,i]),(0,a.useEffect)((()=>{if(!c)return;const e=[],a=c.subscribe(d.Xn.BALANCE_CHANGED,(()=>{n.user.balance.ignoreBalanceEvents||t({forceFetch:!0})})),r=c.subscribe(d.Xn.BALANCE_UPDATE,(e=>{n.user.balance.ignoreBalanceEvents||s(e.value)}));return e.push(a),e.push(r),()=>{e.forEach((e=>e()))}}),[t,s,c,n.user.balance.ignoreBalanceEvents]),null}))},68316:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});const a=s(89775).Z},22263:(e,t,s)=>{"use strict";s.d(t,{c:()=>n});var a=s(38096),r=s(90380);const n=(e,t)=>{var s;if(t)return!0;const{abt:{flags:n}}=e,i=(null==(s=(0,a.getDomainConfig)().feedbackSettings)?void 0:s.flagName)||"";return Boolean(n[r.Z[i]])}},53603:(e,t,s)=>{"use strict";s.d(t,{I:()=>o,s:()=>d});var a=s(87363),r=s.n(a),n=s(78675);const i=(0,a.createContext)(null),o=e=>{const[t,s]=(0,a.useState)(!1);return r().createElement(i.Provider,{value:{isReady:t,setIsReady:s}},e.children)},d=()=>(0,n.C)({context:i,hookName:"useWithReady",contextName:"WithReadyContext"})},99213:(e,t,s)=>{"use strict";s.d(t,{b:()=>r});var a=s(87363);const r=(e,t)=>{const s=(0,a.useRef)(!1);(0,a.useEffect)((()=>{!s.current&&t&&(s.current=!0,e())}),[t,e])}},77976:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var a=s(87363),r=s.n(a),n=s(94521);const i=()=>r().createElement(n.Z,{isFullscreen:!0})},604:(e,t,s)=>{"use strict";s.d(t,{Q:()=>a});var a=(e=>(e.Background="background",e.CloseButton="close_button",e.DrawerSwipe="drawer_swipe",e.PlayButton="play_button",e.SplashScreen="splash_screen",e))(a||{})},90043:(e,t,s)=>{"use strict";s.d(t,{f_:()=>i,ht:()=>r,hu:()=>n,ls:()=>d,lt:()=>c,rV:()=>o,zN:()=>l});var a=s(2203);const r=e=>({type:a.esH,payload:{value:e}}),n=e=>({type:a.iZl,payload:{value:e}}),i=e=>({type:a.OSx,payload:{value:e}}),o=e=>({type:a.E_7,payload:{value:e}}),d=e=>({type:a.WjI,payload:{value:e}}),l=e=>({type:a.D3C,payload:{value:e}}),c=e=>({type:a.Die,payload:{value:e}})},22355:(e,t,s)=>{"use strict";s.d(t,{b:()=>a,y:()=>r});const a=e=>e.ui.isFullscreenActive,r=e=>e.ui.isFullscreenEnabled},37557:(e,t,s)=>{"use strict";s.d(t,{C:()=>a});const a=s(29994).v9},92389:(e,t,s)=>{"use strict";function a(e){var t;let s=document.querySelector(`.stack .${e}`);return s||(s=document.createElement("div"),s.setAttribute("class",e),null==(t=document.querySelector(".stack"))||t.appendChild(s)),s}s.d(t,{_:()=>a})},91521:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r,b:()=>a});const a="yandexGames_leaderboard_clicked",r="yandexGames_no_ads_clicked"},33755:(e,t,s)=>{"use strict";s.d(t,{CX:()=>T,N5:()=>N,bT:()=>O,Vg:()=>_,S$:()=>D,xq:()=>L});var a=s(46210),r=s(14408);const n={hostname:()=>window.location.hostname,pathname:()=>window.location.pathname,protocol:()=>window.location.protocol,rootHostname:()=>window.location.hostname.split(".").slice(-2).join(".")},i=e=>e.replace(/{(\w+)}/g,((e,t)=>{var s,a;return null!=(a=null==(s=n[t])?void 0:s.call(n))?a:""}));var o=s(78308),d=s(40656),l=s(93298),c=s(15771);const h=(0,l.M$)("googlefc",l.XG.Adv,{background:"#123896",text:"white"}),u=()=>{window.googlefc=window.googlefc||{callbackQueue:[]};const{googlefc:e}=window;e.controlledMessagingFunction||(e.controlledMessagingFunction=e=>{return t=void 0,s=null,a=function*(){var t,s;if(window.appData.isGamesLiteApp)return e.proceed(!1),void h("googlefc.controlledMessagingFunction message.proceed(false).\n(window.appData.isGamesLiteApp === true)");(0,c.c6)((null==(s=null==(t=window.appData)?void 0:t.abt)?void 0:s.flags)||{})&&(h("googlefc.controlledMessagingFunction delay"),yield new Promise((e=>{var t;null==(t=window.tti)||t.ready((()=>{e()})),setTimeout((()=>{e()}),15*d.WT)}))),e.proceed(!0),h("googlefc.controlledMessagingFunction default behaviour.")},new Promise(((e,r)=>{var n=e=>{try{o(a.next(e))}catch(e){r(e)}},i=e=>{try{o(a.throw(e))}catch(e){r(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,i);o((a=a.apply(t,s)).next())}));var t,s,a})};var p=s(90380);const m=8,v=40;var g=s(76488),w=s(37705),f=s(79049),y=s(13377),b=Object.defineProperty,k=Object.getOwnPropertySymbols,A=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable,S=(e,t,s)=>t in e?b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,I=(e,t)=>{for(var s in t||(t={}))A.call(t,s)&&S(e,s,t[s]);if(k)for(var s of k(t))E.call(t,s)&&S(e,s,t[s]);return e},P=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const R=(0,l.M$)("GoogleTagUtils",l.XG.Adv,{background:"#0c6c09",text:"#ccc"}),T=8*d.WT;let C;const D=()=>{if(C)return C;u();const e=(0,a.gw)(window.location.href);return C=(0,f.x)({id:"gpt-script",loadTest:()=>{var e;return Boolean(null==(e=window.googletag)?void 0:e.apiReady)},src:e?(0,a.DL)(e):"https://securepubads.g.doubleclick.net/tag/js/gpt.js"}),C},L=({metrikaCounter:e,parallel:t,prebidScriptUrl:s})=>{const a={gpt:!1,prebid:!1},r=s?(0,f.x)({attributes:{ym:e},crossOrigin:"anonymous",id:"prebid_tgo",src:s}):null;return t?Promise.all([D().then((()=>a.gpt=!0)).catch((e=>a.gptError=e)),null==r?void 0:r.then((()=>a.prebid=!0)).catch((e=>a.prebidError=e))]).then((()=>a)).catch((()=>a)):D().then((()=>{a.gpt=!0})).catch((e=>a.gptError=e)).then((()=>{if(!a.gptError)return null==r?void 0:r.then((()=>a.prebid=!0)).catch((e=>a.prebidError=e))})).then((()=>a)).catch((()=>a))},O=e=>P(void 0,null,(function*(){return new Promise(((t,s)=>{window.googletag=window.googletag||{cmd:[]};const{googletag:a}=window;a.cmd||(a.cmd=[]),a.cmd.push((()=>P(void 0,null,(function*(){try{t(yield e(window.googletag))}catch(e){s(e)}}))))}))}));let x;const _=()=>P(void 0,null,(function*(){return x||(!0===(null==googletag?void 0:googletag.pubadsReady)&&R("googletagSetBaseConfig was called after googletag.enableServices()"),x=O((e=>{const t=e.pubads();(e=>{var t;if(!window.appData)return;const s=(0,r.om)(window.appData.abt.flags);if(void 0!==s&&!s.length)return;if(void 0===s){const e="stand"===window.appData.env.CROWD_TYPE;if(g.XK&&!e&&!(null==(t=window.appData.clientFeatures)?void 0:t.isDistrib))return}const a=i(null!=s?s:"{rootHostname}");e.set("page_url",a)})(t),t.enableSingleRequest(),t.disableInitialLoad(),l.HQ&&googletag.pubads().addEventListener("impressionViewable",(()=>{R('pubads event "impressionViewable" called')})).addEventListener("slotOnload",(()=>{R('pubads event "slotOnload" called')})).addEventListener("slotRenderEnded",(()=>{R('pubads event "slotRenderEnded" called')})).addEventListener("slotRequested",(()=>{R('pubads event "slotRequested" called')})).addEventListener("slotResponseReceived",(()=>{R('pubads event "slotResponseReceived" called')})).addEventListener("rewardedSlotReady",(()=>{R('pubads event "rewardedSlotReady" called')})).addEventListener("rewardedSlotGranted",(()=>{R('pubads event "rewardedSlotGranted" called')})).addEventListener("rewardedSlotClosed",(()=>{R('pubads event "rewardedSlotClosed" called')})),function(){return P(this,null,(function*(){const e=yield N(),t=googletag.pubads();R("setGoogleKeysForTargeting",e),Object.entries(e).forEach((([e,s])=>{t.setTargeting(e,s)}))}))}().then((()=>{x=Promise.resolve(),R("googletagSetBaseConfig"),!0===e.pubadsReady&&(0,w.H)({block:y.W.MONETIZATION,level:"error",message:"setGoogleKeysForTargeting finished after googletag.enableServices()"})}))}))),x}));let B;function N(){return B||(B=new o.Z(window.appData.apiData).getGoogleKeyValues({appID:window.clientMetadata.appId,lang:window.clientMetadata.lang,platform:window.clientMetadata.platform}).catch((e=>((0,w.H)({block:y.W.GOOGLE_ADS,message:"Trouble with getting google key values"},e),{}))).then((e=>(R("getGoogleKeysForTargeting",e),I(I({},function(){if(!0!==(0,c.RM)(window.appData.abt.flags,p.Z.advGoogleTestidsTargeting))return{};let e=0,t=0;function s(){t=0,e++}return window.appData.abt.testIds.sort(((e,t)=>(Number(e)||0)-(Number(t)||0))).reduce(((a,r,n)=>{t+=r.length,0!==n&&t>v&&s();const i=`testIds_${e}`;return a[i]||(a[i]=[]),a[i].push(r)>=m&&s(),a}),{})}()),e))))),B}},55231:(e,t,s)=>{"use strict";s.d(t,{TE:()=>h,k_:()=>p});var a=s(40656),r=Object.defineProperty,n=Object.defineProperties,i=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,c=(e,t,s)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;a.WT;const h=a.WT;u=((e,t)=>{for(var s in t||(t={}))d.call(t,s)&&c(e,s,t[s]);if(o)for(var s of o(t))l.call(t,s)&&c(e,s,t[s]);return e})({},{default:[[300,250],[300,300]],wide:[[728,90],[750,200],[970,90],[970,250],[980,90],[980,120]]}),n(u,i({wide:[[728,90],[970,90],[970,250]]}));var u;const p={filterSettings:{iframe:{bidders:"*",filter:"include"}},iframeEnabled:!0,syncEnabled:!0}},38508:(e,t,s)=>{"use strict";s.d(t,{M:()=>n});s(38096);var a=s(41811),r=s(29483);function n(e,t){const{blockId:s,pageId:a}=t;let n="__getTextFromYandexAdvError_EMPTY_ERROR_TEXT__";if(e.text){const t=new RegExp((0,r.h)(s),"g");if(n=e.text.replace(t,"{see additional}"),"number"==typeof a){const e=new RegExp(`{see additional}_${a}`,"g");n=n.replace(e,"{see additional}_{see additional}")}}return n}a.bS},25562:(e,t,s)=>{"use strict";s.d(t,{TG:()=>i,iv:()=>r});s(15771),s(90380);const a=[[300,250],[300,300],[300,500],[300,600],[320,480],[336,280],[480,320]],r=e=>{const t=n(e);return o(a,t,140)},n=e=>120,i=e=>{const{canReturnEmptyArray:t,maxAdvHeight:s,maxAdvWidth:a,sizes:r}=e,n=r.filter((e=>!(!Array.isArray(e)||"fluid"!==e[0])||e[0]<=a&&e[1]<=s));return 0!==n.length||t?n:[r[0]]},o=(e,t=0,s=0)=>{if("undefined"==typeof window)return e;const a=window.innerWidth-t,r=window.innerHeight-s;return i({sizes:e,maxAdvWidth:a,maxAdvHeight:r})}},42873:(e,t,s)=>{"use strict";s.d(t,{U:()=>n});const a=[{bidder:"cpmstar",params:{placementId:86543}},{bidder:"between",params:{s:4711702}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"pubmatic",params:{adSlot:"5337827",publisherId:"161759"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872330,formatId:125925}},{bidder:"yandex",params:{impId:1,pageId:3907938}}],r=[{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5447199"}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1891309,formatId:125927}},{bidder:"between",params:{s:4718353,cur:"EUR"}},{bidder:"cpmstar",params:{placementId:88076}},{bidder:"yandex",params:{impId:1,pageId:3907938}},{bidder:"smilewanted",params:{zoneId:"d-sail.com_hb_display"}}],n={playhop:{default:{catalog:{desktop:[{bidder:"cpmstar",params:{placementId:89042}},{bidder:"between",params:{s:4711945}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"pubmatic",params:{adSlot:"5342202",publisherId:"161759"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:125929}},{bidder:"yandex",params:{impId:7,pageId:3907938}}],mobile:[{bidder:"cpmstar",params:{placementId:89042}},{bidder:"between",params:{s:4711749}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"pubmatic",params:{adSlot:"5337846",publisherId:"161759"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:125925}},{bidder:"yandex",params:{impId:8,pageId:3907938}}]},interstitial:{desktop:[{bidder:"cpmstar",params:{placementId:89042}},{bidder:"between",params:{s:4711743}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"pubmatic",params:{adSlot:"5337842",publisherId:"161759"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:125927}},{bidder:"yandex",params:{impId:1,pageId:3907938}}],mobile:[{bidder:"cpmstar",params:{placementId:89042}},{bidder:"between",params:{s:4711752}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"pubmatic",params:{adSlot:"5337847",publisherId:"161759"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:126085}},{bidder:"yandex",params:{impId:1,pageId:3907938}}]},sticky:{desktop:{sidebar_main:[{bidder:"cpmstar",params:{placementId:89042}},{bidder:"between",params:{s:4711743}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"pubmatic",params:{adSlot:"5337842",publisherId:"161759"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:125936}},{bidder:"yandex",params:{impId:5,pageId:3907938}}],sidebar_small:[{bidder:"cpmstar",params:{placementId:89042}},{bidder:"between",params:{s:4711915}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"pubmatic",params:{adSlot:"5338845",publisherId:"161759"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:126099}},{bidder:"yandex",params:{impId:6,pageId:3907938}}]},mobile:{landscape_bottom:[{bidder:"cpmstar",params:{placementId:89042}},{bidder:"between",params:{s:4711751}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"pubmatic",params:{adSlot:"5337848",publisherId:"161759"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:126096}},{bidder:"yandex",params:{impId:2,pageId:3907938}}],portrait:[{bidder:"cpmstar",params:{placementId:89042}},{bidder:"between",params:{s:4711754}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"pubmatic",params:{adSlot:"5337850",publisherId:"161759"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:126097}},{bidder:"yandex",params:{impId:3,pageId:3907938}}],portrait_high:[{bidder:"cpmstar",params:{placementId:89042}},{bidder:"between",params:{s:4711753}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"pubmatic",params:{adSlot:"5337849",publisherId:"161759"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:126089}},{bidder:"yandex",params:{impId:4,pageId:3907938}}]}}},dsail:{catalog:{desktop:[{bidder:"adform",params:{adxDomain:"adx.adform.net",mid:1978547,priceType:"net"}},{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5342202"}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:125929}},{bidder:"between",params:{s:4711945,cur:"EUR"}},{bidder:"cpmstar",params:{placementId:89042}},{bidder:"yandex",params:{impId:7,pageId:3907938}},{bidder:"smilewanted",params:{zoneId:"d-sail.com_hb_display"}}],mobile:[{bidder:"adform",params:{adxDomain:"adx.adform.net",mid:1978552,priceType:"net"}},{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5337846"}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:125925}},{bidder:"between",params:{s:4711749,cur:"EUR"}},{bidder:"cpmstar",params:{placementId:89042}},{bidder:"yandex",params:{impId:8,pageId:3907938}},{bidder:"smilewanted",params:{zoneId:"d-sail.com_hb_display"}}]},interstitial:{desktop:[{bidder:"adform",params:{adxDomain:"adx.adform.net",mid:1978548,priceType:"net"}},{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5337843"}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:125927}},{bidder:"between",params:{s:4711743,cur:"EUR"}},{bidder:"cpmstar",params:{placementId:89042}},{bidder:"yandex",params:{impId:1,pageId:3907938}},{bidder:"smilewanted",params:{zoneId:"d-sail.com_hb_display"}}],mobile:[{bidder:"adform",params:{adxDomain:"adx.adform.net",mid:1978554,priceType:"net"}},{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5337847"}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:126085}},{bidder:"between",params:{s:4711752,cur:"EUR"}},{bidder:"cpmstar",params:{placementId:89042}},{bidder:"yandex",params:{impId:1,pageId:3907938}},{bidder:"smilewanted",params:{zoneId:"d-sail.com_hb_display"}}]},sticky:{desktop:{sidebar_main:[{bidder:"adform",params:{adxDomain:"adx.adform.net",mid:1978549,priceType:"net"}},{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5337844"}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:125936}},{bidder:"between",params:{s:4711747,cur:"EUR"}},{bidder:"cpmstar",params:{placementId:89042}},{bidder:"yandex",params:{impId:5,pageId:3907938}},{bidder:"smilewanted",params:{zoneId:"d-sail.com_hb_display"}}],sidebar_small:[{bidder:"adform",params:{adxDomain:"adx.adform.net",mid:1978551,priceType:"net"}},{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5338845"}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:126099}},{bidder:"between",params:{s:4711915,cur:"EUR"}},{bidder:"cpmstar",params:{placementId:89042}},{bidder:"yandex",params:{impId:6,pageId:3907938}},{bidder:"smilewanted",params:{zoneId:"d-sail.com_hb_display"}}]},mobile:{landscape_bottom:[{bidder:"adform",params:{adxDomain:"adx.adform.net",mid:1978563,priceType:"net"}},{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5337848"}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:126096}},{bidder:"between",params:{s:4711751,cur:"EUR"}},{bidder:"cpmstar",params:{placementId:89042}},{bidder:"yandex",params:{impId:2,pageId:3907938}},{bidder:"smilewanted",params:{zoneId:"d-sail.com_hb_display"}}],portrait:[{bidder:"adform",params:{adxDomain:"adx.adform.net",mid:1978564,priceType:"net"}},{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5337850"}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:126097}},{bidder:"between",params:{s:4711754,cur:"EUR"}},{bidder:"cpmstar",params:{placementId:89042}},{bidder:"yandex",params:{impId:3,pageId:3907938}},{bidder:"smilewanted",params:{zoneId:"d-sail.com_hb_display"}}],portrait_high:[{bidder:"adform",params:{adxDomain:"adx.adform.net",mid:1978565,priceType:"net"}},{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5337849"}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872333,formatId:126089}},{bidder:"between",params:{s:4711753,cur:"EUR"}},{bidder:"cpmstar",params:{placementId:89042}},{bidder:"yandex",params:{impId:4,pageId:3907938}},{bidder:"smilewanted",params:{zoneId:"d-sail.com_hb_display"}}]}}}},yandex:{default:{catalog:{desktop:[{bidder:"cpmstar",params:{placementId:86541}},{bidder:"between",params:{s:4711728}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"pubmatic",params:{adSlot:"5337831",publisherId:"161759"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872330,formatId:125929}},{bidder:"yandex",params:{impId:7,pageId:3907938}}],mobile:[{bidder:"cpmstar",params:{placementId:86543}},{bidder:"between",params:{s:4711793}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5337837"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872330,formatId:125924}},{bidder:"yandex",params:{impId:8,pageId:3907938}}]},interstitial:{desktop:a,mobile:a},sticky:{desktop:{sidebar_main:[{bidder:"cpmstar",params:{placementId:87338}},{bidder:"between",params:{s:4711730}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"pubmatic",params:{adSlot:"5337833",publisherId:"161759"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872330,formatId:125927}},{bidder:"yandex",params:{impId:5,pageId:3907938}}],sidebar_small:[{bidder:"cpmstar",params:{placementId:87337}},{bidder:"between",params:{s:4711731}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"pubmatic",params:{adSlot:"5337834",publisherId:"161759"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872330,formatId:126087}},{bidder:"yandex",params:{impId:6,pageId:3907938}}]},mobile:{landscape_bottom:[{bidder:"cpmstar",params:{placementId:87339}},{bidder:"between",params:{s:4711725}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"pubmatic",params:{adSlot:"5337836",publisherId:"161759"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872330,formatId:126096}},{bidder:"yandex",params:{impId:2,pageId:3907938}}],portrait:[{bidder:"cpmstar",params:{placementId:87339}},{bidder:"between",params:{s:4711726}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"pubmatic",params:{adSlot:"5337829",publisherId:"161759"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872330,formatId:126097}},{bidder:"yandex",params:{impId:3,pageId:3907938}}],portrait_high:[{bidder:"cpmstar",params:{placementId:87339}},{bidder:"between",params:{s:4711727}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"pubmatic",params:{adSlot:"5337830",publisherId:"161759"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1872330,formatId:126089}},{bidder:"yandex",params:{impId:4,pageId:3907938}}]}}},dsail:{catalog:{desktop:[{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5447203"}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1891309,formatId:125929}},{bidder:"between",params:{s:4718358,cur:"EUR"}},{bidder:"cpmstar",params:{placementId:86544}},{bidder:"yandex",params:{impId:7,pageId:3907938}},{bidder:"smilewanted",params:{zoneId:"d-sail.com_hb_display"}}],mobile:[{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5447198"}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1891309,formatId:125924}},{bidder:"between",params:{s:4718363,cur:"EUR"}},{bidder:"cpmstar",params:{placementId:86543}},{bidder:"yandex",params:{impId:8,pageId:3907938}},{bidder:"smilewanted",params:{zoneId:"d-sail.com_hb_display"}}]},interstitial:{desktop:r,mobile:r},sticky:{desktop:{sidebar_main:[{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5447206"}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1891309,formatId:126086}},{bidder:"between",params:{s:4718360,cur:"EUR"}},{bidder:"cpmstar",params:{placementId:87419}},{bidder:"yandex",params:{impId:5,pageId:3907938}},{bidder:"smilewanted",params:{zoneId:"d-sail.com_hb_display"}}],sidebar_small:[{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5447207"}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1891309,formatId:126087}},{bidder:"between",params:{s:4718361,cur:"EUR"}},{bidder:"cpmstar",params:{placementId:87420}},{bidder:"yandex",params:{impId:6,pageId:3907938}},{bidder:"smilewanted",params:{zoneId:"d-sail.com_hb_display"}}]},mobile:{landscape_bottom:[{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5447200"}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1891309,formatId:126096}},{bidder:"between",params:{s:4718355,cur:"EUR"}},{bidder:"cpmstar",params:{placementId:87339}},{bidder:"yandex",params:{impId:2,pageId:3907938}},{bidder:"smilewanted",params:{zoneId:"d-sail.com_hb_display"}}],portrait:[{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5447201"}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1891309,formatId:126097}},{bidder:"between",params:{s:4718356,cur:"EUR"}},{bidder:"cpmstar",params:{placementId:87339}},{bidder:"yandex",params:{impId:3,pageId:3907938}},{bidder:"smilewanted",params:{zoneId:"d-sail.com_hb_display"}}],portrait_high:[{bidder:"pubmatic",params:{publisherId:"161759",adSlot:"5447202"}},{bidder:"rtbhouse",params:{publisherId:"v4GnkHMXFvfW0XWFA4bn",region:"prebid-eu"}},{bidder:"smartadserver",params:{domain:"https://prg.smartadserver.com",networkId:4170,siteId:614659,pageId:1891309,formatId:126089}},{bidder:"between",params:{s:4718357,cur:"EUR"}},{bidder:"cpmstar",params:{placementId:87339}},{bidder:"yandex",params:{impId:4,pageId:3907938}},{bidder:"smilewanted",params:{zoneId:"d-sail.com_hb_display"}}]}}}}}},59886:(e,t,s)=>{"use strict";s.d(t,{F7:()=>d,GG:()=>g,Hf:()=>u,Vc:()=>h,XI:()=>m,XO:()=>c,ZV:()=>p,cy:()=>l,kw:()=>v,wz:()=>i});var a=s(38096),r=s(25562),n=s(42873);const i={adServerCurrency:"EUR",conversionRateFile:`${"undefined"!=typeof window&&(null==(o=window.appData)?void 0:o.cdnUrl)?window.appData.cdnUrl:"https://yastatic.net/s3"}/games-static/static-data/prebid/currency-file@1/latest.json`,defaultRates:{EUR:{EUR:1,USD:1.1},USD:{EUR:.9,USD:1}}};var o;const d={buckets:[{increment:.01,max:3,precision:2},{increment:.1,max:10},{increment:.2,max:50}]},l={gdpr:{actionTimeout:1e4,cmpApi:"iab",defaultGdprScope:!0,rules:[{enforcePurpose:!0,enforceVendor:!0,purpose:"basicAds",vendorExceptions:["between","cpmstar","pubmatic","rtbhouse","smartadserver","yandex"]}],timeout:5e3},usp:{timeout:100}};var c=(e=>(e.EMPTY_SLOT="Google slot event is empty",e.INSTREAM_EMPTY="Instream response is empty",e.NO_SLOT="googletag couldn't create gptSlot",e))(c||{});const h=(e,t,s)=>{let i=(0,a.getDomainConfig)().adv.bidsServiceName;const o=n.U[i][t].interstitial[e];return{mediaTypes:{banner:{sizes:(0,r.iv)(s)}},bids:o}},u={},p=5e3,m=8e3,v=1e3,g={aws:"https://statics.games-storage-aws.yandex.net/statics/prebid/prebid8.10.0.js",yastatic:"https://yastatic.net/s3/games-static/static-data/prebid/prebid8.52.2.js"}},58098:(e,t,s)=>{"use strict";s.d(t,{BA:()=>g,OH:()=>k,cQ:()=>v});var a=s(46210),r=s(36529),n=s(14184),i=s(55231),o=s(59886),d=s(91605),l=s(68199),c=s(93298),h=s(15771),u=s(90380),p=(e,t,s)=>new Promise(((a,r)=>{var n=e=>{try{o(s.next(e))}catch(e){r(e)}},i=e=>{try{o(s.throw(e))}catch(e){r(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())}));const m=(0,c.M$)("PrebidUtils",c.XG.Adv,{background:"#0c6c09",text:"#ccc"});function v({cdnUrl:e,flags:t,fullUrl:s,options:{isSlowCountry:r}}){const n=(0,a.xA)(s);if(n)return(0,a.Xv)(n);if((0,h.jX)(t))return o.GG.aws;let i=o.GG.yastatic;const d=(0,h.di)(t,u.Z.advPrebidScript);if(d){if(/^https:\/\//.test(d))return d;i=i.replace(/(?:\d+\.){1,2}\d+(\.js)$/,`${d}$1`)}return(0,l.R)(r)&&e&&(i=i.replace("https://yastatic.net/s3",e)),i}const g=e=>p(void 0,null,(function*(){return new Promise((t=>{window.pbjs=window.pbjs||{que:[]};const{pbjs:s}=window;s.que.push((()=>p(void 0,null,(function*(){t(yield e(s))}))))}))}));function w(){const e=new URL(window.location.href);return e.hostname=e.hostname.replace(/^.+\.([a-z0-9]+(\.com)?\.[a-z]+)$/,"$1"),e.search="",e.hash="",e.href}const f=5e3;function y(){let e=!1;return Promise.race([g((t=>p(this,null,(function*(){m("Set prebid config"),e=!0,t.setConfig({consentManagement:o.cy,currency:o.wz,debug:c.HQ,deviceAccess:!0,enableTIDs:!0,enableSendAllBids:!0,fetchBids:!0,pageUrl:w(),priceGranularity:o.F7,targetingControls:{allowTargetingKeys:["BIDDER","AD_ID","PRICE_BUCKET","SIZE","DEAL","SOURCE","FORMAT","UUID","CACHE_ID","CACHE_HOST","ADOMAIN","ACAT","CRID","DSP"],allowSendAllBidsTargetingKeys:["BIDDER","AD_ID","PRICE_BUCKET","SIZE","DEAL","SOURCE","FORMAT","UUID","CACHE_ID","CACHE_HOST","ADOMAIN","ACAT","CRID","DSP"]},transmitTid:!0,userSync:i.k_});const s=(0,d.NR)();s&&t.installedModules.includes("yandexAnalyticsAdapter")&&t.enableAnalytics({provider:"yandex",options:{counters:[s]}}),c.HQ&&function(e){e.onEvent("auctionInit",(()=>{m("Auction init")})),e.onEvent("auctionEnd",(t=>{const s=t.bidsReceived.length?"success":"empty",a="success"===s?e.getHighestCpmBids().map((e=>({ad:e.ad,adunit:e.adUnitCode,adId:e.adId,bidder:e.bidder,cpm:e.cpm,size:e.size,time:e.timeToRespond}))):void 0;m(`Auction end with status = ${s}; result = ${JSON.stringify(a,null,"\t")}`)})),e.onEvent("bidderError",(function(e){var t;const{bidderRequest:s}=e,a=null==(t=s.bids[0])?void 0:t.adUnitCode;m(`Bidder error code = ${s.bidderCode}; adUnitCode = ${a}`)})),e.onEvent("noBid",(function(e){const{adUnitCode:t}=e;m(`No bid for adUnitCode = ${t}`)})),e.onEvent("adRenderFailed",(e=>{m("adRenderFailed, bidder =",e.bid.bidder)})),e.onEvent("adRenderSucceeded",(e=>{m("adRenderSucceeded, bidder =",e.bid.bidder)}))}(t)})))),(0,r.D)(f).then((()=>{e||(m("Config was not set."),(0,n.fF)(new Error("[prebid_tgo] Config was not set (canceled by timeout)")))}))])}let b;function k(){return b||(b=new Promise((e=>{y().finally((()=>{b=Promise.resolve(),e()}))}))),b}},78569:(e,t,s)=>{"use strict";s.d(t,{H:()=>r});var a=s(37705);function r({adUnitCodes:e,advTag:t,bids:s}){for(let r of e){const e=null==s?void 0:s[r];if(e){const s=e.bids[0];(0,a.Kz)("prebid_auction","",{additional:{tag:t,bidder:s.bidder,currency:s.currency,originalCurrency:s.originalCurrency,size:s.size}})}else(0,a.Kz)("prebid_auction","",{additional:{tag:t,bidder:"none"}})}}},40895:(e,t,s)=>{"use strict";s.d(t,{$:()=>a});var a=(e=>(e.ADV_IS_NOT_CONNECTED="ADV_IS_NOT_CONNECTED",e.UNKNOWN="UNKNOWN",e))(a||{})},32054:(e,t,s)=>{"use strict";s.d(t,{CU:()=>i,ZY:()=>n,pr:()=>o});var a=s(41811),r=s(26213);function n({clid:e,flags:t,isConfirmedGuard:s,location:n}){return!t.skip_guard&&e!==a.x2&&(!(i=n.search)||"1"!==new URLSearchParams(i.replace(/^\?/,"")).get(r.U))&&(!!function(e){return e?-1!==e.hash.indexOf("info=true")||-1!==e.search.indexOf("info=true"):"undefined"!=typeof window&&-1!==window.location.href.indexOf("info=true")}(n)||!s);var i}function i({gameData:e,userRegionData:t}){return!(null==t?void 0:t.isForeign)&&(!!(e&&e.extraFeatures.purchases&&e.extraFeatures.hasProducts)&&!(null==e?void 0:e.askedPurchasesInfoPermission))}function o({gameData:e,userRegionData:t}){return!i({gameData:e,userRegionData:t})&&Boolean(null==e?void 0:e.guard)}},3436:(e,t,s)=>{"use strict";let a;s.d(t,{R:()=>a});try{new EventTarget,a=EventTarget}catch(e){class t{constructor(){this.eventListeners={}}addEventListener(e,t){this.eventListeners[e]=this.eventListeners[e]||[],this.eventListeners[e].push(t)}removeEventListener(e,t){this.eventListeners[e]&&(this.eventListeners[e]=this.eventListeners[e].filter((e=>e!==t)))}dispatchEvent(e){const t=e.type;for(const s of this.eventListeners[t]||[]){const t="handleEvent"in s?s.handleEvent:s;try{t.apply(s,[e])}catch(e){}}return!e.defaultPrevented}}a=t}},73285:(e,t,s)=>{"use strict";function a(e){if(!e)return"";const t={"&amp;":"&","&#39;":"'","&quot;":'"'};return e.replace(/&amp;|&#39;|&quot;/g,(e=>t[e]))}s.d(t,{T:()=>a})},41318:(e,t,s)=>{"use strict";function a(e,t,s){if(!t)return s("guard.player.permissions.description");const a=s("payments.currency.genitive").toLowerCase();return s(e?"guard.player.permissions.purchasesInfo.description.auth.withCurrencyName":"guard.player.permissions.purchasesInfo.description.notAuth.withCurrencyName",{params:{currencyName:a}})}s.d(t,{f:()=>a})},37341:(e,t,s)=>{"use strict";s.d(t,{ff:()=>R,TI:()=>P,jT:()=>T});var a=s(87363),r=s(2203);const n=e=>({payload:e,type:r.x8L}),i=e=>({payload:e,type:r.pR1});var o=s(5825),d=s(43548),l=s(41576),c=s(25971),h=s(45474),u=s(93298),p=Object.defineProperty,m=Object.defineProperties,v=Object.getOwnPropertyDescriptors,g=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,y=(e,t,s)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,b=(e,t)=>{for(var s in t||(t={}))w.call(t,s)&&y(e,s,t[s]);if(g)for(var s of g(t))f.call(t,s)&&y(e,s,t[s]);return e};const k=Date.now(),A=(0,l.r)(),E=(0,u.M$)("GameControl | Parent frame",u.XG.Dev,{background:"#355c7d",text:"#ffffff"}),S=e=>JSON.stringify(e,((e,t)=>t instanceof Set?[...t]:t),2),I=(e,t)=>{var s,a,r;const n={initiator:t,timeFromInit:Date.now()-k};return null==(r=window.clickdaemonLog)||r.call(window,e,b({app_id:A,timestamp:Date.now(),sum_time:Number(null==(a=null==(s=null==performance?void 0:performance.now)?void 0:s.call(performance))?void 0:a.toFixed(0))||n.timeFromInit},n)),n},P=e=>(0,o.C)((({gameControl:t})=>e(t))),R=({reason:e}={reason:"other"})=>{const t=(0,o.T)(),s=P((e=>e)),l=(0,a.useRef)(s);l.current=s;const u=(0,a.useCallback)(((e,s,a,r="other")=>{const o=l.current,u=o.pauseReasons;E(`[GAME SWITCH]: gameEvent {${e}}, reason {${r}}, gameplay event {${s}}`),E("state:\n",S(o));return!!a(u,r)&&(o.current.gameEvent===e?(E(`IGNORING repeated {${e}} event with the same {${r}} reason`),!1):(o.current.gameplayEvent!==s&&d.Z.postToChild((0,c.$J)(s,I(s,"parent"))),t(i({gameplayEvent:o.current.gameplayEvent})),t(n({gameEvent:e,gameplayEvent:s})),d.Z.postToChild((0,h.ru)(e)),!0))}),[t]);return(0,a.useMemo)((()=>({gamePause:(s=e)=>u(h.Wu.Pause,c.BE.Stop,((e,s)=>{const a=0===e.size;return t({payload:s,type:r.Cm6}),a&&E(`{${s}} is the first pause reason. Pausing the game and sending the events.`),a}),s),gameResume:(s=e)=>u(h.Wu.Resume,l.current.prev.gameplayEvent,((e,s)=>{const a=1===e.size&&e.has(s);return t({payload:s,type:r.nx9}),a&&E(`{${s}} is the last pause reason. Resuming the game and sending the events.`),a}),s)})),[e,t,u])},T=()=>{const e=(0,o.T)(),t=P((e=>e)),s=(0,a.useRef)(t);s.current=t;const l=(0,a.useCallback)((t=>{const a=s.current;E(`[ON EXTERNAL MESSAGE]: type {${c.Tn}}, gameplay event {${t}}`),E("state:\n",S(a));const{current:o}=a;if(o.gameEvent===h.Wu.Pause)return E(`IGNORING {${t}} due to game is on pause`),!1;if(o.gameplayEvent===t)return E(`IGNORING repeated {${t}} action`),!1;if(t!==c.BE.Start&&t!==c.BE.Stop)return E(`UNKNOWN {${t}} action`),!1;const l=I(t,"child");var u;return e(i({gameplayEvent:o.gameplayEvent})),e(n((u=b({},o),m(u,v({gameplayEvent:t}))))),e({type:r.Ycx}),d.Z.postToChild((0,c.$J)(t,l)),!0}),[e]);return(0,a.useMemo)((()=>({gameplaySwitch:l})),[l])}},73171:(e,t,s)=>{"use strict";s.d(t,{D:()=>r});var a=s(87363);function r(e){const t=(0,a.useRef)();return(0,a.useEffect)((()=>{t.current=e}),[e]),t.current}},61224:(e,t,s)=>{"use strict";s.d(t,{$g:()=>o,VX:()=>c,kH:()=>l});var a=s(41811),r=s(15771),n=s(54093);const i=3e3;function o(e){return Date.now()-e>i}let d;const l=e=>{var t;return!!function(e){return e.referrerClid===a.x2&&(0,n.Gg)(e.userAgent)}(e)||(void 0===d&&(d=Date.now()),!!function(e){return!!(0,r.FV)(e.flags)&&e.referrerClid===a.Tn}(e)&&("function"==typeof(null==(t=window.PARTNERS_KIT)?void 0:t.isAdsEnabled)?!1===window.PARTNERS_KIT.isAdsEnabled():!o(d)&&void 0))},c=e=>!1!==l(e)},79409:(e,t,s)=>{"use strict";function a(e,t){return Boolean(0===(null==t?void 0:t.length)||(null==t?void 0:t.some((t=>t===e))))}s.d(t,{w:()=>a})},81442:(e,t,s)=>{"use strict";s.d(t,{r:()=>r});var a=s(58432);const r=()=>"object"==typeof window&&"2735850"===(0,a.KT)()},51290:(e,t,s)=>{"use strict";s.d(t,{U:()=>S});var a=s(14184),r=s(5e4),n=s(22823),i=s(34711),o=s(7991);const d=/testing/i,l=e=>d.test(e.adv_block_id);var c=s(97553),h=s(93298),u=s(99725),p=Object.defineProperty,m=Object.defineProperties,v=Object.getOwnPropertyDescriptors,g=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,y=(e,t,s)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,b=(e,t)=>{for(var s in t||(t={}))w.call(t,s)&&y(e,s,t[s]);if(g)for(var s of g(t))f.call(t,s)&&y(e,s,t[s]);return e};const k=(0,h.M$)("log-adv",h.XG.Adv),A=Date.now(),E={[r.$.ANCHOR]:0,[r.$.CATALOG]:0,[r.$.FEED_GRID]:0,[r.$.INTERSTITIAL]:0,[r.$.REWARDED]:0,[r.$.STICKY]:0};class S{constructor(e){this.startTime=-1,this.requestStartTime=-1,this.showStartTime=-1,this.previousEventNames=[],this.additional=Object.assign(this.getGeneralEventParams(),e)}tag(e){return this.additional.tag=e,this}bindRequest(e){this.additional.ad_req_id=e.additional.ad_req_id}copy(e={}){const t=Object.assign(Object.create(Object.getPrototypeOf(this)),this);return t.previousEventNames=[...this.previousEventNames],t.additional=b(b({},this.additional),e),t}getGeneralEventParams(){const e={},t=(0,i.X)();t&&(e.clid=String(t));const s=(0,o.W5)();s&&(e.gclid=String(s));const a=(0,n.L)();if(a){const{key:t,value:s}=a;e[t]=s}return e}logError(e,t={}){const s=new Error(e);s.additional=t,(0,a.fF)(s,{prefix:"Adv ClickDaemon error"})}checkOrder(e,t){this.previousEventNames.includes(e)||this.logError(`No precending ${e} event call before ${t}`)}sendLog(e,t={}){var s,a,r,n;r=b(b({},this.additional),t),n={documentHidden:"hidden"===document.visibilityState},(t=m(r,v(n))).exclude_from_alerts=l(t),-1!==this.startTime&&(t.timeshift=Date.now()-this.startTime||-1),(null==(s=t.provider)?void 0:s.includes("_block"))&&(t.provider=t.provider.replace("_block","")),t.provider&&!t.advtype&&(t.advtype=t.provider),this.previousEventNames.push(e),h.HQ&&k("clickdaemon",`adv2_${e}`,t),null==(a=window.clickdaemonLog)||a.call(window,`adv_${e}`,t)}hadEvent(e){return this.previousEventNames.includes(e)}tryOpen({provider:e,reason:t}){this.additional.ad_seq_id=(0,u.w)(),this.additional.reason=t,e&&(this.additional.provider=e);const s={pageShow:++E[this.additional.tag],pageStartTime:Date.now()-A};this.sendLog(c.zL.TRY_OPEN,s),this.startTime=Date.now()}noAdv(){this.checkOrder(c.zL.TRY_OPEN,c.zL.NO_ADV),this.sendLog(c.zL.NO_ADV)}skip(e){this.checkOrder(c.zL.TRY_OPEN,c.zL.SKIP),this.sendLog(c.zL.SKIP,{reason:e})}rateLimited(e){this.checkOrder(c.zL.TRY_OPEN,c.zL.RATE_LIMITED),this.sendLog(c.zL.RATE_LIMITED,{reason:e})}demand({advBlockId:e,depth:t,provider:s,reason:a}){this.checkOrder(c.zL.TRY_OPEN,c.zL.DEMAND),this.additional.adv_block_id=e,this.additional.depth=null!=t?t:0,s&&(this.additional.provider=s),a&&(this.additional.reason=a),this.sendLog(c.zL.DEMAND)}waterfall({advBlockId:e,depth:t,provider:s,reason:a,tag:r}){this.checkOrder(c.zL.DEMAND,c.zL.WATERFALL),r&&(this.additional.tag=r),this.additional.provider=s,this.additional.adv_block_id=e,this.additional.depth=t,this.additional.reason=a,this.sendLog(c.zL.WATERFALL)}request(e){e||this.checkOrder(c.zL.DEMAND,c.zL.REQUEST),this.requestStartTime=Date.now(),e&&(this.additional.adv_block_id=e.advBlockId,e.reason&&(this.additional.reason=e.reason),e.provider&&(this.additional.provider=e.provider)),(null==e?void 0:e.adReqId)?this.additional.ad_req_id=e.adReqId:this.additional.ad_req_id=(0,u.w)();const t={};void 0!==this.highestCpmBidder&&(t.highestCpmBidder=this.highestCpmBidder),this.sendLog(c.zL.REQUEST,t)}response(){this.checkOrder(c.zL.REQUEST,c.zL.RESPONSE);const e={reason:"success",time_to_close:-1===this.requestStartTime?-1:Date.now()-this.requestStartTime};void 0!==this.highestCpmBidder&&(e.highestCpmBidder=this.highestCpmBidder),this.sendLog(c.zL.RESPONSE,e)}responseEmpty(){this.checkOrder(c.zL.REQUEST,c.zL.RESPONSE_EMPTY);const e={time_to_close:-1===this.requestStartTime?-1:Date.now()-this.requestStartTime};void 0!==this.highestCpmBidder&&(e.highestCpmBidder=this.highestCpmBidder),this.sendLog(c.zL.RESPONSE_EMPTY,e)}show(){this.checkOrder(c.zL.DEMAND,c.zL.SHOW),this.showStartTime=Date.now(),this.sendLog(c.zL.SHOW)}rewarded(){this.checkOrder(c.zL.SHOW,c.zL.REWARDED),this.sendLog(c.zL.REWARDED)}close(){this.checkOrder(c.zL.SHOW,c.zL.CLOSE),this.sendLog(c.zL.CLOSE,{time_to_close:-1===this.showStartTime?-1:Date.now()-this.showStartTime})}noContent(){this.checkOrder(c.zL.RESPONSE_EMPTY,c.zL.NO_CONTENT),this.sendLog(c.zL.NO_CONTENT)}fail(e){this.sendLog(c.zL.FAIL,{reason:String(e)})}error(e){this.sendLog(c.zL.ERROR,{reason:String(e)})}}},65068:(e,t,s)=>{"use strict";s.d(t,{i:()=>k});var a=s(23404),r=s(14184),n=s(22823),i=s(34711),o=s(7991),d=s(97553),l=s(60295),c=s(93298),h=s(99725),u=Object.defineProperty,p=Object.defineProperties,m=Object.getOwnPropertyDescriptors,v=Object.getOwnPropertySymbols,g=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable,f=(e,t,s)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,y=(e,t)=>{for(var s in t||(t={}))g.call(t,s)&&f(e,s,t[s]);if(v)for(var s of v(t))w.call(t,s)&&f(e,s,t[s]);return e};const b=(0,c.M$)("log-adv",c.XG.Adv);class k{constructor(e){this.additional=e,this.requestHistory=[],this.openHistory=[],this.showStartTime={},this.requestStartTime={},this.seqToReqMap={}}request(e){var t;const s=Object.assign(this.getGeneralEventParams(),{ad_req_id:(0,h.w)(),adv_block_id:e.advBlockId,advtype:e.advtype,adv_block_type:e.adv_block_type||e.advtype,depth:String(null!=(t=e.depth)?t:Object.keys(this.requestHistory).length),reason:e.reason||d.p_.ONSPOT});if(this.requestStartTime[s.ad_req_id]=Date.now(),e.prevReqId)s.prev_ad_req_id=e.prevReqId;else if("0"!==s.depth)try{s.prev_ad_req_id=this.getPrevAdReqId(Number(s.depth))}catch(e){this.logError("prev_ad_req_id is not defined",(a=y({event:d.zL.REQUEST},s),r={history:this.requestHistory.map((e=>e.ad_req_id))},p(a,m(r))))}var a,r;return this.requestHistory.push(s),this.sendLog(d.zL.REQUEST,s),s.ad_req_id}restoreRequest(e){this.requestHistory.push(e)}response({adReqId:e,depth:t,clickUrl:s,reason:a,advBlockType:r}){let n=-1;if(e)n=this.requestHistory.findIndex((t=>t.ad_req_id===e));else if(void 0!==t)for(let e=this.requestHistory.length-1;e>=0;e--)if(this.requestHistory[e].depth===String(t)){n=e;break}if(-1===n)return void this.logError("Request history not found",y({adReqId:e,depth:t,clickUrl:s,reason:a,advBlockType:r},this.getGeneralEventParams()));const i=this.requestHistory[n],o=Date.now()-this.requestStartTime[i.ad_req_id],c=Object.assign(this.getGeneralEventParams(),{ad_req_id:i.ad_req_id,adv_block_id:i.adv_block_id,adv_block_type:r||i.advtype,advtype:i.advtype,depth:String(i.depth),time_to_close:String(o)});i.prev_ad_req_id&&(c.prev_ad_req_id=i.prev_ad_req_id),s&&(this.requestHistory[n].click_url=s,c.click_url=s),a&&(c.reason=a),(0,l.s4)("load_adv_time",o,!0,{"-additional":encodeURIComponent(JSON.stringify({ad_req_id:i.ad_req_id,adv_block_id:i.adv_block_id,adv_block_type:r||i.advtype,advtype:i.advtype,depth:String(i.depth),tag:i.tag||"",reason:i.reason||""}))}),this.sendLog(d.zL.RESPONSE,c)}rerender(e,t){return this.tryOpen(e,t,d.zL.RERENDER)}tryOpen(e,t,s=d.zL.TRY_OPEN){const a=Object.assign(this.getGeneralEventParams(),{ad_seq_id:(0,h.w)(),adv_block_id:e,advtype:t,startTime:Date.now()});return this.openHistory.push(a),this.sendLog(s,a),a.ad_seq_id}noAdv(e){this.sendNestedTryOpenLog(d.zL.NO_ADV,e)}rateLimited(e,t){this.sendNestedTryOpenLog(d.zL.RATE_LIMITED,t,{reason:e})}skip(e,t){this.sendNestedTryOpenLog(d.zL.SKIP,t,{reason:e})}demand(e,t=0,s,a){const r={};t&&(r.depth=String(t)),e&&(r.reason=e),(null==a?void 0:a.advBlockId)&&(r.adv_block_id=null==a?void 0:a.advBlockId),(null==a?void 0:a.advtype)&&(r.advtype=null==a?void 0:a.advtype),this.sendNestedTryOpenLog(d.zL.DEMAND,s,r)}error(e,t,s){const a=this.getGeneralNestedRequestParams(d.zL.ERROR,e,t);a.reason=s,this.sendLog(d.zL.ERROR,a)}fail(e,t,s){const a=this.getGeneralNestedRequestParams(d.zL.FAIL,e,t);a.reason=s,this.sendLog(d.zL.FAIL,a)}errorNoRequest({adSeqId:e,advBlockId:t,provider:s,error:a,depth:r}){const n=Object.assign(this.getGeneralEventParams(),{ad_req_id:"",ad_seq_id:e,adv_block_id:t,advtype:s,depth:r||0,reason:`Request was not initiated_${a}`});this.sendLog(d.zL.ERROR,n)}noContent(e,t,s={}){const a=this.getGeneralNestedRequestParams(d.zL.NO_CONTENT,e,t);this.sendLog(d.zL.NO_CONTENT,y(y({},a),s))}show(e,t,s,a){const r=this.getGeneralNestedRequestParams(d.zL.SHOW,e,t,s);a&&(r.reason=a),this.showStartTime[t]=Date.now(),this.sendLog(d.zL.SHOW,r)}rewarded(e,t){const s=this.getGeneralNestedRequestParams(d.zL.REWARDED,e,t);this.sendLog(d.zL.REWARDED,s)}close(e,t){const s=this.getGeneralNestedRequestParams(d.zL.CLOSE,e,t);s.time_to_close=String(Date.now()-this.showStartTime[t]),this.sendLog(d.zL.CLOSE,s)}getRequestByAdReqId(e){return this.requestHistory.find((t=>t.ad_req_id===e))}sendLog(e,t){var s;t.documentHidden="hidden"===document.visibilityState,c.HQ&&b("clickdaemon",`adv_${e}`,t),null==(s=window.clickdaemonLog)||s.call(window,`adv_${e}`,t)}getGeneralNestedRequestParams(e,t,s,a){t?this.seqToReqMap[s]&&(this.seqToReqMap[s]=t):t=this.seqToReqMap[s];const r=this.requestHistory.find((e=>e.ad_req_id===t)),n=this.openHistory.find((e=>e.ad_seq_id===s));r||this.logError("ad_req_id is not found",y({event:e,adReqId:t,adSeqId:s,clickUrl:a,advtype:null==n?void 0:n.advtype},this.getGeneralEventParams())),n||this.logError("ad_seq_id is not found",y({event:e,adReqId:t,adSeqId:s,clickUrl:a,advtype:null==r?void 0:r.advtype},this.getGeneralEventParams()));const i=Object.assign(this.getGeneralEventParams(),{ad_req_id:t,ad_seq_id:s,adv_block_id:(null==r?void 0:r.adv_block_id)||"",adv_block_type:null==r?void 0:r.advtype,advtype:null==r?void 0:r.advtype,click_url:a||(null==r?void 0:r.click_url)||"",depth:(null==r?void 0:r.depth)||"0"});return(null==r?void 0:r.adsessionid)&&(i.adsessionid=null==r?void 0:r.adsessionid),(null==r?void 0:r.prev_ad_req_id)&&(i.prev_ad_req_id=r.prev_ad_req_id),Object.assign(this.getGeneralEventParams(),i)}sendNestedTryOpenLog(e,t,s={}){if(!this.openHistory.length)return void this.logError("No adv_try_open was called",y(y({event:e,adSeqId:t},s),this.getGeneralEventParams()));let a;t&&(a=this.openHistory.find((e=>e.ad_seq_id===t))),a||(a=this.openHistory[this.openHistory.length-1]);const r=Object.assign({},a,s);delete r.startTime,this.sendLog(e,r)}getGeneralEventParams(){const e=Object.assign({},this.additional),t=(0,i.X)();t&&(e.clid=String(t));const s=(0,o.W5)();s&&(e.gclid=String(s));const a=(0,n.L)();if(a){const{key:t,value:s}=a;e[t]=s}return e}getPrevAdReqId(e){const t=Object.keys(this.requestHistory).length;let s="";if(e){if(t>=e)for(let t=this.requestHistory.length-1;t>=0;t--)if(this.requestHistory[t].depth===String(e-1)){s=this.requestHistory[t].ad_req_id;break}}else t>0&&(s=this.requestHistory[t-1].ad_req_id);if(!s)throw new Error;return s}logError(e,t={}){const s=new Error(e);s.additional=t,(0,r.fF)(s,{prefix:a.yt})}}},97553:(e,t,s)=>{"use strict";s.d(t,{Jm:()=>i,Ud:()=>r,o9:()=>n,p_:()=>a,zL:()=>o});var a=(e=>(e.ONSPOT="onspot",e.PRELOAD="preload",e.PRELOAD_WATERFALL="preload_waterfall",e.REFRESH="refresh",e.START_FULLSCREEN="start_fullscreen",e.WATERFALL="waterfall",e))(a||{}),r=(e=>(e.EMPTY="empty",e.ERROR="error",e.NOT_IMPL="not_impl",e.SUCCESS="success",e))(r||{}),n=(e=>(e.SKIP="skip",e))(n||{}),i=(e=>(e.ALL_ADS_DISABLED_BY_PARTNERS_KIT="all_ads_disabled_by_partners_kit",e.ANOTHER_AD_OPENED="another_ad_opened",e.INTERSTITIAL_ADS_TURN_OFF="interstitial_ads_turn_off",e.NOT_ENOUGH_CONTAINER_SIZE="not_enough_container_size",e.REWARDED_ADS_TURN_OFF="rewarded_ads_turn_off",e.TV="tv",e.UNKNOWN="unknown",e.UTM="utm",e.WATERFALL_ITEM_CONSTRAINTS="waterfall_item_constraints",e))(i||{}),o=(e=>(e.CLOSE="close",e.DEMAND="demand",e.ERROR="error",e.FAIL="fail",e.NO_ADV="no_adv",e.NO_CONTENT="no_content",e.RATE_LIMITED="rate_limited",e.REQUEST="request",e.RERENDER="rerender",e.RESPONSE="response",e.RESPONSE_EMPTY="response_empty",e.REWARDED="rewarded",e.SHOW="show",e.SKIP="skip",e.TRY_OPEN="try_open",e.WATERFALL="waterfall",e))(o||{})},52763:(e,t,s)=>{"use strict";s.d(t,{Z:()=>w});var a=s(93298),r=Object.defineProperty,n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,d=(e,t,s)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,l=(e,t)=>{for(var s in t||(t={}))i.call(t,s)&&d(e,s,t[s]);if(n)for(var s of n(t))o.call(t,s)&&d(e,s,t[s]);return e};s(29255);const c=["height","width"],h=["top","left","right","bottom"],u=[...c,...h],p="game",m=[".game",".play-guard-dialog",".merge-conflicts",".guard"],v=(0,a.M$)("ResizeBlockManager",a.XG.Dev,{background:"#c7aa00"}),g="ResizeBlockManager";const w=new class{constructor(){if(this.rootElements=[],this.blocks={},this.resizeBlocks={},this.resizes={},this.resizeListeners={},this.getObserverCallback=(e,t,s)=>(a,r)=>{const n=e.querySelector(t);n&&(r.disconnect(),s(n))},"undefined"==typeof window)return;let e;try{window.parent[g],e=window.parent}catch(t){e=window}if(e[g]){const t=e[g];t.rootElements.includes(window.document.body)||(t.rootElements.push(window.document.body),t.updateBlocks(),t.applyResizeBlocks("new rootElement"))}else e[g]=this,this.rootElements=[window.document.body];return e[g]}addResizeBlockListener(e,t,s=!0){var a;v("addListener",e),this.resizeListeners[e]||(this.resizeListeners[e]=[]);const r=this.resizeListeners[e];if(-1===r.indexOf(t)){if(r.push(t),s){const t=e===p?".game":e;this.resizeBlocks[t]&&this.callbackBlock(e,null!=(a=this.resizeBlocks[t])?a:{})}}else v("try to add existing listener, ",e)}removeResizeBlockListener(e,t){if(v("removeListener",e),!this.resizeListeners[e])return;const s=this.resizeListeners[e],a=s.indexOf(t);-1!==a&&s.splice(a,1)}addResizeBlock(e,t){v("addResize",e,t),this.resizes[e]=t,this.calcResizeBlocks(),this.updateBlocks(),this.applyResizeBlocks("addResizeBlock")}removeResizeBlock(e){v("removeResize",e),this.resizes[e]&&(delete this.resizes[e],this.calcResizeBlocks(),this.updateBlocks(),this.applyResizeBlocks("removeResizeBlock"))}findHTMLElement(e){let t=null;for(const s of this.rootElements)if(t=s.querySelector(e),t)break;if(t)return void(this.blocks[e]=t);v("create MutationObserver for ",e);const s=this.rootElements.map((t=>{const s=new MutationObserver(this.getObserverCallback(t,e,(t=>{this.blocks[e]=t,this.applyResizeBlocks("block found "+e)})));return s.observe(t,{childList:!0}),s}));this.blocks[e]=s}updateBlocks(){for(const e in this.blocks){if(void 0!==this.resizeBlocks[e])continue;const t=this.blocks[e];t instanceof Array?(t.forEach((e=>{e.disconnect()})),delete this.blocks[e]):(this.clearResizeBlock(e,this.blocks[e]),delete this.blocks[e])}for(const e in this.resizeBlocks)void 0===this.blocks[e]&&this.findHTMLElement(e)}calcResizeBlocks(){const e={};for(const t in this.resizes){const s=this.resizes[t];for(const t in s)if(s[t])if(t===p)for(const a of m)this.calcResizeParam(e,s[t],a);else this.calcResizeParam(e,s[t],t)}this.resizeBlocks=e}calcResizeParam(e,t,s){var a,r;let n=e[s];n||(n={},e[s]=n);for(const e of u)n[e]=(null!=(a=n[e])?a:0)+(null!=(r=t[e])?r:0)}applyResizeBlocks(e="unknown"){v(`applyResize (${e})`,this.resizeBlocks,this.blocks);for(const e in this.resizeBlocks){const t=this.blocks[e];if(!t||Array.isArray(t))continue;const s=this.resizeBlocks[e];for(const e of h)(null==s?void 0:s[e])?t.style[e]=s[e]+"px":t.style.removeProperty(e);for(const e of c)(null==s?void 0:s[e])?t.style[e]=`calc(100% + ${s[e]}px)`:t.style.removeProperty(e);this.callbackBlock(e,null!=s?s:{})}}clearResizeBlock(e,t){for(const e of u)t.style.removeProperty(e);this.callbackBlock(e,{})}callbackBlock(e,t){var s;if(".game"===e&&this.callbackBlock(p,t),null==(s=this.resizeListeners[e])?void 0:s.length)for(const s of this.resizeListeners[e])s(e,l({top:0,left:0,right:0,bottom:0,width:0,height:0},t))}removeDefaultClass(e){const t=window.document.body;Array.from(t.classList).forEach((s=>{e.forEach((e=>{s.startsWith(e)&&t.classList.remove(s)}))}))}}},909:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(43548),r=s(91521),n=s(48810),i=s(41811);function o(){(0,n.Ur)(r.Z,"true"),a.Z.post({type:"payments",action:"platform-purchase-start",data:{paymentsConfig:{},purchaseConfig:{id:i.U0.NO_ADS_ONE_DAY,developerPayload:""}}})}},65562:(e,t,s)=>{"use strict";s.d(t,{G:()=>r,g:()=>n});var a=s(26256);const r=e=>Boolean((null==e?void 0:e.BrowserName)&&/Safari/i.test(e.BrowserName)),n=e=>(null==e?void 0:e.OSFamily)===a.k.IOS},22695:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});const a={label:"checkbox-desktop-critical-module__label--GXRye"}},72007:(e,t,s)=>{"use strict";s.r(t)},97507:(e,t,s)=>{"use strict";s.r(t)},61976:(e,t,s)=>{"use strict";s.r(t)},40925:(e,t,s)=>{"use strict";s.r(t)},82854:(e,t,s)=>{"use strict";s.r(t)},29255:(e,t,s)=>{"use strict";s.r(t)},37379:e=>{!function(){"use strict";e.exports={polyfill:function(){var e=window,t=document;if(!("scrollBehavior"in t.documentElement.style)||!0===e.__forceSmoothScrollPolyfill__){var s,a=e.HTMLElement||e.Element,r=468,n={scroll:e.scroll||e.scrollTo,scrollBy:e.scrollBy,elementScroll:a.prototype.scroll||d,scrollIntoView:a.prototype.scrollIntoView},i=e.performance&&e.performance.now?e.performance.now.bind(e.performance):Date.now,o=(s=e.navigator.userAgent,new RegExp(["MSIE ","Trident/","Edge/"].join("|")).test(s)?1:0);e.scroll=e.scrollTo=function(){void 0!==arguments[0]&&(!0!==l(arguments[0])?m.call(e,t.body,void 0!==arguments[0].left?~~arguments[0].left:e.scrollX||e.pageXOffset,void 0!==arguments[0].top?~~arguments[0].top:e.scrollY||e.pageYOffset):n.scroll.call(e,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:e.scrollX||e.pageXOffset,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:e.scrollY||e.pageYOffset))},e.scrollBy=function(){void 0!==arguments[0]&&(l(arguments[0])?n.scrollBy.call(e,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:0,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:0):m.call(e,t.body,~~arguments[0].left+(e.scrollX||e.pageXOffset),~~arguments[0].top+(e.scrollY||e.pageYOffset)))},a.prototype.scroll=a.prototype.scrollTo=function(){if(void 0!==arguments[0])if(!0!==l(arguments[0])){var e=arguments[0].left,t=arguments[0].top;m.call(this,this,void 0===e?this.scrollLeft:~~e,void 0===t?this.scrollTop:~~t)}else{if("number"==typeof arguments[0]&&void 0===arguments[1])throw new SyntaxError("Value could not be converted");n.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left:"object"!=typeof arguments[0]?~~arguments[0]:this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top:void 0!==arguments[1]?~~arguments[1]:this.scrollTop)}},a.prototype.scrollBy=function(){void 0!==arguments[0]&&(!0!==l(arguments[0])?this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior}):n.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop))},a.prototype.scrollIntoView=function(){if(!0!==l(arguments[0])){var s=function(e){for(;e!==t.body&&!1===u(e);)e=e.parentNode||e.host;return e}(this),a=s.getBoundingClientRect(),r=this.getBoundingClientRect();s!==t.body?(m.call(this,s,s.scrollLeft+r.left-a.left,s.scrollTop+r.top-a.top),"fixed"!==e.getComputedStyle(s).position&&e.scrollBy({left:a.left,top:a.top,behavior:"smooth"})):e.scrollBy({left:r.left,top:r.top,behavior:"smooth"})}else n.scrollIntoView.call(this,void 0===arguments[0]||arguments[0])}}function d(e,t){this.scrollLeft=e,this.scrollTop=t}function l(e){if(null===e||"object"!=typeof e||void 0===e.behavior||"auto"===e.behavior||"instant"===e.behavior)return!0;if("object"==typeof e&&"smooth"===e.behavior)return!1;throw new TypeError("behavior member of ScrollOptions "+e.behavior+" is not a valid value for enumeration ScrollBehavior.")}function c(e,t){return"Y"===t?e.clientHeight+o<e.scrollHeight:"X"===t?e.clientWidth+o<e.scrollWidth:void 0}function h(t,s){var a=e.getComputedStyle(t,null)["overflow"+s];return"auto"===a||"scroll"===a}function u(e){var t=c(e,"Y")&&h(e,"Y"),s=c(e,"X")&&h(e,"X");return t||s}function p(t){var s,a,n,o,d=(i()-t.startTime)/r;o=d=d>1?1:d,s=.5*(1-Math.cos(Math.PI*o)),a=t.startX+(t.x-t.startX)*s,n=t.startY+(t.y-t.startY)*s,t.method.call(t.scrollable,a,n),a===t.x&&n===t.y||e.requestAnimationFrame(p.bind(e,t))}function m(s,a,r){var o,l,c,h,u=i();s===t.body?(o=e,l=e.scrollX||e.pageXOffset,c=e.scrollY||e.pageYOffset,h=n.scroll):(o=s,l=s.scrollLeft,c=s.scrollTop,h=d),p({scrollable:o,method:h,startTime:u,startX:l,startY:c,x:a,y:r})}}}}()}}]);
//# sourceMappingURL=https://s3.mdst.yandex.net/games/source-maps/_/build/client/game/desktop/yandex/GameBody.component.async.138240b0f9e523a8f3fc.js.map